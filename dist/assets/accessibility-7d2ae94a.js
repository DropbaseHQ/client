import{_ as S,h as u,dr as A,mi as N,cv as V,n as x,nh as W,ni as L}from"./index-5b71d1bd.js";import{hV as D,aW as T,aM as m,av as i,qx as b,eR as c,dj as f,uk as p,cQ as M,aY as I,iC as R,sx as K,c5 as P,au as B,c6 as U,b8 as O,ej as z,e$ as G,hM as q,sW as w,hx as r,hw as a,hR as j,rx as C,af as Y,qH as $,hG as Q,f0 as X,cc as J,fu as Z}from"./vendor-332432be.js";import{r as ee,A as te,a as ie}from"./accessibilityContribution-303aed9a.js";ee();let y=class extends m{onClose(){this._editor.focus(),this.dispose()}constructor(e,t){super(),this._editor=e,this._keybindingService=t,this.options={type:"helpMenu",ariaLabel:i("editor-help","editor accessibility help"),readMoreUrl:"https://go.microsoft.com/fwlink/?linkid=851010"},this.id="editor"}_descriptionForCommand(e,t,o){const n=this._keybindingService.lookupKeybinding(e);return n?b(t,n.getAriaLabel()):b(o,e)}provideContent(){const e=this._editor.getOptions(),t=[];e.get(59)?e.get(88)?t.push(c.readonlyDiffEditor):t.push(c.editableDiffEditor):e.get(88)?t.push(c.readonlyEditor):t.push(c.editableEditor);const o=f?c.changeConfigToOnMac:c.changeConfigToOnWinLinux;switch(e.get(2)){case 0:t.push(o);break;case 2:t.push(c.auto_on);break;case 1:t.push(c.auto_off,o);break}return e.get(140)?t.push(this._descriptionForCommand(p.ID,c.tabFocusModeOnMsg,c.tabFocusModeOnMsgNoKb)):t.push(this._descriptionForCommand(p.ID,c.tabFocusModeOffMsg,c.tabFocusModeOffMsgNoKb)),t.join(`
`)}};y=S([u(1,D)],y);class oe extends m{constructor(){super(),this._register(te.addImplementation(95,"editor",async e=>{const t=e.get(M),o=e.get(N),n=e.get(I),d=e.get(R);let s=t.getActiveCodeEditor()||t.getFocusedCodeEditor();s||(await d.executeCommand(V),s=t.getActiveCodeEditor()),o.registerProvider(n.createInstance(y,s)),o.show("editor")}))}}const se=T.as(A.Workbench);se.registerWorkbenchContribution(oe,4);class ne extends m{constructor(){super(),this._register(ie.addImplementation(90,"hover",e=>{const t=e.get(N),o=e.get(M),n=o.getActiveCodeEditor()||o.getFocusedCodeEditor();if(!n)return!1;const d=K.get(n),s=P(d==null?void 0:d.getWidgetContent());if(!d||!s)return!1;const h=t.registerProvider({id:"hover",provideContent(){return s},onClose(){h.dispose(),d.focus()},options:{ariaLabel:i("hoverAccessibleView","Hover Accessible View"),language:"typescript",type:"view"}});return t.show("hover"),!0}))}}const re=T.as(A.Workbench);re.registerWorkbenchContribution(ne,4);var de=".accessible-view{background-color:var(--vscode-editorWidget-background);border:2px solid var(--vscode-contrastActiveBorder);box-shadow:0 2px 8px var(--vscode-widget-shadow);color:var(--vscode-editorWidget-foreground);position:relative}";x(de,{});const ce=new B("accessibilityHelpWidgetVisible",!1);let v=class k extends m{static get(e){return e.getContribution(k.ID)}constructor(e,t){super(),this.instantiationService=t,this._editor=e}show(){this._widget||(this._widget=this._register(this.instantiationService.createInstance(g,this._editor))),this._widget.show()}hide(){var e;(e=this._widget)==null||e.hide()}};v.ID="editor.contrib.accessibilityHelpController";v=S([u(1,I)],v);let g=class l extends q{constructor(e,t,o,n,d){super(),this._contextKeyService=t,this._keybindingService=o,this._configurationService=n,this._openerService=d,this._editor=e,this._isVisibleKey=ce.bindTo(this._contextKeyService),this._domNode=w(document.createElement("div")),this._domNode.setClassName("accessibilityHelpWidget"),this._domNode.setWidth(l.WIDTH),this._domNode.setHeight(l.HEIGHT),this._domNode.setDisplay("none"),this._domNode.setAttribute("role","dialog"),this._domNode.setAttribute("aria-modal","true"),this._domNode.setAttribute("aria-hidden","true");const s=r(this._domNode.domNode,a("h1",void 0,i("accessibilityHelpTitle","Accessibility Help")));s.id="help-dialog-heading",this._domNode.setAttribute("aria-labelledby",s.id),this._contentDomNode=w(document.createElement("div")),this._contentDomNode.setAttribute("role","document"),this._contentDomNode.domNode.id="help-dialog-content",this._domNode.appendChild(this._contentDomNode),this._domNode.setAttribute("aria-describedby",this._contentDomNode.domNode.id),this._isVisible=!1,this._register(this._editor.onDidLayoutChange(()=>{this._isVisible&&this._layout()})),this._register(j(this._contentDomNode.domNode,"keydown",h=>{this._isVisible&&(h.equals(2083)&&(C(i("emergencyConfOn","Now changing the setting `editor.accessibilitySupport` to 'on'.")),this._configurationService.updateValue("editor.accessibilitySupport","on",2),h.preventDefault(),h.stopPropagation()),h.equals(2086)&&(C(i("openingDocs","Now opening the VS Code Accessibility documentation page.")),this._openerService.open(Y.parse("https://go.microsoft.com/fwlink/?linkid=851010")),h.preventDefault(),h.stopPropagation()))})),this.onblur(this._contentDomNode.domNode,()=>{this.hide()}),this._editor.addOverlayWidget(this)}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return l.ID}getDomNode(){return this._domNode.domNode}getPosition(){return{preference:null}}show(){this._isVisible||(this._isVisible=!0,this._isVisibleKey.set(!0),this._layout(),this._domNode.setDisplay("block"),this._domNode.setAttribute("aria-hidden","false"),this._contentDomNode.domNode.tabIndex=0,this._buildContent(),this._contentDomNode.domNode.focus())}_descriptionForCommand(e,t,o){const n=this._keybindingService.lookupKeybinding(e);return n?b(t,n.getAriaLabel()):b(o,e)}_buildContent(){const e=this._contentDomNode.domNode,t=this._editor.getOptions();r(e,a("p",void 0,i("introMsg","Thank you for trying out VS Code's accessibility options."))),r(e,a("p",void 0,i("status","Status:")));const o=this._configurationService.getValue("editor").accessibilitySupport,n=t.get(2),d=f?i("changeConfigToOnMac","To configure the editor to be permanently optimized for usage with a Screen Reader press Command+E now."):i("changeConfigToOnWinLinux","To configure the editor to be permanently optimized for usage with a Screen Reader press Control+E now."),s=r(e,a("ul"));switch(o){case"auto":switch(n){case 0:r(s,a("li",void 0,i("auto_unknown","The editor is configured to use platform APIs to detect when a Screen Reader is attached, but the current runtime does not support this.")));break;case 2:r(s,a("li",void 0,i("auto_on","The editor has automatically detected a Screen Reader is attached.")));break;case 1:r(s,a("li",void 0,i("auto_off","The editor is configured to automatically detect when a Screen Reader is attached, which is not the case at this time.")," "+d));break}break;case"on":r(s,a("li",void 0,i("configuredOn","The editor is configured to be permanently optimized for usage with a Screen Reader - you can change this via the command `Toggle Screen Reader Accessibility Mode` or by editing the setting `editor.accessibilitySupport`")));break;case"off":r(s,a("li",void 0,i("configuredOff","The editor is configured to never be optimized for usage with a Screen Reader."," "+d)));break}const h=i("tabFocusModeOnMsg","Pressing Tab in the current editor will move focus to the next focusable element. Toggle this behavior by pressing {0}."),E=i("tabFocusModeOnMsgNoKb","Pressing Tab in the current editor will move focus to the next focusable element. The command {0} is currently not triggerable by a keybinding."),H=i("tabFocusModeOffMsg","Pressing Tab in the current editor will insert the tab character. Toggle this behavior by pressing {0}."),F=i("tabFocusModeOffMsgNoKb","Pressing Tab in the current editor will insert the tab character. The command {0} is currently not triggerable by a keybinding.");$.getTabFocusMode("editorFocus")?r(s,a("li",void 0,this._descriptionForCommand(p.ID,h,E))):r(s,a("li",void 0,this._descriptionForCommand(p.ID,H,F))),r(e,f?i("openDocMac","Press Command+H now to open a browser window with more VS Code information related to Accessibility."):i("openDocWinLinux","Press Control+H now to open a browser window with more VS Code information related to Accessibility.")),r(e,a("p",void 0,i("outroMsg","You can dismiss this tooltip and return to the editor by pressing Escape or Shift+Escape.")))}hide(){this._isVisible&&(this._isVisible=!1,this._isVisibleKey.reset(),this._domNode.setDisplay("none"),this._domNode.setAttribute("aria-hidden","true"),this._contentDomNode.domNode.tabIndex=-1,Q(this._contentDomNode.domNode),this._editor.focus())}_layout(){const e=this._editor.getLayoutInfo(),t=Math.min(e.width-40,l.WIDTH),o=Math.min(e.height-40,l.HEIGHT);this._domNode.setTop(Math.round((e.height-o)/2)),this._domNode.setLeft(Math.round((e.width-t)/2)),this._domNode.setWidth(t),this._domNode.setHeight(o)}};g.ID="editor.contrib.accessibilityHelpWidget";g.WIDTH=500;g.HEIGHT=320;g=S([u(1,U),u(2,D),u(3,O),u(4,z)],g);class ae extends X{constructor(){super({id:"editor.action.toggleScreenReaderAccessibilityMode",title:{value:i("toggleScreenReaderMode","Toggle Screen Reader Accessibility Mode"),original:"Toggle Screen Reader Accessibility Mode"},f1:!0,keybinding:{primary:2083,weight:200+10,when:W}})}async run(e){const t=e.get(J);e.get(O).updateValue("editor.accessibilitySupport",t.isScreenReaderOptimized()?"off":"on",2)}}G(ae);function be(){return{[N.toString()]:new Z(L,[])}}export{be as default};
