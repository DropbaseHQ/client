var Hp=Object.defineProperty;var Gp=(c,e,t)=>e in c?Hp(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var Ns=(c,e,t)=>(Gp(c,typeof e!="symbol"?e+"":e,t),t);import{n as he,C as Up,S as zp,A as Kp,j as $p,k as vd,l as qp,m as jp,p as Yo,q as Dr,r as Yp,t as Jp,_ as C,h,v as st,x as Qe,y as Ci,z as Xp,B as Lt,E as Xe,F as _h,V as Oo,G as hc,H as wd,J as yd,K as Zp,L as So,M as Si,N as Mt,O as Qp,P as Eh,Q as eg,R as tg,U as Dh,W as ig,X as kh,Y as og,Z as xh,$ as ti,a0 as lc,a1 as uc,a2 as Us,a3 as kr,a4 as sg,a5 as pc,a6 as to,a7 as Ih,a8 as ng,a9 as rg,aa as ag,ab as cg,ac as dg,ad as hg,ae as lg,af as P,ag as ms,ah as ug,ai as Ah,aj as Ro,ak as xr,al as pg,am as gg,an as Cd,ao as fg,ap as mg,aq as bg,ar as vg,as as wg,at as On,au as Rn,av as It,aw as Ln,ax as gc,ay as gi,az as Pt,aA as ee,aB as ne,aC as J,aD as yg,aE as we,aF as Th,aG as Vh,aH as Oh,aI as Rh,aJ as Cg,aK as Sg,aL as Lh,aM as Ir,aN as Et,aO as He,aP as Mh,aQ as Mn,aR as Ar,aS as _g,aT as Eg,aU as Dg,aV as kg,aW as xg,aX as Ig,aY as Ag,aZ as Ph,a_ as Tr,a$ as Fh,b0 as Vr,b1 as Nh,b2 as rr,b3 as ar,b4 as We,b5 as _e,b6 as Tg,b7 as Vg,b8 as Og,b9 as Rg,ba as Lg,bb as Mg,bc as Bh,bd as Wh,be as Pg,bf as Fg,bg as Ng,bh as Bg,bi as Wg,bj as Hg,bk as Gg,bl as Hh,bm as Gh,bn as Uh,bo as Sd,bp as _d,bq as ii,br as Ed,bs as Ug,bt as zh,bu as _o,bv as Kh,bw as $h,bx as Dd,by as zg,bz as Kg,bA as $g,bB as Or,bC as qg,bD as jg,bE as qh,bF as xi,bG as Yg,bH as Jg,bI as Xg,bJ as Zg,bK as Qg,bL as ef,bM as io,bN as kd,bO as pe,bP as xd,bQ as tf,bR as of,bS as sf,bT as nf,bU as jh,bV as nt,bW as bs,bX as je,bY as et,bZ as fc,b_ as Qs,b$ as vs,c0 as Yh,c1 as mc,c2 as Jh,c3 as Xh,c4 as ws,c5 as ys,c6 as Zh,c7 as Pn,c8 as rf,c9 as af,ca as Qh,cb as bc,cc as el,cd as tl,ce as cf,cf as vc,cg as df,ch as il,ci as wc,cj as ol,ck as sl,cl as hf,cm as lf,cn as Fn,co as nl,cp as uf,cq as $t,cr as rl,cs as pf,ct as gf,cu as ff,cv as yc,cw as al,cx as mf,I as Eo,cy as bf,cz as Cc,cA as cl,cB as dl,cC as Id,cD as Jo,cE as Nn,cF as hl,cG as Ct,cH as Ue,cI as vf,cJ as Bn,cK as wf,cL as ll,cM as yf,cN as Cf,cO as Sf,cP as _f,cQ as Ef,cR as ul,cS as Df,cT as Sc,cU as pl,cV as gl,cW as fl,cX as ml,cY as kf,cZ as xf,c_ as _c,c$ as Cs,d0 as bl,d1 as Ec,d2 as If,d3 as Af,d4 as Tf,d5 as Vf,d6 as Of,d7 as Rf,d8 as Lf,d9 as Mf,da as Pf,db as Ff,dc as Nf,dd as Bf,de as Wf,df as Hf,dg as Gf,dh as vl,di as wl,dj as Uf,dk as zf,dl as Kf,dm as yl,dn as cr,dp as Cl,dq as dr,dr as tt,ds as Wn,dt as $f,du as Sl,dv as Dt,dw as qf,dx as jf,dy as Dc,dz as Do,dA as _l,dB as Yf,dC as El,dD as Jf,dE as kc,dF as Xf,dG as Ad,dH as Td,dI as Xo,dJ as xc,dK as $e,dL as Ic,dM as Zf,dN as Dl,dO as Qf,dP as Ss,dQ as Zo,dR as kl,dS as xl,dT as Ac,dU as em,dV as tm,dW as oi,dX as Rr,dY as im,dZ as om,d_ as sm,d$ as nm,e0 as Il,e1 as rm,e2 as am,e3 as _s,e4 as Tc,e5 as cm,e6 as Al,e7 as Hn,e8 as Vd,e9 as dm,ea as hm,eb as lm,ec as Od,ed as um,ee as pm,ef as gm,eg as Bo,eh as Tl,ei as zs,ej as Rd,ek as Vl,el as Ld,em as hr,en as Md,eo as Te,ep as ai,eq as fm,er as ko,es as Ks,et as mm,eu as bm,ev as vm,ew as wm,ex as ym,ey as Cm,ez as Sm,eA as _m,eB as Em,eC as Dm,eD as km,eE as xm,eF as Im,eG as Lr,eH as Am,eI as Tm,eJ as Pd,eK as Vm,eL as Om,eM as lr,eN as Rm,eO as Lm,eP as Mm,eQ as Pm,eR as Fm,eS as Nm,eT as Bm,eU as Wm,eV as Hm,eW as Gn,eX as Mr,eY as Gm,eZ as Um,e_ as Bs,e$ as zm,f0 as Km,f1 as $m,f2 as qm,f3 as jm,f4 as Ym,f5 as Jm,f6 as Xm,f7 as Zm,f8 as Qm,f9 as eb,fa as tb}from"./index-5b71d1bd.js";import{fc as TE,fb as VE}from"./index-5b71d1bd.js";import{aD as w,a$ as K,e7 as q,oF as ib,aP as Ie,oG as ob,g8 as Ol,oH as Vc,b6 as x,hw as z,oI as fi,bS as Ui,c5 as At,av as u,i2 as ho,oJ as mi,hx as de,hY as Rl,i4 as Oc,i0 as Rc,i1 as Lc,aR as ie,br as A,aW as M,hd as Ze,e5 as bi,ea as _,ir as bt,eb as E,hz as Yt,hA as Ve,cK as Ae,dq as oe,ia as ke,hV as ve,aY as I,cT as te,c6 as G,e$ as j,f0 as ye,fw as fe,co as Mc,cw as Qo,aM as V,eZ as Ai,oK as sb,af as T,cq as Re,by as ge,ct as Ge,oL as nb,aT as Ye,d_ as Ne,iB as Fd,fu as W,ai as Un,b0 as Y,bH as v,f1 as S,au as U,b8 as O,hJ as rt,aZ as it,ic as Pc,hm as lo,f8 as rb,hD as X,hy as mt,hI as Es,hX as Z,oM as uo,jJ as Pe,b2 as Ee,hG as Jt,hM as zn,jF as xo,ip as Tt,ac as ab,aO as Ds,e6 as Kn,oN as cb,dj as De,oO as Nd,oP as Bd,bx as le,oQ as Ii,iA as db,oR as ur,jm as hb,dH as lb,jz as Pr,le as Ll,l4 as ub,oS as Ml,oT as pb,as as gb,kp as k,ex as Le,oU as fb,ek as ks,bn as ze,cm as Ft,ca as Pl,cb as Fl,ae as ot,jj as pr,ji as Oe,oV as mb,hL as R,kY as bb,cc as Nl,iC as Io,hK as Fr,je as Fc,oW as vb,bu as pt,fJ as Fi,f2 as Wo,oX as ci,oY as en,oZ as wb,jD as Wd,o_ as yb,ld as Cb,o$ as Sb,ee as Nc,p0 as Bl,cX as Wl,ak as es,bw as Ao,ej as zi,jq as _b,fU as Ho,p1 as Eb,jK as Db,p2 as $s,p3 as kb,lD as Hl,eS as $n,p4 as xb,p5 as Ib,be as Ce,eL as qn,bf as si,ix as Gl,bb as jn,bJ as Ti,bk as Me,aC as qe,hS as Ab,hT as Tb,jB as Vb,hc as vi,ko as qt,p6 as be,hF as Je,hE as ts,ly as Ob,ag as wi,h$ as Rb,hR as Lb,cU as Ul,p7 as Mb,p8 as Hd,p9 as Pb,gm as Fb,a8 as Q,bq as po,cl as To,pa as zl,f6 as Nb,hq as Bb,pb as Nr,pc as Xt,kA as Ni,bP as Wb,pd as xs,bm as Kl,bQ as Hb,e0 as Gb,pe as Bc,bh as Yn,pf as se,js as N,pg as $l,ph as Ub,eh as Br,jL as zb,en as ql,cC as Kb,e4 as Jn,il as jt,c9 as Gd,hB as Wr,hC as oo,pi as $b,hk as qb,hi as jb,fm as Wc,pj as Hc,pk as Yb,hb as Gc,db as Vt,bl as Jb,pl as Xb,pm as Ji,im as Hr,bW as Uc,b9 as jl,bE as gr,dk as Zb,dD as Qb,pn as tn,po as kt,ef as pi,jg as ev,pp as tv,kS as Yl,b1 as Ut,cG as go,pq as fr,kq as Jl,aX as Gr,cI as zt,pr as iv,cx as Is,bI as zc,aU as Go,di as ov,ps as sv,ig as nv,ih as rv,kD as av,ij as Ur,cV as Li,pt as cv,iq as vt,da as Ki,eH as $i,iH as Uo,cQ as qi,jU as Kc,dl as dv,pu as hv,pv as lv,h8 as Xl,pw as ji,bd as Bi,jh as $c,px as qc,ey as Zl,d6 as Fe,py as Ql,lA as eu,jT as tu,lx as iu,lE as ou,lF as su,pz as nu,dT as Xi,pA as ru,aH as au,pB as cu,el as du,lU as Nt,pC as on,fR as zr,cL as uv,pD as pv,pE as jc,pF as gt,pG as ft,pH as gv,c0 as hu,dt as fv,pI as mv,pJ as bv,pK as Kr,pL as Ws,ba as vv,iK as so,iL as zo,dp as wv,e9 as yv,pM as ut,pN as Cv,dm as Yc,pO as Jc,pP as Sv,pQ as _v,pR as _i,pS as Ei,dJ as at,dK as As,pT as Ts,pU as Vs,pV as lu,pW as Ev,pX as Dv,pY as kv,pZ as xv,p_ as uu,p$ as Xc,q0 as pu,q1 as Iv,q2 as Av,q3 as Tv,q4 as gu,q5 as fu,gc as Vv,jx as Ov,cW as $r,q6 as Rv,kU as Lv,q7 as Mv,hu as Zi,q8 as qr,q9 as Ud,aq as Ko,qa as zd,jc as Pv,bs as Kd,at as mu,iI as Zc,qb as qs,i8 as $d,i5 as Fv,ah as Nv,c7 as bu,qc as Bv,qd as Wv,bY as Hv,aS as Hs,k9 as Gv,b5 as vu,qe as wu,iN as Xn,qf as yu,is as Uv,gX as $o,qg as zv,fj as Cu,bX as jr,e8 as Kv,k1 as no,ll as $v,aN as qv,bD as jv,qh as Yv,qi as Jv,qj as Xv,qk as qd,ql as jd,qm as Zv,qn as Qv,kZ as ew,qo as tw,aJ as Yd,k5 as Jd,b7 as Su,dB as iw,qp as ow,cO as sw,qq as nw,fF as Xd,dd as Zd,qr as rw,qs as aw,hP as cw,hQ as dw,hN as hw,qt as mr,qu as lw,qv as uw,qw as pw,qx as gw,qy as fw,it as mw,qz as Qd,fL as br,fK as bw,cz as vw,ec as ww,qA as yw,dv as Cw,iy as is,qB as eh,oB as Sw,d7 as _w,em as _u,eI as Ew,iz as sn,j9 as Dw,gP as kw,fg as Zt,i3 as xw,qC as Iw}from"./vendor-332432be.js";import{E as nn,V as Aw}from"./viewsService-285340a8.js";import{A as js,a as Tw,T as Qc,b as ed,C as th,c as Vw,d as Ow,e as vr,f as ih,g as oh,P as sh,h as nh,i as Rw,E as Lw,W as Mw,B as Eu,j as Pw,k as rh,l as Fw,w as Nw}from"./editor-11bcb270.js";import{g as qo,a as Bw}from"./window-103210be.js";import{i as Ww,g as Du}from"./quickaccess-f6b93953.js";import"./workbench.contribution-30154607.js";import{S as Hw}from"./simpleIconLabel-0ce5eb95.js";import{D as Gw}from"./style-dfdd0949.js";var Uw=".monaco-workbench.nosidebar>.part.sidebar{display:none!important;visibility:hidden!important}.monaco-workbench .part.sidebar .title-actions .actions-container{justify-content:flex-end}.monaco-workbench .part.sidebar .title-actions .action-item{margin-right:4px}.monaco-workbench .part.sidebar>.title>.title-label h2{text-transform:uppercase}.monaco-workbench .viewlet .collapsible.header .title{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.monaco-workbench .viewlet .collapsible.header .actions{width:0}.monaco-workbench .viewlet .collapsible.header.focused .actions,.monaco-workbench .viewlet .split-view-view:hover>.header .actions{flex:1;width:auto}.monaco-workbench .viewlet .collapsible.header .actions .action-label{background-position:50%;background-repeat:no-repeat;background-size:16px;height:22px;margin-right:0;width:28px}.monaco-workbench .viewlet .collapsible.header .actions .action-label .label,.monaco-workbench .viewlet .collapsible.header.collapsed .actions{display:none}.monaco-workbench .viewlet .collapsible.header .action-label{background-repeat:no-repeat;height:16px;margin-right:.2em;width:16px}";he(Uw,{});var zw=".monaco-workbench .part>.content>.composite{height:100%}.monaco-workbench .part>.composite.title{display:flex}.monaco-workbench .part>.composite.title>.title-actions{flex:1;padding-left:5px}";he(zw,{});var Kw=`.monaco-workbench .part{box-sizing:border-box;overflow:hidden}.monaco-workbench .part>.drop-block-overlay.visible{visibility:visible}.monaco-workbench .part>.drop-block-overlay{height:100%;opacity:0;position:absolute;top:0;visibility:hidden;width:100%;z-index:12}.monaco-workbench .part>.title{box-sizing:border-box;display:none;display:flex;height:35px;overflow:hidden;padding-left:8px;padding-right:8px}.monaco-workbench .part>.title>.title-label{line-height:35px;overflow:hidden;padding-left:12px;text-overflow:ellipsis;white-space:nowrap}.monaco-workbench .part>.title>.title-label h2{cursor:default;font-size:11px;font-weight:400;margin:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.monaco-workbench .part>.title>.title-label a{cursor:default;font-size:13px;text-decoration:none}.monaco-workbench .part>.title>.title-actions{flex:1;height:35px;padding-left:5px}.monaco-workbench .part>.title>.title-actions .action-label{background-position:50%;background-repeat:no-repeat;background-size:16px;display:block}.monaco-workbench .part>.title>.title-actions .action-label .label{display:none}.monaco-workbench .part>.title>.title-actions .action-label.codicon{color:inherit}.monaco-workbench .part>.content{font-size:13px}.monaco-workbench .part.editor>.content .monaco-progress-container,.monaco-workbench .part>.content>.monaco-progress-container{height:2px;left:0;position:absolute;top:33px;z-index:5}.monaco-workbench
	.part.editor>.content
	.monaco-progress-container
	.progress-bit,.monaco-workbench .part>.content>.monaco-progress-container .progress-bit{height:2px}`;he(Kw,{});class Zn extends Up{get dimension(){return this._dimension}constructor(e,t,i,o,s){super(e,i,o),this.options=t,this.layoutService=s,this._onDidVisibilityChange=this._register(new w),this.onDidVisibilityChange=this._onDidVisibilityChange.event,this._onDidChange=this._register(new w),s.registerPart(this)}onThemeChange(e){this.parent&&super.onThemeChange(e)}updateStyles(){super.updateStyles()}create(e,t){this.parent=e,this.titleArea=this.createTitleArea(e,t),this.contentArea=this.createContentArea(e,t),this.partLayout=new Yr(this.options,this.contentArea),this.updateStyles()}getContainer(){return this.parent}createTitleArea(e,t){}getTitleArea(){return this.titleArea}createContentArea(e,t){}getContentArea(){return this.contentArea}layoutContents(e,t){return K(this.partLayout).layout(e,t)}get onDidChange(){return this._onDidChange.event}layout(e,t,i,o){this._dimension=new q(e,t)}setVisible(e){this._onDidVisibilityChange.fire(e)}}const Vn=class Vn{constructor(e,t){this.options=e,this.contentArea=t}layout(e,t){let i;this.options.hasTitle?i=new q(e,Math.min(t,Vn.TITLE_HEIGHT)):i=q.None;let o=e;this.options&&typeof this.options.borderWidth=="function"&&(o-=this.options.borderWidth());const s=new q(o,t-i.height);return this.contentArea&&ib(this.contentArea,s.width,s.height),{titleSize:i,contentSize:s}}};Ns(Vn,"TITLE_HEIGHT",35);let Yr=Vn;class ku extends Zn{constructor(e,t,i,o,s,n,r,a,d,l,p,g,f,b,m){super(b,m,r,t,o),this.notificationService=e,this.storageService=t,this.contextMenuService=i,this.keybindingService=s,this.instantiationService=n,this.registry=a,this.activeCompositeSettingsKey=d,this.defaultCompositeId=l,this.nameForTelemetry=p,this.compositeCSSClass=g,this.titleForegroundColor=f,this.onDidCompositeOpen=this._register(new w),this.onDidCompositeClose=this._register(new w),this.mapCompositeToCompositeContainer=new Map,this.mapActionsBindingToComposite=new Map,this.instantiatedCompositeItems=new Map,this.actionsListener=this._register(new Ie),this.lastActiveCompositeId=t.get(d,1,this.defaultCompositeId)}openComposite(e,t){var i;if(((i=this.activeComposite)==null?void 0:i.getId())===e)return t&&this.activeComposite.focus(),this.activeComposite;if(this.element)return this.doOpenComposite(e,t)}doOpenComposite(e,t=!1){var s;const i=ob.nextId();this.currentCompositeOpenToken=i,this.activeComposite&&this.hideActiveComposite(),this.updateTitle(e);const o=this.createComposite(e,!0);if(!(this.currentCompositeOpenToken!==i||this.activeComposite&&this.activeComposite.getId()!==o.getId()))return((s=this.activeComposite)==null?void 0:s.getId())===o.getId()?(t&&o.focus(),this.onDidCompositeOpen.fire({composite:o,focus:t}),o):(this.showComposite(o),t&&o.focus(),o&&this.onDidCompositeOpen.fire({composite:o,focus:t}),o)}createComposite(e,t){const i=this.instantiatedCompositeItems.get(e);if(i)return i.composite;const o=this.registry.getComposite(e);if(o){const s=this,n=new zp(K(this.progressBar),new class extends Kp{constructor(){super(o.id,!!t),this._register(s.onDidCompositeOpen.event(l=>this.onScopeOpened(l.composite.getId()))),this._register(s.onDidCompositeClose.event(l=>this.onScopeClosed(l.getId())))}}),r=this.instantiationService.createChild(new Ol([Vc,n])),a=o.instantiate(r),d=new x;return this.instantiatedCompositeItems.set(e,{composite:a,disposable:d,progress:n}),d.add(a.onTitleAreaUpdate(()=>this.onTitleAreaUpdate(a.getId()),this)),a}throw new Error(`Unable to find composite with id ${e}`)}showComposite(e){this.activeComposite=e;const t=this.activeComposite.getId();t!==this.defaultCompositeId?this.storageService.store(this.activeCompositeSettingsKey,t,1,1):this.storageService.remove(this.activeCompositeSettingsKey,1),this.lastActiveCompositeId=this.activeComposite.getId();let i=this.mapCompositeToCompositeContainer.get(e.getId());if(i||(i=z(".composite"),i.classList.add(...this.compositeCSSClass.split(" ")),i.id=e.getId(),e.create(i),e.updateStyles(),this.mapCompositeToCompositeContainer.set(e.getId(),i)),!this.activeComposite||e.getId()!==this.activeComposite.getId())return;const o=this.getContentArea();o==null||o.appendChild(i),fi(i);const s=K(this.toolBar);s.actionRunner=e.getActionRunner();const n=this.registry.getComposite(e.getId());n&&n.name!==e.getTitle()&&this.updateTitle(e.getId(),e.getTitle());let r=this.mapActionsBindingToComposite.get(e.getId());r||(r=this.collectCompositeActions(e),this.mapActionsBindingToComposite.set(e.getId(),r)),r(),this.actionsListener.value=s.actionRunner.onDidRun(a=>{a.error&&!Ui(a.error)&&this.notificationService.error(a.error)}),e.setVisible(!0),!(!this.activeComposite||e.getId()!==this.activeComposite.getId())&&(this.contentAreaSize&&e.layout(this.contentAreaSize),this.boundarySashes&&e.setBoundarySashes(this.boundarySashes))}onTitleAreaUpdate(e){var i;const t=this.instantiatedCompositeItems.get(e);if(t&&this.updateTitle(e,t.composite.getTitle()),((i=this.activeComposite)==null?void 0:i.getId())===e){const o=this.collectCompositeActions(this.activeComposite);this.mapActionsBindingToComposite.set(this.activeComposite.getId(),o),o()}else this.mapActionsBindingToComposite.delete(e)}updateTitle(e,t){const i=this.registry.getComposite(e);if(!i||!this.titleLabel)return;t||(t=i.name);const o=this.keybindingService.lookupKeybinding(e);this.titleLabel.updateTitle(e,t,At(o==null?void 0:o.getLabel())),K(this.toolBar).setAriaLabel(u("ariaCompositeToolbarLabel","{0} actions",t))}collectCompositeActions(e){const t=e==null?void 0:e.getMenuIds(),i=(e==null?void 0:e.getActions().slice(0))||[],o=(e==null?void 0:e.getSecondaryActions().slice(0))||[],s=K(this.toolBar);return s.context=this.actionsContextProvider(),()=>s.setActions(ho(i),ho(o),t)}getActiveComposite(){return this.activeComposite}getLastActiveCompositeId(){return this.lastActiveCompositeId}hideActiveComposite(){var i;if(!this.activeComposite)return;const e=this.activeComposite;this.activeComposite=void 0;const t=this.mapCompositeToCompositeContainer.get(e.getId());return e.setVisible(!1),t&&(t.remove(),mi(t)),(i=this.progressBar)==null||i.stop().hide(),this.toolBar&&this.collectCompositeActions()(),this.onDidCompositeClose.fire(e),e}createTitleArea(e){const t=de(e,z(".composite"));t.classList.add("title"),this.titleLabel=this.createTitleLabel(t);const i=de(t,z(".title-actions"));return this.toolBar=this._register(this.instantiationService.createInstance(Rl,i,{actionViewItemProvider:o=>this.actionViewItemProvider(o),orientation:0,getKeyBinding:o=>this.keybindingService.lookupKeybinding(o.id),anchorAlignmentProvider:()=>this.getTitleAreaDropDownAnchorAlignment(),toggleMenuTitle:u("viewsAndMoreActions","Views and More Actions..."),telemetrySource:this.nameForTelemetry})),this.collectCompositeActions()(),t}createTitleLabel(e){const t=de(e,z(".title-label")),i=de(t,z("h2"));this.titleLabelElement=i;const o=this;return{updateTitle:(s,n,r)=>{(!this.activeComposite||this.activeComposite.getId()===s)&&(i.innerText=n,i.title=r?u("titleTooltip","{0} ({1})",n,r):n)},updateStyles:()=>{i.style.color=o.titleForegroundColor&&o.getColor(o.titleForegroundColor)||""}}}updateStyles(){super.updateStyles(),K(this.titleLabel).updateStyles()}actionViewItemProvider(e){return this.activeComposite?this.activeComposite.getActionViewItem(e):Oc(this.instantiationService,e)}actionsContextProvider(){return this.activeComposite?this.activeComposite.getActionsContext():null}createContentArea(e){const t=de(e,z(".content"));return this.progressBar=this._register(new Rc(t,Lc)),this.progressBar.hide(),t}getProgressIndicator(e){const t=this.instantiatedCompositeItems.get(e);return t?t.progress:void 0}getTitleAreaDropDownAnchorAlignment(){return 1}layout(e,t,i,o){var s;super.layout(e,t,i,o),this.contentAreaSize=q.lift(super.layoutContents(e,t).contentSize),(s=this.activeComposite)==null||s.layout(this.contentAreaSize)}setBoundarySashes(e){var t;this.boundarySashes=e,(t=this.activeComposite)==null||t.setBoundarySashes(e)}removeComposite(e){var i;if(((i=this.activeComposite)==null?void 0:i.getId())===e)return!1;this.mapCompositeToCompositeContainer.delete(e),this.mapActionsBindingToComposite.delete(e);const t=this.instantiatedCompositeItems.get(e);return t&&(t.composite.dispose(),ie(t.disposable),this.instantiatedCompositeItems.delete(e)),!0}dispose(){this.mapCompositeToCompositeContainer.clear(),this.mapActionsBindingToComposite.clear(),this.instantiatedCompositeItems.forEach(e=>{e.composite.dispose(),ie(e.disposable)}),this.instantiatedCompositeItems.clear(),super.dispose()}}let rn=class xu extends ku{get preferredWidth(){const e=this.getActivePaneComposite();if(!e)return;const t=e.getOptimalWidth();if(typeof t=="number")return Math.max(t,300)}get onDidPaneCompositeRegister(){return this.viewletRegistry.onDidRegister}get onDidPaneCompositeOpen(){return A.map(this.onDidCompositeOpen.event,e=>e.composite)}get onDidPaneCompositeClose(){return this.onDidCompositeClose.event}constructor(e,t,i,o,s,n,r,a,d,l){super(e,t,i,o,s,n,r,M.as(nn.Viewlets),xu.activeViewletSettingsKey,a.getDefaultViewContainer(0).id,"sideBar","viewlet",$p,"workbench.parts.sidebar",{hasTitle:!0,borderWidth:()=>this.getColor(vd)||this.getColor(Ze)?1:0}),this.viewDescriptorService=a,this.contextKeyService=d,this.extensionService=l,this.minimumWidth=170,this.maximumWidth=Number.POSITIVE_INFINITY,this.minimumHeight=0,this.maximumHeight=Number.POSITIVE_INFINITY,this.priority=1,this.snap=!0,this._onDidViewletDeregister=this._register(new w),this.onDidPaneCompositeDeregister=this._onDidViewletDeregister.event,this.viewletRegistry=M.as(nn.Viewlets),this.sideBarFocusContextKey=qp.bindTo(this.contextKeyService),this.activeViewletContextKey=jp.bindTo(this.contextKeyService),this.blockOpeningViewlet=!1,this.registerListeners()}registerListeners(){this._register(this.onDidPaneCompositeOpen(e=>{this.activeViewletContextKey.set(e.getId())})),this._register(this.onDidPaneCompositeClose(e=>{this.activeViewletContextKey.get()===e.getId()&&this.activeViewletContextKey.reset()})),this._register(this.registry.onDidDeregister(async e=>{var i,o;const t=this.viewDescriptorService.getViewContainersByLocation(0).filter(s=>this.viewDescriptorService.getViewContainerModel(s).activeViewDescriptors.length>0);if(t.length){if(((i=this.getActiveComposite())==null?void 0:i.getId())===e.id){const s=(o=this.viewDescriptorService.getDefaultViewContainer(0))==null?void 0:o.id,n=t.filter(r=>r.id===s)[0]||t[0];await this.openPaneComposite(n.id)}}else this.layoutService.setPartHidden(!0,"workbench.parts.sidebar");this.removeComposite(e.id),this._onDidViewletDeregister.fire(e)}))}create(e){this.element=e,super.create(e);const t=this._register(bi(e));this._register(t.onDidFocus(()=>this.sideBarFocusContextKey.set(!0))),this._register(t.onDidBlur(()=>this.sideBarFocusContextKey.set(!1)))}createTitleArea(e){const t=super.createTitleArea(e);this._register(_(t,E.CONTEXT_MENU,o=>{this.onTitleAreaContextMenu(new bt(o))})),this._register(Yt.addTarget(t)),this._register(_(t,Ve.Contextmenu,o=>{this.onTitleAreaContextMenu(new bt(o))})),this.titleLabelElement.draggable=!0;const i=()=>({type:"composite",id:this.getActivePaneComposite().getId()});return this._register(Yo.INSTANCE.registerDraggable(this.titleLabelElement,i,{})),t}updateStyles(){super.updateStyles();const e=K(this.getContainer());e.style.backgroundColor=this.getColor(Dr)||"",e.style.color=this.getColor(Yp)||"";const t=this.getColor(vd)||this.getColor(Ze),i=this.layoutService.getSideBarPosition()===0;e.style.borderRightWidth=t&&i?"1px":"",e.style.borderRightStyle=t&&i?"solid":"",e.style.borderRightColor=i&&t||"",e.style.borderLeftWidth=t&&!i?"1px":"",e.style.borderLeftStyle=t&&!i?"solid":"",e.style.borderLeftColor=i?"":t||"",e.style.outlineColor=this.getColor(Jp)??""}layout(e,t,i,o){this.layoutService.isVisible("workbench.parts.sidebar")&&super.layout(e,t,i,o)}getActivePaneComposite(){return this.getActiveComposite()}getLastActivePaneCompositeId(){return this.getLastActiveCompositeId()}hideActivePaneComposite(){this.hideActiveComposite()}async openPaneComposite(e,t){if(typeof e=="string"&&this.getPaneComposite(e))return this.doOpenViewlet(e,t);if(await this.extensionService.whenInstalledExtensionsRegistered(),typeof e=="string"&&this.getPaneComposite(e))return this.doOpenViewlet(e,t)}getPaneComposites(){return this.viewletRegistry.getPaneComposites().sort((e,t)=>typeof e.order!="number"?-1:typeof t.order!="number"?1:e.order-t.order)}getPaneComposite(e){return this.getPaneComposites().filter(t=>t.id===e)[0]}doOpenViewlet(e,t){if(!this.blockOpeningViewlet){if(!this.layoutService.isVisible("workbench.parts.sidebar"))try{this.blockOpeningViewlet=!0,this.layoutService.setPartHidden(!1,"workbench.parts.sidebar")}finally{this.blockOpeningViewlet=!1}return this.openComposite(e,t)}}getTitleAreaDropDownAnchorAlignment(){return this.layoutService.getSideBarPosition()===0?0:1}onTitleAreaContextMenu(e){const t=this.getActivePaneComposite();if(t){const i=t?t.getContextMenuActions():[];if(i.length){const o={x:e.posx,y:e.posy};this.contextMenuService.showContextMenu({getAnchor:()=>o,getActions:()=>i.slice(),getActionViewItem:s=>this.actionViewItemProvider(s),actionRunner:t.getActionRunner(),skipTelemetry:!0})}}}toJSON(){return{type:"workbench.parts.sidebar"}}};rn.activeViewletSettingsKey="workbench.sidebar.activeviewletid";rn=C([h(0,Ae),h(1,oe),h(2,ke),h(3,st),h(4,ve),h(5,I),h(6,te),h(7,Qe),h(8,G),h(9,Ci)],rn);const td="viewsLog",Iu=u("views log","Views");function id(c){return Qo(c.windowLogsPath,"views.log")}j(class extends ye{constructor(){super({id:"_workbench.output.showViewsLog",title:{value:"Show Views Log",original:"Show Views Log"},category:fe.Developer,f1:!0})}async run(c){const e=c.get(Mc),t=c.get(Xp),i=c.get(Lt);e.setVisibility(id(i),!0),t.showChannel(td)}});function Au(c){return`${c}.hidden`}let Jr=class extends V{constructor(e,t,i,o,s){super(),this.viewContainerName=t,this.storageService=i,this._onDidChangeStoredState=this._register(new w),this.onDidChangeStoredState=this._onDidChangeStoredState.event,this.logger=o.createLogger(id(s),{id:td,name:Iu,hidden:!0}),this.globalViewsStateStorageId=Au(e),this.workspaceViewsStateStorageId=e,this._register(this.storageService.onDidChangeValue(n=>this.onDidStorageChange(n))),this.state=this.initialize()}set(e,t){this.state.set(e,t)}get(e){return this.state.get(e)}updateState(e){this.updateWorkspaceState(e),this.updateGlobalState(e)}updateWorkspaceState(e){const t=this.getStoredWorkspaceState();for(const i of e){const o=this.get(i.id);o&&(t[i.id]={collapsed:!!o.collapsed,isHidden:!o.visibleWorkspace,size:o.size,order:i.workspace&&o?o.order:void 0})}Object.keys(t).length>0?this.storageService.store(this.workspaceViewsStateStorageId,JSON.stringify(t),1,1):this.storageService.remove(this.workspaceViewsStateStorageId,1)}updateGlobalState(e){const t=this.getStoredGlobalState();for(const i of e){const o=this.get(i.id);t.set(i.id,{id:i.id,isHidden:o&&i.canToggleVisibility?!o.visibleGlobal:!1,order:!i.workspace&&o?o.order:void 0})}this.setStoredGlobalState(t)}onDidStorageChange(e){if(e.key===this.globalViewsStateStorageId&&e.scope===0&&this.globalViewsStatesValue!==this.getStoredGlobalViewsStatesValue()){this._globalViewsStatesValue=void 0;const t=this.getStoredGlobalState(),i=this.getStoredWorkspaceState(),o=[];for(const[s,n]of t){const r=this.get(s);if(r)r.visibleGlobal!==!n.isHidden&&(n.isHidden||this.logger.info(`View visibility state changed: ${s} is now visible`,this.viewContainerName),o.push({id:s,visible:!n.isHidden}));else{const a=i[s];this.set(s,{active:!1,visibleGlobal:!n.isHidden,visibleWorkspace:Ai(a==null?void 0:a.isHidden)?void 0:!(a!=null&&a.isHidden),collapsed:a==null?void 0:a.collapsed,order:a==null?void 0:a.order,size:a==null?void 0:a.size})}}if(o.length){this._onDidChangeStoredState.fire(o);for(const s of o){const n=this.get(s.id);n&&(n.visibleGlobal=s.visible)}}}}initialize(){const e=new Map,t=this.getStoredWorkspaceState();for(const r of Object.keys(t)){const a=t[r];e.set(r,{active:!1,visibleGlobal:void 0,visibleWorkspace:Ai(a.isHidden)?void 0:!a.isHidden,collapsed:a.collapsed,order:a.order,size:a.size})}const i=this.storageService.get(this.globalViewsStateStorageId,1,"[]"),{state:o}=this.parseStoredGlobalState(i);if(o.size>0){for(const{id:r,isHidden:a}of o.values()){const d=e.get(r);d?Ai(d.visibleWorkspace)&&(d.visibleWorkspace=!a):e.set(r,{active:!1,collapsed:void 0,visibleGlobal:void 0,visibleWorkspace:!a})}this.storageService.remove(this.globalViewsStateStorageId,1)}const{state:s,hasDuplicates:n}=this.parseStoredGlobalState(this.globalViewsStatesValue);n&&this.setStoredGlobalState(s);for(const{id:r,isHidden:a,order:d}of s.values()){const l=e.get(r);l?(l.visibleGlobal=!a,Ai(d)||(l.order=d)):e.set(r,{active:!1,visibleGlobal:!a,order:d,collapsed:void 0,visibleWorkspace:void 0})}return e}getStoredWorkspaceState(){return JSON.parse(this.storageService.get(this.workspaceViewsStateStorageId,1,"{}"))}getStoredGlobalState(){return this.parseStoredGlobalState(this.globalViewsStatesValue).state}setStoredGlobalState(e){this.globalViewsStatesValue=JSON.stringify([...e.values()])}parseStoredGlobalState(e){const t=JSON.parse(e);let i=!1;return{state:t.reduce((s,n)=>(typeof n=="string"?(i=i||s.has(n),s.set(n,{id:n,isHidden:!0})):(i=i||s.has(n.id),s.set(n.id,n)),s),new Map),hasDuplicates:i}}get globalViewsStatesValue(){return this._globalViewsStatesValue||(this._globalViewsStatesValue=this.getStoredGlobalViewsStatesValue()),this._globalViewsStatesValue}set globalViewsStatesValue(e){this.globalViewsStatesValue!==e&&(this._globalViewsStatesValue=e,this.setStoredGlobalViewsStatesValue(e))}getStoredGlobalViewsStatesValue(){return this.storageService.get(this.globalViewsStateStorageId,0,"[]")}setStoredGlobalViewsStatesValue(e){this.storageService.store(this.globalViewsStateStorageId,e,0,0)}};Jr=C([h(2,oe),h(3,Mc),h(4,Lt)],Jr);let Xr=class extends V{get title(){return this._title}get icon(){return this._icon}get keybindingId(){return this._keybindingId}get allViewDescriptors(){return this.viewDescriptorItems.map(e=>e.viewDescriptor)}get activeViewDescriptors(){return this.viewDescriptorItems.filter(e=>e.state.active).map(e=>e.viewDescriptor)}get visibleViewDescriptors(){return this.viewDescriptorItems.filter(e=>this.isViewDescriptorVisible(e)).map(e=>e.viewDescriptor)}constructor(e,t,i,o,s){super(),this.viewContainer=e,this.contextKeyService=i,this.contextKeys=new sb,this.viewDescriptorItems=[],this._onDidChangeContainerInfo=this._register(new w),this.onDidChangeContainerInfo=this._onDidChangeContainerInfo.event,this._onDidChangeAllViewDescriptors=this._register(new w),this.onDidChangeAllViewDescriptors=this._onDidChangeAllViewDescriptors.event,this._onDidChangeActiveViewDescriptors=this._register(new w),this.onDidChangeActiveViewDescriptors=this._onDidChangeActiveViewDescriptors.event,this._onDidAddVisibleViewDescriptors=this._register(new w),this.onDidAddVisibleViewDescriptors=this._onDidAddVisibleViewDescriptors.event,this._onDidRemoveVisibleViewDescriptors=this._register(new w),this.onDidRemoveVisibleViewDescriptors=this._onDidRemoveVisibleViewDescriptors.event,this._onDidMoveVisibleViewDescriptors=this._register(new w),this.onDidMoveVisibleViewDescriptors=this._onDidMoveVisibleViewDescriptors.event,this.logger=o.createLogger(id(s),{id:td,name:Iu,hidden:!0}),this._register(A.filter(i.onDidChangeContext,n=>n.affectsSome(this.contextKeys))(()=>this.onDidChangeContext())),this.viewDescriptorsState=this._register(t.createInstance(Jr,e.storageId||`${e.id}.state`,typeof e.title=="string"?e.title:e.title.original)),this._register(this.viewDescriptorsState.onDidChangeStoredState(n=>this.updateVisibility(n))),this.updateContainerInfo()}updateContainerInfo(){var a,d,l,p,g,f;const e=this.viewContainer.alwaysUseContainerInfo||this.visibleViewDescriptors.length===0||this.visibleViewDescriptors.some(b=>M.as(Xe.ViewsRegistry).getViewContainer(b.id)===this.viewContainer),t=e?typeof this.viewContainer.title=="string"?this.viewContainer.title:this.viewContainer.title.value:((a=this.visibleViewDescriptors[0])==null?void 0:a.containerTitle)||((d=this.visibleViewDescriptors[0])==null?void 0:d.name)||"";let i=!1;this._title!==t&&(this._title=t,i=!0);const o=e?this.viewContainer.icon:((l=this.visibleViewDescriptors[0])==null?void 0:l.containerIcon)||_h;let s=!1;this.isEqualIcon(o)||(this._icon=o,s=!0);const n=((p=this.viewContainer.openCommandActionDescriptor)==null?void 0:p.id)??((f=(g=this.activeViewDescriptors.find(b=>b.openCommandActionDescriptor))==null?void 0:g.openCommandActionDescriptor)==null?void 0:f.id);let r=!1;this._keybindingId!==n&&(this._keybindingId=n,r=!0),(i||s||r)&&this._onDidChangeContainerInfo.fire({title:i,icon:s,keybindingId:r})}isEqualIcon(e){return T.isUri(e)?T.isUri(this._icon)&&Re(e,this._icon):ge.isThemeIcon(e)?ge.isThemeIcon(this._icon)&&ge.isEqual(e,this._icon):e===this._icon}isVisible(e){const t=this.viewDescriptorItems.find(i=>i.viewDescriptor.id===e);if(!t)throw new Error(`Unknown view ${e}`);return this.isViewDescriptorVisible(t)}setVisible(e,t){this.updateVisibility([{id:e,visible:t}])}updateVisibility(e){const t=Ge(e.filter(({visible:s})=>!s).map(({id:s})=>this.findAndIgnoreIfNotFound(s))),i=[];for(const{viewDescriptorItem:s,visibleIndex:n}of t)this.updateViewDescriptorItemVisibility(s,!1)&&i.push({viewDescriptor:s.viewDescriptor,index:n});i.length&&this.broadCastRemovedVisibleViewDescriptors(i);const o=[];for(const{id:s,visible:n}of e){if(!n)continue;const r=this.findAndIgnoreIfNotFound(s);if(!r)continue;const{viewDescriptorItem:a,visibleIndex:d}=r;this.updateViewDescriptorItemVisibility(a,!0)&&o.push({index:d,viewDescriptor:a.viewDescriptor,size:a.state.size,collapsed:!!a.state.collapsed})}o.length&&this.broadCastAddedVisibleViewDescriptors(o)}updateViewDescriptorItemVisibility(e,t){return!e.viewDescriptor.canToggleVisibility||this.isViewDescriptorVisibleWhenActive(e)===t?!1:(e.viewDescriptor.workspace?e.state.visibleWorkspace=t:(e.state.visibleGlobal=t,t&&this.logger.info(`Showing view ${e.viewDescriptor.id} in the container ${this.viewContainer.id}`)),this.isViewDescriptorVisible(e)===t)}isCollapsed(e){return!!this.find(e).viewDescriptorItem.state.collapsed}setCollapsed(e,t){const{viewDescriptorItem:i}=this.find(e);i.state.collapsed!==t&&(i.state.collapsed=t),this.viewDescriptorsState.updateState(this.allViewDescriptors)}getSize(e){return this.find(e).viewDescriptorItem.state.size}setSizes(e){for(const{id:t,size:i}of e){const{viewDescriptorItem:o}=this.find(t);o.state.size!==i&&(o.state.size=i)}this.viewDescriptorsState.updateState(this.allViewDescriptors)}move(e,t){const i=this.viewDescriptorItems.findIndex(r=>r.viewDescriptor.id===e),o=this.viewDescriptorItems.findIndex(r=>r.viewDescriptor.id===t),s=this.viewDescriptorItems[i],n=this.viewDescriptorItems[o];nb(this.viewDescriptorItems,i,o);for(let r=0;r<this.viewDescriptorItems.length;r++)this.viewDescriptorItems[r].state.order=r;this.broadCastMovedViewDescriptors({index:i,viewDescriptor:s.viewDescriptor},{index:o,viewDescriptor:n.viewDescriptor})}add(e){const t=[];for(const s of e){const n=s.viewDescriptor;if(n.when)for(const a of n.when.keys())this.contextKeys.add(a);let r=this.viewDescriptorsState.get(n.id);if(r){if(n.workspace)r.visibleWorkspace=Ye(s.visible)?Ye(r.visibleWorkspace)?!n.hideByDefault:r.visibleWorkspace:s.visible;else{const a=r.visibleGlobal;r.visibleGlobal=Ye(s.visible)?Ye(r.visibleGlobal)?!n.hideByDefault:r.visibleGlobal:s.visible,r.visibleGlobal&&!a&&this.logger.info(`Added view ${n.id} in the container ${this.viewContainer.id} and showing it.`,`${a}`,`${n.hideByDefault}`,`${s.visible}`)}r.collapsed=Ye(s.collapsed)?Ye(r.collapsed)?!!n.collapsed:r.collapsed:s.collapsed}else r={active:!1,visibleGlobal:Ye(s.visible)?!n.hideByDefault:s.visible,visibleWorkspace:Ye(s.visible)?!n.hideByDefault:s.visible,collapsed:Ye(s.collapsed)?!!n.collapsed:s.collapsed};this.viewDescriptorsState.set(n.id,r),r.active=this.contextKeyService.contextMatchesRules(n.when),t.push({viewDescriptor:n,state:r})}this.viewDescriptorItems.push(...t),this.viewDescriptorItems.sort(this.compareViewDescriptors.bind(this)),this._onDidChangeAllViewDescriptors.fire({added:t.map(({viewDescriptor:s})=>s),removed:[]});const i=[];for(const s of t)s.state.active&&i.push({viewDescriptorItem:s,visible:this.isViewDescriptorVisible(s)});i.length&&this._onDidChangeActiveViewDescriptors.fire({added:i.map(({viewDescriptorItem:s})=>s.viewDescriptor),removed:[]});const o=[];for(const{viewDescriptorItem:s,visible:n}of i)if(n&&this.isViewDescriptorVisible(s)){const{visibleIndex:r}=this.find(s.viewDescriptor.id);o.push({index:r,viewDescriptor:s.viewDescriptor,size:s.state.size,collapsed:!!s.state.collapsed})}this.broadCastAddedVisibleViewDescriptors(o)}remove(e){const t=[],i=[],o=[],s=[];for(const n of e){if(n.when)for(const a of n.when.keys())this.contextKeys.delete(a);const r=this.viewDescriptorItems.findIndex(a=>a.viewDescriptor.id===n.id);if(r!==-1){t.push(n);const a=this.viewDescriptorItems[r];if(a.state.active&&o.push(a.viewDescriptor),this.isViewDescriptorVisible(a)){const{visibleIndex:d}=this.find(a.viewDescriptor.id);s.push({index:d,viewDescriptor:a.viewDescriptor})}i.push(a)}}i.forEach(n=>this.viewDescriptorItems.splice(this.viewDescriptorItems.indexOf(n),1)),this.broadCastRemovedVisibleViewDescriptors(s),o.length&&this._onDidChangeActiveViewDescriptors.fire({added:[],removed:o}),t.length&&this._onDidChangeAllViewDescriptors.fire({added:[],removed:t})}onDidChangeContext(){const e=[],t=[];for(const s of this.viewDescriptorItems){const n=s.state.active,r=this.contextKeyService.contextMatchesRules(s.viewDescriptor.when);n!==r&&(r?e.push({item:s,visibleWhenActive:this.isViewDescriptorVisibleWhenActive(s)}):t.push(s))}const i=[];for(const s of t)if(this.isViewDescriptorVisible(s)){const{visibleIndex:n}=this.find(s.viewDescriptor.id);i.push({index:n,viewDescriptor:s.viewDescriptor})}t.forEach(s=>s.state.active=!1),e.forEach(({item:s})=>s.state.active=!0),this.broadCastRemovedVisibleViewDescriptors(i),(e.length||t.length)&&this._onDidChangeActiveViewDescriptors.fire({added:e.map(({item:s})=>s.viewDescriptor),removed:t.map(s=>s.viewDescriptor)});const o=[];for(const{item:s,visibleWhenActive:n}of e)if(n&&this.isViewDescriptorVisible(s)){const{visibleIndex:r}=this.find(s.viewDescriptor.id);o.push({index:r,viewDescriptor:s.viewDescriptor,size:s.state.size,collapsed:!!s.state.collapsed})}this.broadCastAddedVisibleViewDescriptors(o)}broadCastAddedVisibleViewDescriptors(e){e.length&&(this._onDidAddVisibleViewDescriptors.fire(e.sort((t,i)=>t.index-i.index)),this.updateState(`Added views:${e.map(t=>t.viewDescriptor.id).join(",")} in ${this.viewContainer.id}`))}broadCastRemovedVisibleViewDescriptors(e){e.length&&(this._onDidRemoveVisibleViewDescriptors.fire(e.sort((t,i)=>i.index-t.index)),this.updateState(`Removed views:${e.map(t=>t.viewDescriptor.id).join(",")} from ${this.viewContainer.id}`))}broadCastMovedViewDescriptors(e,t){this._onDidMoveVisibleViewDescriptors.fire({from:e,to:t}),this.updateState(`Moved view ${e.viewDescriptor.id} to ${t.viewDescriptor.id} in ${this.viewContainer.id}`)}updateState(e){this.logger.info(e),this.viewDescriptorsState.updateState(this.allViewDescriptors),this.updateContainerInfo()}isViewDescriptorVisible(e){return e.state.active?this.isViewDescriptorVisibleWhenActive(e):!1}isViewDescriptorVisibleWhenActive(e){return e.viewDescriptor.workspace?!!e.state.visibleWorkspace:!!e.state.visibleGlobal}find(e){const t=this.findAndIgnoreIfNotFound(e);if(t)return t;throw new Error(`view descriptor ${e} not found`)}findAndIgnoreIfNotFound(e){for(let t=0,i=0;t<this.viewDescriptorItems.length;t++){const o=this.viewDescriptorItems[t];if(o.viewDescriptor.id===e)return{index:t,visibleIndex:i,viewDescriptorItem:o};this.isViewDescriptorVisible(o)&&i++}}compareViewDescriptors(e,t){return e.viewDescriptor.id===t.viewDescriptor.id?0:this.getViewOrder(e)-this.getViewOrder(t)||this.getGroupOrderResult(e.viewDescriptor,t.viewDescriptor)}getViewOrder(e){const t=typeof e.state.order=="number"?e.state.order:e.viewDescriptor.order;return typeof t=="number"?t:Number.MAX_VALUE}getGroupOrderResult(e,t){return!e.group||!t.group||e.group===t.group?0:e.group<t.group?-1:1}};Xr=C([h(1,I),h(2,G),h(3,Mc),h(4,Lt)],Xr);function ah(c){return`${c}.state`}let os=class Bt extends V{get viewContainers(){return this.viewContainersRegistry.all}constructor(e,t,i,o,s){super(),this.instantiationService=e,this.contextKeyService=t,this.storageService=i,this.extensionService=o,this.telemetryService=s,this._onDidChangeContainer=this._register(new w),this.onDidChangeContainer=this._onDidChangeContainer.event,this._onDidChangeLocation=this._register(new w),this.onDidChangeLocation=this._onDidChangeLocation.event,this._onDidChangeContainerLocation=this._register(new w),this.onDidChangeContainerLocation=this._onDidChangeContainerLocation.event,this.viewContainerModels=this._register(new Fd),this.viewsVisibilityActionDisposables=this._register(new Fd),this._onDidChangeViewContainers=this._register(new w),this.onDidChangeViewContainers=this._onDidChangeViewContainers.event,this.activeViewContextKeys=new Map,this.movableViewContextKeys=new Map,this.defaultViewLocationContextKeys=new Map,this.defaultViewContainerLocationContextKeys=new Map,this.viewContainersRegistry=M.as(Xe.ViewContainersRegistry),this.viewsRegistry=M.as(Xe.ViewsRegistry),this.migrateToViewsCustomizationsStorage(),this.viewContainersCustomLocations=new Map(Object.entries(this.viewCustomizations.viewContainerLocations)),this.viewDescriptorsCustomLocations=new Map(Object.entries(this.viewCustomizations.viewLocations)),this.viewContainerBadgeEnablementStates=new Map(Object.entries(this.viewCustomizations.viewContainerBadgeEnablementStates)),this.viewContainers.forEach(n=>this.onDidRegisterViewContainer(n)),this._register(this.viewsRegistry.onViewsRegistered(n=>this.onDidRegisterViews(n))),this._register(this.viewsRegistry.onViewsDeregistered(({views:n,viewContainer:r})=>this.onDidDeregisterViews(n,r))),this._register(this.viewsRegistry.onDidChangeContainer(({views:n,from:r,to:a})=>this.onDidChangeDefaultContainer(n,r,a))),this._register(this.viewContainersRegistry.onDidRegister(({viewContainer:n})=>{this.onDidRegisterViewContainer(n),this._onDidChangeViewContainers.fire({added:[{container:n,location:this.getViewContainerLocation(n)}],removed:[]})})),this._register(this.viewContainersRegistry.onDidDeregister(({viewContainer:n})=>{this.onDidDeregisterViewContainer(n),this._onDidChangeViewContainers.fire({removed:[{container:n,location:this.getViewContainerLocation(n)}],added:[]})})),this._register(this.storageService.onDidChangeValue(n=>{this.onDidStorageChange(n)})),this.extensionService.whenInstalledExtensionsRegistered().then(()=>this.whenExtensionsRegistered())}migrateToViewsCustomizationsStorage(){if(this.storageService.get(Bt.VIEWS_CUSTOMIZATIONS,0))return;const e=this.storageService.get("views.cachedViewContainerLocations",0),t=this.storageService.get("views.cachedViewPositions",0);if(!e&&!t)return;const i=e?JSON.parse(e):[],o=t?JSON.parse(t):[],s={viewContainerLocations:i.reduce((n,[r,a])=>(n[r]=a,n),{}),viewLocations:o.reduce((n,[r,{containerId:a}])=>(n[r]=a,n),{}),viewContainerBadgeEnablementStates:{}};this.storageService.store(Bt.VIEWS_CUSTOMIZATIONS,JSON.stringify(s),0,0),this.storageService.remove("views.cachedViewContainerLocations",0),this.storageService.remove("views.cachedViewPositions",0)}registerGroupedViews(e){for(const[t,i]of e.entries()){const o=this.viewContainersRegistry.get(t);if(!o||!this.viewContainerModels.has(o)){if(this.isGeneratedContainerId(t)){const n=this.viewContainersCustomLocations.get(t);n!==void 0&&this.registerGeneratedViewContainer(n,t)}continue}const s=i.filter(n=>this.getViewContainerModel(o).allViewDescriptors.filter(r=>r.id===n.id).length===0);this.addViews(o,s)}}deregisterGroupedViews(e){for(const[t,i]of e.entries()){const o=this.viewContainersRegistry.get(t);!o||!this.viewContainerModels.has(o)||this.removeViews(o,i)}}moveOrphanViewsToDefaultLocation(){for(const[e,t]of this.viewDescriptorsCustomLocations.entries()){if(this.viewContainersRegistry.get(t))continue;const i=this.viewsRegistry.getViewContainer(e),o=this.getViewDescriptorById(e);i&&o&&this.addViews(i,[o])}}whenExtensionsRegistered(){this.moveOrphanViewsToDefaultLocation();for(const e of[...this.viewContainersCustomLocations.keys()])this.cleanUpGeneratedViewContainer(e);this.saveViewCustomizations(),this.registerViewsVisibilityActions()}onDidRegisterViews(e){this.contextKeyService.bufferChangeEvents(()=>{e.forEach(({views:t,viewContainer:i})=>{const o=this.regroupViews(i.id,t);this.registerGroupedViews(o),t.forEach(s=>this.getOrCreateMovableViewContextKey(s).set(!!s.canMoveView))})})}isGeneratedContainerId(e){return e.startsWith(Bt.COMMON_CONTAINER_ID_PREFIX)}onDidDeregisterViews(e,t){const i=this.regroupViews(t.id,e);this.deregisterGroupedViews(i),this.contextKeyService.bufferChangeEvents(()=>{e.forEach(o=>this.getOrCreateMovableViewContextKey(o).set(!1))})}regroupViews(e,t){const i=new Map;for(const o of t){const s=this.viewDescriptorsCustomLocations.get(o.id)??e;let n=i.get(s);n||i.set(s,n=[]),n.push(o)}return i}getViewDescriptorById(e){return this.viewsRegistry.getView(e)}getViewLocationById(e){const t=this.getViewContainerByViewId(e);return t===null?null:this.getViewContainerLocation(t)}getViewContainerByViewId(e){const t=this.viewDescriptorsCustomLocations.get(e);return t?this.viewContainersRegistry.get(t)??null:this.getDefaultContainerById(e)}getViewContainerLocation(e){return this.viewContainersCustomLocations.get(e.id)??this.getDefaultViewContainerLocation(e)}getDefaultViewContainerLocation(e){return this.viewContainersRegistry.getViewContainerLocation(e)}getDefaultContainerById(e){return this.viewsRegistry.getViewContainer(e)??null}getViewContainerModel(e){return this.getOrRegisterViewContainerModel(e)}getViewContainerById(e){return this.viewContainersRegistry.get(e)||null}getViewContainersByLocation(e){return this.viewContainers.filter(t=>this.getViewContainerLocation(t)===e)}getDefaultViewContainer(e){return this.viewContainersRegistry.getDefaultViewContainer(e)}moveViewContainerToLocation(e,t,i){this.moveViewContainerToLocationWithoutSaving(e,t,i),this.saveViewCustomizations()}getViewContainerBadgeEnablementState(e){return this.viewContainerBadgeEnablementStates.get(e)??!0}setViewContainerBadgeEnablementState(e,t){this.viewContainerBadgeEnablementStates.set(e,t),this.saveViewCustomizations()}moveViewToLocation(e,t){const i=this.registerGeneratedViewContainer(t);this.moveViewsToContainer([e],i)}moveViewsToContainer(e,t,i){if(!e.length)return;const o=this.getViewContainerByViewId(e[0].id),s=t;o&&s&&o!==s&&(this.moveViewsWithoutSaving(e,o,s,i),this.cleanUpGeneratedViewContainer(o.id),this.saveViewCustomizations(),this.reportMovedViews(e,o,s))}reset(){for(const e of this.viewContainers){const t=this.getViewContainerModel(e);for(const s of t.allViewDescriptors){const n=this.getDefaultContainerById(s.id),r=this.getViewContainerByViewId(s.id);r&&n&&r!==n&&this.moveViewsWithoutSaving([s],r,n)}const i=this.getDefaultViewContainerLocation(e),o=this.getViewContainerLocation(e);i!==null&&o!==i&&this.moveViewContainerToLocationWithoutSaving(e,i),this.cleanUpGeneratedViewContainer(e.id)}this.viewContainersCustomLocations.clear(),this.viewDescriptorsCustomLocations.clear(),this.saveViewCustomizations()}isViewContainerRemovedPermanently(e){return this.isGeneratedContainerId(e)&&!this.viewContainersCustomLocations.has(e)}onDidChangeDefaultContainer(e,t,i){const o=e.filter(s=>!this.viewDescriptorsCustomLocations.has(s.id)||!this.viewContainers.includes(t)&&this.viewDescriptorsCustomLocations.get(s.id)===t.id);o.length&&this.moveViewsWithoutSaving(o,t,i)}reportMovedViews(e,t,i){const o=g=>g.id.startsWith(Bt.COMMON_CONTAINER_ID_PREFIX)?"custom":g.extensionId?"extension":g.id,s=this.getViewContainerLocation(t),n=this.getViewContainerLocation(i),r=e.length,a=o(t),d=o(i),l=s===1?"panel":"sidebar",p=n===1?"panel":"sidebar";this.telemetryService.publicLog2("viewDescriptorService.moveViews",{viewCount:r,fromContainer:a,toContainer:d,fromLocation:l,toLocation:p})}moveViewsWithoutSaving(e,t,i,o=Oo.Expand){this.removeViews(t,e),this.addViews(i,e,o);const s=this.getViewContainerLocation(t),n=this.getViewContainerLocation(i);s!==n&&this._onDidChangeLocation.fire({views:e,from:s,to:n}),this._onDidChangeContainer.fire({views:e,from:t,to:i})}moveViewContainerToLocationWithoutSaving(e,t,i){const o=this.getViewContainerLocation(e),s=t;if(o!==s){const n=this.isGeneratedContainerId(e.id),r=s===this.getDefaultViewContainerLocation(e);n||!r?this.viewContainersCustomLocations.set(e.id,s):this.viewContainersCustomLocations.delete(e.id),this.getOrCreateDefaultViewContainerLocationContextKey(e).set(n||r),e.requestedIndex=i,this._onDidChangeContainerLocation.fire({viewContainer:e,from:o,to:s});const a=this.getViewsByContainer(e);this._onDidChangeLocation.fire({views:a,from:o,to:s})}}cleanUpGeneratedViewContainer(e){var i;if(!this.isGeneratedContainerId(e))return;const t=this.getViewContainerById(e);t&&((i=this.getViewContainerModel(t))!=null&&i.allViewDescriptors.length)||[...this.viewDescriptorsCustomLocations.values()].includes(e)||(t&&this.viewContainersRegistry.deregisterViewContainer(t),this.viewContainersCustomLocations.delete(e),this.viewContainerBadgeEnablementStates.delete(e),this.storageService.remove(Au((t==null?void 0:t.storageId)||ah(e)),0))}registerGeneratedViewContainer(e,t){const i=t||this.generateContainerId(e),o=this.viewContainersRegistry.registerViewContainer({id:i,ctorDescriptor:new W(hc,[i,{mergeViewWithContainerWhenSingleView:!0}]),title:i,icon:e===0?_h:void 0,storageId:ah(i),hideIfEmpty:!0},e,{doNotRegisterOpenCommand:!0});return this.viewContainersCustomLocations.get(o.id)!==e&&this.viewContainersCustomLocations.set(o.id,e),this.getOrCreateDefaultViewContainerLocationContextKey(o).set(!0),o}onDidStorageChange(e){e.key===Bt.VIEWS_CUSTOMIZATIONS&&e.scope===0&&JSON.stringify(this.viewCustomizations)!==this.getStoredViewCustomizationsValue()&&this.onDidViewCustomizationsStorageChange()}onDidViewCustomizationsStorageChange(){this._viewCustomizations=void 0;const e=new Map(Object.entries(this.viewCustomizations.viewContainerLocations)),t=new Map(Object.entries(this.viewCustomizations.viewLocations)),i=[],o=[];for(const[s,n]of e.entries()){const r=this.getViewContainerById(s);r?n!==this.getViewContainerLocation(r)&&i.push([r,n]):this.isGeneratedContainerId(s)&&this.registerGeneratedViewContainer(n,s)}for(const s of this.viewContainers)if(!e.has(s.id)){const n=this.getViewContainerLocation(s),r=this.getDefaultViewContainerLocation(s);n!==r&&i.push([s,r])}for(const[s,n]of t.entries()){const r=this.getViewDescriptorById(s);if(r){const a=this.getViewContainerByViewId(s),d=this.viewContainersRegistry.get(n);a&&d&&d!==a&&o.push({views:[r],from:a,to:d})}}for(const s of this.viewContainers){const n=this.getViewContainerModel(s);for(const r of n.allViewDescriptors)if(!t.has(r.id)){const a=this.getViewContainerByViewId(r.id),d=this.getDefaultContainerById(r.id);a&&d&&a!==d&&o.push({views:[r],from:a,to:d})}}for(const[s,n]of i)this.moveViewContainerToLocationWithoutSaving(s,n);for(const{views:s,from:n,to:r}of o)this.moveViewsWithoutSaving(s,n,r,Oo.Default);this.viewContainersCustomLocations=e,this.viewDescriptorsCustomLocations=t}generateContainerId(e){return`${Bt.COMMON_CONTAINER_ID_PREFIX}.${wd(e)}.${Un()}`}saveViewCustomizations(){const e={viewContainerLocations:{},viewLocations:{},viewContainerBadgeEnablementStates:{}};for(const[t,i]of this.viewContainersCustomLocations){const o=this.getViewContainerById(t);o&&!this.isGeneratedContainerId(t)&&i===this.getDefaultViewContainerLocation(o)||(e.viewContainerLocations[t]=i)}for(const[t,i]of this.viewDescriptorsCustomLocations){const o=this.getViewContainerById(i);if(o){const s=this.getDefaultContainerById(t);if((s==null?void 0:s.id)===o.id)continue}e.viewLocations[t]=i}for(const[t,i]of this.viewContainerBadgeEnablementStates)i===!1&&(e.viewContainerBadgeEnablementStates[t]=i);this.viewCustomizations=e}get viewCustomizations(){return this._viewCustomizations||(this._viewCustomizations=JSON.parse(this.getStoredViewCustomizationsValue()),this._viewCustomizations.viewContainerLocations=this._viewCustomizations.viewContainerLocations??{},this._viewCustomizations.viewLocations=this._viewCustomizations.viewLocations??{},this._viewCustomizations.viewContainerBadgeEnablementStates=this._viewCustomizations.viewContainerBadgeEnablementStates??{}),this._viewCustomizations}set viewCustomizations(e){const t=JSON.stringify(e);JSON.stringify(this.viewCustomizations)!==t&&(this._viewCustomizations=e,this.setStoredViewCustomizationsValue(t))}getStoredViewCustomizationsValue(){return this.storageService.get(Bt.VIEWS_CUSTOMIZATIONS,0,"{}")}setStoredViewCustomizationsValue(e){this.storageService.store(Bt.VIEWS_CUSTOMIZATIONS,e,0,0)}getViewsByContainer(e){const t=this.viewsRegistry.getViews(e).filter(i=>(this.viewDescriptorsCustomLocations.get(i.id)??e.id)===e.id);for(const[i,o]of this.viewDescriptorsCustomLocations.entries()){if(o!==e.id||this.viewsRegistry.getViewContainer(i)===e)continue;const s=this.getViewDescriptorById(i);s&&t.push(s)}return t}onDidRegisterViewContainer(e){const t=this.isGeneratedContainerId(e.id)?!0:this.getViewContainerLocation(e)===this.getDefaultViewContainerLocation(e);this.getOrCreateDefaultViewContainerLocationContextKey(e).set(t),this.getOrRegisterViewContainerModel(e)}getOrRegisterViewContainerModel(e){var i;let t=(i=this.viewContainerModels.get(e))==null?void 0:i.viewContainerModel;if(!t){const o=new x;t=o.add(this.instantiationService.createInstance(Xr,e)),this.onDidChangeActiveViews({added:t.activeViewDescriptors,removed:[]}),t.onDidChangeActiveViewDescriptors(n=>this.onDidChangeActiveViews(n),this,o),this.onDidChangeVisibleViews({added:[...t.visibleViewDescriptors],removed:[]}),t.onDidAddVisibleViewDescriptors(n=>this.onDidChangeVisibleViews({added:n.map(({viewDescriptor:r})=>r),removed:[]}),this,o),t.onDidRemoveVisibleViewDescriptors(n=>this.onDidChangeVisibleViews({added:[],removed:n.map(({viewDescriptor:r})=>r)}),this,o),o.add(Y(()=>this.viewsVisibilityActionDisposables.deleteAndDispose(e))),o.add(this.registerResetViewContainerAction(e)),this.viewContainerModels.set(e,{viewContainerModel:t,disposables:o,dispose:()=>o.dispose()}),this.onDidRegisterViews([{views:this.viewsRegistry.getViews(e),viewContainer:e}]);const s=this.getViewsByContainer(e).filter(n=>this.getDefaultContainerById(n.id)!==e);s.length&&(this.addViews(e,s),this.contextKeyService.bufferChangeEvents(()=>{s.forEach(n=>this.getOrCreateMovableViewContextKey(n).set(!!n.canMoveView))}))}return t}onDidDeregisterViewContainer(e){this.viewContainerModels.deleteAndDispose(e)}onDidChangeActiveViews({added:e,removed:t}){this.contextKeyService.bufferChangeEvents(()=>{e.forEach(i=>this.getOrCreateActiveViewContextKey(i).set(!0)),t.forEach(i=>this.getOrCreateActiveViewContextKey(i).set(!1))})}onDidChangeVisibleViews({added:e,removed:t}){this.contextKeyService.bufferChangeEvents(()=>{e.forEach(i=>this.getOrCreateVisibleViewContextKey(i).set(!0)),t.forEach(i=>this.getOrCreateVisibleViewContextKey(i).set(!1))})}registerViewsVisibilityActions(){for(const[e,{viewContainerModel:t,disposables:i}]of this.viewContainerModels)this.viewsVisibilityActionDisposables.set(e,this.registerViewsVisibilityActionsForContainer(t)),i.add(A.any(t.onDidChangeActiveViewDescriptors,t.onDidAddVisibleViewDescriptors,t.onDidRemoveVisibleViewDescriptors,t.onDidMoveVisibleViewDescriptors)(o=>this.viewsVisibilityActionDisposables.set(e,this.registerViewsVisibilityActionsForContainer(t))))}registerViewsVisibilityActionsForContainer(e){const t=new x;return e.activeViewDescriptors.forEach((i,o)=>{i.remoteAuthority||(t.add(j(class extends yd{constructor(){super({id:`${i.id}.toggleVisibility`,viewPaneContainerId:e.viewContainer.id,precondition:i.canToggleVisibility&&(!e.isVisible(i.id)||e.visibleViewDescriptors.length>1)?v.true():v.false(),toggled:v.has(`${i.id}.visible`),title:i.name,menu:[{id:Zp,group:"1_toggleViews",when:v.and(v.equals("viewContainer",e.viewContainer.id),v.equals("viewContainerLocation",wd(0))),order:o},{id:S.ViewContainerTitleContext,when:v.and(v.equals("viewContainer",e.viewContainer.id)),order:o,group:"1_toggleVisibility"},{id:S.ViewTitleContext,when:v.and(e.visibleViewDescriptors.length>1?v.or(...e.visibleViewDescriptors.map(s=>v.equals("view",s.id))):v.false()),order:o,group:"2_toggleVisibility"}]})}async runInViewPaneContainer(s,n){n.toggleViewVisibility(i.id)}})),t.add(j(class extends yd{constructor(){super({id:`${i.id}.removeView`,viewPaneContainerId:e.viewContainer.id,title:u("hideView","Hide '{0}'",i.name),precondition:i.canToggleVisibility&&(!e.isVisible(i.id)||e.visibleViewDescriptors.length>1)?v.true():v.false(),menu:[{id:S.ViewTitleContext,when:v.and(v.equals("view",i.id),v.has(`${i.id}.visible`)),group:"1_hide",order:1}]})}async runInViewPaneContainer(s,n){n.toggleViewVisibility(i.id)}})))}),t}registerResetViewContainerAction(e){const t=this;return j(class extends ye{constructor(){super({id:`${e.id}.resetViewContainerLocation`,title:{original:"Reset Location",value:u("resetViewLocation","Reset Location")},menu:[{id:S.ViewContainerTitleContext,when:v.or(v.and(v.equals("viewContainer",e.id),v.equals(`${e.id}.defaultViewContainerLocation`,!1)))}]})}run(){t.moveViewContainerToLocation(e,t.getDefaultViewContainerLocation(e))}})}addViews(e,t,i=Oo.Default){this.contextKeyService.bufferChangeEvents(()=>{t.forEach(o=>{const s=this.getDefaultContainerById(o.id)===e;this.getOrCreateDefaultViewLocationContextKey(o).set(s),s?this.viewDescriptorsCustomLocations.delete(o.id):this.viewDescriptorsCustomLocations.set(o.id,e.id)})}),this.getViewContainerModel(e).add(t.map(o=>({viewDescriptor:o,collapsed:i===Oo.Default?void 0:!1,visible:i===Oo.Default?void 0:!0})))}removeViews(e,t){this.contextKeyService.bufferChangeEvents(()=>{t.forEach(i=>{this.viewDescriptorsCustomLocations.get(i.id)===e.id&&this.viewDescriptorsCustomLocations.delete(i.id),this.getOrCreateDefaultViewLocationContextKey(i).set(!1)})}),this.getViewContainerModel(e).remove(t)}getOrCreateActiveViewContextKey(e){const t=`${e.id}.active`;let i=this.activeViewContextKeys.get(t);return i||(i=new U(t,!1).bindTo(this.contextKeyService),this.activeViewContextKeys.set(t,i)),i}getOrCreateVisibleViewContextKey(e){const t=`${e.id}.visible`;let i=this.activeViewContextKeys.get(t);return i||(i=new U(t,!1).bindTo(this.contextKeyService),this.activeViewContextKeys.set(t,i)),i}getOrCreateMovableViewContextKey(e){const t=`${e.id}.canMove`;let i=this.movableViewContextKeys.get(t);return i||(i=new U(t,!1).bindTo(this.contextKeyService),this.movableViewContextKeys.set(t,i)),i}getOrCreateDefaultViewLocationContextKey(e){const t=`${e.id}.defaultViewLocation`;let i=this.defaultViewLocationContextKeys.get(t);return i||(i=new U(t,!1).bindTo(this.contextKeyService),this.defaultViewLocationContextKeys.set(t,i)),i}getOrCreateDefaultViewContainerLocationContextKey(e){const t=`${e.id}.defaultViewContainerLocation`;let i=this.defaultViewContainerLocationContextKeys.get(t);return i||(i=new U(t,!1).bindTo(this.contextKeyService),this.defaultViewContainerLocationContextKeys.set(t,i)),i}};os.VIEWS_CUSTOMIZATIONS="views.customizations";os.COMMON_CONTAINER_ID_PREFIX="workbench.views.service";os=C([h(0,I),h(1,G),h(2,oe),h(3,Ci),h(4,Ne)],os);const Di="workbench.action.globalActivity",Ys="workbench.action.accountsActivity";let Zr=class extends V{constructor(e,t,i){super(),this.viewId=e,this.viewDescriptorService=t,this.activityService=i,this.activity=void 0,this.activityDisposable=V.None,this._register(A.filter(this.viewDescriptorService.onDidChangeContainer,o=>o.views.some(s=>s.id===e))(()=>this.update())),this._register(A.filter(this.viewDescriptorService.onDidChangeLocation,o=>o.views.some(s=>s.id===e))(()=>this.update()))}setActivity(e){this.activity=e,this.update()}clearActivity(){this.activity=void 0,this.update()}update(){this.activityDisposable.dispose();const e=this.viewDescriptorService.getViewContainerByViewId(this.viewId);e&&this.activity&&(this.activityDisposable=this.activityService.showViewContainerActivity(e.id,this.activity))}dispose(){this.activityDisposable.dispose()}};Zr=C([h(1,Qe),h(2,So)],Zr);let Qr=class{constructor(e,t,i){this.paneCompositeService=e,this.viewDescriptorService=t,this.instantiationService=i,this.viewActivities=new Map}showViewContainerActivity(e,{badge:t,clazz:i,priority:o}){const s=this.viewDescriptorService.getViewContainerById(e);if(s){const n=this.viewDescriptorService.getViewContainerLocation(s);if(n!==null)return this.paneCompositeService.showActivity(s.id,n,t,i,o)}return V.None}showViewActivity(e,t){let i=this.viewActivities.get(e);i?i.id++:(i={id:1,activity:this.instantiationService.createInstance(Zr,e)},this.viewActivities.set(e,i));const o=i.id;i.activity.setActivity(t);const s=i;return Y(()=>{s.id===o&&(s.activity.dispose(),this.viewActivities.delete(e))})}showAccountsActivity({badge:e,clazz:t,priority:i}){return this.paneCompositeService.showActivity(Ys,0,e,t,i)}showGlobalActivity({badge:e,clazz:t,priority:i}){return this.paneCompositeService.showActivity(Di,0,e,t,i)}};Qr=C([h(0,Si),h(1,Qe),h(2,I)],Qr);var $w='.monaco-workbench .part.activitybar{height:100%;width:48px}.monaco-workbench .activitybar.bordered:before{border-color:inherit;box-sizing:border-box;content:"";float:left;height:100%;position:absolute;width:0}.monaco-workbench .activitybar.left.bordered:before{border-right-style:solid;border-right-width:1px;right:0}.monaco-workbench .activitybar.right.bordered:before{border-left-style:solid;border-left-width:1px;left:0}.monaco-workbench .activitybar>.content{display:flex;flex-direction:column;height:100%;justify-content:space-between}.monaco-workbench .activitybar>.content .monaco-action-bar{background-color:inherit;text-align:left}.monaco-workbench .activitybar .action-item:focus{outline:0!important}.monaco-workbench .activitybar>.content>.composite-bar{margin-bottom:auto}.monaco-workbench .activitybar .menubar,.monaco-workbench .activitybar .menubar.compact .toolbar-toggle-more{height:35px;width:100%}';he($w,{});var qw='.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item{display:block;position:relative}.monaco-workbench .activitybar>.content .composite-bar>.monaco-action-bar .action-item:after,.monaco-workbench .activitybar>.content .composite-bar>.monaco-action-bar .action-item:before{background-color:transparent;content:"";display:none;height:2px;position:absolute;transition-delay:.1s;transition-duration:0ms;transition-property:background-color;width:48px}.monaco-workbench .activitybar>.content.dragged-over .composite-bar>.monaco-action-bar .action-item:after,.monaco-workbench .activitybar>.content.dragged-over .composite-bar>.monaco-action-bar .action-item:before{display:block}.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item:before{margin-top:-2px;top:1px}.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item:after{bottom:1px;margin-bottom:-2px}.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item:first-of-type:before{margin-top:-2px;top:2px}.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item:last-of-type:after{bottom:2px;margin-bottom:-2px}.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item.bottom:after,.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item.bottom:before,.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item.top:after,.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item.top:before{transition-delay:0s}.monaco-workbench .activitybar>.content.dragged-over-head>.composite-bar>.monaco-action-bar .action-item:first-of-type:before,.monaco-workbench .activitybar>.content.dragged-over-tail>.composite-bar>.monaco-action-bar .action-item:last-of-type:after,.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item.bottom+.action-item:before,.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item.top:before,.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item:last-of-type.bottom:after{background-color:var(--insert-border-color)}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-label{box-sizing:border-box;display:flex;height:48px;margin-right:0;overflow:hidden;position:relative;width:48px;z-index:1}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-label:not(.codicon){font-size:15px;line-height:40px;padding:0 0 0 48px}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-label.codicon{align-items:center;font-size:24px;justify-content:center}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.active .action-label.codicon,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus .action-label.codicon,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:hover .action-label.codicon{color:var(--vscode-activityBar-foreground)!important}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.active .action-label.uri-icon,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus .action-label.uri-icon,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:hover .action-label.uri-icon{background-color:var(--vscode-activityBar-foreground)!important}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.checked .active-item-indicator:before,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus .active-item-indicator:before{border-left:2px solid;content:"";height:100%;position:absolute;top:0;width:0;z-index:1}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.checked .active-item-indicator:before{height:100%;top:0}.monaco-workbench.hc-black .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.checked:not(:focus) .active-item-indicator.action-item,.monaco-workbench.hc-light .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.checked:not(:focus) .active-item-indicator{display:none}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.clicked:focus:before{border-left:none!important}.monaco-workbench .activitybar.left>.content :not(.monaco-menu)>.monaco-action-bar .action-item .active-item-indicator:before{left:0}.monaco-workbench .activitybar.right>.content :not(.monaco-menu)>.monaco-action-bar .action-item .active-item-indicator:before{right:0}.monaco-workbench.hc-black .activitybar.left>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus:before,.monaco-workbench.hc-black .activitybar.right>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus:before,.monaco-workbench.hc-light .activitybar.left>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus:before,.monaco-workbench.hc-light .activitybar.right>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus:before{outline:none}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .active-item-indicator,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .badge,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .profile-badge{bottom:0;height:100%;left:0;margin:auto;overflow:hidden;position:absolute;top:0;width:100%}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .active-item-indicator,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .badge{z-index:2}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .profile-badge{z-index:1}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .active-item-indicator{pointer-events:none}.monaco-workbench.border .activitybar.right>.content :not(.monaco-menu)>.monaco-action-bar .active-item-indicator{left:-2px}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .badge .badge-content{border-radius:20px;font-size:9px;font-weight:600;height:16px;line-height:16px;min-width:8px;padding:0 4px;position:absolute;right:8px;text-align:center;top:24px}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .profile-badge .profile-badge-content{background-color:var(--vscode-profileBadge-background);border:2px solid var(--vscode-activityBar-background);border-radius:7px;color:var(--vscode-profileBadge-foreground);font-size:9px;font-weight:600;line-height:10px;padding:2px 3px;position:absolute;right:6px;top:24px}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:active .profile-badge-content,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus .profile-badge-content,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:hover .profile-badge-content{color:var(--vscode-activityBar-foreground)}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .badge .codicon.badge-content{font-size:12px;font-weight:unset;justify-content:center;padding:0}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .badge .codicon.badge-content:before{text-align:center;vertical-align:baseline}.monaco-workbench .activitybar.right>.content :not(.monaco-menu)>.monaco-action-bar .badge,.monaco-workbench .activitybar.right>.content :not(.monaco-menu)>.monaco-action-bar .profile-badge{left:auto;right:0}';he(qw,{});let ss=class Tu extends js{constructor(e,t,i,o,s){super(e),this.paneCompositePart=t,this.layoutService=i,this.telemetryService=o,this.configurationService=s,this.lastRun=0}updateActivity(e){this.activity=e}async run(e){if(e instanceof MouseEvent&&e.button===2)return;const t=Date.now();if(t>this.lastRun&&t-this.lastRun<Tu.preventDoubleClickDelay)return;this.lastRun=t;const i=this.layoutService.isVisible("workbench.parts.sidebar"),o=this.paneCompositePart.getActivePaneComposite(),s=this.configurationService.getValue("workbench.activityBar.iconClickBehavior"),n=e&&"preserveFocus"in e?!e.preserveFocus:!0;if(i&&(o==null?void 0:o.getId())===this.activity.id){switch(s){case"focus":this.logAction("refocus"),this.paneCompositePart.openPaneComposite(this.activity.id,n);break;case"toggle":default:this.logAction("hide"),this.layoutService.setPartHidden(!0,"workbench.parts.sidebar");break}return}return this.logAction("show"),await this.paneCompositePart.openPaneComposite(this.activity.id,n),this.activate()}logAction(e){this.telemetryService.publicLog2("activityBarAction",{viewletId:this.activity.id,action:e})}};ss.preventDoubleClickDelay=300;ss=C([h(2,st),h(3,Ne),h(4,O)],ss);let ea=class extends Tw{constructor(e,t,i,o,s,n,r,a,d,l,p){super(e,i,()=>!0,o,s,d,p),this.contextMenuActionsProvider=t,this.menuService=n,this.contextMenuService=r,this.contextKeyService=a,this.environmentService=l}render(e){super.render(e),this._register(_(this.container,E.MOUSE_DOWN,async t=>{X.stop(t,!0),(t==null?void 0:t.button)!==2&&this.run()})),this._register(_(this.container,E.CONTEXT_MENU,async t=>{const i=new x,o=await this.resolveContextMenuActions(i),s=new bt(t),n={x:s.posx,y:s.posy};this.contextMenuService.showContextMenu({getAnchor:()=>n,getActions:()=>o,onHide:()=>i.dispose()})})),this._register(_(this.container,E.KEY_UP,t=>{const i=new mt(t);(i.equals(3)||i.equals(10))&&(X.stop(t,!0),this.run())})),this._register(_(this.container,Ve.Tap,t=>{X.stop(t,!0),this.run()}))}async resolveContextMenuActions(e){return this.contextMenuActionsProvider()}};ea=C([h(3,te),h(4,Mt),h(5,rt),h(6,ke),h(7,G),h(8,O),h(9,Lt),h(10,ve)],ea);let an=class extends ea{constructor(e,t,i,o,s,n,r,a,d,l,p,g,f,b){super(t,i,{draggable:!1,colors:s,icon:o,hasPopup:!0,hoverOptions:n},r,a,d,l,p,g,f,b),this.menuId=e}async run(){const e=new x,t=e.add(this.menuService.createMenu(this.menuId,this.contextKeyService)),i=await this.resolveMainMenuActions(t,e);this.contextMenuService.showContextMenu({getAnchor:()=>this.container,anchorAlignment:this.configurationService.getValue("workbench.sideBar.location")==="left"?1:0,anchorAxisAlignment:1,getActions:()=>i,onHide:()=>e.dispose(),menuActionOptions:{renderShortTitle:!0}})}async resolveMainMenuActions(e,t){const i=[];return Es(e,{renderShortTitle:!0},{primary:[],secondary:i}),i}};an=C([h(6,te),h(7,Mt),h(8,rt),h(9,ke),h(10,G),h(11,O),h(12,Lt),h(13,ve)],an);let Vi=class Vu extends an{constructor(e,t,i,o,s,n,r,a,d,l,p,g,f,b,m,y,D){super(S.AccountsContext,e,t,!0,i,o,s,n,a,r,d,f,p,m),this.authenticationService=l,this.productService=g,this.storageService=b,this.credentialsService=y,this.logService=D,this.groupedAccounts=new Map,this.problematicProviders=new Set,this.initialized=!1,this.sessionFromEmbedder=og(this.credentialsService,this.productService),this.registerListeners(),this.initialize()}registerListeners(){this._register(this.authenticationService.onDidRegisterAuthenticationProvider(async e=>{await this.addAccountsFromProvider(e.id)})),this._register(this.authenticationService.onDidUnregisterAuthenticationProvider(e=>{this.groupedAccounts.delete(e.id),this.problematicProviders.delete(e.id)})),this._register(this.authenticationService.onDidChangeSessions(async e=>{for(const t of[...e.event.changed,...e.event.added])try{await this.addOrUpdateAccount(e.providerId,t.account)}catch(i){this.logService.error(i)}for(const t of e.event.removed)this.removeAccount(e.providerId,t.account)}))}async initialize(){const e=this.authenticationService.getProviderIds(),t=await Promise.allSettled(e.map(i=>this.addAccountsFromProvider(i)));for(const i of t)i.status==="rejected"&&this.logService.error(i.reason);this.initialized=!0}async resolveMainMenuActions(e,t){await super.resolveMainMenuActions(e,t);const i=this.authenticationService.getProviderIds(),o=e.getActions();let s=[];for(const n of i){if(!this.initialized){const d=t.add(new Z("noAccountsAvailable",u("loading","Loading..."),void 0,!1));s.push(d);break}const r=this.authenticationService.getLabel(n),a=this.groupedAccounts.get(n);if(!a){if(this.problematicProviders.has(n)){const d=t.add(new Z("providerUnavailable",u("authProviderUnavailable","{0} is currently unavailable",r),void 0,!1));s.push(d);try{await this.addAccountsFromProvider(n)}catch(l){this.logService.error(l)}}continue}for(const d of a){const p=[t.add(new Z(`configureSessions${d.label}`,u("manageTrustedExtensions","Manage Trusted Extensions"),void 0,!0,()=>this.authenticationService.manageTrustedExtensionsForAccount(n,d.label)))];if(d.canSignOut){const f=t.add(new Z("signOut",u("signOut","Sign Out"),void 0,!0,async()=>{const m=(await this.authenticationService.getSessions(n)).filter(y=>y.account.id===d.id);return await this.authenticationService.removeAccountSessions(n,d.label,m)}));p.push(f)}const g=new uo("activitybar.submenu",`${d.label} (${r})`,p);s.push(g)}}if(i.length&&!s.length){const n=t.add(new Z("noAccountsAvailable",u("noAccounts","You are not signed in to any accounts"),void 0,!1));s.push(n)}return s.length&&o.length&&s.push(new Pe),o.forEach((n,r)=>{const a=n[1];s=s.concat(a),r!==o.length-1&&s.push(new Pe)}),s}async resolveContextMenuActions(e){const t=await super.resolveContextMenuActions(e);return t.unshift(Ee({id:"hideAccounts",label:u("hideAccounts","Hide Accounts"),run:()=>this.storageService.store(Vu.ACCOUNTS_VISIBILITY_PREFERENCE_KEY,!1,0,0)}),new Pe),t}async addOrUpdateAccount(e,t){let i=this.groupedAccounts.get(e);if(i){const n=i.find(r=>r.id===t.id);if(n){n.label!==t.label&&(n.label=t.label);return}}else i=[],this.groupedAccounts.set(e,i);const o=await this.sessionFromEmbedder;let s=!!(o!=null&&o.canSignOut);s||(o!=null&&o.id?s=!(await this.authenticationService.getSessions(e)).filter(r=>r.account.id===t.id).some(r=>r.id===o.id):s=!0),i.push({...t,canSignOut:s})}removeAccount(e,t){const i=this.groupedAccounts.get(e);if(!i)return;const o=i.findIndex(s=>s.id===t.id);o!==-1&&(i.splice(o,1),i.length===0&&this.groupedAccounts.delete(e))}async addAccountsFromProvider(e){try{const t=await this.authenticationService.getSessions(e);this.problematicProviders.delete(e);for(const i of t)try{await this.addOrUpdateAccount(e,i.account)}catch(o){this.logService.error(o)}}catch(t){this.logService.error(t),this.problematicProviders.add(e)}}};Vi.ACCOUNTS_VISIBILITY_PREFERENCE_KEY="workbench.activity.showAccounts";Vi=C([h(4,te),h(5,Mt),h(6,ke),h(7,rt),h(8,G),h(9,Qp),h(10,Lt),h(11,Eh),h(12,O),h(13,oe),h(14,ve),h(15,eg),h(16,it)],Vi);let ta=class extends an{constructor(e,t,i,o,s,n,r,a,d,l,p,g,f){super(S.GlobalActivity,e,t,!0,i,o,n,r,a,d,l,p,g,f),this.userDataProfileService=s,this._register(A.any(this.userDataProfileService.onDidUpdateCurrentProfile,this.userDataProfileService.onDidChangeCurrentProfile)(()=>this.updateProfileBadge()))}render(e){super.render(e),this.profileBadge=de(e,z(".profile-badge")),this.profileBadgeContent=de(this.profileBadge,z(".profile-badge-content")),this.updateProfileBadge()}updateProfileBadge(){!this.profileBadge||!this.profileBadgeContent||(Jt(this.profileBadgeContent),mi(this.profileBadge),!this.userDataProfileService.currentProfile.isDefault&&(this.action.getBadge()||(this.profileBadgeContent.textContent=this.userDataProfileService.currentProfile.name.substring(0,2).toUpperCase(),fi(this.profileBadge))))}updateBadge(){super.updateBadge(),this.updateProfileBadge()}computeTitle(){return this.userDataProfileService.currentProfile.isDefault?super.computeTitle():u("manage","Manage {0} (Profile)",this.userDataProfileService.currentProfile.name)}};ta=C([h(4,tg),h(5,te),h(6,Mt),h(7,rt),h(8,ke),h(9,G),h(10,O),h(11,Lt),h(12,ve)],ta);class jw extends ss{}class ch extends Qc{constructor(e,t){super({id:e,name:e,classNames:void 0},t)}setActivity(e){this.label=e.name}}class Ou extends ed{constructor(e,t){super({id:e,name:e,classNames:void 0},t)}setActivity(e){this.label=e.name}}class Ru extends ye{constructor(e,t){super(e),this.offset=t}async run(e){const t=e.get(Si),i=t.getVisiblePaneCompositeIds(0),o=t.getActivePaneComposite(0);if(!o)return;let s;for(let n=0;n<i.length;n++)if(i[n]===o.getId()){s=i[(n+i.length+this.offset)%i.length];break}await t.openPaneComposite(s,0,!0)}}j(class extends Ru{constructor(){super({id:"workbench.action.previousSideBarView",title:{value:u("previousSideBarView","Previous Primary Side Bar View"),original:"Previous Primary Side Bar View"},category:fe.View,f1:!0},-1)}});j(class extends Ru{constructor(){super({id:"workbench.action.nextSideBarView",title:{value:u("nextSideBarView","Next Primary Side Bar View"),original:"Next Primary Side Bar View"},category:fe.View,f1:!0},1)}});j(class extends ye{constructor(){super({id:"workbench.action.focusActivityBar",title:{value:u("focusActivityBar","Focus Activity Bar"),original:"Focus Activity Bar"},category:fe.View,f1:!0})}async run(e){const t=e.get(st);t.setPartHidden(!1,"workbench.parts.activitybar"),t.focusPart("workbench.parts.activitybar")}});Pc((c,e)=>{const t=c.getColor(Dh);t&&e.addRule(`
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked .active-item-indicator:before {
				border-left-color: ${t};
			}
		`);const i=c.getColor(ig);i&&e.addRule(`
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:focus::before {
				visibility: hidden;
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:focus .active-item-indicator:before {
				visibility: visible;
				border-left-color: ${i};
			}
		`);const o=c.getColor(kh);o&&e.addRule(`
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked .active-item-indicator {
				z-index: 0;
				background-color: ${o};
			}
		`);const s=c.getColor(lo);if(s)e.addRule(`
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:before {
				content: "";
				position: absolute;
				top: 8px;
				left: 8px;
				height: 32px;
				width: 32px;
				z-index: 1;
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.profile-activity-item:before {
				top: -6px;
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.active:before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.active:hover:before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:hover:before {
				outline: 1px solid;
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:hover:before {
				outline: 1px dashed;
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:focus .active-item-indicator:before {
				border-left-color: ${s};
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.active:before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.active:hover:before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:hover:before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:hover:before {
				outline-color: ${s};
			}
		`);else{const n=c.getColor(rb);n&&e.addRule(`
				.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:focus .active-item-indicator:before {
						border-left-color: ${n};
					}
				`)}});class Lu{constructor(e,t,i,o,s){this.viewDescriptorService=e,this.targetContainerLocation=t,this.openComposite=i,this.moveComposite=o,this.getItems=s}drop(e,t,i,o){const s=e.getData();if(s.type==="composite"){const n=this.viewDescriptorService.getViewContainerById(s.id);if(this.viewDescriptorService.getViewContainerLocation(n)===this.targetContainerLocation)t&&this.moveComposite(s.id,t,o);else{if(this.viewDescriptorService.getViewContainerModel(n).allViewDescriptors.some(d=>!d.canMoveView))return;this.viewDescriptorService.moveViewContainerToLocation(n,this.targetContainerLocation,this.getTargetIndex(t,o))}}if(s.type==="view"){const n=this.viewDescriptorService.getViewDescriptorById(s.id);if(n&&n.canMoveView){this.viewDescriptorService.moveViewToLocation(n,this.targetContainerLocation);const r=this.viewDescriptorService.getViewContainerByViewId(n.id);t&&this.moveComposite(r.id,t,o),this.openComposite(r.id,!0).then(a=>{a==null||a.openView(n.id,!0)})}}}onDragEnter(e,t,i){return this.canDrop(e,t)}onDragOver(e,t,i){return this.canDrop(e,t)}getTargetIndex(e,t){if(!e)return;const i=this.getItems(),o=this.targetContainerLocation===1?t==null?void 0:t.horizontallyBefore:t==null?void 0:t.verticallyBefore;return i.filter(s=>s.visible).findIndex(s=>s.id===e)+(o?0:1)}canDrop(e,t){const i=e.getData();if(i.type==="composite"){const o=this.viewDescriptorService.getViewContainerById(i.id);return this.viewDescriptorService.getViewContainerLocation(o)===this.targetContainerLocation?i.id!==t:!this.viewDescriptorService.getViewContainerModel(o).allViewDescriptors.some(r=>!r.canMoveView)}else{const o=this.viewDescriptorService.getViewDescriptorById(i.id);return!(!o||!o.canMoveView)}}}let cn=class extends zn{constructor(e,t,i,o,s){super(),this.options=t,this.instantiationService=i,this.contextMenuService=o,this.viewDescriptorService=s,this._onDidChange=this._register(new w),this.onDidChange=this._onDidChange.event,this.model=new Yw(e,t),this.visibleComposites=[],this.compositeSizeInBar=new Map,this.computeSizes(this.model.visibleItems)}getCompositeBarItems(){return[...this.model.items]}setCompositeBarItems(e){this.model.setItems(e)&&this.updateCompositeSwitcher()}getPinnedComposites(){return this.model.pinnedItems}getVisibleComposites(){return this.model.visibleItems}create(e){const t=e.appendChild(z(".composite-bar"));this.compositeSwitcherBar=this._register(new xo(t,{actionViewItemProvider:o=>{if(o instanceof th)return this.compositeOverflowActionViewItem;const s=this.model.findItem(o.id);return s&&this.instantiationService.createInstance(Vw,{draggable:!0,colors:this.options.colors,icon:this.options.icon,hoverOptions:this.options.activityHoverOptions},o,s.pinnedAction,s.toggleBadgeAction,n=>this.options.getContextMenuActionsForComposite(n),()=>this.getContextMenuActions(),this.options.dndHandler,this)},orientation:this.options.orientation,ariaLabel:u("activityBarAriaLabel","Active View Switcher"),ariaRole:"tablist",animated:!1,preventLoopNavigation:this.options.preventLoopNavigation,triggerKeys:{keyDown:!0}})),this._register(_(e,E.CONTEXT_MENU,o=>this.showContextMenu(o))),this._register(Yt.addTarget(e)),this._register(_(e,Ve.Contextmenu,o=>this.showContextMenu(o)));let i;return this._register(Yo.INSTANCE.registerTarget(e,{onDragOver:o=>{const s=this.getVisibleComposites();if(!s.length||o.eventData.target&&Tt(o.eventData.target,t)){i=this.updateFromDragging(e,!1,!1,!0);return}const n=this.insertAtFront(t,o.eventData),r=n?s[0]:s[s.length-1],a=this.options.dndHandler.onDragOver(o.dragAndDropData,r.id,o.eventData);xh(o.eventData.dataTransfer,"move",a),i=this.updateFromDragging(e,a,n,!0)},onDragLeave:o=>{i=this.updateFromDragging(e,!1,!1,!1)},onDragEnd:o=>{i=this.updateFromDragging(e,!1,!1,!1)},onDrop:o=>{const s=this.getVisibleComposites();if(s.length){const n=this.insertAtFront(t,o.eventData)?s[0]:s[s.length-1];this.options.dndHandler.drop(o.dragAndDropData,n.id,o.eventData,i)}i=this.updateFromDragging(e,!1,!1,!1)}})),t}insertAtFront(e,t){const i=e.getBoundingClientRect(),o=t.clientX,s=t.clientY;switch(this.options.orientation){case 0:return o<i.left;case 1:return s<i.top}}updateFromDragging(e,t,i,o){if(e.classList.toggle("dragged-over",o),e.classList.toggle("dragged-over-head",t&&i),e.classList.toggle("dragged-over-tail",t&&!i),!!t)return{verticallyBefore:i,horizontallyBefore:i}}focus(e){var t;(t=this.compositeSwitcherBar)==null||t.focus(e)}recomputeSizes(){this.computeSizes(this.model.visibleItems)}layout(e){this.dimension=e,!(e.height===0||e.width===0)&&(this.compositeSizeInBar.size===0&&this.computeSizes(this.model.visibleItems),this.updateCompositeSwitcher())}addComposite({id:e,name:t,order:i,requestedIndex:o}){this.model.add(e,t,i,o)&&(this.computeSizes([this.model.findItem(e)]),this.updateCompositeSwitcher())}removeComposite(e){this.isPinned(e)&&this.unpin(e),this.model.remove(e)&&this.updateCompositeSwitcher()}hideComposite(e){this.model.hide(e)&&(this.resetActiveComposite(e),this.updateCompositeSwitcher())}activateComposite(e){const t=this.model.activeItem;this.model.activate(e)&&(this.visibleComposites.indexOf(e)===-1||this.model.activeItem&&!this.model.activeItem.pinned||t&&!t.pinned)&&this.updateCompositeSwitcher()}deactivateComposite(e){const t=this.model.activeItem;this.model.deactivate()&&t&&!t.pinned&&this.updateCompositeSwitcher()}showActivity(e,t,i,o){if(!t)throw ab("badge");typeof o!="number"&&(o=0);const s={badge:t,clazz:i,priority:o};return this.model.addActivity(e,s),Y(()=>this.model.removeActivity(e,s))}async pin(e,t){this.model.setPinned(e,!0)&&(this.updateCompositeSwitcher(),t&&(await this.options.openComposite(e),this.activateComposite(e)))}unpin(e){this.model.setPinned(e,!1)&&(this.updateCompositeSwitcher(),this.resetActiveComposite(e))}areBadgesEnabled(e){return this.viewDescriptorService.getViewContainerBadgeEnablementState(e)}toggleBadgeEnablement(e){this.viewDescriptorService.setViewContainerBadgeEnablementState(e,!this.areBadgesEnabled(e)),this.updateCompositeSwitcher();const t=this.model.findItem(e);t&&t.activityAction.setBadge(t.activityAction.getBadge(),t.activityAction.getClass())}resetActiveComposite(e){const t=this.options.getDefaultCompositeId();!this.model.activeItem||this.model.activeItem.id!==e||(this.deactivateComposite(e),t&&t!==e&&this.isPinned(t)?this.options.openComposite(t,!0):this.options.openComposite(this.visibleComposites.filter(i=>i!==e)[0]))}isPinned(e){const t=this.model.findItem(e);return t==null?void 0:t.pinned}move(e,t,i){if(i!==void 0){const o=this.model.items.findIndex(n=>n.id===e);let s=this.model.items.findIndex(n=>n.id===t);o>=0&&s>=0&&(!i&&o>s&&s++,i&&o<s&&s--,s<this.model.items.length&&s>=0&&s!==o&&this.model.move(this.model.items[o].id,this.model.items[s].id)&&setTimeout(()=>this.updateCompositeSwitcher(),0))}else this.model.move(e,t)&&setTimeout(()=>this.updateCompositeSwitcher(),0)}getAction(e){const t=this.model.findItem(e);return t==null?void 0:t.activityAction}computeSizes(e){const t=this.options.compositeSize;if(t)e.forEach(i=>this.compositeSizeInBar.set(i.id,t));else{const i=this.compositeSwitcherBar;if(i&&this.dimension&&this.dimension.height!==0&&this.dimension.width!==0){const o=i.viewItems.length;i.push(e.map(s=>s.activityAction)),e.forEach((s,n)=>this.compositeSizeInBar.set(s.id,this.options.orientation===1?i.getHeight(o+n):i.getWidth(o+n))),e.forEach(()=>i.pull(i.viewItems.length-1))}}}updateCompositeSwitcher(){var a,d;const e=this.compositeSwitcherBar;if(!e||!this.dimension)return;let t=this.model.visibleItems.filter(l=>l.pinned||this.model.activeItem&&this.model.activeItem.id===l.id).map(l=>l.id),i=t.length;const o=t.length;let s=0;const n=this.options.orientation===1?this.dimension.height:this.dimension.width;for(let l=0;l<t.length;l++){const p=this.compositeSizeInBar.get(t[l]);if(s+p>n){i=l;break}s+=p}for(o>i&&(t=t.slice(0,i)),this.model.activeItem&&t.every(l=>!!this.model.activeItem&&l!==this.model.activeItem.id)&&(s+=this.compositeSizeInBar.get(this.model.activeItem.id),t.push(this.model.activeItem.id));s>n&&t.length;){const l=t.length>1?t.splice(t.length-2,1)[0]:t.pop();s-=this.compositeSizeInBar.get(l)}for(o>t.length&&(s+=this.options.overflowActionSize);s>n&&t.length;){const l=t.length>1&&t[t.length-1]===((a=this.model.activeItem)==null?void 0:a.id)?t.splice(t.length-2,1)[0]:t.pop();s-=this.compositeSizeInBar.get(l)}o===t.length&&this.compositeOverflowAction&&(e.pull(e.length()-1),this.compositeOverflowAction.dispose(),this.compositeOverflowAction=void 0,(d=this.compositeOverflowActionViewItem)==null||d.dispose(),this.compositeOverflowActionViewItem=void 0);const r=[];this.visibleComposites.forEach((l,p)=>{t.includes(l)||r.push(p)}),r.reverse().forEach(l=>{const p=e.viewItems[l];e.pull(l),p.dispose(),this.visibleComposites.splice(l,1)}),t.forEach((l,p)=>{const g=this.visibleComposites.indexOf(l);if(p!==g){if(g!==-1){const f=e.viewItems[g];e.pull(g),f.dispose(),this.visibleComposites.splice(g,1)}e.push(this.model.findItem(l).activityAction,{label:!0,icon:this.options.icon,index:p}),this.visibleComposites.splice(p,0,l)}}),o>t.length&&!this.compositeOverflowAction&&(this.compositeOverflowAction=this.instantiationService.createInstance(th,()=>{var l;(l=this.compositeOverflowActionViewItem)==null||l.showMenu()}),this.compositeOverflowActionViewItem=this.instantiationService.createInstance(Ow,this.compositeOverflowAction,()=>this.getOverflowingComposites(),()=>this.model.activeItem?this.model.activeItem.id:void 0,l=>{var g;const p=this.model.findItem(l);return(g=p==null?void 0:p.activity[0])==null?void 0:g.badge},this.options.getOnCompositeClickAction,this.options.colors,this.options.activityHoverOptions),e.push(this.compositeOverflowAction,{label:!1,icon:!0})),this._onDidChange.fire()}getOverflowingComposites(){let e=this.model.visibleItems.filter(t=>t.pinned).map(t=>t.id);return this.model.activeItem&&!this.model.activeItem.pinned&&e.push(this.model.activeItem.id),e=e.filter(t=>!this.visibleComposites.includes(t)),this.model.visibleItems.filter(t=>e.includes(t.id)).map(t=>{var i;return{id:t.id,name:((i=this.getAction(t.id))==null?void 0:i.label)||t.name}})}showContextMenu(e){X.stop(e,!0);const t=new bt(e);this.contextMenuService.showContextMenu({getAnchor:()=>({x:t.posx,y:t.posy}),getActions:()=>this.getContextMenuActions(e)})}getContextMenuActions(e){return this.model.visibleItems.map(({id:i,name:o,activityAction:s})=>Ee({id:i,label:this.getAction(i).label||o||i,checked:this.isPinned(i),enabled:s.enabled,run:()=>{this.isPinned(i)?this.unpin(i):this.pin(i,!0)}}))}};cn=C([h(2,I),h(3,ke),h(4,Qe)],cn);class Yw{get items(){return this._items}constructor(e,t){this._items=[],this.options=t,this.setItems(e)}setItems(e){const t=[];let i=!1;if(!this.items||this.items.length===0)this._items=e.map(o=>this.createCompositeBarItem(o.id,o.name,o.order,o.pinned,o.visible)),i=!0;else{const o=this.items;for(let s=0;s<e.length;s++){const n=e[s],r=o.filter(({id:a})=>a===n.id)[0];r?r.pinned!==n.pinned||s!==o.indexOf(r)?(r.pinned=n.pinned,t.push(r),i=!0):t.push(r):(t.push(this.createCompositeBarItem(n.id,n.name,n.order,n.pinned,n.visible)),i=!0)}this._items=t}return i}get visibleItems(){return this.items.filter(e=>e.visible)}get pinnedItems(){return this.items.filter(e=>e.visible&&e.pinned)}createCompositeBarItem(e,t,i,o,s){const n=this.options;return{id:e,name:t,pinned:o,order:i,visible:s,activity:[],get activityAction(){return n.getActivityAction(e)},get pinnedAction(){return n.getCompositePinnedAction(e)},get toggleBadgeAction(){return n.getCompositeBadgeAction(e)}}}add(e,t,i,o){const s=this.findItem(e);if(s){let n=!1;return s.name=t,Ye(i)||(n=s.order!==i,s.order=i),s.visible||(s.visible=!0,n=!0),n}else{const n=this.createCompositeBarItem(e,t,i,!0,!0);if(Ye(o))if(Ye(i))this.items.push(n);else{let r=0;for(;r<this.items.length&&typeof this.items[r].order=="number"&&this.items[r].order<i;)r++;this.items.splice(r,0,n)}else{let r=0,a=o;for(;a>0&&r<this.items.length;)this.items[r++].visible&&a--;this.items.splice(r,0,n)}return!0}}remove(e){for(let t=0;t<this.items.length;t++)if(this.items[t].id===e)return this.items.splice(t,1),!0;return!1}hide(e){for(const t of this.items)if(t.id===e)return t.visible?(t.visible=!1,!0):!1;return!1}move(e,t){const i=this.findIndex(e),o=this.findIndex(t);if(i===-1||o===-1)return!1;const s=this.items.splice(i,1)[0];return this.items.splice(o,0,s),s.pinned=!0,!0}setPinned(e,t){for(const i of this.items)if(i.id===e)return i.pinned!==t?(i.pinned=t,!0):!1;return!1}addActivity(e,t){const i=this.findItem(e);if(i){const o=i.activity;for(let s=0;s<=o.length;s++)if(s===o.length){o.push(t);break}else if(o[s].priority<=t.priority){o.splice(s,0,t);break}return this.updateActivity(e),!0}return!1}removeActivity(e,t){const i=this.findItem(e);if(i){const o=i.activity.indexOf(t);if(o!==-1)return i.activity.splice(o,1),this.updateActivity(e),!0}return!1}updateActivity(e){const t=this.findItem(e);if(t)if(t.activity.length){const[{badge:i,clazz:o}]=t.activity;t.activityAction.setBadge(i,o)}else t.activityAction.setBadge(void 0)}activate(e){if(!this.activeItem||this.activeItem.id!==e){this.activeItem&&this.deactivate();for(const t of this.items)if(t.id===e)return this.activeItem=t,this.activeItem.activityAction.activate(),!0}return!1}deactivate(){return this.activeItem?(this.activeItem.activityAction.deactivate(),this.activeItem=void 0,!0):!1}findItem(e){return this.items.filter(t=>t.id===e)[0]}findIndex(e){for(let t=0;t<this.items.length;t++)if(this.items[t].id===e)return t;return-1}}var Jw=".monaco-workbench .menubar .toolbar-toggle-more,.monaco-workbench .menubar>.menubar-menu-button{color:var(--vscode-titleBar-activeForeground)}.monaco-workbench .activitybar .menubar.compact .toolbar-toggle-more,.monaco-workbench .activitybar .menubar.compact>.menubar-menu-button{color:var(--vscode-activityBar-inactiveForeground)}.monaco-workbench .activitybar .menubar.compact:not(:focus-within)>.menubar-menu-button:hover,.monaco-workbench .activitybar .menubar.compact:not(:focus-within)>.menubar-menu-button:hover .toolbar-toggle-more,.monaco-workbench .activitybar .menubar.compact>.menubar-menu-button.open,.monaco-workbench .activitybar .menubar.compact>.menubar-menu-button.open .toolbar-toggle-more,.monaco-workbench .activitybar .menubar.compact>.menubar-menu-button:focus,.monaco-workbench .activitybar .menubar.compact>.menubar-menu-button:focus .toolbar-toggle-more{color:var(--vscode-activityBar-foreground)}.monaco-workbench .menubar.inactive:not(.compact)>.menubar-menu-button,.monaco-workbench .menubar.inactive:not(.compact)>.menubar-menu-button .toolbar-toggle-more{color:var(--vscode-titleBar-inactiveForeground)}.monaco-workbench .menubar:not(.compact)>.menubar-menu-button.open,.monaco-workbench .menubar:not(.compact)>.menubar-menu-button.open .toolbar-toggle-more,.monaco-workbench .menubar:not(.compact)>.menubar-menu-button:focus,.monaco-workbench .menubar:not(.compact)>.menubar-menu-button:focus .toolbar-toggle-more,.monaco-workbench .menubar:not(:focus-within):not(.compact)>.menubar-menu-button:hover,.monaco-workbench .menubar:not(:focus-within):not(.compact)>.menubar-menu-button:hover .toolbar-toggle-more{color:var(--vscode-menubar-selectionForeground)}.monaco-workbench .menubar:not(.compact)>.menubar-menu-button.open .menubar-menu-title,.monaco-workbench .menubar:not(.compact)>.menubar-menu-button:focus .menubar-menu-title,.monaco-workbench .menubar:not(:focus-within):not(.compact)>.menubar-menu-button:hover .menubar-menu-title{background-color:var(--vscode-menubar-selectionBackground)}.monaco-workbench .menubar>.menubar-menu-button:hover .menubar-menu-title{outline:dashed 1px var(--vscode-menubar-selectionBorder)}.monaco-workbench .menubar>.menubar-menu-button.open .menubar-menu-title,.monaco-workbench .menubar>.menubar-menu-button:focus .menubar-menu-title{outline:solid 1px var(--vscode-menubar-selectionBorder)}.monaco-workbench .menubar>.menubar-menu-button.open .menubar-menu-title,.monaco-workbench .menubar>.menubar-menu-button:focus .menubar-menu-title,.monaco-workbench .menubar>.menubar-menu-button:hover .menubar-menu-title{outline-color:var(--vscode-menubar-selectionBorder);outline-offset:-1px}";he(Jw,{});var Xw='.menubar{box-sizing:border-box;display:flex;flex-shrink:1;height:100%;overflow:hidden}.menubar.overflow-menu-only{width:38px}.fullscreen .menubar:not(.compact){margin:0;padding:4px 5px}.menubar>.menubar-menu-button{-webkit-app-region:no-drag;zoom:1;align-items:center;box-sizing:border-box;cursor:default;display:flex;outline:0!important;white-space:nowrap}.monaco-workbench .menubar:not(.compact)>.menubar-menu-button:focus .menubar-menu-title{outline-color:var(--vscode-focusBorder);outline-offset:-1px;outline-style:solid;outline-width:1px}.menubar.compact{flex-shrink:0;overflow:visible}.menubar.compact>.menubar-menu-button{height:100%;padding:0;width:100%}.menubar-menu-title{border-radius:5px;padding:0 8px}.menubar .menubar-menu-items-holder{left:0;opacity:1;position:fixed;z-index:2000}.menubar.compact .menubar-menu-items-holder{position:fixed}.menubar .menubar-menu-items-holder.monaco-menu-container{border:none;outline:0}.menubar .menubar-menu-items-holder.monaco-menu-container :focus{outline:0}.menubar .toolbar-toggle-more{align-items:center;display:flex;height:22px;justify-content:center;padding:0 8px;vertical-align:sub;width:22px}.menubar.compact .toolbar-toggle-more{align-items:center;cursor:pointer;display:flex;justify-content:center;left:0;position:relative;top:0;width:100%}.menubar.compact .toolbar-toggle-more:before,.menubar:not(.compact) .menubar-menu-button:first-child .toolbar-toggle-more:before{content:"\\eb94"!important}.menubar.compact>.menubar-menu-button.open .menubar-menu-title,.menubar.compact>.menubar-menu-button:focus .menubar-menu-title,.menubar.compact>.menubar-menu-button:hover .menubar-menu-title{outline-offset:-8px!important;outline-width:1px!important}';he(Xw,{});const Yi=z;var me;(function(c){c[c.HIDDEN=0]="HIDDEN",c[c.VISIBLE=1]="VISIBLE",c[c.FOCUSED=2]="FOCUSED",c[c.OPEN=3]="OPEN"})(me||(me={}));class ue extends V{constructor(e,t,i){super(),this.container=e,this.options=t,this.menuStyle=i,this._mnemonicsInUse=!1,this.openedViaKeyboard=!1,this.awaitingAltRelease=!1,this.ignoreNextMouseUp=!1,this.updatePending=!1,this.numMenusShown=0,this.overflowLayoutScheduled=void 0,this.container.setAttribute("role","menubar"),this.isCompact&&this.container.classList.add("compact"),this.menus=[],this.mnemonics=new Map,this._focusState=me.VISIBLE,this._onVisibilityChange=this._register(new w),this._onFocusStateChange=this._register(new w),this.createOverflowMenu(),this.menuUpdater=this._register(new Ds(()=>this.update(),200)),this.actionRunner=this.options.actionRunner??this._register(new Kn),this._register(this.actionRunner.onWillRun(()=>{this.setUnfocusedState()})),this._register(cb.getInstance().event(this.onModifierKeyToggled,this)),this._register(_(this.container,E.KEY_DOWN,o=>{const s=new mt(o);let n=!0;const r=o.key?o.key.toLocaleLowerCase():"",a=De&&!this.isCompact;if(s.equals(15)||a&&s.equals(1026))this.focusPrevious();else if(s.equals(17)||a&&s.equals(2))this.focusNext();else if(s.equals(9)&&this.isFocused&&!this.isOpen)this.setUnfocusedState();else if(!this.isOpen&&!s.ctrlKey&&this.options.enableMnemonics&&this.mnemonicsInUse&&this.mnemonics.has(r)){const d=this.mnemonics.get(r);this.onMenuTriggered(d,!1)}else n=!1;!this.isCompact&&(s.equals(1026)||s.equals(2))&&s.preventDefault(),n&&(s.preventDefault(),s.stopPropagation())})),this._register(_(window,E.MOUSE_DOWN,()=>{this.isFocused&&this.setUnfocusedState()})),this._register(_(this.container,E.FOCUS_IN,o=>{const s=o;s.relatedTarget&&(this.container.contains(s.relatedTarget)||(this.focusToReturn=s.relatedTarget))})),this._register(_(this.container,E.FOCUS_OUT,o=>{const s=o;s.relatedTarget?s.relatedTarget&&!this.container.contains(s.relatedTarget)&&(this.focusToReturn=void 0,this.setUnfocusedState()):this.setUnfocusedState()})),this._register(_(window,E.KEY_DOWN,o=>{if(!this.options.enableMnemonics||!o.altKey||o.ctrlKey||o.defaultPrevented)return;const s=o.key.toLocaleLowerCase();if(!this.mnemonics.has(s))return;this.mnemonicsInUse=!0,this.updateMnemonicVisibility(!0);const n=this.mnemonics.get(s);this.onMenuTriggered(n,!1)})),this.setUnfocusedState()}push(e){gb(e).forEach(i=>{const o=this.menus.length,s=Nd(i.label),n=Bd.exec(i.label);if(n){const r=n[1]?n[1]:n[3];this.registerMnemonic(this.menus.length,r)}if(this.isCompact)this.menus.push(i);else{const r=Yi("div.menubar-menu-button",{role:"menuitem",tabindex:-1,"aria-label":s,"aria-haspopup":!0}),a=Yi("div.menubar-menu-title",{role:"none","aria-hidden":!0});r.appendChild(a),this.container.insertBefore(r,this.overflowMenu.buttonElement),this.updateLabels(a,r,i.label),this._register(_(r,E.KEY_UP,d=>{const l=new mt(d);let p=!0;(l.equals(18)||l.equals(3))&&!this.isOpen?(this.focusedMenu={index:o},this.openedViaKeyboard=!0,this.focusState=me.OPEN):p=!1,p&&(l.preventDefault(),l.stopPropagation())})),this._register(Yt.addTarget(r)),this._register(_(r,Ve.Tap,d=>{this.isOpen&&this.focusedMenu&&this.focusedMenu.holder&&Tt(d.initialTarget,this.focusedMenu.holder)||(this.ignoreNextMouseUp=!1,this.onMenuTriggered(o,!0),d.preventDefault(),d.stopPropagation())})),this._register(_(r,E.MOUSE_DOWN,d=>{if(!new bt(d).leftButton){d.preventDefault();return}this.isOpen?this.ignoreNextMouseUp=!1:(this.ignoreNextMouseUp=!0,this.onMenuTriggered(o,!0)),d.preventDefault(),d.stopPropagation()})),this._register(_(r,E.MOUSE_UP,d=>{d.defaultPrevented||(this.ignoreNextMouseUp?this.ignoreNextMouseUp=!1:this.isFocused&&this.onMenuTriggered(o,!0))})),this._register(_(r,E.MOUSE_ENTER,()=>{this.isOpen&&!this.isCurrentMenu(o)?(r.focus(),this.cleanupCustomMenu(),this.showCustomMenu(o,!1)):this.isFocused&&!this.isOpen&&(this.focusedMenu={index:o},r.focus())})),this.menus.push({label:i.label,actions:i.actions,buttonElement:r,titleElement:a})}})}createOverflowMenu(){const e=this.isCompact?u("mAppMenu","Application Menu"):u("mMore","More"),t=Yi("div.menubar-menu-button",{role:"menuitem",tabindex:this.isCompact?0:-1,"aria-label":e,"aria-haspopup":!0}),i=Yi("div.menubar-menu-title.toolbar-toggle-more"+ge.asCSSSelector(le.menuBarMore),{role:"none","aria-hidden":!0});t.appendChild(i),this.container.appendChild(t),t.style.visibility="hidden",this._register(_(t,E.KEY_UP,o=>{const s=new mt(o);let n=!0;const r=[3];this.isCompact?(r.push(10),this.options.compactMode===Ii.Right?r.push(17):this.options.compactMode===Ii.Left&&r.push(15)):r.push(18),r.some(a=>s.equals(a))&&!this.isOpen?(this.focusedMenu={index:ue.OVERFLOW_INDEX},this.openedViaKeyboard=!0,this.focusState=me.OPEN):n=!1,n&&(s.preventDefault(),s.stopPropagation())})),this._register(Yt.addTarget(t)),this._register(_(t,Ve.Tap,o=>{this.isOpen&&this.focusedMenu&&this.focusedMenu.holder&&Tt(o.initialTarget,this.focusedMenu.holder)||(this.ignoreNextMouseUp=!1,this.onMenuTriggered(ue.OVERFLOW_INDEX,!0),o.preventDefault(),o.stopPropagation())})),this._register(_(t,E.MOUSE_DOWN,o=>{if(!new bt(o).leftButton){o.preventDefault();return}this.isOpen?this.ignoreNextMouseUp=!1:(this.ignoreNextMouseUp=!0,this.onMenuTriggered(ue.OVERFLOW_INDEX,!0)),o.preventDefault(),o.stopPropagation()})),this._register(_(t,E.MOUSE_UP,o=>{o.defaultPrevented||(this.ignoreNextMouseUp?this.ignoreNextMouseUp=!1:this.isFocused&&this.onMenuTriggered(ue.OVERFLOW_INDEX,!0))})),this._register(_(t,E.MOUSE_ENTER,()=>{this.isOpen&&!this.isCurrentMenu(ue.OVERFLOW_INDEX)?(this.overflowMenu.buttonElement.focus(),this.cleanupCustomMenu(),this.showCustomMenu(ue.OVERFLOW_INDEX,!1)):this.isFocused&&!this.isOpen&&(this.focusedMenu={index:ue.OVERFLOW_INDEX},t.focus())})),this.overflowMenu={buttonElement:t,titleElement:i,label:"More",actions:[]}}updateMenu(e){const t=this.menus.filter(i=>i.label===e.label);t&&t.length&&(t[0].actions=e.actions)}dispose(){super.dispose(),this.menus.forEach(e=>{var t,i;(t=e.titleElement)==null||t.remove(),(i=e.buttonElement)==null||i.remove()}),this.overflowMenu.titleElement.remove(),this.overflowMenu.buttonElement.remove(),ie(this.overflowLayoutScheduled),this.overflowLayoutScheduled=void 0}blur(){this.setUnfocusedState()}getWidth(){if(!this.isCompact&&this.menus){const e=this.menus[0].buttonElement.getBoundingClientRect().left;return(this.hasOverflow?this.overflowMenu.buttonElement.getBoundingClientRect().right:this.menus[this.menus.length-1].buttonElement.getBoundingClientRect().right)-e}return 0}getHeight(){return this.container.clientHeight}toggleFocus(){!this.isFocused&&this.options.visibility!=="hidden"?(this.mnemonicsInUse=!0,this.focusedMenu={index:this.numMenusShown>0?0:ue.OVERFLOW_INDEX},this.focusState=me.FOCUSED):this.isOpen||this.setUnfocusedState()}updateOverflowAction(){var r,a;if(!this.menus||!this.menus.length)return;const e="overflow-menu-only";this.container.classList.toggle(e,!1);const t=this.container.offsetWidth;let i=0,o=this.isCompact;const s=this.numMenusShown;this.numMenusShown=0;const n=this.menus.filter(d=>d.buttonElement!==void 0&&d.titleElement!==void 0);for(const d of n){if(!o){const l=d.buttonElement.offsetWidth;i+l>t?o=!0:(i+=l,this.numMenusShown++,this.numMenusShown>s&&(d.buttonElement.style.visibility="visible"))}o&&(d.buttonElement.style.visibility="hidden")}if(this.numMenusShown-1<=n.length/2){for(const d of n)d.buttonElement.style.visibility="hidden";o=!0,this.numMenusShown=0,i=0}if(this.isCompact){this.overflowMenu.actions=[];for(let l=this.numMenusShown;l<this.menus.length;l++)this.overflowMenu.actions.push(new uo(`menubar.submenu.${this.menus[l].label}`,this.menus[l].label,this.menus[l].actions||[]));const d=(a=(r=this.options).getCompactMenuActions)==null?void 0:a.call(r);d&&d.length&&(this.overflowMenu.actions.push(new Pe),this.overflowMenu.actions.push(...d)),this.overflowMenu.buttonElement.style.visibility="visible"}else if(o){for(;i+this.overflowMenu.buttonElement.offsetWidth>t&&this.numMenusShown>0;){this.numMenusShown--;const d=n[this.numMenusShown].buttonElement.offsetWidth;n[this.numMenusShown].buttonElement.style.visibility="hidden",i-=d}this.overflowMenu.actions=[];for(let d=this.numMenusShown;d<n.length;d++)this.overflowMenu.actions.push(new uo(`menubar.submenu.${n[d].label}`,n[d].label,n[d].actions||[]));this.overflowMenu.buttonElement.nextElementSibling!==n[this.numMenusShown].buttonElement&&(this.overflowMenu.buttonElement.remove(),this.container.insertBefore(this.overflowMenu.buttonElement,n[this.numMenusShown].buttonElement)),this.overflowMenu.buttonElement.style.visibility="visible"}else this.overflowMenu.buttonElement.remove(),this.container.appendChild(this.overflowMenu.buttonElement),this.overflowMenu.buttonElement.style.visibility="hidden";this.container.classList.toggle(e,this.numMenusShown===0)}updateLabels(e,t,i){const o=Nd(i);if(this.options.enableMnemonics){const n=db(i);ur.lastIndex=0;let r=ur.exec(n);for(;r&&r[1];)r=ur.exec(n);const a=d=>d.replace(/&amp;&amp;/g,"&amp;");r?(e.innerText="",e.append(hb(a(n.substr(0,r.index))," "),Yi("mnemonic",{"aria-hidden":"true"},r[3]),lb(a(n.substr(r.index+r[0].length))," "))):e.innerText=a(n).trim()}else e.innerText=o.replace(/&&/g,"&");const s=Bd.exec(i);if(s){const n=s[1]?s[1]:s[3];this.options.enableMnemonics?t.setAttribute("aria-keyshortcuts","Alt+"+n.toLocaleLowerCase()):t.removeAttribute("aria-keyshortcuts")}}update(e){if(e&&(this.options=e),this.isFocused){this.updatePending=!0;return}this.menus.forEach(t=>{!t.buttonElement||!t.titleElement||this.updateLabels(t.titleElement,t.buttonElement,t.label)}),this.overflowLayoutScheduled||(this.overflowLayoutScheduled=Pr(()=>{this.updateOverflowAction(),this.overflowLayoutScheduled=void 0})),this.setUnfocusedState()}registerMnemonic(e,t){this.mnemonics.set(t.toLocaleLowerCase(),e)}hideMenubar(){this.container.style.display!=="none"&&(this.container.style.display="none",this._onVisibilityChange.fire(!1))}showMenubar(){this.container.style.display!=="flex"&&(this.container.style.display="flex",this._onVisibilityChange.fire(!0),this.updateOverflowAction())}get focusState(){return this._focusState}set focusState(e){var s,n;if(this._focusState>=me.FOCUSED&&e<me.FOCUSED&&this.updatePending&&(this.menuUpdater.schedule(),this.updatePending=!1),e===this._focusState)return;const t=this.isVisible,i=this.isOpen,o=this.isFocused;switch(this._focusState=e,e){case me.HIDDEN:t&&this.hideMenubar(),i&&this.cleanupCustomMenu(),o&&(this.focusedMenu=void 0,this.focusToReturn&&(this.focusToReturn.focus(),this.focusToReturn=void 0));break;case me.VISIBLE:t||this.showMenubar(),i&&this.cleanupCustomMenu(),o&&(this.focusedMenu&&(this.focusedMenu.index===ue.OVERFLOW_INDEX?this.overflowMenu.buttonElement.blur():(s=this.menus[this.focusedMenu.index].buttonElement)==null||s.blur()),this.focusedMenu=void 0,this.focusToReturn&&(this.focusToReturn.focus(),this.focusToReturn=void 0));break;case me.FOCUSED:t||this.showMenubar(),i&&this.cleanupCustomMenu(),this.focusedMenu&&(this.focusedMenu.index===ue.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():(n=this.menus[this.focusedMenu.index].buttonElement)==null||n.focus());break;case me.OPEN:t||this.showMenubar(),this.focusedMenu&&this.showCustomMenu(this.focusedMenu.index,this.openedViaKeyboard);break}this._focusState=e,this._onFocusStateChange.fire(this.focusState>=me.FOCUSED)}get isVisible(){return this.focusState>=me.VISIBLE}get isFocused(){return this.focusState>=me.FOCUSED}get isOpen(){return this.focusState>=me.OPEN}get hasOverflow(){return this.isCompact||this.numMenusShown<this.menus.length}get isCompact(){return this.options.compactMode!==void 0}setUnfocusedState(){this.options.visibility==="toggle"||this.options.visibility==="hidden"?this.focusState=me.HIDDEN:this.options.visibility==="classic"&&Ll()?this.focusState=me.HIDDEN:this.focusState=me.VISIBLE,this.ignoreNextMouseUp=!1,this.mnemonicsInUse=!1,this.updateMnemonicVisibility(!1)}focusPrevious(){var t;if(!this.focusedMenu||this.numMenusShown===0)return;let e=(this.focusedMenu.index-1+this.numMenusShown)%this.numMenusShown;this.focusedMenu.index===ue.OVERFLOW_INDEX?e=this.numMenusShown-1:this.focusedMenu.index===0&&this.hasOverflow&&(e=ue.OVERFLOW_INDEX),e!==this.focusedMenu.index&&(this.isOpen?(this.cleanupCustomMenu(),this.showCustomMenu(e)):this.isFocused&&(this.focusedMenu.index=e,e===ue.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():(t=this.menus[e].buttonElement)==null||t.focus()))}focusNext(){var t;if(!this.focusedMenu||this.numMenusShown===0)return;let e=(this.focusedMenu.index+1)%this.numMenusShown;this.focusedMenu.index===ue.OVERFLOW_INDEX?e=0:this.focusedMenu.index===this.numMenusShown-1&&(e=ue.OVERFLOW_INDEX),e!==this.focusedMenu.index&&(this.isOpen?(this.cleanupCustomMenu(),this.showCustomMenu(e)):this.isFocused&&(this.focusedMenu.index=e,e===ue.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():(t=this.menus[e].buttonElement)==null||t.focus()))}updateMnemonicVisibility(e){this.menus&&this.menus.forEach(t=>{if(t.titleElement&&t.titleElement.children.length){const i=t.titleElement.children.item(0);i&&(i.style.textDecoration=this.options.alwaysOnMnemonics||e?"underline":"")}})}get mnemonicsInUse(){return this._mnemonicsInUse}set mnemonicsInUse(e){this._mnemonicsInUse=e}get shouldAltKeyFocus(){return De?!1:!this.options.disableAltFocus||this.options.visibility==="toggle"}get onVisibilityChange(){return this._onVisibilityChange.event}get onFocusStateChange(){return this._onFocusStateChange.event}onMenuTriggered(e,t){this.isOpen?this.isCurrentMenu(e)?this.setUnfocusedState():(this.cleanupCustomMenu(),this.showCustomMenu(e,this.openedViaKeyboard)):(this.focusedMenu={index:e},this.openedViaKeyboard=!t,this.focusState=me.OPEN)}onModifierKeyToggled(e){const t=!e.altKey&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey;this.options.visibility!=="hidden"&&(e.event&&this.shouldAltKeyFocus&&ub.toEnum(e.event.code)===159&&e.event.preventDefault(),this.isFocused&&e.lastKeyPressed==="alt"&&e.altKey&&(this.setUnfocusedState(),this.mnemonicsInUse=!1,this.awaitingAltRelease=!0),t&&e.lastKeyPressed==="alt"&&e.lastKeyReleased==="alt"&&(this.awaitingAltRelease||(!this.isFocused&&this.shouldAltKeyFocus?(this.mnemonicsInUse=!0,this.focusedMenu={index:this.numMenusShown>0?0:ue.OVERFLOW_INDEX},this.focusState=me.FOCUSED):this.isOpen||this.setUnfocusedState())),!e.altKey&&e.lastKeyReleased==="alt"&&(this.awaitingAltRelease=!1),this.options.enableMnemonics&&this.menus&&!this.isOpen&&this.updateMnemonicVisibility(!this.awaitingAltRelease&&e.altKey||this.mnemonicsInUse))}isCurrentMenu(e){return this.focusedMenu?this.focusedMenu.index===e:!1}cleanupCustomMenu(){var e,t,i;this.focusedMenu&&(this.focusedMenu.index===ue.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():(e=this.menus[this.focusedMenu.index].buttonElement)==null||e.focus(),this.focusedMenu.holder&&((t=this.focusedMenu.holder.parentElement)==null||t.classList.remove("open"),this.focusedMenu.holder.remove()),(i=this.focusedMenu.widget)==null||i.dispose(),this.focusedMenu={index:this.focusedMenu.index})}showCustomMenu(e,t=!0){const i=e>=this.numMenusShown?ue.OVERFLOW_INDEX:e,o=i===ue.OVERFLOW_INDEX?this.overflowMenu:this.menus[i];if(!o.actions||!o.buttonElement||!o.titleElement)return;const s=Yi("div.menubar-menu-items-holder",{title:""});o.buttonElement.classList.add("open");const n=o.titleElement.getBoundingClientRect(),r=Ml(o.titleElement);this.options.compactMode===Ii.Right?(s.style.top=`${n.top}px`,s.style.left=`${n.left+this.container.clientWidth}px`):this.options.compactMode===Ii.Left?(s.style.top=`${n.top}px`,s.style.right=`${this.container.clientWidth}px`,s.style.left="auto"):(s.style.top=`${n.bottom*r}px`,s.style.left=`${n.left*r}px`),o.buttonElement.appendChild(s);const a={getKeyBinding:this.options.getKeybinding,actionRunner:this.actionRunner,enableMnemonics:this.options.alwaysOnMnemonics||this.mnemonicsInUse&&this.options.enableMnemonics,ariaLabel:At(o.buttonElement.getAttribute("aria-label")),expandDirection:this.isCompact?this.options.compactMode:Ii.Right,useEventAsContext:!0},d=this._register(new pb(s,o.actions,a,this.menuStyle));this._register(d.onDidCancel(()=>{this.focusState=me.FOCUSED})),i!==e?d.trigger(e-this.numMenusShown):d.focus(t),this.focusedMenu={index:i,holder:s,widget:d}}}ue.OVERFLOW_INDEX=-1;function dh(c){return c&&c.hasOwnProperty("folderUri")}function Zw(c){return c&&c.hasOwnProperty("workspace")}const Mu="inRecentFilesPicker";class Qw extends ye{constructor(e){super(e),this.removeFromRecentlyOpened={iconClass:ge.asClassName(le.removeClose),tooltip:u("remove","Remove from Recently Opened")},this.dirtyRecentlyOpenedFolder={iconClass:"dirty-workspace "+ge.asClassName(le.closeDirty),tooltip:u("dirtyRecentlyOpenedFolder","Folder With Unsaved Files"),alwaysVisible:!0},this.dirtyRecentlyOpenedWorkspace={...this.dirtyRecentlyOpenedFolder,tooltip:u("dirtyRecentlyOpenedWorkspace","Workspace With Unsaved Files")}}async run(e){const t=e.get(lc),i=e.get(ks),o=e.get(ze),s=e.get(Ft),n=e.get(ve),r=e.get(Pl),a=e.get(Fl),d=e.get(ti),l=e.get(uc),p=await t.getRecentlyOpened(),g=await t.getDirtyWorkspaces();let f=!1;const b=new ot,m=new ot;for(const H of g)dh(H)?b.set(H.folderUri,!0):(m.set(H.workspace.configPath,H.workspace),f=!0);const y=new ot,D=new ot;for(const H of p.workspaces)Us(H)?y.set(H.folderUri,!0):(D.set(H.workspace.configPath,H.workspace),f=!0);const L=[];for(const H of p.workspaces){const Vo=Us(H)?b.has(H.folderUri):m.has(H.workspace.configPath);L.push(this.toQuickPick(r,a,s,H,Vo))}for(const H of g)dh(H)&&!y.has(H.folderUri)?L.push(this.toQuickPick(r,a,s,H,!0)):Zw(H)&&!D.has(H.workspace.configPath)&&L.push(this.toQuickPick(r,a,s,H,!0));const $=p.files.map(H=>this.toQuickPick(r,a,s,H,!1)),Se=p.workspaces[0],St=Se&&o.isCurrentWorkspace(kr(Se)?Se.workspace:Se.folderUri);let F;const re={type:"separator",label:f?u("workspacesAndFolders","folders & workspaces"):u("folders","folders")},ae={type:"separator",label:u("files","files")},dt=[re,...L,ae,...$],ri=await i.pick(dt,{contextKey:Mu,activeItem:[...L,...$][St?1:0],placeHolder:De?u("openRecentPlaceholderMac","Select to open (hold Cmd-key to force new window or Option-key for same window)"):u("openRecentPlaceholder","Select to open (hold Ctrl-key to force new window or Alt-key for same window)"),matchOnDescription:!0,onKeyMods:H=>F=H,quickNavigate:this.isQuickNavigate()?{keybindings:n.lookupKeybindings(this.desc.id)}:void 0,hideInput:this.isQuickNavigate(),onDidTriggerItemButton:async H=>{if(H.button===this.removeFromRecentlyOpened)await t.removeRecentlyOpened([H.item.resource]),H.removeItem();else if(H.button===this.dirtyRecentlyOpenedFolder||H.button===this.dirtyRecentlyOpenedWorkspace){const Vo=H.button===this.dirtyRecentlyOpenedWorkspace,{confirmed:Wp}=await l.confirm({title:Vo?u("dirtyWorkspace","Workspace with Unsaved Files"):u("dirtyFolder","Folder with Unsaved Files"),message:Vo?u("dirtyWorkspaceConfirm","Do you want to open the workspace to review the unsaved files?"):u("dirtyFolderConfirm","Do you want to open the folder to review the unsaved files?"),detail:Vo?u("dirtyWorkspaceConfirmDetail","Workspaces with unsaved files cannot be removed until all unsaved files have been saved or reverted."):u("dirtyFolderConfirmDetail","Folders with unsaved files cannot be removed until all unsaved files have been saved or reverted.")});Wp&&(d.openWindow([H.item.openable],{remoteAuthority:H.item.remoteAuthority||null}),i.cancel())}}});if(ri)return d.openWindow([ri.openable],{forceNewWindow:F==null?void 0:F.ctrlCmd,forceReuseWindow:F==null?void 0:F.alt,remoteAuthority:ri.remoteAuthority||null})}toQuickPick(e,t,i,o,s){let n,r,a,d,l=!1;Us(o)?(d=o.folderUri,r=pr(e,t,d,Oe.FOLDER),n={folderUri:d},a=o.label||i.getWorkspaceLabel(d,{verbose:2})):kr(o)?(d=o.workspace.configPath,r=pr(e,t,d,Oe.ROOT_FOLDER),n={workspaceUri:d},a=o.label||i.getWorkspaceLabel(o.workspace,{verbose:2}),l=!0):(d=o.fileUri,r=pr(e,t,d,Oe.FILE),n={fileUri:d},a=o.label||i.getUriLabel(d));const{name:p,parentPath:g}=mb(a);return{iconClasses:r,label:p,ariaLabel:s?l?u("recentDirtyWorkspaceAriaLabel","{0}, workspace with unsaved changes",p):u("recentDirtyFolderAriaLabel","{0}, folder with unsaved changes",p):p,description:g,buttons:s?[l?this.dirtyRecentlyOpenedWorkspace:this.dirtyRecentlyOpenedFolder]:[this.removeFromRecentlyOpened],openable:n,resource:d,remoteAuthority:o.remoteAuthority}}}class Qn extends Qw{constructor(){super({id:Qn.ID,title:{value:u("openRecent","Open Recent..."),mnemonicTitle:u({key:"miMore",comment:["&& denotes a mnemonic"]},"&&More..."),original:"Open Recent..."},category:fe.File,f1:!0,keybinding:{weight:200,primary:2096,mac:{primary:304}},menu:{id:S.MenubarRecentMenu,group:"y_more",order:1}})}isQuickNavigate(){return!1}}Qn.ID="workbench.action.openRecent";class od extends ye{constructor(){super({id:od.ID,title:{value:u("reloadWindow","Reload Window"),original:"Reload Window"},category:fe.Developer,f1:!0,keybinding:{weight:200+50,when:fb,primary:2096}})}run(e){return e.get(ti).reload()}}od.ID="workbench.action.reloadWindow";const Pu=v.and(Ww,v.has(Mu)),hh="workbench.action.quickOpenNavigateNextInRecentFilesPicker";k.registerCommandAndKeybindingRule({id:hh,weight:200+50,handler:Du(hh,!0),when:Pu,primary:2096,mac:{primary:304}});const lh="workbench.action.quickOpenNavigatePreviousInRecentFilesPicker";k.registerCommandAndKeybindingRule({id:lh,weight:200+50,handler:Du(lh,!1),when:Pu,primary:3120,mac:{primary:1328}});Le.registerCommand("workbench.action.toggleConfirmBeforeClose",c=>{const e=c.get(O),t=e.inspect("window.confirmBeforeClose").userValue;return e.updateValue("window.confirmBeforeClose",t==="never"?"keyboardOnly":"never")});R.appendMenuItem(S.MenubarMainMenu,{submenu:S.MenubarFileMenu,title:{value:"File",original:"File",mnemonicTitle:u({key:"mFile",comment:["&& denotes a mnemonic"]},"&&File")},order:1});R.appendMenuItem(S.MenubarMainMenu,{submenu:S.MenubarEditMenu,title:{value:"Edit",original:"Edit",mnemonicTitle:u({key:"mEdit",comment:["&& denotes a mnemonic"]},"&&Edit")},order:2});R.appendMenuItem(S.MenubarMainMenu,{submenu:S.MenubarSelectionMenu,title:{value:"Selection",original:"Selection",mnemonicTitle:u({key:"mSelection",comment:["&& denotes a mnemonic"]},"&&Selection")},order:3});R.appendMenuItem(S.MenubarMainMenu,{submenu:S.MenubarViewMenu,title:{value:"View",original:"View",mnemonicTitle:u({key:"mView",comment:["&& denotes a mnemonic"]},"&&View")},order:4});R.appendMenuItem(S.MenubarMainMenu,{submenu:S.MenubarGoMenu,title:{value:"Go",original:"Go",mnemonicTitle:u({key:"mGoto",comment:["&& denotes a mnemonic"]},"&&Go")},order:5});R.appendMenuItem(S.MenubarMainMenu,{submenu:S.MenubarTerminalMenu,title:{value:"Terminal",original:"Terminal",mnemonicTitle:u({key:"mTerminal",comment:["&& denotes a mnemonic"]},"&&Terminal")},order:7});R.appendMenuItem(S.MenubarMainMenu,{submenu:S.MenubarHelpMenu,title:{value:"Help",original:"Help",mnemonicTitle:u({key:"mHelp",comment:["&& denotes a mnemonic"]},"&&Help")},order:8});R.appendMenuItem(S.MenubarMainMenu,{submenu:S.MenubarPreferencesMenu,title:{value:"Preferences",original:"Preferences",mnemonicTitle:u({key:"mPreferences",comment:["&& denotes a mnemonic"]},"Preferences")},when:bb,order:9});class ns extends V{constructor(e,t,i,o,s,n,r,a,d,l,p,g,f,b){super(),this.menuService=e,this.workspacesService=t,this.contextKeyService=i,this.keybindingService=o,this.configurationService=s,this.labelService=n,this.updateService=r,this.storageService=a,this.notificationService=d,this.preferencesService=l,this.environmentService=p,this.accessibilityService=g,this.hostService=f,this.commandService=b,this.keys=["window.menuBarVisibility","window.enableMenuBarMnemonics","window.customMenuBarAltFocus","workbench.sideBar.location","window.nativeTabs"],this.menus={},this.topLevelTitles={},this.recentlyOpened={files:[],workspaces:[]},this.mainMenu=this._register(this.menuService.createMenu(S.MenubarMainMenu,this.contextKeyService)),this.mainMenuDisposables=this._register(new x),this.setupMainMenu(),this.menuUpdater=this._register(new Ds(()=>this.doUpdateMenubar(!1),200)),this.notifyUserOfCustomMenubarAccessibility()}registerListeners(){this._register(this.hostService.onDidChangeFocus(e=>this.onDidChangeWindowFocus(e))),this._register(this.configurationService.onDidChangeConfiguration(e=>this.onConfigurationUpdated(e))),this.updateService.onStateChange(()=>this.onUpdateStateChange()),this._register(this.workspacesService.onDidChangeRecentlyOpened(()=>{this.onDidChangeRecentlyOpened()})),this._register(this.keybindingService.onDidUpdateKeybindings(()=>this.updateMenubar())),this._register(this.labelService.onDidChangeFormatters(()=>{this.onDidChangeRecentlyOpened()})),this._register(this.mainMenu.onDidChange(()=>{this.setupMainMenu(),this.doUpdateMenubar(!0)}))}setupMainMenu(){this.mainMenuDisposables.clear(),this.menus={},this.topLevelTitles={};const[,e]=this.mainMenu.getActions()[0];for(const t of e)t instanceof Fr&&typeof t.item.title!="string"&&(this.menus[t.item.title.original]=this.mainMenuDisposables.add(this.menuService.createMenu(t.item.submenu,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.topLevelTitles[t.item.title.original]=t.item.title.mnemonicTitle??t.item.title.value)}updateMenubar(){this.menuUpdater.schedule()}calculateActionLabel(e){return e.label}onUpdateStateChange(){this.updateMenubar()}onUpdateKeybindings(){this.updateMenubar()}getOpenRecentActions(){if(!this.recentlyOpened)return[];const{workspaces:e,files:t}=this.recentlyOpened,i=[];if(e.length>0){for(let o=0;o<ns.MAX_MENU_RECENT_ENTRIES&&o<e.length;o++)i.push(this.createOpenRecentMenuAction(e[o]));i.push(new Pe)}if(t.length>0){for(let o=0;o<ns.MAX_MENU_RECENT_ENTRIES&&o<t.length;o++)i.push(this.createOpenRecentMenuAction(t[o]));i.push(new Pe)}return i}onDidChangeWindowFocus(e){e&&this.onDidChangeRecentlyOpened()}onConfigurationUpdated(e){this.keys.some(t=>e.affectsConfiguration(t))&&this.updateMenubar(),e.affectsConfiguration("editor.accessibilitySupport")&&this.notifyUserOfCustomMenubarAccessibility(),e.affectsConfiguration("window.menuBarVisibility")&&this.onDidChangeRecentlyOpened()}get menubarHidden(){return De&&Fc?!1:qo(this.configurationService)==="hidden"}onDidChangeRecentlyOpened(){this.menubarHidden||this.workspacesService.getRecentlyOpened().then(e=>{this.recentlyOpened=e,this.updateMenubar()})}createOpenRecentMenuAction(e){let t,i,o,s;const n=e.remoteAuthority;Us(e)?(i=e.folderUri,t=e.label||this.labelService.getWorkspaceLabel(i,{verbose:2}),o="openRecentFolder",s={folderUri:i}):kr(e)?(i=e.workspace.configPath,t=e.label||this.labelService.getWorkspaceLabel(e.workspace,{verbose:2}),o="openRecentWorkspace",s={workspaceUri:i}):(i=e.fileUri,t=e.label||this.labelService.getUriLabel(i),o="openRecentFile",s={fileUri:i});const r=new Z(o,vb(t),void 0,void 0,a=>{const d=a,l=a&&(!De&&(d.ctrlKey||d.shiftKey)||De&&(d.metaKey||d.altKey));return this.hostService.openWindow([s],{forceNewWindow:!!l,remoteAuthority:n||null})});return Object.assign(r,{uri:i,remoteAuthority:n})}notifyUserOfCustomMenubarAccessibility(){if(pt||De)return;const e=this.storageService.getBoolean("menubar/accessibleMenubarNotified",-1,!1),t=Bw(this.configurationService)==="custom";if(e||t||!this.accessibilityService.isScreenReaderOptimized())return;const i=u("menubar.customTitlebarAccessibilityNotification","Accessibility support is enabled for you. For the most accessible experience, we recommend the custom title bar style.");this.notificationService.prompt(Fi.Info,i,[{label:u("goToSetting","Open Settings"),run:()=>this.preferencesService.openUserSettings({query:"window.titleBarStyle"})}]),this.storageService.store("menubar/accessibleMenubarNotified",!0,-1,0)}}ns.MAX_MENU_RECENT_ENTRIES=10;let ia=class extends ns{constructor(e,t,i,o,s,n,r,a,d,l,p,g,f,b,m,y){super(e,t,i,o,s,n,r,a,d,l,p,g,m,y),this.layoutService=f,this.telemetryService=b,this.alwaysOnMnemonics=!1,this.focusInsideMenubar=!1,this.pendingFirstTimeUpdate=!1,this.visible=!0,this.webNavigationMenu=this._register(this.menuService.createMenu(S.MenubarHomeMenu,this.contextKeyService)),this.reinstallDisposables=this._register(new x),this._onVisibilityChange=this._register(new w),this._onFocusStateChange=this._register(new w),this.actionRunner=this._register(new Kn),this.actionRunner.onDidRun(D=>{this.telemetryService.publicLog2("workbenchActionExecuted",{id:D.action.id,from:"menu"})}),this.workspacesService.getRecentlyOpened().then(D=>{this.recentlyOpened=D}),this.registerListeners(),this.registerActions()}doUpdateMenubar(e){this.focusInsideMenubar||this.setupCustomMenubar(e),e&&(this.pendingFirstTimeUpdate=!0)}registerActions(){const e=this;pt&&this._register(j(class extends ye{constructor(){super({id:"workbench.actions.menubar.focus",title:{value:u("focusMenu","Focus Application Menu"),original:"Focus Application Menu"},keybinding:{primary:68,weight:200,when:Wo},f1:!0})}async run(){var t;(t=e.menubar)==null||t.toggleFocus()}}))}getUpdateAction(){switch(this.updateService.state.type){case"uninitialized":return null;case"idle":return new Z("update.check",u({key:"checkForUpdates",comment:["&& denotes a mnemonic"]},"Check for &&Updates..."),void 0,!0,()=>this.updateService.checkForUpdates(!0));case"checking for updates":return new Z("update.checking",u("checkingForUpdates","Checking for Updates..."),void 0,!1);case"available for download":return new Z("update.downloadNow",u({key:"download now",comment:["&& denotes a mnemonic"]},"D&&ownload Update"),void 0,!0,()=>this.updateService.downloadUpdate());case"downloading":return new Z("update.downloading",u("DownloadingUpdate","Downloading Update..."),void 0,!1);case"downloaded":return new Z("update.install",u({key:"installUpdate...",comment:["&& denotes a mnemonic"]},"Install &&Update..."),void 0,!0,()=>this.updateService.applyUpdate());case"updating":return new Z("update.updating",u("installingUpdate","Installing Update..."),void 0,!1);case"ready":return new Z("update.restart",u({key:"restartToUpdate",comment:["&& denotes a mnemonic"]},"Restart to &&Update"),void 0,!0,()=>this.updateService.quitAndInstall())}}get currentMenubarVisibility(){return qo(this.configurationService)}get currentDisableMenuBarAltFocus(){const e=this.configurationService.getValue("window.customMenuBarAltFocus");let t=!1;return typeof e=="boolean"&&(t=!e),t}insertActionsBefore(e,t){switch(e.id){case Qn.ID:t.push(...this.getOpenRecentActions());break;case"workbench.action.showAboutDialog":if(!De&&!pt){const i=this.getUpdateAction();i&&(i.label=ci(i.label),t.push(i),t.push(new Pe))}break}}get currentEnableMenuBarMnemonics(){let e=this.configurationService.getValue("window.enableMenuBarMnemonics");return typeof e!="boolean"&&(e=!0),e&&(!pt||Ll())}get currentCompactMenuMode(){return this.currentMenubarVisibility!=="compact"?void 0:this.configurationService.getValue("workbench.sideBar.location")==="right"?Ii.Left:Ii.Right}onDidVisibilityChange(e){this.visible=e,this.onDidChangeRecentlyOpened(),this._onVisibilityChange.fire(e)}toActionsArray(e){const t=[];return en(e,{shouldForwardArgs:!0},t),t}setupCustomMenubar(e){var i;if(!this.container)return;e?(this.menubar&&this.reinstallDisposables.clear(),this.menubar=this.reinstallDisposables.add(new ue(this.container,this.getMenuBarOptions(),wb)),this.accessibilityService.alwaysUnderlineAccessKeys().then(o=>{var s;this.alwaysOnMnemonics=o,(s=this.menubar)==null||s.update(this.getMenuBarOptions())}),this.reinstallDisposables.add(this.menubar.onFocusStateChange(o=>{this._onFocusStateChange.fire(o),o||(this.pendingFirstTimeUpdate?(this.setupCustomMenubar(!0),this.pendingFirstTimeUpdate=!1):this.updateMenubar(),this.focusInsideMenubar=!1)})),this.reinstallDisposables.add(this.menubar.onVisibilityChange(o=>this.onDidVisibilityChange(o))),this.reinstallDisposables.add(_(this.container,E.FOCUS_IN,()=>{this.focusInsideMenubar=!0})),this.reinstallDisposables.add(_(this.container,E.FOCUS_OUT,()=>{this.focusInsideMenubar=!1})),this.menubar.isVisible&&this.onDidVisibilityChange(!0)):(i=this.menubar)==null||i.update(this.getMenuBarOptions());const t=(o,s,n)=>{s.splice(0);for(const r of o)if(this.insertActionsBefore(r,s),r instanceof Pe)s.push(r);else if(r instanceof Fr||r instanceof Wd){let a=typeof r.item.title=="string"?r.item.title:r.item.title.mnemonicTitle??r.item.title.value;if(r instanceof Fr){const d=[];t(r.actions,d,n),d.length>0&&s.push(new uo(r.id,ci(a),d))}else{Sb(r.item.toggled)&&(a=r.item.toggled.mnemonicTitle??r.item.toggled.title??a);const d=new Z(r.id,ci(a),r.class,r.enabled,()=>this.commandService.executeCommand(r.id));d.tooltip=r.tooltip,d.checked=r.checked,s.push(d)}}if(n==="File"&&this.currentCompactMenuMode===void 0){const r=this.getWebNavigationActions();r.length&&s.push(...r)}};for(const o of Object.keys(this.topLevelTitles)){const s=this.menus[o];e&&s&&(this.reinstallDisposables.add(s.onDidChange(()=>{var r;if(!this.focusInsideMenubar){const a=[];t(this.toActionsArray(s),a,o),(r=this.menubar)==null||r.updateMenu({actions:a,label:ci(this.topLevelTitles[o])})}})),s===this.menus.File&&this.reinstallDisposables.add(this.webNavigationMenu.onDidChange(()=>{var r;if(!this.focusInsideMenubar){const a=[];t(this.toActionsArray(s),a,o),(r=this.menubar)==null||r.updateMenu({actions:a,label:ci(this.topLevelTitles[o])})}})));const n=[];s&&t(this.toActionsArray(s),n,o),this.menubar&&(e?this.menubar.push({actions:n,label:ci(this.topLevelTitles[o])}):this.menubar.updateMenu({actions:n,label:ci(this.topLevelTitles[o])}))}}getWebNavigationActions(){if(!pt)return[];const e=[];for(const t of this.webNavigationMenu.getActions()){const[,i]=t;for(const o of i)if(o instanceof Wd){const s=typeof o.item.title=="string"?o.item.title:o.item.title.mnemonicTitle??o.item.title.value;e.push(new Z(o.id,ci(s),o.class,o.enabled,async n=>{this.commandService.executeCommand(o.id,n)}))}e.push(new Pe)}return e.length&&e.pop(),e}getMenuBarOptions(){return{enableMnemonics:this.currentEnableMenuBarMnemonics,disableAltFocus:this.currentDisableMenuBarAltFocus,visibility:this.currentMenubarVisibility,actionRunner:this.actionRunner,getKeybinding:e=>this.keybindingService.lookupKeybinding(e.id),alwaysOnMnemonics:this.alwaysOnMnemonics,compactMode:this.currentCompactMenuMode,getCompactMenuActions:()=>pt?this.getWebNavigationActions():[]}}onDidChangeWindowFocus(e){var t;this.visible&&(super.onDidChangeWindowFocus(e),this.container&&(e?this.container.classList.remove("inactive"):(this.container.classList.add("inactive"),(t=this.menubar)==null||t.blur())))}onUpdateStateChange(){this.visible&&super.onUpdateStateChange()}onDidChangeRecentlyOpened(){this.visible&&super.onDidChangeRecentlyOpened()}onUpdateKeybindings(){this.visible&&super.onUpdateKeybindings()}registerListeners(){super.registerListeners(),this._register(_(window,E.RESIZE,()=>{this.menubar&&!(yb&&Cb.pointerEvents)&&this.menubar.blur()})),pt&&(this._register(this.layoutService.onDidChangeFullscreen(e=>this.updateMenubar())),this._register(this.webNavigationMenu.onDidChange(()=>this.updateMenubar())))}get onVisibilityChange(){return this._onVisibilityChange.event}get onFocusStateChange(){return this._onFocusStateChange.event}getMenubarItemsDimensions(){return this.menubar?new q(this.menubar.getWidth(),this.menubar.getHeight()):new q(0,0)}create(e){return this.container=e,this.container&&this.doUpdateMenubar(!0),this.container}layout(e){var t;(t=this.menubar)==null||t.update(this.getMenuBarOptions())}toggleFocus(){var e;(e=this.menubar)==null||e.toggleFocus()}};ia=C([h(0,rt),h(1,lc),h(2,G),h(3,ve),h(4,O),h(5,Ft),h(6,sg),h(7,oe),h(8,Ae),h(9,pc),h(10,Lt),h(11,Nl),h(12,st),h(13,Ne),h(14,ti),h(15,Io)],ia);let Qt=class Be extends Zn{constructor(e,t,i,o,s,n,r,a,d,l){super("workbench.parts.activitybar",{hasTitle:!1},o,s,i),this.paneCompositePart=e,this.instantiationService=t,this.storageService=s,this.extensionService=n,this.viewDescriptorService=r,this.contextKeyService=a,this.configurationService=d,this.environmentService=l,this.minimumWidth=48,this.maximumWidth=48,this.minimumHeight=0,this.maximumHeight=Number.POSITIVE_INFINITY,this.globalActivity=[],this.accountsActivity=[],this.compositeActions=new Map,this.viewContainerDisposables=new Map,this.keyboardNavigationDisposables=this._register(new x),this.location=0,this.hasExtensionsRegistered=!1,this.enabledViewContainersContextKeys=new Map,this._cachedViewContainers=void 0;for(const p of this.cachedViewContainers)p.visible=!this.shouldBeHidden(p.id,p);this.compositeBar=this.createCompositeBar(),this.onDidRegisterViewContainers(this.getViewContainers()),this.registerListeners()}createCompositeBar(){const e=this.cachedViewContainers.map(t=>({id:t.id,name:t.name,visible:t.visible,order:t.order,pinned:t.pinned}));return this._register(this.instantiationService.createInstance(cn,e,{icon:!0,orientation:1,activityHoverOptions:this.getActivityHoverOptions(),preventLoopNavigation:!0,openComposite:async(t,i)=>await this.paneCompositePart.openPaneComposite(t,!i)??null,getActivityAction:t=>this.getCompositeActions(t).activityAction,getCompositePinnedAction:t=>this.getCompositeActions(t).pinnedAction,getCompositeBadgeAction:t=>this.getCompositeActions(t).badgeAction,getOnCompositeClickAction:t=>Ee({id:t,label:"",run:async()=>{var i;return((i=this.paneCompositePart.getActivePaneComposite())==null?void 0:i.getId())===t?this.paneCompositePart.hideActivePaneComposite():this.paneCompositePart.openPaneComposite(t)}}),fillExtraContextMenuActions:(t,i)=>{const o=qo(this.configurationService);(o==="compact"||o==="hidden"||o==="toggle")&&t.unshift(Ee({id:"toggleMenuVisibility",label:u("menu","Menu"),checked:o==="compact",run:()=>this.configurationService.updateValue("window.menuBarVisibility",o==="compact"?"toggle":"compact")}),new Pe),o==="compact"&&this.menuBarContainer&&(i!=null&&i.target)&&Tt(i.target,this.menuBarContainer)&&t.unshift(Ee({id:"hideCompactMenu",label:u("hideMenu","Hide Menu"),run:()=>this.configurationService.updateValue("window.menuBarVisibility","toggle")}),new Pe),t.push(new Pe),t.push(Ee({id:"toggleAccountsVisibility",label:u("accounts","Accounts"),checked:this.accountsVisibilityPreference,run:()=>this.accountsVisibilityPreference=!this.accountsVisibilityPreference})),t.push(new Pe),t.push(Ee({id:vr.ID,label:vr.getLabel(this.layoutService),run:()=>this.instantiationService.invokeFunction(s=>new vr().run(s))})),t.push(Ee({id:ih.ID,label:u("hideActivitBar","Hide Activity Bar"),run:()=>this.instantiationService.invokeFunction(s=>new ih().run(s))}))},getContextMenuActionsForComposite:t=>this.getContextMenuActionsForComposite(t),getDefaultCompositeId:()=>{var t;return(t=this.viewDescriptorService.getDefaultViewContainer(this.location))==null?void 0:t.id},hidePart:()=>this.layoutService.setPartHidden(!0,"workbench.parts.sidebar"),dndHandler:new Lu(this.viewDescriptorService,0,async(t,i)=>await this.paneCompositePart.openPaneComposite(t,i)??null,(t,i,o)=>this.compositeBar.move(t,i,o==null?void 0:o.verticallyBefore),()=>this.compositeBar.getCompositeBarItems()),compositeSize:52,colors:t=>this.getActivitybarItemColors(t),overflowActionSize:Be.ACTION_HEIGHT}))}getActivityHoverOptions(){return{position:()=>this.layoutService.getSideBarPosition()===0?1:0}}getContextMenuActionsForComposite(e){const t=[],i=this.viewDescriptorService.getViewContainerById(e),o=this.viewDescriptorService.getDefaultViewContainerLocation(i);if(o!==this.viewDescriptorService.getViewContainerLocation(i))t.push(Ee({id:"resetLocationAction",label:u("resetLocation","Reset Location"),run:()=>this.viewDescriptorService.moveViewContainerToLocation(i,o)}));else{const s=this.viewDescriptorService.getViewContainerModel(i);if(s.allViewDescriptors.length===1){const n=s.allViewDescriptors[0],r=this.viewDescriptorService.getDefaultContainerById(n.id);r!==i&&t.push(Ee({id:"resetLocationAction",label:u("resetLocation","Reset Location"),run:()=>this.viewDescriptorService.moveViewsToContainer([n],r)}))}}return t}registerListeners(){this._register(this.viewDescriptorService.onDidChangeViewContainers(({added:t,removed:i})=>this.onDidChangeViewContainers(t,i))),this._register(this.viewDescriptorService.onDidChangeContainerLocation(({viewContainer:t,from:i,to:o})=>this.onDidChangeViewContainerLocation(t,i,o))),this.paneCompositePart.onDidPaneCompositeOpen(t=>this.onDidChangeViewContainerVisibility(t.getId(),!0)),this.paneCompositePart.onDidPaneCompositeClose(t=>this.onDidChangeViewContainerVisibility(t.getId(),!1));const e=this._register(new x);this._register(this.extensionService.onDidRegisterExtensions(()=>{e.clear(),this.onDidRegisterExtensions(),this.compositeBar.onDidChange(()=>this.saveCachedViewContainers(),this,e),this.storageService.onDidChangeValue(t=>this.onDidStorageValueChange(t),this,e)})),this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration("window.menuBarVisibility")&&(qo(this.configurationService)==="compact"?this.installMenubar():this.uninstallMenubar())}))}onDidChangeViewContainers(e,t){t.filter(({location:i})=>i===0).forEach(({container:i})=>this.onDidDeregisterViewContainer(i)),this.onDidRegisterViewContainers(e.filter(({location:i})=>i===0).map(({container:i})=>i))}onDidChangeViewContainerLocation(e,t,i){t===this.location&&this.onDidDeregisterViewContainer(e),i===this.location&&this.onDidRegisterViewContainers([e])}onDidChangeViewContainerVisibility(e,t){t?this.onDidViewContainerVisible(e):this.compositeBar.deactivateComposite(e)}onDidRegisterExtensions(){this.hasExtensionsRegistered=!0;for(const{id:e}of this.cachedViewContainers){const t=this.getViewContainer(e);t?this.showOrHideViewContainer(t):this.viewDescriptorService.isViewContainerRemovedPermanently(e)?this.removeComposite(e):this.hideComposite(e)}this.saveCachedViewContainers()}onDidViewContainerVisible(e){const t=this.getViewContainer(e);t&&(this.addComposite(t),this.compositeBar.activateComposite(t.id),this.shouldBeHidden(t)&&this.viewDescriptorService.getViewContainerModel(t).activeViewDescriptors.length===0&&this.hideComposite(t.id))}showActivity(e,t,i,o){return this.getViewContainer(e)?this.compositeBar.showActivity(e,t,i,o):e===Di?this.showGlobalActivity(Di,t,i,o):e===Ys?this.showGlobalActivity(Ys,t,i,o):V.None}showGlobalActivity(e,t,i,o){typeof o!="number"&&(o=0);const s={badge:t,clazz:i,priority:o},n=e===Di?this.globalActivity:this.accountsActivity;for(let r=0;r<=n.length;r++)if(r===n.length){n.push(s);break}else if(n[r].priority<=o){n.splice(r,0,s);break}return this.updateGlobalActivity(e),Y(()=>this.removeGlobalActivity(e,s))}removeGlobalActivity(e,t){const i=e===Di?this.globalActivity:this.accountsActivity,o=i.indexOf(t);o!==-1&&(i.splice(o,1),this.updateGlobalActivity(e))}updateGlobalActivity(e){const t=e===Di?this.globalActivityAction:this.accountsActivityAction;if(!t)return;const i=e===Di?this.globalActivity:this.accountsActivity;if(i.length){const[{badge:o,clazz:s,priority:n}]=i;if(o instanceof to&&i.length>1){const r=this.getCumulativeNumberBadge(i,n);t.setBadge(r)}else t.setBadge(o,s)}else t.setBadge(void 0)}getCumulativeNumberBadge(e,t){const i=e.filter(n=>n.badge instanceof to&&n.priority===t),o=i.reduce((n,r)=>n+r.badge.number,0),s=()=>i.reduce((n,r,a)=>(n=n+r.badge.getDescription(),a<i.length-1&&(n=`${n}
`),n),"");return new to(o,s)}uninstallMenubar(){this.menuBar&&(this.menuBar.dispose(),this.menuBar=void 0),this.menuBarContainer&&(this.menuBarContainer.remove(),this.menuBarContainer=void 0,this.registerKeyboardNavigationListeners())}installMenubar(){if(this.menuBar)return;this.menuBarContainer=document.createElement("div"),this.menuBarContainer.classList.add("menubar"),K(this.content).prepend(this.menuBarContainer),this.menuBar=this._register(this.instantiationService.createInstance(ia)),this.menuBar.create(this.menuBarContainer),this.registerKeyboardNavigationListeners()}createContentArea(e){return this.element=e,this.content=document.createElement("div"),this.content.classList.add("content"),e.appendChild(this.content),qo(this.configurationService)==="compact"&&this.installMenubar(),this.compositeBarContainer=this.compositeBar.create(this.content),this.globalActivitiesContainer=document.createElement("div"),this.content.appendChild(this.globalActivitiesContainer),this.registerKeyboardNavigationListeners(),this.content}registerKeyboardNavigationListeners(){this.keyboardNavigationDisposables.clear(),this.menuBarContainer&&this.keyboardNavigationDisposables.add(_(this.menuBarContainer,E.KEY_DOWN,e=>{var i;const t=new mt(e);(t.equals(18)||t.equals(17))&&((i=this.compositeBar)==null||i.focus())})),this.compositeBarContainer&&this.keyboardNavigationDisposables.add(_(this.compositeBarContainer,E.KEY_DOWN,e=>{var i,o;const t=new mt(e);t.equals(18)||t.equals(17)?(i=this.globalActivityActionBar)==null||i.focus(!0):(t.equals(16)||t.equals(15))&&((o=this.menuBar)==null||o.toggleFocus())})),this.globalActivitiesContainer&&this.keyboardNavigationDisposables.add(_(this.globalActivitiesContainer,E.KEY_DOWN,e=>{var i;const t=new mt(e);(t.equals(16)||t.equals(15))&&((i=this.compositeBar)==null||i.focus(this.getVisiblePaneCompositeIds().length-1))}))}createGlobalActivityActionBar(e){this.globalActivityActionBar=this._register(new xo(e,{actionViewItemProvider:t=>{if(t.id==="workbench.actions.manage")return this.instantiationService.createInstance(ta,t,()=>this.compositeBar.getContextMenuActions(),i=>this.getActivitybarItemColors(i),this.getActivityHoverOptions());if(t.id==="workbench.actions.accounts")return this.instantiationService.createInstance(Vi,t,()=>this.compositeBar.getContextMenuActions(),i=>this.getActivitybarItemColors(i),this.getActivityHoverOptions());throw new Error(`No view item for action '${t.id}'`)},orientation:1,ariaLabel:u("manage","Manage"),animated:!1,preventLoopNavigation:!0})),this.globalActivityAction=this._register(new js({id:"workbench.actions.manage",name:u("manage","Manage"),classNames:ge.asClassNameArray(Be.GEAR_ICON)})),this.accountsVisibilityPreference&&(this.accountsActivityAction=this._register(new js({id:"workbench.actions.accounts",name:u("accounts","Accounts"),classNames:ge.asClassNameArray(Be.ACCOUNTS_ICON)})),this.globalActivityActionBar.push(this.accountsActivityAction,{index:Be.ACCOUNTS_ACTION_INDEX})),this.globalActivityActionBar.push(this.globalActivityAction)}toggleAccountsActivity(){!!this.accountsActivityAction!==this.accountsVisibilityPreference&&(this.globalActivityActionBar&&(this.accountsActivityAction?(this.globalActivityActionBar.pull(Be.ACCOUNTS_ACTION_INDEX),this.accountsActivityAction=void 0):(this.accountsActivityAction=this._register(new js({id:"workbench.actions.accounts",name:u("accounts","Accounts"),classNames:ge.asClassNameArray(le.account)})),this.globalActivityActionBar.push(this.accountsActivityAction,{index:Be.ACCOUNTS_ACTION_INDEX}))),this.updateGlobalActivity(Ys))}getCompositeActions(e){let t=this.compositeActions.get(e);if(!t){const i=this.getViewContainer(e);if(i){const o=this.viewDescriptorService.getViewContainerModel(i);t={activityAction:this.instantiationService.createInstance(ss,this.toActivity(o),this.paneCompositePart),pinnedAction:new Qc(this.toActivity(o),this.compositeBar),badgeAction:new ed(this.toActivity(o),this.compositeBar)}}else{const o=this.cachedViewContainers.filter(s=>s.id===e)[0];t={activityAction:this.instantiationService.createInstance(jw,Be.toActivity(e,e,o==null?void 0:o.icon,void 0),this.paneCompositePart),pinnedAction:new ch(e,this.compositeBar),badgeAction:new Ou(e,this.compositeBar)}}this.compositeActions.set(e,t)}return t}onDidRegisterViewContainers(e){for(const t of e){this.addComposite(t),this.cachedViewContainers.filter(({id:r})=>r===t.id)[0]||this.compositeBar.pin(t.id);const o=this.paneCompositePart.getActivePaneComposite();(o==null?void 0:o.getId())===t.id&&this.compositeBar.activateComposite(t.id);const s=this.viewDescriptorService.getViewContainerModel(t);this.updateActivity(t,s),this.showOrHideViewContainer(t);const n=new x;n.add(s.onDidChangeContainerInfo(()=>this.updateActivity(t,s))),n.add(s.onDidChangeActiveViewDescriptors(()=>this.showOrHideViewContainer(t))),this.viewContainerDisposables.set(t.id,n)}}onDidDeregisterViewContainer(e){const t=this.viewContainerDisposables.get(e.id);t==null||t.dispose(),this.viewContainerDisposables.delete(e.id),this.removeComposite(e.id)}updateActivity(e,t){const i=this.toActivity(t),{activityAction:o,pinnedAction:s}=this.getCompositeActions(e.id);o.updateActivity(i),s instanceof ch&&s.setActivity(i),this.saveCachedViewContainers()}toActivity(e){return Be.toActivity(e.viewContainer.id,e.title,e.icon,e.keybindingId)}static toActivity(e,t,i,o){let s,n;if(T.isUri(i)){n=i;const r=Nc(i),a=new Bl;a.update(r);const d=`activity-${e.replace(/\./g,"-")}-${a.digest()}`,l=`.monaco-workbench .activitybar .monaco-action-bar .action-label.${d}`;s=[d,"uri-icon"],Wl(l,`
				mask: ${r} no-repeat 50% 50%;
				mask-size: 24px;
				-webkit-mask: ${r} no-repeat 50% 50%;
				-webkit-mask-size: 24px;
			`)}else ge.isThemeIcon(i)&&(s=ge.asClassNameArray(i));return{id:e,name:t,classNames:s,iconUrl:n,keybindingId:o}}showOrHideViewContainer(e){let t=this.enabledViewContainersContextKeys.get(e.id);t||(t=this.contextKeyService.createKey(Ih(e.id),!1),this.enabledViewContainersContextKeys.set(e.id,t)),this.shouldBeHidden(e)?(t.set(!1),this.hideComposite(e.id)):(t.set(!0),this.addComposite(e))}shouldBeHidden(e,t){var s;const i=es(e)?this.getViewContainer(e):e,o=es(e)?e:e.id;if(i)if(i.hideIfEmpty){if(this.viewDescriptorService.getViewContainerModel(i).activeViewDescriptors.length>0)return!1}else return!1;if(!this.hasExtensionsRegistered&&!(this.environmentService.remoteAuthority&&Fc)){if(t=t||this.cachedViewContainers.find(({id:n})=>n===o),!i&&(t!=null&&t.isBuiltin)&&(t!=null&&t.visible))return!1;if((s=t==null?void 0:t.views)!=null&&s.length)return t.views.every(({when:n})=>!!n&&!this.contextKeyService.contextMatchesRules(v.deserialize(n)))}return!0}addComposite(e){this.compositeBar.addComposite({id:e.id,name:typeof e.title=="string"?e.title:e.title.value,order:e.order,requestedIndex:e.requestedIndex})}hideComposite(e){this.compositeBar.hideComposite(e);const t=this.compositeActions.get(e);t&&(t.activityAction.dispose(),t.pinnedAction.dispose(),this.compositeActions.delete(e))}removeComposite(e){this.compositeBar.removeComposite(e);const t=this.compositeActions.get(e);t&&(t.activityAction.dispose(),t.pinnedAction.dispose(),this.compositeActions.delete(e))}getPinnedPaneCompositeIds(){const e=this.compositeBar.getPinnedComposites().map(t=>t.id);return this.getViewContainers().filter(t=>this.compositeBar.isPinned(t.id)).sort((t,i)=>e.indexOf(t.id)-e.indexOf(i.id)).map(t=>t.id)}getVisiblePaneCompositeIds(){return this.compositeBar.getVisibleComposites().filter(e=>{var t;return((t=this.paneCompositePart.getActivePaneComposite())==null?void 0:t.getId())===e.id||this.compositeBar.isPinned(e.id)}).map(e=>e.id)}focus(){this.compositeBar.focus()}updateStyles(){super.updateStyles();const e=K(this.getContainer()),t=this.getColor(ng)||"";e.style.backgroundColor=t;const i=this.getColor(rg)||this.getColor(Ze)||"";e.classList.toggle("bordered",!!i),e.style.borderColor=i||""}getActivitybarItemColors(e){return{activeForegroundColor:e.getColor(ag),inactiveForegroundColor:e.getColor(cg),activeBorderColor:e.getColor(Dh),activeBackground:e.getColor(kh),badgeBackground:e.getColor(dg),badgeForeground:e.getColor(hg),dragAndDropBorder:e.getColor(lg),activeBackgroundColor:void 0,inactiveBackgroundColor:void 0,activeBorderBottomColor:void 0}}layout(e,t){if(!this.layoutService.isVisible("workbench.parts.activitybar"))return;let o=super.layoutContents(e,t).contentSize.height;this.menuBarContainer&&(o-=this.menuBarContainer.clientHeight),this.globalActivityActionBar&&(o-=this.globalActivityActionBar.viewItems.length*Be.ACTION_HEIGHT),this.compositeBar.layout(new q(e,o))}getViewContainer(e){const t=this.viewDescriptorService.getViewContainerById(e);return t&&this.viewDescriptorService.getViewContainerLocation(t)===this.location?t:void 0}getViewContainers(){return this.viewDescriptorService.getViewContainersByLocation(this.location)}onDidStorageValueChange(e){if(e.key===Be.PINNED_VIEW_CONTAINERS&&e.scope===0&&this.pinnedViewContainersValue!==this.getStoredPinnedViewContainersValue()){this._pinnedViewContainersValue=void 0,this._cachedViewContainers=void 0;const t=[],i=this.compositeBar.getCompositeBarItems();for(const o of this.cachedViewContainers)t.push({id:o.id,name:o.name,order:o.order,pinned:o.pinned,visible:!!i.find(({id:s})=>s===o.id)});for(let o=0;o<i.length;o++)if(!t.some(({id:s})=>s===i[o].id)){const s=this.viewDescriptorService.getViewContainerById(i[o].id);t.splice(o,0,{...i[o],pinned:!0,visible:!0,order:s==null?void 0:s.order})}this.compositeBar.setCompositeBarItems(t)}e.key===Vi.ACCOUNTS_VISIBILITY_PREFERENCE_KEY&&e.scope===0&&this.toggleAccountsActivity()}saveCachedViewContainers(){const e=[],t=this.compositeBar.getCompositeBarItems();for(const i of t){const o=this.getViewContainer(i.id);if(o){const s=this.viewDescriptorService.getViewContainerModel(o),n=[];for(const{when:r}of s.allViewDescriptors)n.push({when:r?r.serialize():void 0});e.push({id:i.id,name:s.title,icon:T.isUri(s.icon)&&this.environmentService.remoteAuthority?void 0:s.icon,views:n,pinned:i.pinned,order:i.order,visible:i.visible,isBuiltin:!o.extensionId})}else e.push({id:i.id,pinned:i.pinned,order:i.order,visible:!1,isBuiltin:!1})}this.storeCachedViewContainersState(e)}get cachedViewContainers(){if(this._cachedViewContainers===void 0){this._cachedViewContainers=this.getPinnedViewContainers();for(const e of this.getPlaceholderViewContainers()){const t=this._cachedViewContainers.filter(i=>i.id===e.id)[0];t&&(t.name=e.name,t.icon=e.themeIcon?e.themeIcon:e.iconUrl?T.revive(e.iconUrl):void 0,T.isUri(t.icon)&&this.environmentService.remoteAuthority&&(t.icon=void 0),t.views=e.views,t.isBuiltin=e.isBuiltin)}}return this._cachedViewContainers}storeCachedViewContainersState(e){this.setPinnedViewContainers(e.map(({id:t,pinned:i,visible:o,order:s})=>({id:t,pinned:i,visible:o,order:s}))),this.setPlaceholderViewContainers(e.map(({id:t,icon:i,name:o,views:s,isBuiltin:n})=>({id:t,iconUrl:T.isUri(i)?i:void 0,themeIcon:ge.isThemeIcon(i)?i:void 0,name:o,isBuiltin:n,views:s})))}getPinnedViewContainers(){return JSON.parse(this.pinnedViewContainersValue)}setPinnedViewContainers(e){this.pinnedViewContainersValue=JSON.stringify(e)}get pinnedViewContainersValue(){return this._pinnedViewContainersValue||(this._pinnedViewContainersValue=this.getStoredPinnedViewContainersValue()),this._pinnedViewContainersValue}set pinnedViewContainersValue(e){this.pinnedViewContainersValue!==e&&(this._pinnedViewContainersValue=e,this.setStoredPinnedViewContainersValue(e))}getStoredPinnedViewContainersValue(){return this.storageService.get(Be.PINNED_VIEW_CONTAINERS,0,"[]")}setStoredPinnedViewContainersValue(e){this.storageService.store(Be.PINNED_VIEW_CONTAINERS,e,0,0)}getPlaceholderViewContainers(){return JSON.parse(this.placeholderViewContainersValue)}setPlaceholderViewContainers(e){this.placeholderViewContainersValue=JSON.stringify(e)}get placeholderViewContainersValue(){return this._placeholderViewContainersValue||(this._placeholderViewContainersValue=this.getStoredPlaceholderViewContainersValue()),this._placeholderViewContainersValue}set placeholderViewContainersValue(e){this.placeholderViewContainersValue!==e&&(this._placeholderViewContainersValue=e,this.setStoredPlaceholderViewContainersValue(e))}getStoredPlaceholderViewContainersValue(){return this.storageService.get(Be.PLACEHOLDER_VIEW_CONTAINERS,0,"[]")}setStoredPlaceholderViewContainersValue(e){this.storageService.store(Be.PLACEHOLDER_VIEW_CONTAINERS,e,0,1)}get accountsVisibilityPreference(){return this.storageService.getBoolean(Vi.ACCOUNTS_VISIBILITY_PREFERENCE_KEY,0,!0)}set accountsVisibilityPreference(e){this.storageService.store(Vi.ACCOUNTS_VISIBILITY_PREFERENCE_KEY,e,0,0)}toJSON(){return{type:"workbench.parts.activitybar"}}};Qt.PINNED_VIEW_CONTAINERS="workbench.activity.pinnedViewlets2";Qt.PLACEHOLDER_VIEW_CONTAINERS="workbench.activity.placeholderViewlets";Qt.ACTION_HEIGHT=48;Qt.ACCOUNTS_ACTION_INDEX=0;Qt.GEAR_ICON=Ao("settings-view-bar-icon",le.settingsGear,u("settingsViewBarIcon","Settings icon in the view bar."));Qt.ACCOUNTS_ICON=Ao("accounts-view-bar-icon",le.account,u("accountsViewBarIcon","Accounts icon in the view bar."));Qt=C([h(1,I),h(2,st),h(3,te),h(4,oe),h(5,Ci),h(6,Qe),h(7,G),h(8,O),h(9,Lt)],Qt);var ey='.monaco-workbench .workbench-hover{background:var(--vscode-editorHoverWidget-background);border:1px solid var(--vscode-editorHoverWidget-border);border-radius:3px;box-shadow:0 2px 8px var(--vscode-widget-shadow);color:var(--vscode-editorHoverWidget-foreground);font-size:13px;line-height:19px;max-width:700px;overflow:hidden;position:relative;z-index:40}.monaco-workbench .workbench-hover hr{border-bottom:none}.monaco-workbench .workbench-hover:not(.skip-fade-in){animation:fadein .1s linear}.monaco-workbench .workbench-hover.compact{font-size:12px}.monaco-workbench .workbench-hover.compact .hover-contents{padding:2px 8px}.monaco-workbench .workbench-hover-container.locked .workbench-hover{outline:1px solid var(--vscode-editorHoverWidget-border)}.monaco-workbench .workbench-hover-container.locked .workbench-hover:focus,.monaco-workbench .workbench-hover-lock:focus{outline:1px solid var(--vscode-focusBorder)}.monaco-workbench .workbench-hover-container.locked .workbench-hover-lock:hover{background:var(--vscode-toolbar-hoverBackground)}.monaco-workbench .workbench-hover-pointer{pointer-events:none;position:absolute;z-index:41}.monaco-workbench .workbench-hover-pointer:after{background-color:var(--vscode-editorHoverWidget-background);border-bottom:1px solid var(--vscode-editorHoverWidget-border);border-right:1px solid var(--vscode-editorHoverWidget-border);content:"";height:5px;position:absolute;width:5px}.monaco-workbench .locked .workbench-hover-pointer:after{border-bottom-width:2px;border-right-width:2px;height:4px;width:4px}.monaco-workbench .workbench-hover-pointer.left{left:-3px}.monaco-workbench .workbench-hover-pointer.right{right:3px}.monaco-workbench .workbench-hover-pointer.top{top:-3px}.monaco-workbench .workbench-hover-pointer.bottom{bottom:3px}.monaco-workbench .workbench-hover-pointer.left:after{transform:rotate(135deg)}.monaco-workbench .workbench-hover-pointer.right:after{transform:rotate(315deg)}.monaco-workbench .workbench-hover-pointer.top:after{transform:rotate(225deg)}.monaco-workbench .workbench-hover-pointer.bottom:after{transform:rotate(45deg)}.monaco-workbench .workbench-hover a{color:var(--vscode-textLink-foreground)}.monaco-workbench .workbench-hover a:focus{outline:1px solid;outline-color:var(--vscode-focusBorder);outline-offset:-1px;text-decoration:underline}.monaco-workbench .workbench-hover a:active,.monaco-workbench .workbench-hover a:hover{color:var(--vscode-textLink-activeForeground)}.monaco-workbench .workbench-hover code{background:var(--vscode-textCodeBlock-background)}.monaco-workbench .workbench-hover .hover-row .actions{background:var(--vscode-editorHoverWidget-statusBarBackground)}.monaco-workbench .workbench-hover.right-aligned{left:1px}.monaco-workbench .workbench-hover.right-aligned .hover-row.status-bar .actions{flex-direction:row-reverse}.monaco-workbench .workbench-hover.right-aligned .hover-row.status-bar .actions .action-container{margin-left:16px;margin-right:0}';he(ey,{});const _t=z;let oa=class extends zn{get isDisposed(){return this._isDisposed}get isMouseIn(){return this._lockMouseTracker.isMouseIn}get domNode(){return this._hover.containerDomNode}get onDispose(){return this._onDispose.event}get onRequestLayout(){return this._onRequestLayout.event}get anchor(){return this._hoverPosition===2?0:1}get x(){return this._x}get y(){return this._y}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked!==e&&(this._isLocked=e,this._hoverContainer.classList.toggle("locked",this._isLocked))}constructor(e,t,i,o,s){super(),this._keybindingService=t,this._configurationService=i,this._openerService=o,this._instantiationService=s,this._messageListeners=new x,this._isDisposed=!1,this._forcePosition=!1,this._x=0,this._y=0,this._isLocked=!1,this._enableFocusTraps=!1,this._addedFocusTrap=!1,this._onDispose=this._register(new w),this._onRequestLayout=this._register(new w),this._linkHandler=e.linkHandler||(p=>_b(this._openerService,p,Ho(e.content)?e.content.isTrusted:void 0)),this._target="targetElements"in e.target?e.target:new ty(e.target),this._hoverPointer=e.showPointer?_t("div.workbench-hover-pointer"):void 0,this._hover=this._register(new Eb),this._hover.containerDomNode.classList.add("workbench-hover","fadeIn"),e.compact&&this._hover.containerDomNode.classList.add("workbench-hover","compact"),e.skipFadeInAnimation&&this._hover.containerDomNode.classList.add("skip-fade-in"),e.additionalClasses&&this._hover.containerDomNode.classList.add(...e.additionalClasses),e.forcePosition&&(this._forcePosition=!0),e.trapFocus&&(this._enableFocusTraps=!0),this._hoverPosition=e.hoverPosition??3,this.onmousedown(this._hover.containerDomNode,p=>p.stopPropagation()),this.onkeydown(this._hover.containerDomNode,p=>{p.equals(9)&&this.dispose()}),this._register(_(window,"blur",()=>this.dispose()));const n=_t("div.hover-row.markdown-hover"),r=_t("div.hover-contents");if(typeof e.content=="string")r.textContent=e.content,r.style.whiteSpace="pre-wrap";else if(e.content instanceof HTMLElement)r.appendChild(e.content),r.classList.add("html-hover-contents");else{const p=e.content,g=this._instantiationService.createInstance(Db,{codeBlockFontFamily:this._configurationService.getValue("editor").fontFamily||$s.fontFamily}),{element:f}=g.render(p,{actionHandler:{callback:b=>this._linkHandler(b),disposables:this._messageListeners},asyncRenderCallback:()=>{r.classList.add("code-hover-contents"),this.layout(),this._onRequestLayout.fire()}});r.appendChild(f)}if(n.appendChild(r),this._hover.contentsDomNode.appendChild(n),e.actions&&e.actions.length>0){const p=_t("div.hover-row.status-bar"),g=_t("div.actions");e.actions.forEach(f=>{const b=this._keybindingService.lookupKeybinding(f.commandId),m=b?b.getLabel():null;kb.render(g,{label:f.label,commandId:f.commandId,run:y=>{f.run(y),this.dispose()},iconClass:f.iconClass},m)}),p.appendChild(g),this._hover.containerDomNode.appendChild(p)}this._hoverContainer=_t("div.workbench-hover-container"),this._hoverPointer&&this._hoverContainer.appendChild(this._hoverPointer),this._hoverContainer.appendChild(this._hover.containerDomNode);let a;if(e.actions&&e.actions.length>0?a=!1:e.hideOnHover===void 0?a=typeof e.content=="string"||Ho(e.content)&&!e.content.value.includes("](")&&!e.content.value.includes("</a>"):a=e.hideOnHover,a&&e.showHoverHint){const p=_t("div.hover-row.status-bar"),g=_t("div.info");g.textContent=u("hoverhint","Hold {0} key to mouse over",De?"Option":"Alt"),p.appendChild(g),this._hover.containerDomNode.appendChild(p)}const d=[...this._target.targetElements];a||d.push(this._hoverContainer);const l=this._register(new uh(d));if(this._register(l.onMouseOut(()=>{this._isLocked||this.dispose()})),a){const p=[...this._target.targetElements,this._hoverContainer];this._lockMouseTracker=this._register(new uh(p)),this._register(this._lockMouseTracker.onMouseOut(()=>{this._isLocked||this.dispose()}))}else this._lockMouseTracker=l}addFocusTrap(){if(!this._enableFocusTraps||this._addedFocusTrap)return;this._addedFocusTrap=!0;const e=this._hover.containerDomNode,t=this.findLastFocusableChild(this._hover.containerDomNode);if(t){const i=Hl(this._hoverContainer,_t("div")),o=de(this._hoverContainer,_t("div"));i.tabIndex=0,o.tabIndex=0,this._register(_(o,"focus",s=>{e.focus(),s.preventDefault()})),this._register(_(i,"focus",s=>{t.focus(),s.preventDefault()}))}}findLastFocusableChild(e){if(e.hasChildNodes())for(let t=0;t<e.childNodes.length;t++){const i=e.childNodes.item(e.childNodes.length-t-1);if(i.nodeType===i.ELEMENT_NODE){const s=i;if(typeof s.tabIndex=="number"&&s.tabIndex>=0)return s}const o=this.findLastFocusableChild(i);if(o)return o}}render(e){e.appendChild(this._hoverContainer),this.layout(),this.addFocusTrap()}layout(){this._hover.containerDomNode.classList.remove("right-aligned"),this._hover.contentsDomNode.style.maxHeight="";const e=l=>{const p=Ml(l),g=l.getBoundingClientRect();return{top:g.top*p,bottom:g.bottom*p,right:g.right*p,left:g.left*p}},t=this._target.targetElements.map(l=>e(l)),i=Math.min(...t.map(l=>l.top)),o=Math.max(...t.map(l=>l.right)),s=Math.max(...t.map(l=>l.bottom)),n=Math.min(...t.map(l=>l.left)),r=o-n,a=s-i,d={top:i,right:o,bottom:s,left:n,width:r,height:a,center:{x:n+r/2,y:i+a/2}};if(this.adjustHorizontalHoverPosition(d),this.adjustVerticalHoverPosition(d),this.adjustHoverMaxHeight(d),this._hoverContainer.style.padding="",this._hoverContainer.style.margin="",this._hoverPointer){switch(this._hoverPosition){case 1:d.left+=3,d.right+=3,this._hoverContainer.style.paddingLeft="3px",this._hoverContainer.style.marginLeft="-3px";break;case 0:d.left-=3,d.right-=3,this._hoverContainer.style.paddingRight="3px",this._hoverContainer.style.marginRight="-3px";break;case 2:d.top+=3,d.bottom+=3,this._hoverContainer.style.paddingTop="3px",this._hoverContainer.style.marginTop="-3px";break;case 3:d.top-=3,d.bottom-=3,this._hoverContainer.style.paddingBottom="3px",this._hoverContainer.style.marginBottom="-3px";break}d.center.x=d.left+r/2,d.center.y=d.top+a/2}this.computeXCordinate(d),this.computeYCordinate(d),this._hoverPointer&&(this._hoverPointer.classList.remove("top"),this._hoverPointer.classList.remove("left"),this._hoverPointer.classList.remove("right"),this._hoverPointer.classList.remove("bottom"),this.setHoverPointerPosition(d)),this._hover.onContentsChanged()}computeXCordinate(e){const t=this._hover.containerDomNode.clientWidth+2;this._target.x!==void 0?this._x=this._target.x:this._hoverPosition===1?this._x=e.right:this._hoverPosition===0?this._x=e.left-t:(this._hoverPointer?this._x=e.center.x-this._hover.containerDomNode.clientWidth/2:this._x=e.left,this._x+t>=document.documentElement.clientWidth&&(this._hover.containerDomNode.classList.add("right-aligned"),this._x=Math.max(document.documentElement.clientWidth-t-2,document.documentElement.clientLeft))),this._x<document.documentElement.clientLeft&&(this._x=e.left+2)}computeYCordinate(e){this._target.y!==void 0?this._y=this._target.y:this._hoverPosition===3?this._y=e.top:this._hoverPosition===2?this._y=e.bottom-2:this._hoverPointer?this._y=e.center.y+this._hover.containerDomNode.clientHeight/2:this._y=e.bottom,this._y>window.innerHeight&&(this._y=e.bottom)}adjustHorizontalHoverPosition(e){if(this._target.x===void 0){if(this._forcePosition){const t=(this._hoverPointer?3:0)+2;this._hoverPosition===1?this._hover.containerDomNode.style.maxWidth=`${document.documentElement.clientWidth-e.right-t}px`:this._hoverPosition===0&&(this._hover.containerDomNode.style.maxWidth=`${e.left-t}px`);return}this._hoverPosition===1?document.documentElement.clientWidth-e.right<this._hover.containerDomNode.clientWidth&&(e.left>=this._hover.containerDomNode.clientWidth?this._hoverPosition=0:this._hoverPosition=2):this._hoverPosition===0&&(e.left<this._hover.containerDomNode.clientWidth&&(document.documentElement.clientWidth-e.right>=this._hover.containerDomNode.clientWidth?this._hoverPosition=1:this._hoverPosition=2),e.left-this._hover.containerDomNode.clientWidth<=document.documentElement.clientLeft&&(this._hoverPosition=1))}}adjustVerticalHoverPosition(e){this._target.y!==void 0||this._forcePosition||(this._hoverPosition===3?e.top-this._hover.containerDomNode.clientHeight<0&&(this._hoverPosition=2):this._hoverPosition===2&&e.bottom+this._hover.containerDomNode.clientHeight>window.innerHeight&&(this._hoverPosition=3))}adjustHoverMaxHeight(e){let t=window.innerHeight/2;if(this._forcePosition){const i=(this._hoverPointer?3:0)+2;this._hoverPosition===3?t=Math.min(t,e.top-i):this._hoverPosition===2&&(t=Math.min(t,window.innerHeight-e.bottom-i))}if(this._hover.containerDomNode.style.maxHeight=`${t}px`,this._hover.contentsDomNode.clientHeight<this._hover.contentsDomNode.scrollHeight){const i=`${this._hover.scrollbar.options.verticalScrollbarSize}px`;this._hover.contentsDomNode.style.paddingRight!==i&&(this._hover.contentsDomNode.style.paddingRight=i)}}setHoverPointerPosition(e){if(this._hoverPointer)switch(this._hoverPosition){case 0:case 1:{this._hoverPointer.classList.add(this._hoverPosition===0?"right":"left");const t=this._hover.containerDomNode.clientHeight;t>e.height?this._hoverPointer.style.top=`${e.center.y-(this._y-t)-3}px`:this._hoverPointer.style.top=`${Math.round(t/2)-3}px`;break}case 3:case 2:{this._hoverPointer.classList.add(this._hoverPosition===3?"bottom":"top");const t=this._hover.containerDomNode.clientWidth;let i=Math.round(t/2)-3;const o=this._x+i;(o<e.left||o>e.right)&&(i=e.center.x-this._x-3),this._hoverPointer.style.left=`${i}px`;break}}}focus(){this._hover.containerDomNode.focus()}hide(){this.dispose()}dispose(){this._isDisposed||(this._onDispose.fire(),this._hoverContainer.remove(),this._messageListeners.dispose(),this._target.dispose(),super.dispose()),this._isDisposed=!0}};oa=C([h(1,ve),h(2,O),h(3,zi),h(4,I)],oa);class uh extends zn{get onMouseOut(){return this._onMouseOut.event}get isMouseIn(){return this._isMouseIn}constructor(e){super(),this._elements=e,this._isMouseIn=!0,this._onMouseOut=this._register(new w),this._elements.forEach(t=>this.onmouseover(t,()=>this._onTargetMouseOver())),this._elements.forEach(t=>this.onmouseleave(t,()=>this._onTargetMouseLeave()))}_onTargetMouseOver(){this._isMouseIn=!0,this._clearEvaluateMouseStateTimeout()}_onTargetMouseLeave(){this._isMouseIn=!1,this._evaluateMouseState()}_evaluateMouseState(){this._clearEvaluateMouseStateTimeout(),this._mouseTimeout=window.setTimeout(()=>this._fireIfMouseOutside(),0)}_clearEvaluateMouseStateTimeout(){this._mouseTimeout&&(clearTimeout(this._mouseTimeout),this._mouseTimeout=void 0)}_fireIfMouseOutside(){this._isMouseIn||this._onMouseOut.fire()}}class ty{constructor(e){this._element=e,this.targetElements=[this._element]}dispose(){}}let sa=class{constructor(e,t,i,o){this._instantiationService=e,this._contextViewService=t,this._keybindingService=o,i.onDidShowContextMenu(()=>this.hideHover())}showHover(e,t){if(ph(this._currentHoverOptions)===ph(e))return;this._currentHoverOptions=e,e.trapFocus&&document.activeElement?this._lastFocusedElementBeforeOpen=document.activeElement:this._lastFocusedElementBeforeOpen=void 0;const i=new x,o=this._instantiationService.createInstance(oa,e);o.onDispose(()=>{var r;(r=this._lastFocusedElementBeforeOpen)==null||r.focus(),this._currentHoverOptions===e&&(this._currentHoverOptions=void 0),i.dispose()});const s=this._contextViewService;if(s.showContextView(new iy(o,t),e.container),o.onRequestLayout(()=>s.layout()),"targetElements"in e.target)for(const r of e.target.targetElements)i.add(_(r,E.CLICK,()=>this.hideHover()));else i.add(_(e.target,E.CLICK,()=>this.hideHover()));const n=document.activeElement;if(n&&(i.add(_(n,E.KEY_DOWN,r=>this._keyDown(r,o,!!e.hideOnKeyDown))),i.add(_(document,E.KEY_DOWN,r=>this._keyDown(r,o,!!e.hideOnKeyDown))),i.add(_(n,E.KEY_UP,r=>this._keyUp(r,o))),i.add(_(document,E.KEY_UP,r=>this._keyUp(r,o)))),"IntersectionObserver"in window){const r=new IntersectionObserver(d=>this._intersectionChange(d,o),{threshold:0}),a="targetElements"in e.target?e.target.targetElements[0]:e.target;r.observe(a),i.add(Y(()=>r.disconnect()))}return this._currentHover=o,o}hideHover(){var e;(e=this._currentHover)!=null&&e.isLocked||!this._currentHoverOptions||(this._currentHover=void 0,this._currentHoverOptions=void 0,this._contextViewService.hideContextView())}_intersectionChange(e,t){e[e.length-1].isIntersecting||t.dispose()}_keyDown(e,t,i){var n,r;if(e.key==="Alt"){t.isLocked=!0;return}const o=new mt(e);this._keybindingService.resolveKeyboardEvent(o).getSingleModifierDispatchChords().some(a=>!!a)||this._keybindingService.softDispatch(o,o.target).kind!==0||i&&(!((n=this._currentHoverOptions)!=null&&n.trapFocus)||e.key!=="Tab")&&(this.hideHover(),(r=this._lastFocusedElementBeforeOpen)==null||r.focus())}_keyUp(e,t){var i;e.key==="Alt"&&(t.isLocked=!1,t.isMouseIn||(this.hideHover(),(i=this._lastFocusedElementBeforeOpen)==null||i.focus()))}};sa=C([h(0,I),h(1,$n),h(2,ke),h(3,ve)],sa);function ph(c){if(c!==void 0)return(c==null?void 0:c.id)??c}class iy{get anchorPosition(){return this._hover.anchor}constructor(e,t=!1){this._hover=e,this._focus=t}render(e){return this._hover.render(e),this._focus&&this._hover.focus(),this._hover}getAnchor(){return{x:this._hover.x,y:this._hover.y}}layout(){this._hover.layout()}}Pc((c,e)=>{const t=c.getColor(xb);t&&(e.addRule(`.monaco-workbench .workbench-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-workbench .workbench-hover hr { border-top: 1px solid ${t.transparent(.5)}; }`))});const rs=new Ib;let dn=class Fu{constructor(e,t,i,o,s,n,r,a,d,l){this.fileService=e,this.configurationService=t,this.contextService=i,this.clipboardService=o,this.editorService=s,this.uriIdentityService=n,this.bulkEditService=r,this.progressService=a,this.filesConfigurationService=l,this.disposables=new x,this.fileChangeEvents=[],this.config=this.configurationService.getValue("explorer"),this.model=new ug(this.contextService,this.uriIdentityService,this.fileService,this.configurationService,this.filesConfigurationService),this.disposables.add(this.model),this.disposables.add(this.fileService.onDidRunOperation(p=>this.onDidRunOperation(p))),this.onFileChangesScheduler=new Ds(async()=>{const p=this.fileChangeEvents;this.fileChangeEvents=[];const g=[2];this.config.sortOrder==="modified"&&g.push(0);let f=!1;this.roots.forEach(b=>{this.view&&!f&&(f=Nu(b,this.view,p,g))}),p.forEach(b=>{if(!f)for(const m of b.rawAdded){const y=this.model.findClosest(Ti(m));if(y&&!y.getChild(Me(m))){f=!0;break}}}),f&&await this.refresh(!1)},Fu.EXPLORER_FILE_CHANGES_REACT_DELAY),this.disposables.add(this.fileService.onDidFilesChange(p=>{this.fileChangeEvents.push(p),!this.editable&&(this.onFileChangesScheduler.isScheduled()||this.onFileChangesScheduler.schedule())})),this.disposables.add(this.configurationService.onDidChangeConfiguration(p=>this.onConfigurationUpdated(p))),this.disposables.add(A.any(this.fileService.onDidChangeFileSystemProviderRegistrations,this.fileService.onDidChangeFileSystemProviderCapabilities)(async p=>{let g=!1;this.model.roots.forEach(f=>{f.resource.scheme===p.scheme&&(g=!0,f.forgetChildren())}),g&&this.view&&await this.view.setTreeInput()})),this.disposables.add(this.model.onDidChangeRoots(()=>{var p;(p=this.view)==null||p.setTreeInput()})),this.disposables.add(d.onDidChangeFocus(p=>{p&&this.refresh(!1)})),this.revealExcludeMatcher=new Ah(p=>oy(t.getValue({resource:p})),p=>p.affectsConfiguration("explorer.autoRevealExclude"),i,t),this.disposables.add(this.revealExcludeMatcher)}get roots(){return this.model.roots}get sortOrderConfiguration(){return{sortOrder:this.config.sortOrder,lexicographicOptions:this.config.sortOrderLexicographicOptions}}registerView(e){this.view=e}getContext(e,t=!1){if(!this.view)return[];const i=new Set(this.view.getContext(e));return i.forEach(o=>{var s;try{if(e&&!t&&((s=this.view)!=null&&s.isItemCollapsed(o))&&o.nestedChildren)for(const n of o.nestedChildren)i.add(n)}catch{return}}),[...i]}async applyBulkEdit(e,t){const i=new qe,o=this.progressService.withProgress({location:t.progressLocation||10,title:t.progressLabel,cancellable:e.length>1,delay:500},async s=>{await this.bulkEditService.apply(e,{undoRedoSource:rs,label:t.undoLabel,code:"undoredo.explorerOperation",progress:s,token:i.token,confirmBeforeUndo:t.confirmBeforeUndo})},()=>i.cancel());await this.progressService.withProgress({location:1,delay:500},()=>o),i.dispose()}hasViewFocus(){return!!this.view&&this.view.hasFocus()}findClosest(e){return this.model.findClosest(e)}findClosestRoot(e){const t=this.model.roots.filter(i=>this.uriIdentityService.extUri.isEqualOrParent(e,i.resource)).sort((i,o)=>o.resource.path.length-i.resource.path.length);return t.length?t[0]:null}async setEditable(e,t){if(!this.view)return;t?this.editable={stat:e,data:t}:this.editable=void 0;const i=this.isEditable(e);await this.view.setEditable(e,i),!this.editable&&this.fileChangeEvents.length&&!this.onFileChangesScheduler.isScheduled()&&this.onFileChangesScheduler.schedule()}async setToCopy(e,t){var o;const i=this.cutItems;this.cutItems=t?e:void 0,await this.clipboardService.writeResources(e.map(s=>s.resource)),(o=this.view)==null||o.itemsCopied(e,t,i)}isCut(e){return!!this.cutItems&&this.cutItems.some(t=>this.uriIdentityService.extUri.isEqual(t.resource,e.resource))}getEditable(){return this.editable}getEditableData(e){return this.editable&&this.editable.stat===e?this.editable.data:void 0}isEditable(e){return!!this.editable&&(this.editable.stat===e||!e)}async select(e,t){if(!this.view)return;const i=t==="force",o=this.findClosest(e);if(o)return this.shouldAutoRevealItem(o,i)?(await this.view.selectResource(o.resource,t),Promise.resolve(void 0)):void 0;const s={resolveTo:[e],resolveMetadata:this.config.sortOrder==="modified"},n=this.findClosestRoot(e);if(n)try{const r=await this.fileService.resolve(n.resource,s),a=Ro.create(this.fileService,this.configurationService,this.filesConfigurationService,r,void 0,s.resolveTo);Ro.mergeLocalWithDisk(a,n);const d=n.find(e);if(await this.view.refresh(!0,n),d&&!this.shouldAutoRevealItem(d,i))return;await this.view.selectResource(d?d.resource:void 0,t)}catch(r){n.error=r,await this.view.refresh(!1,n)}}async refresh(e=!0){var t;if(this.model.roots.forEach(i=>i.forgetChildren()),this.view){await this.view.refresh(!0);const i=(t=this.editorService.activeEditor)==null?void 0:t.resource,o=this.configurationService.getValue().explorer.autoReveal;e&&i&&o&&this.select(i,o)}}async onDidRunOperation(e){const t=this.config.fileNesting.enabled;if(e.isOperation(0)||e.isOperation(3)){const i=e.target,o=Ti(i.resource),s=this.model.findAll(o);s.length&&await Promise.all(s.map(async n=>{var d;const r=this.config.sortOrder==="modified";if(!n.isDirectoryResolved){const l=await this.fileService.resolve(n.resource,{resolveMetadata:r});if(l){const p=Ro.create(this.fileService,this.configurationService,this.filesConfigurationService,l,n.parent);Ro.mergeLocalWithDisk(p,n)}}const a=Ro.create(this.fileService,this.configurationService,this.filesConfigurationService,i,n.parent);n.removeChild(a),n.addChild(a),await((d=this.view)==null?void 0:d.refresh(t,n))}))}else if(e.isOperation(2)){const i=e.resource,o=e.target,s=Ti(i),n=Ti(o.resource),r=this.model.findAll(i);if(r.every(d=>!d.nestedParent)&&this.uriIdentityService.extUri.isEqual(s,n))await Promise.all(r.map(async d=>{var l;d.rename(o),await((l=this.view)==null?void 0:l.refresh(t,d.parent))}));else{const d=this.model.findAll(n);d.length&&r.length&&await Promise.all(r.map(async(l,p)=>{var b,m,y;const g=l.parent,f=l.nestedParent;l.move(d[p]),f&&await((b=this.view)==null?void 0:b.refresh(!1,f)),await((m=this.view)==null?void 0:m.refresh(!1,g)),await((y=this.view)==null?void 0:y.refresh(t,d[p]))}))}}else if(e.isOperation(1)){const i=this.model.findAll(e.resource);await Promise.all(i.map(async o=>{var s,n;if(o.parent){const r=o.parent;r.removeChild(o);const a=o.nestedParent;a&&(a.removeChild(o),await((s=this.view)==null?void 0:s.refresh(!1,a))),await((n=this.view)==null?void 0:n.refresh(t,r))}}))}}shouldAutoRevealItem(e,t){if(e===void 0||t)return!0;if(this.revealExcludeMatcher.matches(e.resource,s=>!!(e.parent&&e.parent.getChild(s))))return!1;const i=e.root;let o=e.parent;for(;o!==i;){if(o===void 0)return!0;if(this.revealExcludeMatcher.matches(o.resource))return!1;o=o.parent}return!0}async onConfigurationUpdated(e){var n,r;if(!e.affectsConfiguration("explorer"))return;let t=!1;e.affectsConfiguration("explorer.fileNesting")&&(t=!0);const i=this.configurationService.getValue(),o=((n=i==null?void 0:i.explorer)==null?void 0:n.sortOrder)||"default";this.config.sortOrder!==o&&(t=this.config.sortOrder!==void 0);const s=((r=i==null?void 0:i.explorer)==null?void 0:r.sortOrderLexicographicOptions)||"default";this.config.sortOrderLexicographicOptions!==s&&(t=t||this.config.sortOrderLexicographicOptions!==void 0),this.config=i.explorer,t&&await this.refresh()}dispose(){this.disposables.dispose()}};dn.EXPLORER_FILE_CHANGES_REACT_DELAY=500;dn=C([h(0,Ce),h(1,O),h(2,ze),h(3,qn),h(4,P),h(5,si),h(6,Gl),h(7,jn),h(8,ti),h(9,ms)],dn);function Nu(c,e,t,i){for(const[o,s]of c.children)if(e.isItemVisible(s)&&(t.some(n=>n.contains(s.resource,...i))||s.isDirectory&&s.isDirectoryResolved&&Nu(s,e,t,i)))return!0;return!1}function oy(c){const e=c&&c.explorer&&c.explorer.autoRevealExclude;return e||{}}var sy='.monaco-workbench .part.basepanel>.composite.title>.title-actions .monaco-action-bar .actions-container{justify-content:flex-end}.monaco-workbench .part.basepanel>.composite.title>.global-actions .monaco-action-bar .action-item,.monaco-workbench .part.basepanel>.composite.title>.title-actions .monaco-action-bar .action-item{margin-right:4px}.monaco-workbench .part.basepanel>.composite.title>.title-actions .monaco-action-bar .action-item .action-label{outline-offset:-2px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container.composite-bar>.monaco-action-bar .action-label.codicon-more{align-items:center;color:inherit!important;display:flex;justify-content:center;margin-left:0;margin-right:0}.monaco-workbench .part.basepanel .empty-panel-message-area{display:none;height:100%;width:100%}.monaco-workbench .part.basepanel .empty-panel-message-area.visible{align-content:center;align-items:center;display:flex;justify-content:center}.monaco-workbench .part.basepanel .empty-panel-message-area .empty-panel-message{margin:12px;text-align:center}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar{height:35px;line-height:27px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item{display:flex;font-size:11px;padding:2px 10px;text-transform:uppercase}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.icon{padding-left:2px;padding-right:2px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.icon .action-label:not(.codicon){height:16px;width:16px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:after,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:before{background-color:var(--insert-border-color);content:"";display:none;height:24px;opacity:0;position:absolute;transition-delay:.1s;transition-duration:0ms;transition-property:opacity;width:2px}.monaco-workbench .part.basepanel>.composite.title.dragged-over>.panel-switcher-container>.monaco-action-bar .action-item:after,.monaco-workbench .part.basepanel>.composite.title.dragged-over>.panel-switcher-container>.monaco-action-bar .action-item:before{display:block}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:before{left:1px;margin-left:-2px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:after{margin-right:-2px;right:1px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:first-of-type:before{left:2px;margin-left:-2px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:last-of-type:after{margin-right:-2px;right:2px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.left:after,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.left:before,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.right:after,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.right:before{transition-delay:0s}.monaco-workbench .part.basepanel>.composite.title.dragged-over-head>.panel-switcher-container>.monaco-action-bar .action-item:first-of-type:before,.monaco-workbench .part.basepanel>.composite.title.dragged-over-tail>.panel-switcher-container>.monaco-action-bar .action-item:last-of-type:after,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.left:before,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.right+.action-item:before,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:last-of-type.right:after{opacity:1}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item .action-label{border-radius:0;margin-right:0;padding:2px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.icon .action-label.codicon,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:not(.icon) .action-label{background:none!important}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.checked .action-label{margin-right:0}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .badge{align-items:center;display:flex;margin-left:8px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.icon .badge{margin-left:0}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .badge .badge-content{border-radius:11px;box-sizing:border-box;display:inline-block;font-size:11px;font-weight:400;height:18px;line-height:11px;min-width:18px;padding:3px 5px;position:relative;text-align:center}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item .active-item-indicator{bottom:0;height:100%;left:10px;overflow:hidden;pointer-events:none;position:absolute;top:-4px;width:calc(100% - 20px);z-index:1}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.icon .active-item-indicator{left:2px;top:1px;width:calc(100% - 4px)}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.checked .active-item-indicator:before,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:focus .active-item-indicator:before{border-top-style:solid;border-top-width:1px;bottom:0;content:"";height:0;position:absolute;width:100%;z-index:1}.monaco-workbench .part.basepanel>.title>.panel-switcher-container>.monaco-action-bar .action-item.clicked:not(.checked):focus .active-item-indicator:before{border-top-color:transparent!important}.monaco-workbench .part.basepanel.right .global-actions .codicon-panel-maximize:before,.monaco-workbench .part.basepanel.right .global-actions .codicon-panel-restore:before,.monaco-workbench .part.basepanel.right .title-actions .codicon-split-horizontal:before{display:inline-block;transform:rotate(-90deg)}.monaco-workbench .part.basepanel.left .global-actions .codicon-panel-maximize:before,.monaco-workbench .part.basepanel.left .global-actions .codicon-panel-restore:before,.monaco-workbench .part.basepanel.left .title-actions .codicon-split-horizontal:before{display:inline-block;transform:rotate(90deg)}';he(sy,{});let hn=class na extends ku{get preferredHeight(){return this.layoutService.dimension.height*.4}get preferredWidth(){const e=this.getActivePaneComposite();if(!e)return;const t=e.getOptimalWidth();if(typeof t=="number")return Math.max(t,300)}get onDidPaneCompositeOpen(){return A.map(this.onDidCompositeOpen.event,e=>e.composite)}constructor(e,t,i,o,s,n,r,a,d,l,p,g,f,b,m,y,D,L,$,Se){var St;super(e,t,i,o,s,n,r,M.as(m),g,((St=a.getDefaultViewContainer(D))==null?void 0:St.id)||"","panel","panel",void 0,p,Se),this.viewDescriptorService=a,this.contextKeyService=d,this.extensionService=l,this.partId=p,this.pinnedPanelsKey=f,this.placeholdeViewContainersKey=b,this.backgroundColor=y,this.viewContainerLocation=D,this.activePanelContextKey=L,this.panelFocusContextKey=$,this.panelOptions=Se,this.minimumWidth=300,this.maximumWidth=Number.POSITIVE_INFINITY,this.minimumHeight=77,this.maximumHeight=Number.POSITIVE_INFINITY,this.snap=!0,this.onDidPaneCompositeClose=this.onDidCompositeClose.event,this.compositeActions=new Map,this.panelDisposables=new Map,this.blockOpeningPanel=!1,this.extensionsRegistered=!1,this.enabledViewContainersContextKeys=new Map,this.panelRegistry=M.as(m),this.dndHandler=new Lu(this.viewDescriptorService,this.viewContainerLocation,(F,re)=>this.openPaneComposite(F,re).then(ae=>ae||null),(F,re,ae)=>this.compositeBar.move(F,re,ae==null?void 0:ae.horizontallyBefore),()=>this.compositeBar.getCompositeBarItems()),this.compositeBar=this._register(this.instantiationService.createInstance(cn,this.getCachedPanels(),{icon:!!this.panelOptions.useIcons,orientation:0,activityHoverOptions:this.getActivityHoverOptions(),openComposite:(F,re)=>this.openPaneComposite(F,!re).then(ae=>ae||null),getActivityAction:F=>this.getCompositeActions(F).activityAction,getCompositePinnedAction:F=>this.getCompositeActions(F).pinnedAction,getCompositeBadgeAction:F=>this.getCompositeActions(F).badgeAction,getOnCompositeClickAction:F=>this.instantiationService.createInstance(sh,K(this.getPaneComposite(F)),this.viewContainerLocation),fillExtraContextMenuActions:F=>this.fillExtraContextMenuActions(F),getContextMenuActionsForComposite:F=>this.getContextMenuActionsForComposite(F),getDefaultCompositeId:()=>{var F;return(F=a.getDefaultViewContainer(this.viewContainerLocation))==null?void 0:F.id},hidePart:()=>this.layoutService.setPartHidden(!0,this.partId),dndHandler:this.dndHandler,compositeSize:0,overflowActionSize:44,colors:F=>({activeBackgroundColor:F.getColor(this.backgroundColor),inactiveBackgroundColor:F.getColor(this.backgroundColor),activeBorderBottomColor:F.getColor(fg),activeForegroundColor:F.getColor(mg),inactiveForegroundColor:F.getColor(bg),badgeBackground:F.getColor(Ab),badgeForeground:F.getColor(Tb),dragAndDropBorder:F.getColor(vg)})})),this.registerListeners(),this.onDidRegisterPanels([...this.getPaneComposites()]),this.globalActions=this._register(this.instantiationService.createInstance(wg,p==="workbench.parts.panel"?S.PanelTitle:S.AuxiliaryBarTitle,void 0,void 0)),this._register(this.globalActions.onDidChange(()=>this.updateGlobalToolbarActions()))}getContextMenuActionsForComposite(e){const t=[],i=this.viewDescriptorService.getViewContainerById(e),o=this.viewDescriptorService.getDefaultViewContainerLocation(i);if(o!==this.viewDescriptorService.getViewContainerLocation(i))t.push(Ee({id:"resetLocationAction",label:u("resetLocation","Reset Location"),run:()=>this.viewDescriptorService.moveViewContainerToLocation(i,o)}));else{const s=this.viewDescriptorService.getViewContainerModel(i);if(s.allViewDescriptors.length===1){const n=s.allViewDescriptors[0],r=this.viewDescriptorService.getDefaultContainerById(n.id);r!==i&&t.push(Ee({id:"resetLocationAction",label:u("resetLocation","Reset Location"),run:()=>this.viewDescriptorService.moveViewsToContainer([n],r)}))}}return t}onDidRegisterPanels(e){const t=this.getCachedPanels();for(const i of e){const o=t.filter(({id:r})=>r===i.id)[0],s=this.getActivePaneComposite(),n=(s==null?void 0:s.getId())===i.id||this.extensionsRegistered&&this.compositeBar.getVisibleComposites().length===0;if(n||!this.shouldBeHidden(i.id,o)){const r={id:i.id,name:i.name,order:i.order,requestedIndex:i.requestedIndex};this.compositeBar.addComposite(r),o||this.compositeBar.pin(i.id),n&&(this.compositeBar.activateComposite(i.id),!s&&this.element&&this.layoutService.isVisible(this.partId)&&this.doOpenPanel(i.id))}}for(const i of e){const o=this.getViewContainer(i.id),s=this.viewDescriptorService.getViewContainerModel(o);this.updateActivity(o,s),this.showOrHideViewContainer(o,s);const n=new x;n.add(s.onDidChangeActiveViewDescriptors(()=>this.showOrHideViewContainer(o,s))),n.add(s.onDidChangeContainerInfo(()=>this.updateActivity(o,s))),this.panelDisposables.set(i.id,n)}}async onDidDeregisterPanel(e){var o,s;const t=this.panelDisposables.get(e);t==null||t.dispose(),this.panelDisposables.delete(e);const i=this.viewDescriptorService.getViewContainersByLocation(this.viewContainerLocation).filter(n=>this.viewDescriptorService.getViewContainerModel(n).activeViewDescriptors.length>0);if(i.length){if(((o=this.getActivePaneComposite())==null?void 0:o.getId())===e){const n=(s=this.viewDescriptorService.getDefaultViewContainer(this.viewContainerLocation))==null?void 0:s.id,r=i.filter(a=>a.id===n)[0]||i[0];await this.openPaneComposite(r.id)}}else this.layoutService.setPartHidden(!0,this.partId);this.removeComposite(e)}updateActivity(e,t){var r;const i=(r=this.getPlaceholderViewContainers().filter(a=>a.id===e.id)[0])==null?void 0:r.name,o={id:e.id,name:this.extensionsRegistered||i===void 0?t.title:i,keybindingId:t.keybindingId},{activityAction:s,pinnedAction:n}=this.getCompositeActions(e.id);s.setActivity(this.toActivity(t)),n instanceof nh&&n.setActivity(o),this.compositeBar.recomputeSizes(),this.layoutCompositeBar(),this.extensionsRegistered&&this.saveCachedPanels()}toActivity(e){return na.toActivity(e.viewContainer.id,e.title,this.panelOptions.useIcons?e.icon:void 0,e.keybindingId)}static toActivity(e,t,i,o){let s,n;if(T.isUri(i)){n=i;const r=Nc(i),a=new Bl;a.update(r);const d=`activity-${e.replace(/\./g,"-")}-${a.digest()}`;s=[d,"uri-icon"];const l=`.monaco-workbench .basepanel .monaco-action-bar .action-label.${d}`;Wl(l,`
				mask: ${r} no-repeat 50% 50%;
				mask-size: 16px;
				-webkit-mask: ${r} no-repeat 50% 50%;
				-webkit-mask-size: 16px;
				mask-origin: padding;
				-webkit-mask-origin: padding;
			`)}else ge.isThemeIcon(i)&&(s=ge.asClassNameArray(i));return{id:e,name:t,classNames:s,iconUrl:n,keybindingId:o}}showOrHideViewContainer(e,t){let i=this.enabledViewContainersContextKeys.get(e.id);if(i||(i=this.contextKeyService.createKey(Ih(e.id),!1),this.enabledViewContainersContextKeys.set(e.id,i)),t.activeViewDescriptors.length){if(i.set(!0),this.compositeBar.addComposite({id:e.id,name:typeof e.title=="string"?e.title:e.title.value,order:e.order,requestedIndex:e.requestedIndex}),this.layoutService.isRestored()&&this.layoutService.isVisible(this.partId)){const o=this.getActiveComposite();(o===void 0||o.getId()===e.id)&&this.compositeBar.activateComposite(e.id)}this.layoutCompositeBar(),this.layoutEmptyMessage()}else e.hideIfEmpty&&(i.set(!1),this.hideComposite(e.id))}shouldBeHidden(e,t){const i=this.getViewContainer(e);return!i||!i.hideIfEmpty?!1:t!=null&&t.views&&t.views.length?t.views.every(({when:o})=>!!o&&!this.contextKeyService.contextMatchesRules(v.deserialize(o))):!1}registerListeners(){this._register(this.registry.onDidRegister(t=>this.onDidRegisterPanels([t]))),this._register(this.registry.onDidDeregister(t=>this.onDidDeregisterPanel(t.id))),this._register(this.onDidPaneCompositeOpen(t=>this.onPanelOpen(t))),this._register(this.onDidPaneCompositeClose(this.onPanelClose,this));const e=this._register(new x);this._register(this.extensionService.onDidRegisterExtensions(()=>{e.clear(),this.onDidRegisterExtensions(),this.compositeBar.onDidChange(()=>this.saveCachedPanels(),this,e),this.storageService.onDidChangeValue(t=>this.onDidStorageValueChange(t),this,e)}))}onDidRegisterExtensions(){this.extensionsRegistered=!0;const e=this.getPaneComposites();for(const{id:t}of this.getCachedPanels())e.every(i=>i.id!==t)&&(this.viewDescriptorService.isViewContainerRemovedPermanently(t)?this.removeComposite(t):this.hideComposite(t));this.saveCachedPanels()}hideComposite(e){this.compositeBar.hideComposite(e);const t=this.compositeActions.get(e);t&&(t.activityAction.dispose(),t.pinnedAction.dispose(),this.compositeActions.delete(e))}onPanelOpen(e){this.activePanelContextKey.set(e.getId());const t=this.panelRegistry.getPaneComposite(e.getId());t&&this.compositeBar.addComposite(t),this.compositeBar.activateComposite(e.getId());const i=this.panelRegistry.getPaneComposite(e.getId());if(i){const o=this.getViewContainer(i.id);o!=null&&o.hideIfEmpty&&this.viewDescriptorService.getViewContainerModel(o).activeViewDescriptors.length===0&&this.hideComposite(i.id)}this.layoutCompositeBar(),this.layoutEmptyMessage()}onPanelClose(e){const t=e.getId();this.activePanelContextKey.get()===t&&this.activePanelContextKey.reset(),this.compositeBar.deactivateComposite(e.getId()),this.layoutEmptyMessage()}create(e){this.element=e,super.create(e),this.createEmptyPanelMessage();const t=this._register(bi(e));this._register(t.onDidFocus(()=>this.panelFocusContextKey.set(!0))),this._register(t.onDidBlur(()=>this.panelFocusContextKey.set(!1)))}createEmptyPanelMessage(){const e=this.getContentArea();this.emptyPanelMessageElement=document.createElement("div"),this.emptyPanelMessageElement.classList.add("empty-panel-message-area");const t=document.createElement("div");t.classList.add("empty-panel-message"),t.innerText=u("panel.emptyMessage","Drag a view here to display."),this.emptyPanelMessageElement.appendChild(t),e.appendChild(this.emptyPanelMessageElement),this._register(Yo.INSTANCE.registerTarget(this.emptyPanelMessageElement,{onDragOver:i=>{X.stop(i.eventData,!0);const o=this.dndHandler.onDragEnter(i.dragAndDropData,void 0,i.eventData);xh(i.eventData.dataTransfer,"move",o)},onDragEnter:i=>{var s;X.stop(i.eventData,!0);const o=this.dndHandler.onDragEnter(i.dragAndDropData,void 0,i.eventData);this.emptyPanelMessageElement.style.backgroundColor=o&&((s=this.theme.getColor(On))==null?void 0:s.toString())||""},onDragLeave:i=>{X.stop(i.eventData,!0),this.emptyPanelMessageElement.style.backgroundColor=""},onDragEnd:i=>{X.stop(i.eventData,!0),this.emptyPanelMessageElement.style.backgroundColor=""},onDrop:i=>{X.stop(i.eventData,!0),this.emptyPanelMessageElement.style.backgroundColor="",this.dndHandler.drop(i.dragAndDropData,void 0,i.eventData)}}))}createTitleArea(e){const t=super.createTitleArea(e),i=t.appendChild(z(".global-actions"));return this.globalToolBar=this._register(new Vb(i,this.contextMenuService,{actionViewItemProvider:o=>this.actionViewItemProvider(o),orientation:0,getKeyBinding:o=>this.keybindingService.lookupKeybinding(o.id),anchorAlignmentProvider:()=>this.getTitleAreaDropDownAnchorAlignment(),toggleMenuTitle:u("moreActions","More Actions...")})),this.updateGlobalToolbarActions(),t}updateStyles(){super.updateStyles();const e=K(this.getContainer());e.style.backgroundColor=this.getColor(this.backgroundColor)||"";const t=this.getColor(Ze)||"";e.style.borderLeftColor=t,e.style.borderRightColor=t;const i=this.getTitleArea();i&&(i.style.borderTopColor=this.getColor(Ze)||"")}doOpenPanel(e,t){if(!this.blockOpeningPanel){if(!this.layoutService.isVisible(this.partId))try{this.blockOpeningPanel=!0,this.layoutService.setPartHidden(!1,this.partId)}finally{this.blockOpeningPanel=!1}return this.openComposite(e,t)}}async openPaneComposite(e,t){if(typeof e=="string"&&this.getPaneComposite(e))return this.doOpenPanel(e,t);if(await this.extensionService.whenInstalledExtensionsRegistered(),typeof e=="string"&&this.getPaneComposite(e))return this.doOpenPanel(e,t)}showActivity(e,t,i){return this.compositeBar.showActivity(e,t,i)}getPaneComposite(e){return this.panelRegistry.getPaneComposite(e)}getPaneComposites(){return this.panelRegistry.getPaneComposites().sort((e,t)=>typeof e.order!="number"?1:typeof t.order!="number"?-1:e.order-t.order)}getPinnedPaneCompositeIds(){const e=this.compositeBar.getPinnedComposites().map(t=>t.id);return this.getPaneComposites().filter(t=>e.includes(t.id)).sort((t,i)=>e.indexOf(t.id)-e.indexOf(i.id)).map(t=>t.id)}getVisiblePaneCompositeIds(){return this.compositeBar.getVisibleComposites().filter(e=>{var t;return((t=this.getActivePaneComposite())==null?void 0:t.getId())===e.id||this.compositeBar.isPinned(e.id)}).map(e=>e.id)}getActivePaneComposite(){return this.getActiveComposite()}getLastActivePaneCompositeId(){return this.getLastActiveCompositeId()}hideActivePaneComposite(){this.layoutService.isVisible(this.partId)&&this.layoutService.setPartHidden(!0,this.partId),this.hideActiveComposite()}createTitleLabel(e){return this.compositeBar.create(e).classList.add("panel-switcher-container"),{updateTitle:(i,o,s)=>{const n=this.compositeBar.getAction(i);n&&(n.label=o)},updateStyles:()=>{}}}onTitleAreaUpdate(e){super.onTitleAreaUpdate(e),this.layoutCompositeBar()}layout(e,t,i,o){this.layoutService.isVisible(this.partId)&&(this.contentDimension=new q(e,t),super.layout(this.contentDimension.width,this.contentDimension.height,i,o),this.layoutCompositeBar(),this.layoutEmptyMessage())}layoutCompositeBar(){if(this.contentDimension&&this.dimension){let e=this.contentDimension.width-40;this.toolBar&&(e=Math.max(na.MIN_COMPOSITE_BAR_WIDTH,e-this.getToolbarWidth())),this.compositeBar.layout(new q(e,this.dimension.height))}}layoutEmptyMessage(){var e;(e=this.emptyPanelMessageElement)==null||e.classList.toggle("visible",this.compositeBar.getVisibleComposites().length===0)}getViewContainer(e){const t=this.viewDescriptorService.getViewContainerById(e);return t&&this.viewDescriptorService.getViewContainerLocation(t)===this.viewContainerLocation?t:void 0}updateGlobalToolbarActions(){var i;const e=this.globalActions.getPrimaryActions(),t=this.globalActions.getSecondaryActions();(i=this.globalToolBar)==null||i.setActions(ho(e),ho(t))}getCompositeActions(e){let t=this.compositeActions.get(e);if(!t){const i=this.getViewContainer(e);if(i){const o=this.viewDescriptorService.getViewContainerModel(i);t={activityAction:this.instantiationService.createInstance(sh,this.toActivity(o),this.viewContainerLocation),pinnedAction:new Qc(this.toActivity(o),this.compositeBar),badgeAction:new ed(this.toActivity(o),this.compositeBar)}}else t={activityAction:this.instantiationService.createInstance(Rw,e,this.viewContainerLocation),pinnedAction:new nh(e,this.compositeBar),badgeAction:new Ou(e,this.compositeBar)};this.compositeActions.set(e,t)}return t}removeComposite(e){if(super.removeComposite(e)){this.compositeBar.removeComposite(e);const t=this.compositeActions.get(e);return t&&(t.activityAction.dispose(),t.pinnedAction.dispose(),this.compositeActions.delete(e)),!0}return!1}getToolbarWidth(){var t;return!this.getActivePaneComposite()||!this.toolBar?0:this.toolBar.getItemsWidth()+(((t=this.globalToolBar)==null?void 0:t.getItemsWidth())??0)}onDidStorageValueChange(e){if(e.key===this.pinnedPanelsKey&&e.scope===0&&this.cachedPanelsValue!==this.getStoredCachedPanelsValue()){this._cachedPanelsValue=void 0;const t=[],i=this.compositeBar.getCompositeBarItems(),o=this.getCachedPanels();for(const s of o)t.push({id:s.id,name:s.name,order:s.order,pinned:s.pinned,visible:!!i.find(({id:n})=>n===s.id)});for(let s=0;s<i.length;s++)t.some(({id:n})=>n===i[s].id)||t.splice(s,0,i[s]);this.compositeBar.setCompositeBarItems(t)}}saveCachedPanels(){const e=[],t=[],i=this.compositeBar.getCompositeBarItems();for(const o of i){const s=this.getViewContainer(o.id);if(s){const n=this.viewDescriptorService.getViewContainerModel(s);e.push({id:o.id,name:n.title,pinned:o.pinned,order:o.order,visible:o.visible}),t.push({id:o.id,name:this.getCompositeActions(o.id).activityAction.label})}else e.push({id:o.id,name:o.name,pinned:o.pinned,order:o.order,visible:o.visible})}this.cachedPanelsValue=JSON.stringify(e),this.setPlaceholderViewContainers(t)}getCachedPanels(){const e=this.getPaneComposites(),i=JSON.parse(this.cachedPanelsValue).map(o=>{const s=typeof o=="string"?{id:o,pinned:!0,order:void 0,visible:!0}:o,n=e.some(r=>r.id===s.id);return s.visible=n?Ye(s.visible)?!0:s.visible:!1,s});for(const o of this.getPlaceholderViewContainers()){const s=i.filter(n=>n.id===o.id)[0];s&&(s.name=o.name)}return i}get cachedPanelsValue(){return this._cachedPanelsValue||(this._cachedPanelsValue=this.getStoredCachedPanelsValue()),this._cachedPanelsValue}set cachedPanelsValue(e){this.cachedPanelsValue!==e&&(this._cachedPanelsValue=e,this.setStoredCachedViewletsValue(e))}getStoredCachedPanelsValue(){return this.storageService.get(this.pinnedPanelsKey,0,"[]")}setStoredCachedViewletsValue(e){this.storageService.store(this.pinnedPanelsKey,e,0,0)}getPlaceholderViewContainers(){return JSON.parse(this.placeholderViewContainersValue)}setPlaceholderViewContainers(e){this.placeholderViewContainersValue=JSON.stringify(e)}get placeholderViewContainersValue(){return this._placeholderViewContainersValue||(this._placeholderViewContainersValue=this.getStoredPlaceholderViewContainersValue()),this._placeholderViewContainersValue}set placeholderViewContainersValue(e){this.placeholderViewContainersValue!==e&&(this._placeholderViewContainersValue=e,this.setStoredPlaceholderViewContainersValue(e))}getStoredPlaceholderViewContainersValue(){return this.storageService.get(this.placeholdeViewContainersKey,1,"[]")}setStoredPlaceholderViewContainersValue(e){this.storageService.store(this.placeholdeViewContainersKey,e,1,1)}};hn.MIN_COMPOSITE_BAR_WIDTH=50;hn=C([h(0,Ae),h(1,oe),h(2,ke),h(3,st),h(4,ve),h(5,I),h(6,te),h(7,Qe),h(8,G),h(9,Ci)],hn);let ln=class Bu extends hn{constructor(e,t,i,o,s,n,r,a,d,l,p,g,f){super(e,t,o,s,n,r,a,d,l,p,"workbench.parts.panel",Bu.activePanelSettingsKey,"workbench.panel.pinnedPanels","workbench.panel.placeholderPanels",nn.Panels,xr,1,pg.bindTo(l),gg.bindTo(l),{useIcons:!1,hasTitle:!0}),this.commandService=g,this.menuService=f}updateStyles(){super.updateStyles();const e=K(this.getContainer()),t=this.getColor(Cd)||this.getColor(Ze)||"";e.style.borderLeftColor=t,e.style.borderRightColor=t;const i=this.getTitleArea();i&&(i.style.borderTopColor=this.getColor(Cd)||this.getColor(Ze)||"")}getActivityHoverOptions(){return{position:()=>this.layoutService.getPanelPosition()===2&&!this.layoutService.isPanelMaximized()?3:2}}fillExtraContextMenuActions(e){const t=this.menuService.createMenu(S.PanelPositionMenu,this.contextKeyService),i=this.menuService.createMenu(S.PanelAlignmentMenu,this.contextKeyService),o=[],s=[];en(t,{shouldForwardArgs:!0},{primary:[],secondary:o}),en(i,{shouldForwardArgs:!0},{primary:[],secondary:s}),i.dispose(),t.dispose(),e.push(new Pe,new uo("workbench.action.panel.position",u("panel position","Panel Position"),o),new uo("workbench.action.panel.align",u("align panel","Align Panel"),s),Ee({id:oh.ID,label:u("hidePanel","Hide Panel"),run:()=>this.commandService.executeCommand(oh.ID)}))}layout(e,t,i,o){let s;this.layoutService.getPanelPosition()===1?s=new q(e-1,t):s=new q(e,t),super.layout(s.width,s.height,i,o)}toJSON(){return{type:"workbench.parts.panel"}}};ln.activePanelSettingsKey="workbench.panelpart.activepanelid";ln=C([h(0,Ae),h(1,oe),h(2,Ne),h(3,ke),h(4,st),h(5,ve),h(6,I),h(7,te),h(8,Qe),h(9,G),h(10,Ci),h(11,Io),h(12,rt)],ln);var ny=".monaco-grid-view{overflow:hidden;position:relative}.monaco-grid-branch-node,.monaco-grid-view{height:100%;width:100%}";he(ny,{});const ry={separatorBorder:vi.transparent};function xt(c){return c===0?1:0}class ay{constructor(e){this.isLayoutEnabled=e}}function cy(c,e){return e===1?{left:c.start,right:c.end,top:c.orthogonalStart,bottom:c.orthogonalEnd}:{top:c.start,bottom:c.end,left:c.orthogonalStart,right:c.orthogonalEnd}}function dy(c,e){return e===1?{start:c.left,end:c.right,orthogonalStart:c.top,orthogonalEnd:c.bottom}:{start:c.top,end:c.bottom,orthogonalStart:c.left,orthogonalEnd:c.right}}function ht(c,e){if(Math.abs(c)>e)throw new Error("Invalid index");return Ob(c,e+1)}class ce{get size(){return this._size}get orthogonalSize(){return this._orthogonalSize}get absoluteOffset(){return this._absoluteOffset}get absoluteOrthogonalOffset(){return this._absoluteOrthogonalOffset}get styles(){return this._styles}get width(){return this.orientation===1?this.size:this.orthogonalSize}get height(){return this.orientation===1?this.orthogonalSize:this.size}get top(){return this.orientation===1?this._absoluteOffset:this._absoluteOrthogonalOffset}get left(){return this.orientation===1?this._absoluteOrthogonalOffset:this._absoluteOffset}get minimumSize(){return this.children.length===0?0:Math.max(...this.children.map(e=>e.minimumOrthogonalSize))}get maximumSize(){return Math.min(...this.children.map(e=>e.maximumOrthogonalSize))}get priority(){if(this.children.length===0)return 0;const e=this.children.map(t=>typeof t.priority>"u"?0:t.priority);return e.some(t=>t===2)?2:e.some(t=>t===1)?1:0}get proportionalLayout(){return this.children.length===0?!0:this.children.every(e=>e.proportionalLayout)}get minimumOrthogonalSize(){return this.splitview.minimumSize}get maximumOrthogonalSize(){return this.splitview.maximumSize}get minimumWidth(){return this.orientation===1?this.minimumOrthogonalSize:this.minimumSize}get minimumHeight(){return this.orientation===1?this.minimumSize:this.minimumOrthogonalSize}get maximumWidth(){return this.orientation===1?this.maximumOrthogonalSize:this.maximumSize}get maximumHeight(){return this.orientation===1?this.maximumSize:this.maximumOrthogonalSize}get boundarySashes(){return this._boundarySashes}set boundarySashes(e){if(!(this._boundarySashes.start===e.start&&this._boundarySashes.end===e.end&&this._boundarySashes.orthogonalStart===e.orthogonalStart&&this._boundarySashes.orthogonalEnd===e.orthogonalEnd)){this._boundarySashes=e,this.splitview.orthogonalStartSash=e.orthogonalStart,this.splitview.orthogonalEndSash=e.orthogonalEnd;for(let t=0;t<this.children.length;t++){const i=this.children[t],o=t===0,s=t===this.children.length-1;i.boundarySashes={start:e.orthogonalStart,end:e.orthogonalEnd,orthogonalStart:o?e.start:i.boundarySashes.orthogonalStart,orthogonalEnd:s?e.end:i.boundarySashes.orthogonalEnd}}}}get edgeSnapping(){return this._edgeSnapping}set edgeSnapping(e){if(this._edgeSnapping!==e){this._edgeSnapping=e;for(const t of this.children)t instanceof ce&&(t.edgeSnapping=e);this.updateSplitviewEdgeSnappingEnablement()}}constructor(e,t,i,o,s=0,n=0,r=!1,a){if(this.orientation=e,this.layoutController=t,this.splitviewProportionalLayout=o,this.children=[],this._absoluteOffset=0,this._absoluteOrthogonalOffset=0,this.absoluteOrthogonalSize=0,this._onDidChange=new w,this.onDidChange=this._onDidChange.event,this._onDidScroll=new w,this.onDidScrollDisposable=V.None,this.onDidScroll=this._onDidScroll.event,this.childrenChangeDisposable=V.None,this._onDidSashReset=new w,this.onDidSashReset=this._onDidSashReset.event,this.splitviewSashResetDisposable=V.None,this.childrenSashResetDisposable=V.None,this._boundarySashes={},this._edgeSnapping=!1,this._styles=i,this._size=s,this._orthogonalSize=n,this.element=z(".monaco-grid-branch-node"),!a)this.splitview=new ts(this.element,{orientation:e,styles:i,proportionalLayout:o}),this.splitview.layout(s,{orthogonalSize:n,absoluteOffset:0,absoluteOrthogonalOffset:0,absoluteSize:s,absoluteOrthogonalSize:n});else{const l={views:a.map(g=>({view:g.node,size:g.node.size,visible:g.node instanceof xe&&g.visible!==void 0?g.visible:!0})),size:this.orthogonalSize},p={proportionalLayout:o,orientation:e,styles:i};this.children=a.map(g=>g.node),this.splitview=new ts(this.element,{...p,descriptor:l}),this.children.forEach((g,f)=>{const b=f===0,m=f===this.children.length;g.boundarySashes={start:this.boundarySashes.orthogonalStart,end:this.boundarySashes.orthogonalEnd,orthogonalStart:b?this.boundarySashes.start:this.splitview.sashes[f-1],orthogonalEnd:m?this.boundarySashes.end:this.splitview.sashes[f]}})}const d=A.map(this.splitview.onDidSashReset,l=>[l]);this.splitviewSashResetDisposable=d(this._onDidSashReset.fire,this._onDidSashReset),this.updateChildrenEvents()}style(e){this._styles=e,this.splitview.style(e);for(const t of this.children)t instanceof ce&&t.style(e)}layout(e,t,i){if(this.layoutController.isLayoutEnabled){if(typeof i>"u")throw new Error("Invalid state");this._size=i.orthogonalSize,this._orthogonalSize=e,this._absoluteOffset=i.absoluteOffset+t,this._absoluteOrthogonalOffset=i.absoluteOrthogonalOffset,this.absoluteOrthogonalSize=i.absoluteOrthogonalSize,this.splitview.layout(i.orthogonalSize,{orthogonalSize:e,absoluteOffset:this._absoluteOrthogonalOffset,absoluteOrthogonalOffset:this._absoluteOffset,absoluteSize:i.absoluteOrthogonalSize,absoluteOrthogonalSize:i.absoluteSize}),this.updateSplitviewEdgeSnappingEnablement()}}setVisible(e){for(const t of this.children)t.setVisible(e)}addChild(e,t,i,o){i=ht(i,this.children.length),this.splitview.addView(e,t,i,o),this.children.splice(i,0,e),this.updateBoundarySashes(),this.onDidChildrenChange()}removeChild(e,t){e=ht(e,this.children.length),this.splitview.removeView(e,t),this.children.splice(e,1),this.updateBoundarySashes(),this.onDidChildrenChange()}moveChild(e,t){e=ht(e,this.children.length),t=ht(t,this.children.length),e!==t&&(e<t&&(t-=1),this.splitview.moveView(e,t),this.children.splice(t,0,this.children.splice(e,1)[0]),this.updateBoundarySashes(),this.onDidChildrenChange())}swapChildren(e,t){e=ht(e,this.children.length),t=ht(t,this.children.length),e!==t&&(this.splitview.swapViews(e,t),[this.children[e].boundarySashes,this.children[t].boundarySashes]=[this.children[e].boundarySashes,this.children[t].boundarySashes],[this.children[e],this.children[t]]=[this.children[t],this.children[e]],this.onDidChildrenChange())}resizeChild(e,t){e=ht(e,this.children.length),this.splitview.resizeView(e,t)}isChildSizeMaximized(e){return this.splitview.isViewSizeMaximized(e)}distributeViewSizes(e=!1){if(this.splitview.distributeViewSizes(),e)for(const t of this.children)t instanceof ce&&t.distributeViewSizes(!0)}getChildSize(e){return e=ht(e,this.children.length),this.splitview.getViewSize(e)}isChildVisible(e){return e=ht(e,this.children.length),this.splitview.isViewVisible(e)}setChildVisible(e,t){e=ht(e,this.children.length),this.splitview.isViewVisible(e)!==t&&this.splitview.setViewVisible(e,t)}getChildCachedVisibleSize(e){return e=ht(e,this.children.length),this.splitview.getViewCachedVisibleSize(e)}updateBoundarySashes(){for(let e=0;e<this.children.length;e++)this.children[e].boundarySashes={start:this.boundarySashes.orthogonalStart,end:this.boundarySashes.orthogonalEnd,orthogonalStart:e===0?this.boundarySashes.start:this.splitview.sashes[e-1],orthogonalEnd:e===this.children.length-1?this.boundarySashes.end:this.splitview.sashes[e]}}onDidChildrenChange(){this.updateChildrenEvents(),this._onDidChange.fire(void 0)}updateChildrenEvents(){const e=A.map(A.any(...this.children.map(o=>o.onDidChange)),()=>{});this.childrenChangeDisposable.dispose(),this.childrenChangeDisposable=e(this._onDidChange.fire,this._onDidChange);const t=A.any(...this.children.map((o,s)=>A.map(o.onDidSashReset,n=>[s,...n])));this.childrenSashResetDisposable.dispose(),this.childrenSashResetDisposable=t(this._onDidSashReset.fire,this._onDidSashReset);const i=A.any(A.signal(this.splitview.onDidScroll),...this.children.map(o=>o.onDidScroll));this.onDidScrollDisposable.dispose(),this.onDidScrollDisposable=i(this._onDidScroll.fire,this._onDidScroll)}trySet2x2(e){if(this.children.length!==2||e.children.length!==2)return V.None;if(this.getChildSize(0)!==e.getChildSize(0))return V.None;const[t,i]=this.children,[o,s]=e.children;if(!(t instanceof xe)||!(i instanceof xe))return V.None;if(!(o instanceof xe)||!(s instanceof xe))return V.None;this.orientation===0?(i.linkedWidthNode=o.linkedHeightNode=t,t.linkedWidthNode=s.linkedHeightNode=i,s.linkedWidthNode=t.linkedHeightNode=o,o.linkedWidthNode=i.linkedHeightNode=s):(o.linkedWidthNode=i.linkedHeightNode=t,s.linkedWidthNode=t.linkedHeightNode=i,t.linkedWidthNode=s.linkedHeightNode=o,i.linkedWidthNode=o.linkedHeightNode=s);const n=this.splitview.sashes[0],r=e.splitview.sashes[0];return n.linkedSash=r,r.linkedSash=n,this._onDidChange.fire(void 0),e._onDidChange.fire(void 0),Y(()=>{n.linkedSash=r.linkedSash=void 0,t.linkedHeightNode=t.linkedWidthNode=void 0,i.linkedHeightNode=i.linkedWidthNode=void 0,o.linkedHeightNode=o.linkedWidthNode=void 0,s.linkedHeightNode=s.linkedWidthNode=void 0})}updateSplitviewEdgeSnappingEnablement(){this.splitview.startSnappingEnabled=this._edgeSnapping||this._absoluteOrthogonalOffset>0,this.splitview.endSnappingEnabled=this._edgeSnapping||this._absoluteOrthogonalOffset+this._size<this.absoluteOrthogonalSize}dispose(){for(const e of this.children)e.dispose();this._onDidChange.dispose(),this._onDidSashReset.dispose(),this.splitviewSashResetDisposable.dispose(),this.childrenSashResetDisposable.dispose(),this.childrenChangeDisposable.dispose(),this.splitview.dispose()}}function hy(c){const[e,t]=A.split(c.onDidChange,Ai);return A.any(t,A.map(A.latch(A.map(e,i=>[c.minimumWidth,c.maximumWidth,c.minimumHeight,c.maximumHeight]),wi),i=>{}))}class xe{get size(){return this._size}get orthogonalSize(){return this._orthogonalSize}get linkedWidthNode(){return this._linkedWidthNode}set linkedWidthNode(e){this._onDidLinkedWidthNodeChange.input=e?e._onDidViewChange:A.None,this._linkedWidthNode=e,this._onDidSetLinkedNode.fire(void 0)}get linkedHeightNode(){return this._linkedHeightNode}set linkedHeightNode(e){this._onDidLinkedHeightNodeChange.input=e?e._onDidViewChange:A.None,this._linkedHeightNode=e,this._onDidSetLinkedNode.fire(void 0)}constructor(e,t,i,o,s=0){this.view=e,this.orientation=t,this.layoutController=i,this._size=0,this.absoluteOffset=0,this.absoluteOrthogonalOffset=0,this.onDidScroll=A.None,this.onDidSashReset=A.None,this._onDidLinkedWidthNodeChange=new qt,this._linkedWidthNode=void 0,this._onDidLinkedHeightNodeChange=new qt,this._linkedHeightNode=void 0,this._onDidSetLinkedNode=new w,this.disposables=new x,this._boundarySashes={},this.cachedWidth=0,this.cachedHeight=0,this.cachedTop=0,this.cachedLeft=0,this._orthogonalSize=o,this._size=s;const n=hy(e);this._onDidViewChange=A.map(n,r=>r&&(this.orientation===0?r.width:r.height),this.disposables),this.onDidChange=A.any(this._onDidViewChange,this._onDidSetLinkedNode.event,this._onDidLinkedWidthNodeChange.event,this._onDidLinkedHeightNodeChange.event)}get width(){return this.orientation===1?this.orthogonalSize:this.size}get height(){return this.orientation===1?this.size:this.orthogonalSize}get top(){return this.orientation===1?this.absoluteOffset:this.absoluteOrthogonalOffset}get left(){return this.orientation===1?this.absoluteOrthogonalOffset:this.absoluteOffset}get element(){return this.view.element}get minimumWidth(){return this.linkedWidthNode?Math.max(this.linkedWidthNode.view.minimumWidth,this.view.minimumWidth):this.view.minimumWidth}get maximumWidth(){return this.linkedWidthNode?Math.min(this.linkedWidthNode.view.maximumWidth,this.view.maximumWidth):this.view.maximumWidth}get minimumHeight(){return this.linkedHeightNode?Math.max(this.linkedHeightNode.view.minimumHeight,this.view.minimumHeight):this.view.minimumHeight}get maximumHeight(){return this.linkedHeightNode?Math.min(this.linkedHeightNode.view.maximumHeight,this.view.maximumHeight):this.view.maximumHeight}get minimumSize(){return this.orientation===1?this.minimumHeight:this.minimumWidth}get maximumSize(){return this.orientation===1?this.maximumHeight:this.maximumWidth}get priority(){return this.view.priority}get proportionalLayout(){return this.view.proportionalLayout??!0}get snap(){return this.view.snap}get minimumOrthogonalSize(){return this.orientation===1?this.minimumWidth:this.minimumHeight}get maximumOrthogonalSize(){return this.orientation===1?this.maximumWidth:this.maximumHeight}get boundarySashes(){return this._boundarySashes}set boundarySashes(e){var t,i;this._boundarySashes=e,(i=(t=this.view).setBoundarySashes)==null||i.call(t,cy(e,this.orientation))}layout(e,t,i){if(this.layoutController.isLayoutEnabled){if(typeof i>"u")throw new Error("Invalid state");this._size=e,this._orthogonalSize=i.orthogonalSize,this.absoluteOffset=i.absoluteOffset+t,this.absoluteOrthogonalOffset=i.absoluteOrthogonalOffset,this._layout(this.width,this.height,this.top,this.left)}}_layout(e,t,i,o){this.cachedWidth===e&&this.cachedHeight===t&&this.cachedTop===i&&this.cachedLeft===o||(this.cachedWidth=e,this.cachedHeight=t,this.cachedTop=i,this.cachedLeft=o,this.view.layout(e,t,i,o))}setVisible(e){var t,i;(i=(t=this.view).setVisible)==null||i.call(t,e)}dispose(){this.disposables.dispose()}}function Wu(c,e,t){if(c instanceof ce){const i=new ce(xt(c.orientation),c.layoutController,c.styles,c.splitviewProportionalLayout,e,t,c.edgeSnapping);let o=0;for(let s=c.children.length-1;s>=0;s--){const n=c.children[s],r=n instanceof ce?n.orthogonalSize:n.size;let a=c.size===0?0:Math.round(e*r/c.size);o+=a,s===0&&(a+=e-o),i.addChild(Wu(n,t,a),a,0,!0)}return i}else return new xe(c.view,xt(c.orientation),c.layoutController,t)}class ro{get root(){return this._root}set root(e){const t=this._root;t&&(this.element.removeChild(t.element),t.dispose()),this._root=e,this.element.appendChild(e.element),this.onDidSashResetRelay.input=e.onDidSashReset,this._onDidChange.input=A.map(e.onDidChange,()=>{}),this._onDidScroll.input=e.onDidScroll}get width(){return this.root.width}get height(){return this.root.height}get minimumWidth(){return this.root.minimumWidth}get minimumHeight(){return this.root.minimumHeight}get maximumWidth(){return this.root.maximumHeight}get maximumHeight(){return this.root.maximumHeight}get orientation(){return this._root.orientation}get boundarySashes(){return this._boundarySashes}set orientation(e){if(this._root.orientation===e)return;const{size:t,orthogonalSize:i,absoluteOffset:o,absoluteOrthogonalOffset:s}=this._root;this.root=Wu(this._root,i,t),this.root.layout(t,0,{orthogonalSize:i,absoluteOffset:s,absoluteOrthogonalOffset:o,absoluteSize:t,absoluteOrthogonalSize:i}),this.boundarySashes=this.boundarySashes}set boundarySashes(e){this._boundarySashes=e,this.root.boundarySashes=dy(e,this.orientation)}set edgeSnapping(e){this.root.edgeSnapping=e}constructor(e={}){this.onDidSashResetRelay=new qt,this._onDidScroll=new qt,this._onDidChange=new qt,this._boundarySashes={},this.disposable2x2=V.None,this.onDidSashReset=this.onDidSashResetRelay.event,this.onDidScroll=this._onDidScroll.event,this.onDidChange=this._onDidChange.event,this.element=z(".monaco-grid-view"),this.styles=e.styles||ry,this.proportionalLayout=typeof e.proportionalLayout<"u"?!!e.proportionalLayout:!0,this.layoutController=new ay(!1),this.root=new ce(0,this.layoutController,this.styles,this.proportionalLayout)}style(e){this.styles=e,this.root.style(e)}layout(e,t,i=0,o=0){this.layoutController.isLayoutEnabled=!0;const[s,n,r,a]=this.root.orientation===1?[t,e,i,o]:[e,t,o,i];this.root.layout(s,0,{orthogonalSize:n,absoluteOffset:r,absoluteOrthogonalOffset:a,absoluteSize:s,absoluteOrthogonalSize:n})}addView(e,t,i){this.disposable2x2.dispose(),this.disposable2x2=V.None;const[o,s]=be(i),[n,r]=this.getNode(o);if(r instanceof ce){const a=new xe(e,xt(r.orientation),this.layoutController,r.orthogonalSize);r.addChild(a,t,s)}else{const[,a]=be(n),[,d]=be(o);let l=0;const p=a.getChildCachedVisibleSize(d);typeof p=="number"&&(l=Je.Invisible(p)),a.removeChild(d);const g=new ce(r.orientation,r.layoutController,this.styles,this.proportionalLayout,r.size,r.orthogonalSize,a.edgeSnapping);a.addChild(g,r.size,d);const f=new xe(r.view,a.orientation,this.layoutController,r.size);g.addChild(f,l,0),typeof t!="number"&&t.type==="split"&&(t=Je.Split(0));const b=new xe(e,a.orientation,this.layoutController,r.size);g.addChild(b,t,s)}this.trySet2x2()}removeView(e,t){this.disposable2x2.dispose(),this.disposable2x2=V.None;const[i,o]=be(e),[s,n]=this.getNode(i);if(!(n instanceof ce))throw new Error("Invalid location");const r=n.children[o];if(!(r instanceof xe))throw new Error("Invalid location");if(n.removeChild(o,t),n.children.length===0)throw new Error("Invalid grid state");if(n.children.length>1)return this.trySet2x2(),r.view;if(s.length===0){const f=n.children[0];return f instanceof xe||(n.removeChild(0),this.root=f,this.boundarySashes=this.boundarySashes,this.trySet2x2()),r.view}const[,a]=be(s),[,d]=be(i),l=n.children[0],p=n.isChildVisible(0);n.removeChild(0);const g=a.children.map((f,b)=>a.getChildSize(b));if(a.removeChild(d,t),l instanceof ce){g.splice(d,1,...l.children.map(f=>f.size));for(let f=0;f<l.children.length;f++){const b=l.children[f];a.addChild(b,b.size,d+f)}}else{const f=new xe(l.view,xt(l.orientation),this.layoutController,l.size),b=p?l.orthogonalSize:Je.Invisible(l.orthogonalSize);a.addChild(f,b,d)}for(let f=0;f<g.length;f++)a.resizeChild(f,g[f]);return this.trySet2x2(),r.view}moveView(e,t,i){const[,o]=this.getNode(e);if(!(o instanceof ce))throw new Error("Invalid location");o.moveChild(t,i),this.trySet2x2()}swapViews(e,t){const[i,o]=be(e),[,s]=this.getNode(i);if(!(s instanceof ce))throw new Error("Invalid from location");const n=s.getChildSize(o),r=s.children[o];if(!(r instanceof xe))throw new Error("Invalid from location");const[a,d]=be(t),[,l]=this.getNode(a);if(!(l instanceof ce))throw new Error("Invalid to location");const p=l.getChildSize(d),g=l.children[d];if(!(g instanceof xe))throw new Error("Invalid to location");s===l?s.swapChildren(o,d):(s.removeChild(o),l.removeChild(d),s.addChild(g,n,o),l.addChild(r,p,d)),this.trySet2x2()}resizeView(e,t){const[i,o]=be(e),[s,n]=this.getNode(i);if(!(n instanceof ce))throw new Error("Invalid location");if(!t.width&&!t.height)return;const[r,a]=n.orientation===1?[t.width,t.height]:[t.height,t.width];if(typeof a=="number"&&s.length>0){const[,d]=be(s),[,l]=be(i);d.resizeChild(l,a)}typeof r=="number"&&n.resizeChild(o,r),this.trySet2x2()}getViewSize(e){if(!e)return{width:this.root.width,height:this.root.height};const[,t]=this.getNode(e);return{width:t.width,height:t.height}}getViewCachedVisibleSize(e){const[t,i]=be(e),[,o]=this.getNode(t);if(!(o instanceof ce))throw new Error("Invalid location");return o.getChildCachedVisibleSize(i)}maximizeViewSize(e){const[t,i]=this.getNode(e);if(!(i instanceof xe))throw new Error("Invalid location");for(let o=0;o<t.length;o++)t[o].resizeChild(e[o],Number.POSITIVE_INFINITY)}isViewSizeMaximized(e){const[t,i]=this.getNode(e);if(!(i instanceof xe))throw new Error("Invalid location");for(let o=0;o<t.length;o++)if(!t[o].isChildSizeMaximized(e[o]))return!1;return!0}distributeViewSizes(e){if(!e){this.root.distributeViewSizes(!0);return}const[,t]=this.getNode(e);if(!(t instanceof ce))throw new Error("Invalid location");t.distributeViewSizes(),this.trySet2x2()}isViewVisible(e){const[t,i]=be(e),[,o]=this.getNode(t);if(!(o instanceof ce))throw new Error("Invalid from location");return o.isChildVisible(i)}setViewVisible(e,t){const[i,o]=be(e),[,s]=this.getNode(i);if(!(s instanceof ce))throw new Error("Invalid from location");s.setChildVisible(o,t)}getView(e){const t=e?this.getNode(e)[1]:this._root;return this._getViews(t,this.orientation)}static deserialize(e,t,i={}){var r;if(typeof e.orientation!="number")throw new Error("Invalid JSON: 'orientation' property must be a number.");if(typeof e.width!="number")throw new Error("Invalid JSON: 'width' property must be a number.");if(typeof e.height!="number")throw new Error("Invalid JSON: 'height' property must be a number.");if(((r=e.root)==null?void 0:r.type)!=="branch")throw new Error("Invalid JSON: 'root' property must have 'type' value of branch.");const o=e.orientation,s=e.height,n=new ro(i);return n._deserialize(e.root,o,t,s),n}_deserialize(e,t,i,o){this.root=this._deserializeNode(e,t,i,o)}_deserializeNode(e,t,i,o){let s;if(e.type==="branch"){const r=e.data.map(a=>({node:this._deserializeNode(a,xt(t),i,e.size),visible:a.visible}));s=new ce(t,this.layoutController,this.styles,this.proportionalLayout,e.size,o,void 0,r)}else s=new xe(i.fromJSON(e.data),t,this.layoutController,o,e.size);return s}_getViews(e,t,i){const o={top:e.top,left:e.left,width:e.width,height:e.height};if(e instanceof xe)return{view:e.view,box:o,cachedVisibleSize:i};const s=[];for(let n=0;n<e.children.length;n++){const r=e.children[n],a=e.getChildCachedVisibleSize(n);s.push(this._getViews(r,xt(t),a))}return{children:s,box:o}}getNode(e,t=this.root,i=[]){if(e.length===0)return[i,t];if(!(t instanceof ce))throw new Error("Invalid location");const[o,...s]=e;if(o<0||o>=t.children.length)throw new Error("Invalid location");const n=t.children[o];return i.push(t),this.getNode(s,n,i)}trySet2x2(){if(this.disposable2x2.dispose(),this.disposable2x2=V.None,this.root.children.length!==2)return;const[e,t]=this.root.children;!(e instanceof ce)||!(t instanceof ce)||(this.disposable2x2=e.trySet2x2(t))}getViewMap(e,t){t||(t=this.root),t instanceof ce?t.children.forEach(i=>this.getViewMap(e,i)):e.set(t.view,t.element)}dispose(){this.onDidSashResetRelay.dispose(),this.root.dispose(),this.element&&this.element.parentElement&&this.element.parentElement.removeChild(this.element)}}function ly(c){switch(c){case 0:return 1;case 1:return 0;case 2:return 3;case 3:return 2}}function Mi(c){return!!c.children}function Hu(c,e){if(e.length===0)return c;if(!Mi(c))throw new Error("Invalid location");const[t,...i]=e;return Hu(c.children[t],i)}function uy(c,e){return!(c.start>=e.end||e.start>=c.end)}function Gu(c,e){const t=sd(e),i=e===0?c.top:e===3?c.left+c.width:e===1?c.top+c.height:c.left,o={start:t===1?c.top:c.left,end:t===1?c.top+c.height:c.left+c.width};return{offset:i,range:o}}function py(c,e,t){const i=[];function o(s,n,r){if(Mi(s))for(const a of s.children)o(a,n,r);else{const{offset:a,range:d}=Gu(s.box,n);a===r.offset&&uy(d,r.range)&&i.push(s)}}return o(c,e,t),i}function ra(c,e){return e.length%2===0?xt(c):c}function sd(c){return c===0||c===1?0:1}function gh(c,e,t){const i=ra(c,e),o=sd(t);if(i===o){let[s,n]=be(e);return(t===3||t===1)&&(n+=1),[...s,n]}else{const s=t===3||t===1?1:0;return[...e,s]}}function gy(c){const e=c.parentElement;if(!e)throw new Error("Invalid grid element");let t=e.firstElementChild,i=0;for(;t!==c&&t!==e.lastElementChild&&t;)t=t.nextElementSibling,i++;return i}function Uu(c){const e=c.parentElement;if(!e)throw new Error("Invalid grid element");if(/\bmonaco-grid-view\b/.test(e.className))return[];const t=gy(e),i=e.parentElement.parentElement.parentElement.parentElement;return[...Uu(i),t]}var ao;(function(c){c.Distribute={type:"distribute"},c.Split={type:"split"},c.Auto={type:"auto"};function e(t){return{type:"invisible",cachedVisibleSize:t}}c.Invisible=e})(ao||(ao={}));class fy extends V{get orientation(){return this.gridview.orientation}set orientation(e){this.gridview.orientation=e}get width(){return this.gridview.width}get height(){return this.gridview.height}get minimumWidth(){return this.gridview.minimumWidth}get minimumHeight(){return this.gridview.minimumHeight}get maximumWidth(){return this.gridview.maximumWidth}get maximumHeight(){return this.gridview.maximumHeight}get boundarySashes(){return this.gridview.boundarySashes}set boundarySashes(e){this.gridview.boundarySashes=e}set edgeSnapping(e){this.gridview.edgeSnapping=e}get element(){return this.gridview.element}constructor(e,t={}){super(),this.views=new Map,this.didLayout=!1,e instanceof ro?(this.gridview=e,this.gridview.getViewMap(this.views)):this.gridview=new ro(t),this._register(this.gridview),this._register(this.gridview.onDidSashReset(this.onDidSashReset,this)),e instanceof ro||this._addView(e,0,[0]),this.onDidChange=this.gridview.onDidChange,this.onDidScroll=this.gridview.onDidScroll}style(e){this.gridview.style(e)}layout(e,t,i=0,o=0){this.gridview.layout(e,t,i,o),this.didLayout=!0}addView(e,t,i,o){if(this.views.has(e))throw new Error("Can't add same view twice");const s=sd(o);this.views.size===1&&this.orientation!==s&&(this.orientation=s);const n=this.getViewLocation(i),r=gh(this.gridview.orientation,n,o);let a;if(typeof t=="number")a=t;else if(t.type==="split"){const[,d]=be(n);a=Je.Split(d)}else if(t.type==="distribute")a=Je.Distribute;else if(t.type==="auto"){const[,d]=be(n);a=Je.Auto(d)}else a=t;this._addView(e,a,r)}addViewAt(e,t,i){if(this.views.has(e))throw new Error("Can't add same view twice");let o;typeof t=="number"?o=t:t.type==="distribute"?o=Je.Distribute:o=t,this._addView(e,o,i)}_addView(e,t,i){this.views.set(e,e.element),this.gridview.addView(e,t,i)}removeView(e,t){if(this.views.size===1)throw new Error("Can't remove last view");const i=this.getViewLocation(e);let o;(t==null?void 0:t.type)==="distribute"?o=Je.Distribute:(t==null?void 0:t.type)==="auto"&&(o=Je.Auto(0)),this.gridview.removeView(i,o),this.views.delete(e)}moveView(e,t,i,o){const s=this.getViewLocation(e),[n,r]=be(s),a=this.getViewLocation(i),d=gh(this.gridview.orientation,a,o),[l,p]=be(d);wi(n,l)?this.gridview.moveView(n,r,p):(this.removeView(e,typeof t=="number"?void 0:t),this.addView(e,t,i,o))}moveViewTo(e,t){const i=this.getViewLocation(e),[o,s]=be(i),[n,r]=be(t);if(wi(o,n))this.gridview.moveView(o,s,r);else{const a=this.getViewSize(e),d=ra(this.gridview.orientation,i),l=this.getViewCachedVisibleSize(e),p=typeof l>"u"?d===1?a.width:a.height:ao.Invisible(l);this.removeView(e),this.addViewAt(e,p,t)}}swapViews(e,t){const i=this.getViewLocation(e),o=this.getViewLocation(t);return this.gridview.swapViews(i,o)}resizeView(e,t){const i=this.getViewLocation(e);return this.gridview.resizeView(i,t)}isViewSizeMaximized(e){const t=this.getViewLocation(e);return this.gridview.isViewSizeMaximized(t)}getViewSize(e){if(!e)return this.gridview.getViewSize();const t=this.getViewLocation(e);return this.gridview.getViewSize(t)}getViewCachedVisibleSize(e){const t=this.getViewLocation(e);return this.gridview.getViewCachedVisibleSize(t)}maximizeViewSize(e){const t=this.getViewLocation(e);this.gridview.maximizeViewSize(t)}distributeViewSizes(){this.gridview.distributeViewSizes()}isViewVisible(e){const t=this.getViewLocation(e);return this.gridview.isViewVisible(t)}setViewVisible(e,t){const i=this.getViewLocation(e);this.gridview.setViewVisible(i,t)}getViews(){return this.gridview.getView()}getNeighborViews(e,t,i=!1){if(!this.didLayout)throw new Error("Can't call getNeighborViews before first layout");const o=this.getViewLocation(e),s=this.getViews(),n=Hu(s,o);let r=Gu(n.box,t);return i&&(t===0&&n.box.top===0?r={offset:s.box.top+s.box.height,range:r.range}:t===3&&n.box.left+n.box.width===s.box.width?r={offset:0,range:r.range}:t===1&&n.box.top+n.box.height===s.box.height?r={offset:0,range:r.range}:t===2&&n.box.left===0&&(r={offset:s.box.left+s.box.width,range:r.range})),py(s,ly(t),r).map(a=>a.view)}getViewLocation(e){const t=this.views.get(e);if(!t)throw new Error("View not found");return Uu(t)}onDidSashReset(e){const t=s=>{const n=this.gridview.getView(s);if(Mi(n))return!1;const r=ra(this.orientation,s),a=r===1?n.view.preferredWidth:n.view.preferredHeight;if(typeof a!="number")return!1;const d=r===1?{width:Math.round(a)}:{height:Math.round(a)};return this.gridview.resizeView(s,d),!0};if(t(e))return;const[i,o]=be(e);t([...i,o+1])||this.gridview.distributeViewSizes(i)}}class Oi extends fy{constructor(){super(...arguments),this.initialLayoutContext=!0}static serializeNode(e,t){const i=t===0?e.box.width:e.box.height;return Mi(e)?{type:"branch",data:e.children.map(o=>Oi.serializeNode(o,xt(t))),size:i}:typeof e.cachedVisibleSize=="number"?{type:"leaf",data:e.view.toJSON(),size:e.cachedVisibleSize,visible:!1}:{type:"leaf",data:e.view.toJSON(),size:i}}static deserialize(e,t,i={}){if(typeof e.orientation!="number")throw new Error("Invalid JSON: 'orientation' property must be a number.");if(typeof e.width!="number")throw new Error("Invalid JSON: 'width' property must be a number.");if(typeof e.height!="number")throw new Error("Invalid JSON: 'height' property must be a number.");const o=ro.deserialize(e,t,i);return new Oi(o,i)}static from(e,t={}){return Oi.deserialize(ju(e),{fromJSON:i=>i},t)}serialize(){return{root:Oi.serializeNode(this.getViews(),this.orientation),orientation:this.orientation,width:this.width,height:this.height}}layout(e,t,i=0,o=0){super.layout(e,t,i,o),this.initialLayoutContext&&(this.initialLayoutContext=!1,this.gridview.trySet2x2())}}function zu(c){return!!c.groups}function Ku(c,e){if(!e&&c.groups&&c.groups.length<=1&&(c.groups=void 0),!zu(c))return;let t=0,i=0;for(const r of c.groups)Ku(r,!1),r.size&&(t+=r.size,i++);const o=i>0?t:1,s=c.groups.length-i,n=o/s;for(const r of c.groups)r.size||(r.size=n)}function $u(c){return zu(c)?{type:"branch",data:c.groups.map(e=>$u(e)),size:c.size}:{type:"leaf",data:c.data,size:c.size}}function qu(c,e){if(c.type==="branch"){const t=c.data.map(i=>qu(i,xt(e)));if(e===0){const i=c.size||(t.length===0?void 0:Math.max(...t.map(s=>s.width||0))),o=t.length===0?void 0:t.reduce((s,n)=>s+(n.height||0),0);return{width:i,height:o}}else{const i=t.length===0?void 0:t.reduce((s,n)=>s+(n.width||0),0),o=c.size||(t.length===0?void 0:Math.max(...t.map(s=>s.height||0)));return{width:i,height:o}}}else{const t=e===0?c.size:void 0,i=e===0?void 0:c.size;return{width:t,height:i}}}function ju(c){Ku(c,!0);const e=$u(c),{width:t,height:i}=qu(e,c.orientation);return{root:e,orientation:c.orientation,width:t||1,height:i||1}}var my='.monaco-workbench .part.editor>.content .editor-group-container{height:100%}.monaco-workbench .part.editor>.content .editor-group-container.empty{opacity:.5}.monaco-workbench .part.editor>.content .editor-group-container.empty.active,.monaco-workbench .part.editor>.content .editor-group-container.empty.dragged-over{opacity:1}.monaco-workbench .part.editor>.content:not(.empty) .editor-group-container.empty.active:focus{outline:1px solid var(--vscode-editorGroup-focusedEmptyBorder);outline-offset:-2px}.monaco-workbench .part.editor>.content.empty .editor-group-container.empty.active:focus{outline:none}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;margin:auto;max-width:290px}.monaco-workbench .part.editor>.content .editor-group-container:not(.empty)>.editor-group-watermark{display:none}.monaco-workbench .part.editor>.content:not(.empty) .editor-group-container.empty>.editor-group-watermark{height:calc(100% - 70px);max-width:200px}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.letterpress{aspect-ratio:1/1;background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjYwIDI2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWw6c3BhY2U9InByZXNlcnZlIiBzdHlsZT0iZmlsbC1ydWxlOmV2ZW5vZGQ7Y2xpcC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjEuNDE0MjEiPjxnIG9wYWNpdHk9Ii4xIj48cGF0aCBkPSJNMjU5Ljk5NiAyNDIuMDAySC0uMDAzVjE4aDI2MHYyMjRaTTUuOTk3IDI0LjAwNnYyMTEuOTkxaDI0OFYyNC4wMDZoLTI0OFoiLz48cGF0aCBkPSJNNzcgMjJoMTh2MjE2SDc3ek0xMTIgNDJoNzB2MThoLTcwek0xMTIgMTgyaDcwdjE4aC03MHpNMTI5LjQ5OCA3N2g4OHYxOGgtODh6TTEyOS40OTggMTEyaDg4djE4aC04OHpNMTI5LjQ5OCAxNDdoODh2MThoLTg4eiIvPjwvZz48L3N2Zz4=");background-position-x:center;background-repeat:no-repeat;background-size:contain;max-height:100%;width:100%}.monaco-workbench.vs-dark .part.editor>.content .editor-group-container .editor-group-watermark>.letterpress{background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjYwIDI2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWw6c3BhY2U9InByZXNlcnZlIiBzdHlsZT0iZmlsbC1ydWxlOmV2ZW5vZGQ7Y2xpcC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjEuNDE0MjEiPjxnIG9wYWNpdHk9Ii4zIj48cGF0aCBkPSJNMjU5Ljk5NiAyNDIuMDAySC0uMDAzVjE4aDI2MHYyMjRaTTUuOTk3IDI0LjAwNnYyMTEuOTkxaDI0OFYyNC4wMDZoLTI0OFoiLz48cGF0aCBkPSJNNzcgMjJoMTh2MjE2SDc3ek0xMTIgNDJoNzB2MThoLTcwek0xMTIgMTgyaDcwdjE4aC03MHpNMTI5LjQ5OCA3N2g4OHYxOGgtODh6TTEyOS40OTggMTEyaDg4djE4aC04OHpNMTI5LjQ5OCAxNDdoODh2MThoLTg4eiIvPjwvZz48L3N2Zz4=")}.monaco-workbench.hc-light .part.editor>.content .editor-group-container .editor-group-watermark>.letterpress{background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjYwIDI2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWw6c3BhY2U9InByZXNlcnZlIiBzdHlsZT0iZmlsbC1ydWxlOmV2ZW5vZGQ7Y2xpcC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjEuNDE0MjEiPjxnIGZpbGw9IiNkOWQ5ZDkiPjxwYXRoIGQ9Ik0yNTkuOTk2IDI0Mi4wMDJILS4wMDNWMThoMjYwdjIyNFpNNS45OTcgMjQuMDA2djIxMS45OTFoMjQ4VjI0LjAwNmgtMjQ4WiIvPjxwYXRoIGQ9Ik03NyAyMmgxOHYyMTZINzd6TTExMiA0Mmg3MHYxOGgtNzB6TTExMiAxODJoNzB2MThoLTcwek0xMjkuNDk4IDc3aDg4djE4aC04OHpNMTI5LjQ5OCAxMTJoODh2MThoLTg4ek0xMjkuNDk4IDE0N2g4OHYxOGgtODh6Ii8+PC9nPjwvc3ZnPg==")}.monaco-workbench.hc-black .part.editor>.content .editor-group-container .editor-group-watermark>.letterpress{background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjYwIDI2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWw6c3BhY2U9InByZXNlcnZlIiBzdHlsZT0iZmlsbC1ydWxlOmV2ZW5vZGQ7Y2xpcC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjEuNDE0MjEiPjxnIGZpbGw9IiMzQzNDM0MiPjxwYXRoIGQ9Ik0yNTkuOTk2IDI0Mi4wMDJILS4wMDNWMThoMjYwdjIyNFpNNS45OTcgMjQuMDA2djIxMS45OTFoMjQ4VjI0LjAwNmgtMjQ4WiIvPjxwYXRoIGQ9Ik03NyAyMmgxOHYyMTZINzd6TTExMiA0Mmg3MHYxOGgtNzB6TTExMiAxODJoNzB2MThoLTcwek0xMjkuNDk4IDc3aDg4djE4aC04OHpNMTI5LjQ5OCAxMTJoODh2MThoLTg4ek0xMjkuNDk4IDE0N2g4OHYxOGgtODh6Ii8+PC9nPjwvc3ZnPg==")}.monaco-workbench .part.editor>.content .editor-group-container.max-height-478px>.editor-group-watermark>.shortcuts,.monaco-workbench .part.editor>.content:not(.empty) .editor-group-container>.editor-group-watermark>.shortcuts{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts>.watermark-box{border-collapse:separate;border-spacing:11px 17px;display:inline-table}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dl{cursor:default;display:table-row;opacity:.8}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dt{letter-spacing:.04em;text-align:right}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dd{text-align:left}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dd,.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dt{display:table-cell;vertical-align:middle}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dl,.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dt{color:rgba(0,0,0,.68)}.monaco-workbench.vs-dark .part.editor>.content .editor-group-container .editor-group-watermark>.shortcuts dl,.monaco-workbench.vs-dark .part.editor>.content .editor-group-container .editor-group-watermark>.shortcuts dt{color:hsla(0,0%,100%,.6)}.monaco-workbench.hc-black .part.editor>.content .editor-group-container .editor-group-watermark>.shortcuts dt,.monaco-workbench.hc-light .part.editor>.content .editor-group-container .editor-group-watermark>.shortcuts dt{color:var(--vscode-editor-foreground)}.monaco-workbench.hc-black .part.editor>.content .editor-group-container .editor-group-watermark>.shortcuts dl,.monaco-workbench.hc-light .part.editor>.content .editor-group-container .editor-group-watermark>.shortcuts dl{color:var(--vscode-editor-foreground);opacity:1}.monaco-workbench .part.editor>.content .editor-group-container>.title{box-sizing:border-box;overflow:hidden;position:relative}.monaco-workbench .part.editor>.content .editor-group-container>.title:not(.tabs){display:flex;flex-wrap:nowrap}.monaco-workbench .part.editor>.content .editor-group-container>.title.title-border-bottom:after{background-color:var(--title-border-bottom-color);bottom:0;content:"";height:1px;left:0;pointer-events:none;position:absolute;width:100%;z-index:9}.monaco-workbench .part.editor>.content .editor-group-container.empty>.title{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-container-toolbar{display:none;height:35px}.monaco-workbench .part.editor>.content:not(.empty) .editor-group-container.empty>.editor-group-container-toolbar{display:block}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-container-toolbar .actions-container{justify-content:flex-end}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-container-toolbar .action-item{margin-right:4px}.monaco-workbench .part.editor>.content .editor-group-container.empty>.editor-container{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.editor-container>.editor-instance{height:100%}.monaco-workbench .part.editor>.content .grid-view-container{height:100%;width:100%}';he(my,{});var by='.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container{display:flex;position:relative}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container.tabs-border-bottom:after{background-color:var(--tabs-border-bottom-color);bottom:0;content:"";height:1px;left:0;pointer-events:none;position:absolute;width:100%;z-index:9}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container>.monaco-scrollable-element{flex:1}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container>.monaco-scrollable-element .scrollbar{cursor:default;z-index:11}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container{display:flex;height:35px;scrollbar-width:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.scroll{overflow:scroll!important}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container.wrapping .tabs-container{flex-wrap:wrap;height:auto}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container::-webkit-scrollbar{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab{box-sizing:border-box;cursor:pointer;display:flex;height:35px;padding-left:10px;position:relative;white-space:nowrap}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container.wrapping .tabs-container>.tab:last-child{margin-right:var(--last-tab-margin-right)}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container.wrapping .tabs-container>.tab.last-in-row:not(:last-child){border-right:0!important}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.has-icon.tab-actions-off:not(.sticky-compact),.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.has-icon.tab-actions-right,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.has-icon.tab-actions-off:not(.sticky-compact),.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.has-icon.tab-actions-right{padding-left:5px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit{flex-shrink:0;min-width:fit-content;width:120px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed{flex:1 0 0;max-width:var(--tab-sizing-current-width,var(--tab-sizing-fixed-max-width,160px));min-width:var(--tab-sizing-current-width,var(--tab-sizing-fixed-min-width,50px))}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.last-in-row{min-width:calc(var(--tab-sizing-current-width, var(--tab-sizing-fixed-min-width, 50px)) - 1px)}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container.wrapping .tabs-container>.tab.sizing-fit.last-in-row:not(:last-child){flex-grow:1}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink{flex-basis:0;flex-grow:1;max-width:fit-content;min-width:80px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit.sticky-shrink,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.sticky-shrink,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.sticky-shrink{flex-basis:0;flex-grow:0;position:sticky;z-index:8}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.sticky-compact{max-width:38px;min-width:38px;width:38px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit.sticky-shrink,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.sticky-shrink,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.sticky-shrink{max-width:80px;min-width:80px;width:80px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.disable-sticky-tabs>.tab.sizing-fit.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.disable-sticky-tabs>.tab.sizing-fit.sticky-shrink,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.disable-sticky-tabs>.tab.sizing-fixed.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.disable-sticky-tabs>.tab.sizing-fixed.sticky-shrink,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.disable-sticky-tabs>.tab.sizing-shrink.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.disable-sticky-tabs>.tab.sizing-shrink.sticky-shrink{position:static}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.tab-actions-left:after,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.tab-actions-off:after,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.tab-actions-left:after,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.tab-actions-off:after{content:"";display:flex;flex:0;width:5px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.tab-actions-left,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.tab-actions-left{min-width:80px;padding-right:5px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dragged{transform:translateZ(0)}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dragged-over div{pointer-events:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-left{flex-direction:row-reverse;padding-left:0;padding-right:10px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab>.tab-border-bottom-container,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab>.tab-border-top-container{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.active.tab-border-bottom>.tab-border-bottom-container,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.active.tab-border-top>.tab-border-top-container,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dirty-border-top>.tab-border-top-container{display:block;left:0;pointer-events:none;position:absolute;width:100%}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.active.tab-border-top>.tab-border-top-container{background-color:var(--tab-border-top-color);height:1px;top:0;z-index:6}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.active.tab-border-bottom>.tab-border-bottom-container{background-color:var(--tab-border-bottom-color);bottom:0;height:1px;z-index:10}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dirty-border-top>.tab-border-top-container{background-color:var(--tab-dirty-border-top-color);height:2px;top:0;z-index:6}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab .tab-label{line-height:35px;margin-bottom:auto;margin-top:auto}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed .tab-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink .tab-label{position:relative}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed>.tab-label>.monaco-icon-label-container:after,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink>.tab-label>.monaco-icon-label-container:after{bottom:1px;content:"";height:calc(100% - 2px);opacity:1;padding:0;position:absolute;right:0;top:1px;width:5px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed:focus>.tab-label>.monaco-icon-label-container:after,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink:focus>.tab-label>.monaco-icon-label-container:after{opacity:0}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed>.tab-label.tab-label-has-badge:after,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink>.tab-label.tab-label-has-badge:after{padding-right:5px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sticky-compact:not(.has-icon) .monaco-icon-label{text-align:center}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit .monaco-icon-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit .monaco-icon-label>.monaco-icon-label-container{overflow:visible}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed>.monaco-icon-label>.monaco-icon-label-container,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink>.monaco-icon-label>.monaco-icon-label-container{flex:none;text-overflow:clip}.monaco-workbench.hc-black .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed>.monaco-icon-label>.monaco-icon-label-container,.monaco-workbench.hc-black .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink>.monaco-icon-label>.monaco-icon-label-container,.monaco-workbench.hc-light .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed>.monaco-icon-label>.monaco-icon-label-container,.monaco-workbench.hc-light .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink>.monaco-icon-label>.monaco-icon-label-container{text-overflow:ellipsis}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab>.tab-actions{margin-bottom:auto;margin-top:auto;width:28px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab>.tab-actions>.monaco-action-bar{width:28px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-right.sizing-fixed>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-right.sizing-shrink>.tab-actions{flex:0;overflow:hidden}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dirty.tab-actions-right.sizing-fixed>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dirty.tab-actions-right.sizing-shrink>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sticky.tab-actions-right.sizing-fixed>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sticky.tab-actions-right.sizing-shrink>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-right.sizing-fixed:hover>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-right.sizing-fixed>.tab-actions:focus-within,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-right.sizing-shrink:hover>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-right.sizing-shrink>.tab-actions:focus-within{overflow:visible}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off.sticky-compact>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off:not(.dirty):not(.sticky)>.tab-actions{display:none}.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab.active:hover>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab.active>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab.dirty>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab.sticky>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab:hover>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab>.tab-actions .action-label:focus{opacity:1}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab>.tab-actions .actions-container{justify-content:center}.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab>.tab-actions .action-label.codicon{color:inherit;font-size:16px;height:16px;padding:2px;width:16px}.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab.sticky.dirty>.tab-actions .action-label:not(:hover):before,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sticky.dirty>.tab-actions .action-label:not(:hover):before{content:"\\ebb2"}.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab.dirty>.tab-actions .action-label:not(:hover):before,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dirty>.tab-actions .action-label:not(:hover):before{content:"\\ea71"}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.active:hover>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.active>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dirty>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sticky>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab:hover>.tab-actions .action-label{opacity:.5}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab>.tab-actions .action-label{opacity:0}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off{padding-right:10px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.tab-actions-off:not(.sticky-compact),.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.tab-actions-off:not(.sticky-compact){padding-right:5px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off.dirty-border-top>.tab-actions{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off.dirty:not(.dirty-border-top):not(.sticky-compact),.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off.sticky:not(.sticky-compact){padding-right:0}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off>.tab-actions{pointer-events:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control{cursor:default;flex:1 100%;height:22px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .monaco-icon-label{height:22px;line-height:22px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .monaco-icon-label:before{height:22px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .outline-element-icon{height:22px;line-height:22px;padding-right:3px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item{max-width:80%}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item:before{align-items:center;display:flex;height:22px;justify-content:center;width:16px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item:last-child{padding-right:8px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item:last-child .codicon:last-child{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .editor-actions{cursor:default;flex:initial;height:35px;padding:0 8px 0 4px}.monaco-workbench .part.editor>.content .editor-group-container>.title .editor-actions .action-item{margin-right:4px}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container.wrapping .editor-actions{bottom:0;position:absolute;right:0}';he(by,{});var vy=".monaco-workbench .part.editor>.content .editor-group-container>.title{cursor:pointer}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab .tab-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .title-label{flex:1;white-space:nowrap}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab .tab-label a,.monaco-workbench .part.editor>.content .editor-group-container>.title .title-label a{font-size:13px}.monaco-workbench .part.editor>.content .editor-group-container>.title .monaco-icon-label:before,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab .monaco-icon-label:before,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab .tab-label a,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab .tab-label span,.monaco-workbench .part.editor>.content .editor-group-container>.title .title-label a,.monaco-workbench .part.editor>.content .editor-group-container>.title .title-label h2{cursor:pointer}.monaco-workbench .part.editor>.content .editor-group-container>.title .monaco-icon-label:before{height:35px}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .monaco-icon-label:after,.monaco-workbench .part.editor>.content .editor-group-container>.title.tabs .monaco-icon-label:after{margin-right:0}.monaco-editor-group-drag-image{border-radius:10px;display:inline-block;font-size:12px;padding:1px 7px;position:absolute}";he(vy,{});class nd{dispose(){}}class wy{constructor(e,t,i,o){this._disposables=new x,this._onDidSelectItem=new w,this._onDidFocusItem=new w,this._onDidChangeFocus=new w,this.onDidSelectItem=this._onDidSelectItem.event,this.onDidFocusItem=this._onDidFocusItem.event,this.onDidChangeFocus=this._onDidChangeFocus.event,this._items=new Array,this._nodes=new Array,this._freeNodes=new Array,this._enabled=!0,this._focusedItemIdx=-1,this._selectedItemIdx=-1,this._domNode=document.createElement("div"),this._domNode.className="monaco-breadcrumbs",this._domNode.tabIndex=0,this._domNode.setAttribute("role","list"),this._scrollable=new Rb(this._domNode,{vertical:2,horizontal:1,horizontalScrollbarSize:t,useShadows:!1,scrollYToX:!0}),this._separatorIcon=i,this._disposables.add(this._scrollable),this._disposables.add(Lb(this._domNode,"click",r=>this._onClick(r))),e.appendChild(this._scrollable.getDomNode());const s=Ul(this._domNode);this._style(s,o);const n=bi(this._domNode);this._disposables.add(n),this._disposables.add(n.onDidBlur(r=>this._onDidChangeFocus.fire(!1))),this._disposables.add(n.onDidFocus(r=>this._onDidChangeFocus.fire(!0)))}setHorizontalScrollbarSize(e){this._scrollable.updateOptions({horizontalScrollbarSize:e})}dispose(){var e;this._disposables.dispose(),(e=this._pendingLayout)===null||e===void 0||e.dispose(),this._onDidSelectItem.dispose(),this._onDidFocusItem.dispose(),this._onDidChangeFocus.dispose(),this._domNode.remove(),this._nodes.length=0,this._freeNodes.length=0}layout(e){var t;e&&q.equals(e,this._dimension)||((t=this._pendingLayout)===null||t===void 0||t.dispose(),e?this._pendingLayout=this._updateDimensions(e):this._pendingLayout=this._updateScrollbar())}_updateDimensions(e){const t=new x;return t.add(Mb(()=>{this._dimension=e,this._domNode.style.width=`${e.width}px`,this._domNode.style.height=`${e.height}px`,t.add(this._updateScrollbar())})),t}_updateScrollbar(){return Hd(()=>{Hd(()=>{this._scrollable.setRevealOnScroll(!1),this._scrollable.scanDomNode(),this._scrollable.setRevealOnScroll(!0)})})}_style(e,t){let i="";t.breadcrumbsBackground&&(i+=`.monaco-breadcrumbs { background-color: ${t.breadcrumbsBackground}}`),t.breadcrumbsForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item { color: ${t.breadcrumbsForeground}}
`),t.breadcrumbsFocusForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item.focused { color: ${t.breadcrumbsFocusForeground}}
`),t.breadcrumbsFocusAndSelectionForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item.focused.selected { color: ${t.breadcrumbsFocusAndSelectionForeground}}
`),t.breadcrumbsHoverForeground&&(i+=`.monaco-breadcrumbs:not(.disabled	) .monaco-breadcrumb-item:hover:not(.focused):not(.selected) { color: ${t.breadcrumbsHoverForeground}}
`),e.innerText=i}setEnabled(e){this._enabled=e,this._domNode.classList.toggle("disabled",!this._enabled)}domFocus(){const e=this._focusedItemIdx>=0?this._focusedItemIdx:this._items.length-1;e>=0&&e<this._items.length?this._focus(e,void 0):this._domNode.focus()}isDOMFocused(){let e=document.activeElement;for(;e;){if(this._domNode===e)return!0;e=e.parentElement}return!1}getFocused(){return this._items[this._focusedItemIdx]}setFocused(e,t){this._focus(this._items.indexOf(e),t)}focusPrev(e){this._focusedItemIdx>0&&this._focus(this._focusedItemIdx-1,e)}focusNext(e){this._focusedItemIdx+1<this._nodes.length&&this._focus(this._focusedItemIdx+1,e)}_focus(e,t){this._focusedItemIdx=-1;for(let i=0;i<this._nodes.length;i++){const o=this._nodes[i];i!==e?o.classList.remove("focused"):(this._focusedItemIdx=i,o.classList.add("focused"),o.focus())}this._reveal(this._focusedItemIdx,!0),this._onDidFocusItem.fire({type:"focus",item:this._items[this._focusedItemIdx],node:this._nodes[this._focusedItemIdx],payload:t})}reveal(e){const t=this._items.indexOf(e);t>=0&&this._reveal(t,!1)}revealLast(){this._reveal(this._items.length-1,!1)}_reveal(e,t){if(e<0||e>=this._nodes.length)return;const i=this._nodes[e];if(!i)return;const{width:o}=this._scrollable.getScrollDimensions(),{scrollLeft:s}=this._scrollable.getScrollPosition();(!t||i.offsetLeft>s+o||i.offsetLeft<s)&&(this._scrollable.setRevealOnScroll(!1),this._scrollable.setScrollPosition({scrollLeft:i.offsetLeft}),this._scrollable.setRevealOnScroll(!0))}getSelection(){return this._items[this._selectedItemIdx]}setSelection(e,t){this._select(this._items.indexOf(e),t)}_select(e,t){this._selectedItemIdx=-1;for(let i=0;i<this._nodes.length;i++){const o=this._nodes[i];i!==e?o.classList.remove("selected"):(this._selectedItemIdx=i,o.classList.add("selected"))}this._onDidSelectItem.fire({type:"select",item:this._items[this._selectedItemIdx],node:this._nodes[this._selectedItemIdx],payload:t})}getItems(){return this._items}setItems(e){let t,i=[];try{t=Pb(this._items,e,(o,s)=>o.equals(s)),i=this._items.splice(t,this._items.length-t,...e.slice(t)),this._render(t),ie(i),this._focus(-1,void 0)}catch(o){const s=new Error(`BreadcrumbsItem#setItems: newItems: ${e.length}, prefix: ${t}, removed: ${i.length}`);throw s.name=o.name,s.stack=o.stack,s}}_render(e){let t=!1;for(;e<this._items.length&&e<this._nodes.length;e++){const i=this._items[e],o=this._nodes[e];this._renderItem(i,o),t=!0}for(;e<this._nodes.length;){const i=this._nodes.pop();i&&(this._freeNodes.push(i),i.remove(),t=!0)}for(;e<this._items.length;e++){const i=this._items[e],o=this._freeNodes.length>0?this._freeNodes.pop():document.createElement("div");o&&(this._renderItem(i,o),this._domNode.appendChild(o),this._nodes.push(o),t=!0)}t&&this.layout(void 0)}_renderItem(e,t){Jt(t),t.className="";try{e.render(t)}catch(o){t.innerText="<<RENDER ERROR>>",console.error(o)}t.tabIndex=-1,t.setAttribute("role","listitem"),t.classList.add("monaco-breadcrumb-item");const i=z(ge.asCSSSelector(this._separatorIcon));t.appendChild(i)}_onClick(e){if(this._enabled)for(let t=e.target;t;t=t.parentElement){const i=this._nodes.indexOf(t);if(i>=0){this._focus(i,e),this._select(i,e);break}}}}var yy=".monaco-workbench .part.editor>.content .editor-group-container .breadcrumbs-control.hidden{display:none}.monaco-workbench .part.editor>.content .editor-group-container .breadcrumbs-control .monaco-breadcrumb-item.focused .hint-more,.monaco-workbench .part.editor>.content .editor-group-container .breadcrumbs-control .monaco-breadcrumb-item.focused .monaco-icon-label,.monaco-workbench .part.editor>.content .editor-group-container .breadcrumbs-control .monaco-breadcrumb-item.selected .hint-more,.monaco-workbench .part.editor>.content .editor-group-container .breadcrumbs-control .monaco-breadcrumb-item.selected .monaco-icon-label{text-decoration-line:underline}.monaco-workbench .monaco-breadcrumb-item.shows-symbol-icon .codicon[class*=codicon-symbol-]{padding-right:6px}.monaco-workbench .monaco-breadcrumbs-picker .arrow{border-style:solid;position:absolute;width:0}.monaco-workbench .monaco-breadcrumbs-picker .picker-item{flex:1;line-height:22px}.monaco-workbench .monaco-breadcrumbs-picker .highlighting-tree{display:flex;flex-direction:column;height:100%;overflow:hidden}.monaco-workbench .monaco-breadcrumbs-picker .highlighting-tree>.input{box-sizing:border-box;height:36px;padding:5px 9px;position:relative}.monaco-workbench .monaco-breadcrumbs-picker .highlighting-tree>.tree{height:calc(100% - 36px)}.monaco-workbench .monaco-breadcrumbs-picker .highlighting-tree.inactive>.input{display:none}.monaco-workbench .monaco-breadcrumbs-picker .highlighting-tree.inactive>.tree{height:100%}.monaco-workbench .monaco-breadcrumbs-picker .highlighting-tree .monaco-highlighted-label .highlight{font-weight:700}";he(yy,{});class un{constructor(e,t){this.uri=e,this.kind=t}}class aa{constructor(e,t){this.element=e,this.outline=t}}let ca=class{constructor(e,t,i,o,s){this.resource=e,this._workspaceService=o,this._outlineService=s,this._disposables=new x,this._currentOutline=new Ie,this._outlineDisposables=new x,this._onDidUpdate=new w,this.onDidUpdate=this._onDidUpdate.event,this._cfgFilePath=It.FilePath.bindTo(i),this._cfgSymbolPath=It.SymbolPath.bindTo(i),this._disposables.add(this._cfgFilePath.onDidChange(n=>this._onDidUpdate.fire(this))),this._disposables.add(this._cfgSymbolPath.onDidChange(n=>this._onDidUpdate.fire(this))),this._workspaceService.onDidChangeWorkspaceFolders(this._onDidChangeWorkspaceFolders,this,this._disposables),this._fileInfo=this._initFilePathInfo(e),t&&(this._bindToEditor(t),this._disposables.add(s.onDidChange(()=>this._bindToEditor(t))),this._disposables.add(t.onDidChangeControl(()=>this._bindToEditor(t)))),this._onDidUpdate.fire(this)}dispose(){this._disposables.dispose(),this._cfgFilePath.dispose(),this._cfgSymbolPath.dispose(),this._currentOutline.dispose(),this._outlineDisposables.dispose(),this._onDidUpdate.dispose()}isRelative(){return!!this._fileInfo.folder}getElements(){let e=[];if(this._cfgFilePath.getValue()==="on"?e=e.concat(this._fileInfo.path):this._cfgFilePath.getValue()==="last"&&this._fileInfo.path.length>0&&(e=e.concat(this._fileInfo.path.slice(-1))),this._cfgSymbolPath.getValue()==="off"||!this._currentOutline.value)return e;const t=this._currentOutline.value.config.breadcrumbsDataSource.getBreadcrumbElements();for(let i=this._cfgSymbolPath.getValue()==="last"&&t.length>0?t.length-1:0;i<t.length;i++)e.push(new aa(t[i],this._currentOutline.value));return t.length===0&&!this._currentOutline.value.isEmpty&&e.push(new aa(this._currentOutline.value,this._currentOutline.value)),e}_initFilePathInfo(e){if(Fb(e,Q.untitled,Q.data))return{folder:void 0,path:[]};const t={folder:At(this._workspaceService.getWorkspaceFolder(e)),path:[]};let i=e;for(;i&&i.path!=="/"&&!(t.folder&&Re(t.folder.uri,i));){t.path.unshift(new un(i,t.path.length===0?Oe.FILE:Oe.FOLDER));const o=i.path.length;if(i=Ti(i),i.path.length===o)break}return t.folder&&this._workspaceService.getWorkbenchState()===3&&t.path.unshift(new un(t.folder.uri,Oe.ROOT_FOLDER)),t}_onDidChangeWorkspaceFolders(){this._fileInfo=this._initFilePathInfo(this.resource),this._onDidUpdate.fire(this)}_bindToEditor(e){const t=new qe;this._currentOutline.clear(),this._outlineDisposables.clear(),this._outlineDisposables.add(Y(()=>t.dispose(!0))),this._outlineService.createOutline(e,2,t.token).then(i=>{t.token.isCancellationRequested&&(i==null||i.dispose(),i=void 0),this._currentOutline.value=i,this._onDidUpdate.fire(this),i&&this._outlineDisposables.add(i.onDidChange(()=>this._onDidUpdate.fire(this)))}).catch(i=>{this._onDidUpdate.fire(this),po(i)})}};ca=C([h(2,O),h(3,ze),h(4,Rn)],ca);let pn=class{constructor(e,t,i,o,s){this.resource=t,this._instantiationService=i,this._themeService=o,this._configurationService=s,this._disposables=new x,this._fakeEvent=new UIEvent("fakeEvent"),this._onWillPickElement=new w,this.onWillPickElement=this._onWillPickElement.event,this._previewDispoables=new Ie,this._domNode=document.createElement("div"),this._domNode.className="monaco-breadcrumbs-picker show-file-icons",e.appendChild(this._domNode)}dispose(){this._disposables.dispose(),this._previewDispoables.dispose(),this._onWillPickElement.dispose(),this._domNode.remove(),setTimeout(()=>this._tree.dispose(),0)}async show(e,t,i,o,s){const r=this._themeService.getColorTheme().getColor(zl);this._arrow=document.createElement("div"),this._arrow.className="arrow",this._arrow.style.borderColor=`transparent transparent ${r?r.toString():""}`,this._domNode.appendChild(this._arrow),this._treeContainer=document.createElement("div"),this._treeContainer.style.background=r?r.toString():"",this._treeContainer.style.paddingTop="2px",this._treeContainer.style.borderRadius="3px",this._treeContainer.style.boxShadow=`0 0 8px 2px ${this._themeService.getColorTheme().getColor(Nb)}`,this._treeContainer.style.border=`1px solid ${this._themeService.getColorTheme().getColor(Bb)}`,this._domNode.appendChild(this._treeContainer),this._layoutInfo={maxHeight:t,width:i,arrowSize:o,arrowOffset:s,inputHeight:0},this._tree=this._createTree(this._treeContainer,e),this._disposables.add(this._tree.onDidOpen(async a=>{const{element:d,editorOptions:l,sideBySide:p}=a;await this._revealElement(d,{...l,preserveFocus:!1},p)})),this._disposables.add(this._tree.onDidChangeFocus(a=>{this._previewDispoables.value=this._previewElement(a.elements[0])})),this._disposables.add(this._tree.onDidChangeContentHeight(()=>{this._layout()})),this._domNode.focus();try{await this._setInput(e),this._layout()}catch(a){po(a)}}_layout(){const e=2*this._layoutInfo.arrowSize,t=Math.min(this._layoutInfo.maxHeight-e,this._tree.contentHeight),i=t+e;this._domNode.style.height=`${i}px`,this._domNode.style.width=`${this._layoutInfo.width}px`,this._arrow.style.top=`-${2*this._layoutInfo.arrowSize}px`,this._arrow.style.borderWidth=`${this._layoutInfo.arrowSize}px`,this._arrow.style.marginLeft=`${this._layoutInfo.arrowOffset}px`,this._treeContainer.style.height=`${t}px`,this._treeContainer.style.width=`${this._layoutInfo.width}px`,this._tree.layout(t,this._layoutInfo.width)}restoreViewState(){}};pn=C([h(2,I),h(3,te),h(4,O)],pn);class Cy{getHeight(e){return 22}getTemplateId(e){return"FileStat"}}class Sy{getId(e){return T.isUri(e)?e.toString():Nr(e)?e.id:Xt(e)?e.uri.toString():e.resource.toString()}}let da=class{constructor(e){this._fileService=e}hasChildren(e){return T.isUri(e)||Nr(e)||Xt(e)||e.isDirectory}async getChildren(e){if(Nr(e))return e.folders;let t;return Xt(e)?t=e.uri:T.isUri(e)?t=e:t=e.resource,(await this._fileService.resolve(t)).children??[]}};da=C([h(0,Ce)],da);let ha=class{constructor(e,t){this._labels=e,this._configService=t,this.templateId="FileStat"}renderTemplate(e){return this._labels.create(e,{supportHighlights:!0})}renderElement(e,t,i){const o=this._configService.getValue("explorer.decorations"),{element:s}=e;let n,r;Xt(s)?(n=s.uri,r=Oe.ROOT_FOLDER):(n=s.resource,r=s.isDirectory?Oe.FOLDER:Oe.FILE),i.setFile(n,{fileKind:r,hidePath:!0,fileDecorations:o,matches:Ni(e.filterData),extraClasses:["picker-item"]})}disposeTemplate(e){e.dispose()}};ha=C([h(1,O)],ha);class _y{getKeyboardNavigationLabel(e){return e.name}}class Ey{getWidgetAriaLabel(){return u("breadcrumbs","Breadcrumbs")}getAriaLabel(e){return e.name}}let la=class{constructor(e,t){this._workspaceService=e,this._cachedExpressions=new Map,this._disposables=new x;const i=It.FileExcludes.bindTo(t),o=()=>{e.getWorkspace().folders.forEach(s=>{const n=i.getValue({resource:s.uri});if(!n)return;const r={};for(const a in n){if(typeof n[a]!="boolean")continue;const d=a.indexOf("**/")!==0?Kl.join(s.uri.path,a):a;r[d]=n[a]}this._cachedExpressions.set(s.uri.toString(),Hb(r))})};o(),this._disposables.add(i),this._disposables.add(i.onDidChange(o)),this._disposables.add(e.onDidChangeWorkspaceFolders(o))}dispose(){this._disposables.dispose()}filter(e,t){if(Xt(e))return!0;const i=this._workspaceService.getWorkspaceFolder(e.resource);return!i||!this._cachedExpressions.has(i.uri.toString())?!0:!this._cachedExpressions.get(i.uri.toString())(Wb(i.uri.path,e.resource.path),Me(e.resource))}};la=C([h(0,ze),h(1,O)],la);class Dy{compare(e,t){return Xt(e)&&Xt(t)?e.index-t.index:e.isDirectory===t.isDirectory?Gb(e.name,t.name):e.isDirectory?-1:1}}let ua=class extends pn{constructor(e,t,i,o,s,n,r){super(e,t,i,o,s),this._workspaceService=n,this._editorService=r}_createTree(e){this._treeContainer.classList.add("file-icon-themable-tree"),this._treeContainer.classList.add("show-file-icons");const t=o=>{this._treeContainer.classList.toggle("align-icons-and-twisties",o.hasFileIcons&&!o.hasFolderIcons),this._treeContainer.classList.toggle("hide-arrows",o.hidesExplorerArrows===!0)};this._disposables.add(this._themeService.onDidFileIconThemeChange(t)),t(this._themeService.getFileIconTheme());const i=this._instantiationService.createInstance(Ln,gc);return this._disposables.add(i),this._instantiationService.createInstance(xs,"BreadcrumbsFilePicker",e,new Cy,[this._instantiationService.createInstance(ha,i)],this._instantiationService.createInstance(da),{multipleSelectionSupport:!1,sorter:new Dy,filter:this._instantiationService.createInstance(la),identityProvider:new Sy,keyboardNavigationLabelProvider:new _y,accessibilityProvider:this._instantiationService.createInstance(Ey),showNotFoundMessage:!1,overrideStyles:{listBackground:zl}})}async _setInput(e){const{uri:t,kind:i}=e;let o;i===Oe.ROOT_FOLDER?o=this._workspaceService.getWorkspace():o=Ti(t);const s=this._tree;await s.setInput(o);let n;for(const{element:r}of s.getNode().children)if(Xt(r)&&Re(r.uri,t)){n=r;break}else if(Re(r.resource,t)){n=r;break}n&&(s.reveal(n,.5),s.setFocus([n],this._fakeEvent)),s.domFocus()}_previewElement(e){return V.None}async _revealElement(e,t,i){return!Xt(e)&&e.isFile?(this._onWillPickElement.fire(),await this._editorService.openEditor({resource:e.resource,options:t},i?gi:void 0),!0):!1}};ua=C([h(2,I),h(3,te),h(4,O),h(5,ze),h(6,P)],ua);let pa=class{constructor(e,t,i){this.comparator=e,this._order=i.getValue(t,"breadcrumbs.symbolSortOrder")}compare(e,t){return this._order==="name"?this.comparator.compareByName(e,t):this._order==="type"?this.comparator.compareByType(e,t):this.comparator.compareByPosition(e,t)}};pa=C([h(2,To)],pa);class ky extends pn{_createTree(e,t){const{config:i}=t.outline;return this._instantiationService.createInstance(Bc,"BreadcrumbsOutlinePicker",e,i.delegate,i.renderers,i.treeDataSource,{...i.options,sorter:this._instantiationService.createInstance(pa,i.comparator,void 0),collapseByDefault:!0,expandOnlyOnTwistieClick:!0,multipleSelectionSupport:!1,showNotFoundMessage:!1})}_setInput(e){const t=e.outline.captureViewState();this.restoreViewState=()=>{t.dispose()};const i=this._tree;return i.setInput(e.outline),e.element!==e.outline&&(i.reveal(e.element,.5),i.setFocus([e.element],this._fakeEvent)),i.domFocus(),Promise.resolve()}_previewElement(e){return this._tree.getInput().preview(e)}async _revealElement(e,t,i){return this._onWillPickElement.fire(),await this._tree.getInput().reveal(e,t,i),!0}}class gn extends nd{constructor(e,t,i){super(),this.model=e,this.element=t,this.options=i,this._disposables=new x}dispose(){this._disposables.dispose()}equals(e){return e instanceof gn?this.element.element===e.element.element&&this.options.showFileIcons===e.options.showFileIcons&&this.options.showSymbolIcons===e.options.showSymbolIcons:!1}render(e){const{element:t,outline:i}=this.element;if(t===i){const r=z("span",void 0,"");e.appendChild(r);return}const o=i.config.delegate.getTemplateId(t),s=i.config.renderers.find(r=>r.templateId===o);if(!s){e.innerText="<<NO RENDERER>>";return}const n=s.renderTemplate(e);s.renderElement({element:t,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:0,collapsible:!1,collapsed:!1,visible:!0,filterData:void 0},0,n,void 0),this._disposables.add(Y(()=>{s.disposeTemplate(n)}))}}class fn extends nd{constructor(e,t,i,o){super(),this.model=e,this.element=t,this.options=i,this._labels=o,this._disposables=new x}dispose(){this._disposables.dispose()}equals(e){return e instanceof fn?Kb.isEqual(this.element.uri,e.element.uri)&&this.options.showFileIcons===e.options.showFileIcons&&this.options.showSymbolIcons===e.options.showSymbolIcons:!1}render(e){const t=this._labels.create(e);t.setFile(this.element.uri,{hidePath:!0,hideIcon:this.element.kind===Oe.FOLDER||!this.options.showFileIcons,fileKind:this.element.kind,fileDecorations:{colors:this.options.showDecorationColors,badges:!1}}),e.classList.add(Oe[this.element.kind].toLowerCase()),this._disposables.add(t)}}const xy=Ao("breadcrumb-separator",le.chevronRight,u("separatorIcon","Icon for the separator in the breadcrumbs."));let B=class Wt{constructor(e,t,i,o,s,n,r,a,d,l,p,g){this._options=t,this._editorGroup=i,this._contextKeyService=o,this._contextViewService=s,this._instantiationService=n,this._quickInputService=r,this._fileService=a,this._editorService=d,this._labelService=l,this._disposables=new x,this._breadcrumbsDisposables=new x,this._model=new Ie,this._breadcrumbsPickerShowing=!1,this.domNode=document.createElement("div"),this.domNode.classList.add("breadcrumbs-control"),de(e,this.domNode),this._cfUseQuickPick=It.UseQuickPick.bindTo(p),this._cfShowIcons=It.Icons.bindTo(p),this._cfTitleScrollbarSizing=It.TitleScrollbarSizing.bindTo(p),this._labels=this._instantiationService.createInstance(Ln,gc);const f=this._cfTitleScrollbarSizing.getValue()??"default",b=t.widgetStyles??$l;this._widget=new wy(this.domNode,Wt.SCROLLBAR_SIZES[f],xy,b),this._widget.onDidSelectItem(this._onSelectEvent,this,this._disposables),this._widget.onDidFocusItem(this._onFocusEvent,this,this._disposables),this._widget.onDidChangeFocus(this._updateCkBreadcrumbsActive,this,this._disposables),this._ckBreadcrumbsPossible=Wt.CK_BreadcrumbsPossible.bindTo(this._contextKeyService),this._ckBreadcrumbsVisible=Wt.CK_BreadcrumbsVisible.bindTo(this._contextKeyService),this._ckBreadcrumbsActive=Wt.CK_BreadcrumbsActive.bindTo(this._contextKeyService),this._disposables.add(g.register(this._editorGroup.id,this._widget)),this.hide()}dispose(){this._disposables.dispose(),this._breadcrumbsDisposables.dispose(),this._ckBreadcrumbsPossible.reset(),this._ckBreadcrumbsVisible.reset(),this._ckBreadcrumbsActive.reset(),this._cfUseQuickPick.dispose(),this._cfShowIcons.dispose(),this._widget.dispose(),this._labels.dispose(),this.domNode.remove()}get model(){return this._model.value}layout(e){this._widget.layout(e)}isHidden(){return this.domNode.classList.contains("hidden")}hide(){this._breadcrumbsDisposables.clear(),this._ckBreadcrumbsVisible.set(!1),this.domNode.classList.toggle("hidden",!0)}revealLast(){this._widget.revealLast()}update(){this._breadcrumbsDisposables.clear();const e=ne.getCanonicalUri(this._editorGroup.activeEditor,{supportSideBySide:J.PRIMARY}),t=this.isHidden();if(!e||!this._fileService.hasProvider(e))return this._ckBreadcrumbsPossible.set(!1),t?!1:(this.hide(),!0);const i=ne.getOriginalUri(this._editorGroup.activeEditor,{supportSideBySide:J.PRIMARY});this.domNode.classList.toggle("hidden",!1),this._ckBreadcrumbsVisible.set(!0),this._ckBreadcrumbsPossible.set(!0);const o=this._instantiationService.createInstance(ca,i??e,this._editorGroup.activeEditorPane);this._model.value=o,this.domNode.classList.toggle("backslash-path",this._labelService.getSeparator(e.scheme,e.authority)==="\\");const s=()=>{this.domNode.classList.toggle("relative-path",o.isRelative());const l=this._cfShowIcons.getValue(),p={...this._options,showFileIcons:this._options.showFileIcons&&l,showSymbolIcons:this._options.showSymbolIcons&&l},g=o.getElements().map(f=>f instanceof un?new fn(o,f,p,this._labels):new gn(o,f,p));g.length===0?(this._widget.setEnabled(!1),this._widget.setItems([new class extends nd{render(f){f.innerText=u("empty","no elements")}equals(f){return f===this}}])):(this._widget.setEnabled(!0),this._widget.setItems(g),this._widget.reveal(g[g.length-1]))},n=o.onDidUpdate(s),r=this._cfShowIcons.onDidChange(s);s(),this._breadcrumbsDisposables.clear(),this._breadcrumbsDisposables.add(n),this._breadcrumbsDisposables.add(Y(()=>this._model.clear())),this._breadcrumbsDisposables.add(r),this._breadcrumbsDisposables.add(Y(()=>this._widget.setItems([])));const a=()=>{const l=this._cfTitleScrollbarSizing.getValue()??"default";this._widget.setHorizontalScrollbarSize(Wt.SCROLLBAR_SIZES[l])};a();const d=this._cfTitleScrollbarSizing.onDidChange(a);return this._breadcrumbsDisposables.add(d),this._breadcrumbsDisposables.add({dispose:()=>{this._breadcrumbsPickerShowing&&this._contextViewService.hideContextView({source:this})}}),t!==this.isHidden()}_onFocusEvent(e){e.item&&this._breadcrumbsPickerShowing&&(this._breadcrumbsPickerIgnoreOnceItem=void 0,this._widget.setSelection(e.item))}_onSelectEvent(e){if(!e.item)return;if(e.item===this._breadcrumbsPickerIgnoreOnceItem){this._breadcrumbsPickerIgnoreOnceItem=void 0,this._widget.setFocused(void 0),this._widget.setSelection(void 0);return}const{element:t}=e.item;this._editorGroup.focus();const i=this._getEditorGroup(e.payload);if(i!==void 0){this._widget.setFocused(void 0),this._widget.setSelection(void 0),this._revealInEditor(e,t,i);return}if(this._cfUseQuickPick.getValue()){this._widget.setFocused(void 0),this._widget.setSelection(void 0),this._quickInputService.quickAccess.show(t instanceof aa?"@":"");return}let o,s;this._contextViewService.showContextView({render:n=>{e.item instanceof fn?o=this._instantiationService.createInstance(ua,n,e.item.model.resource):e.item instanceof gn&&(o=this._instantiationService.createInstance(ky,n,e.item.model.resource));const r=o.onWillPickElement(()=>this._contextViewService.hideContextView({source:this,didPick:!0})),a=Ub.onDidChange(()=>this._contextViewService.hideContextView({source:this})),d=bi(n),l=d.onDidBlur(()=>{this._breadcrumbsPickerIgnoreOnceItem=this._widget.isDOMFocused()?e.item:void 0,this._contextViewService.hideContextView({source:this})});return this._breadcrumbsPickerShowing=!0,this._updateCkBreadcrumbsActive(),Br(o,r,a,d,l)},getAnchor:()=>{if(!s){const n=window.innerWidth-8;let r=Math.min(window.innerHeight*.7,300);const a=Math.min(n,Math.max(240,n/4.17)),d=8;let l;const p=zb(e.node.firstChild),g=p.top+p.height+d;g+r>=window.innerHeight&&(r=window.innerHeight-g-30);let f=p.left;if(f+a>=n&&(f=n-a),e.payload instanceof bt){const b=a-2*d;l=e.payload.posx-f,l>b&&(f=Math.min(n-a,f+l-b),l=b)}else l=p.left+p.width*.3-f;o.show(t,r,a,d,Math.max(0,l)),s={x:f,y:g}}return s},onHide:n=>{n!=null&&n.didPick||o.restoreViewState(),this._breadcrumbsPickerShowing=!1,this._updateCkBreadcrumbsActive(),(n==null?void 0:n.source)===this&&(this._widget.setFocused(void 0),this._widget.setSelection(void 0)),o.dispose()}})}_updateCkBreadcrumbsActive(){const e=this._widget.isDOMFocused()||this._breadcrumbsPickerShowing;this._ckBreadcrumbsActive.set(e)}async _revealInEditor(e,t,i,o=!1){if(t instanceof un)if(t.kind===Oe.FILE)await this._editorService.openEditor({resource:t.uri,options:{pinned:o}},i);else{const s=this._widget.getItems(),n=s.indexOf(e.item);this._widget.setFocused(s[n+1]),this._widget.setSelection(s[n+1],Wt.Payload_Pick)}else t.outline.reveal(t,{pinned:o},i===gi)}_getEditorGroup(e){return e===Wt.Payload_RevealAside?gi:e===Wt.Payload_Reveal?yg:void 0}};B.HEIGHT=22;B.SCROLLBAR_SIZES={default:3,large:8};B.Payload_Reveal={};B.Payload_RevealAside={};B.Payload_Pick={};B.CK_BreadcrumbsPossible=new U("breadcrumbsPossible",!1,u("breadcrumbsPossible","Whether the editor can show breadcrumbs"));B.CK_BreadcrumbsVisible=new U("breadcrumbsVisible",!1,u("breadcrumbsVisible","Whether breadcrumbs are currently visible"));B.CK_BreadcrumbsActive=new U("breadcrumbsActive",!1,u("breadcrumbsActive","Whether breadcrumbs have focus"));B=C([h(3,G),h(4,$n),h(5,I),h(6,ks),h(7,Ce),h(8,P),h(9,Ft),h(10,O),h(11,Pt)],B);j(class extends ye{constructor(){super({id:"breadcrumbs.toggle",title:{value:u("cmd.toggle","Toggle Breadcrumbs"),mnemonicTitle:u({key:"miBreadcrumbs",comment:["&& denotes a mnemonic"]},"Toggle &&Breadcrumbs"),original:"Toggle Breadcrumbs"},category:fe.View,toggled:{condition:v.equals("config.breadcrumbs.enabled",!0),title:u("cmd.toggle2","Breadcrumbs"),mnemonicTitle:u({key:"miBreadcrumbs2",comment:["&& denotes a mnemonic"]},"&&Breadcrumbs")},menu:[{id:S.CommandPalette},{id:S.MenubarAppearanceMenu,group:"4_editor",order:2},{id:S.NotebookToolbar,group:"notebookLayout",order:2},{id:S.StickyScrollContext}]})}run(e){const t=e.get(O),i=It.IsEnabled.bindTo(t).getValue();It.IsEnabled.bindTo(t).updateValue(!i)}});function rd(c,e){const t=c.get(ee),o=c.get(Pt).getWidget(t.activeGroup.id);if(o){const s=ql(o.getItems());o.setFocused(s),e&&o.setSelection(s,B.Payload_Pick)}}j(class extends ye{constructor(){super({id:"breadcrumbs.focusAndSelect",title:{value:u("cmd.focusAndSelect","Focus and Select Breadcrumbs"),original:"Focus and Select Breadcrumbs"},precondition:B.CK_BreadcrumbsVisible,keybinding:{weight:200,primary:3161,when:B.CK_BreadcrumbsPossible},f1:!0})}run(e,...t){rd(e,!0)}});j(class extends ye{constructor(){super({id:"breadcrumbs.focus",title:{value:u("cmd.focus","Focus Breadcrumbs"),original:"Focus Breadcrumbs"},precondition:B.CK_BreadcrumbsVisible,keybinding:{weight:200,primary:3157,when:B.CK_BreadcrumbsPossible},f1:!0})}run(e,...t){rd(e,!1)}});k.registerCommandAndKeybindingRule({id:"breadcrumbs.toggleToOn",weight:200,primary:3161,when:v.not("config.breadcrumbs.enabled"),handler:async c=>{const e=c.get(I),t=c.get(O),i=It.IsEnabled.bindTo(t);return i.getValue()||(await i.updateValue(!0),await Yn(50)),e.invokeFunction(rd,!0)}});k.registerCommandAndKeybindingRule({id:"breadcrumbs.focusNext",weight:200,primary:17,secondary:[2065],mac:{primary:17,secondary:[529]},when:v.and(B.CK_BreadcrumbsVisible,B.CK_BreadcrumbsActive),handler(c){const e=c.get(ee),i=c.get(Pt).getWidget(e.activeGroup.id);i&&i.focusNext()}});k.registerCommandAndKeybindingRule({id:"breadcrumbs.focusPrevious",weight:200,primary:15,secondary:[2063],mac:{primary:15,secondary:[527]},when:v.and(B.CK_BreadcrumbsVisible,B.CK_BreadcrumbsActive),handler(c){const e=c.get(ee),i=c.get(Pt).getWidget(e.activeGroup.id);i&&i.focusPrev()}});k.registerCommandAndKeybindingRule({id:"breadcrumbs.focusNextWithPicker",weight:200+1,primary:2065,mac:{primary:529},when:v.and(B.CK_BreadcrumbsVisible,B.CK_BreadcrumbsActive,se),handler(c){const e=c.get(ee),i=c.get(Pt).getWidget(e.activeGroup.id);i&&i.focusNext()}});k.registerCommandAndKeybindingRule({id:"breadcrumbs.focusPreviousWithPicker",weight:200+1,primary:2063,mac:{primary:527},when:v.and(B.CK_BreadcrumbsVisible,B.CK_BreadcrumbsActive,se),handler(c){const e=c.get(ee),i=c.get(Pt).getWidget(e.activeGroup.id);i&&i.focusPrev()}});k.registerCommandAndKeybindingRule({id:"breadcrumbs.selectFocused",weight:200,primary:3,secondary:[18],when:v.and(B.CK_BreadcrumbsVisible,B.CK_BreadcrumbsActive),handler(c){const e=c.get(ee),i=c.get(Pt).getWidget(e.activeGroup.id);i&&i.setSelection(i.getFocused(),B.Payload_Pick)}});k.registerCommandAndKeybindingRule({id:"breadcrumbs.revealFocused",weight:200,primary:10,secondary:[2051],when:v.and(B.CK_BreadcrumbsVisible,B.CK_BreadcrumbsActive),handler(c){const e=c.get(ee),i=c.get(Pt).getWidget(e.activeGroup.id);i&&i.setSelection(i.getFocused(),B.Payload_Reveal)}});k.registerCommandAndKeybindingRule({id:"breadcrumbs.selectEditor",weight:200+1,primary:9,when:v.and(B.CK_BreadcrumbsVisible,B.CK_BreadcrumbsActive),handler(c){var o;const e=c.get(ee),i=c.get(Pt).getWidget(e.activeGroup.id);i&&(i.setFocused(void 0),i.setSelection(void 0),(o=e.activeGroup.activeEditorPane)==null||o.focus())}});k.registerCommandAndKeybindingRule({id:"breadcrumbs.revealFocusedFromTreeAside",weight:200,primary:2051,when:v.and(B.CK_BreadcrumbsVisible,B.CK_BreadcrumbsActive,se),handler(c){const e=c.get(P),i=c.get(N).lastFocusedList;if(!(i instanceof Bc)&&!(i instanceof xs))return;const o=i.getFocus()[0];if(T.isUri(o==null?void 0:o.resource))return e.openEditor({resource:o.resource,options:{pinned:!0}},gi);const s=i.getInput();if(s&&typeof s.outlineKind=="string")return s.reveal(o,{pinned:!0,preserveFocus:!1},!0)}});class Yu extends Kn{constructor(e){super(),this.context=e}run(e,t){let i=this.context;return t!=null&&t.preserveFocus&&(i={...this.context,preserveFocus:!0}),super.run(e,i)}}let mn=class extends Jn{constructor(e,t,i,o,s,n,r,a,d,l,p,g,f){super(p),this.accessor=t,this.group=i,this.contextMenuService=o,this.instantiationService=s,this.contextKeyService=n,this.keybindingService=r,this.notificationService=a,this.menuService=d,this.quickInputService=l,this.configurationService=g,this.fileService=f,this.editorTransfer=jt.getInstance(),this.groupTransfer=jt.getInstance(),this.treeItemsTransfer=jt.getInstance(),this.breadcrumbsControl=void 0,this.editorToolBarMenuDisposables=this._register(new x),this.resourceContext=this._register(s.createInstance(we)),this.editorPinnedContext=Th.bindTo(n),this.editorIsFirstContext=Vh.bindTo(n),this.editorIsLastContext=Oh.bindTo(n),this.editorStickyContext=Rh.bindTo(n),this.editorCanSplitInGroupContext=Cg.bindTo(n),this.sideBySideEditorContext=Sg.bindTo(n),this.groupLockedContext=Lh.bindTo(n),this.renderDropdownAsChildElement=!1,this.create(e)}createBreadcrumbsControl(e,t){const i=this._register(It.IsEnabled.bindTo(this.configurationService));this._register(i.onDidChange(()=>{const o=i.getValue();!o&&this.breadcrumbsControl?(this.breadcrumbsControl.dispose(),this.breadcrumbsControl=void 0,this.handleBreadcrumbsEnablementChange()):o&&!this.breadcrumbsControl&&(this.breadcrumbsControl=this.instantiationService.createInstance(B,e,t,this.group),this.breadcrumbsControl.update(),this.handleBreadcrumbsEnablementChange())})),i.getValue()&&(this.breadcrumbsControl=this.instantiationService.createInstance(B,e,t,this.group)),this._register(this.fileService.onDidChangeFileSystemProviderRegistrations(o=>{var s,n;(s=this.breadcrumbsControl)!=null&&s.model&&this.breadcrumbsControl.model.resource.scheme!==o.scheme||(n=this.breadcrumbsControl)!=null&&n.update()&&this.handleBreadcrumbsEnablementChange()}))}createEditorActionsToolBar(e){const t={groupId:this.group.id};this.editorActionsToolbar=this._register(this.instantiationService.createInstance(Rl,e,{actionViewItemProvider:i=>this.actionViewItemProvider(i),orientation:0,ariaLabel:u("ariaLabelEditorActions","Editor actions"),getKeyBinding:i=>this.getKeybinding(i),actionRunner:this._register(new Yu(t)),anchorAlignmentProvider:()=>1,renderDropdownAsChildElement:this.renderDropdownAsChildElement,telemetrySource:"editorPart",resetMenu:S.EditorTitle,maxNumberOfItems:9})),this.editorActionsToolbar.context=t,this._register(this.editorActionsToolbar.actionRunner.onDidRun(i=>{i.error&&!Ui(i.error)&&this.notificationService.error(i.error)}))}actionViewItemProvider(e){const t=this.group.activeEditorPane;if(t instanceof Ir){const i=t.getActionViewItem(e);if(i)return i}return Oc(this.instantiationService,e,{menuAsChild:this.renderDropdownAsChildElement})}updateEditorActionsToolbar(){const{primary:e,secondary:t}=this.prepareEditorActions(this.getEditorActions());K(this.editorActionsToolbar).setActions(ho(e),ho(t))}getEditorActions(){const e=[],t=[];if(this.editorToolBarMenuDisposables.clear(),this.contextKeyService.bufferChangeEvents(()=>{const o=this.group.activeEditor;this.resourceContext.set(Gd(ne.getOriginalUri(o,{supportSideBySide:J.PRIMARY}))),this.editorPinnedContext.set(o?this.group.isPinned(o):!1),this.editorIsFirstContext.set(o?this.group.isFirst(o):!1),this.editorIsLastContext.set(o?this.group.isLast(o):!1),this.editorStickyContext.set(o?this.group.isSticky(o):!1),this.editorCanSplitInGroupContext.set(o?o.hasCapability(32):!1),this.sideBySideEditorContext.set((o==null?void 0:o.typeId)===Et.ID),this.groupLockedContext.set(this.group.isLocked)}),this.group.activeEditorPane instanceof Ir){const o=this.getEditorPaneAwareContextKeyService(),s=this.menuService.createMenu(S.EditorTitle,o,{emitEventsForSubmenuChanges:!0,eventDebounceDelay:0});this.editorToolBarMenuDisposables.add(s),this.editorToolBarMenuDisposables.add(s.onDidChange(()=>{this.updateEditorActionsToolbar()}));const n=(r,a)=>a==="navigation"&&r.actions.length<=1;Es(s,{arg:this.resourceContext.get(),shouldForwardArgs:!0},{primary:e,secondary:t},"navigation",n)}return{primary:e,secondary:t}}getEditorPaneAwareContextKeyService(){var e;return((e=this.group.activeEditorPane)==null?void 0:e.scopedContextKeyService)??this.contextKeyService}clearEditorActionsToolbar(){var e;(e=this.editorActionsToolbar)==null||e.setActions([],[])}enableGroupDragging(e){this._register(_(e,E.DRAG_START,t=>{var o;if(t.target!==e)return;this.groupTransfer.setData([new He(this.group.id)],He.prototype),t.dataTransfer&&(t.dataTransfer.effectAllowed="copyMove");let i=!1;if(this.accessor.partOptions.showTabs?i=this.doFillResourceDataTransfers(this.group.getEditors(1),t):this.group.activeEditor&&(i=this.doFillResourceDataTransfers([this.group.activeEditor],t)),!i&&Wr&&((o=t.dataTransfer)==null||o.setData(oo.TEXT,String(this.group.label))),this.group.activeEditor){let s=this.group.activeEditor.getName();this.accessor.partOptions.showTabs&&this.group.count>1&&(s=u("draggedEditorGroup","{0} (+{1})",s,this.group.count-1)),$b(t,s,"monaco-editor-group-drag-image",this.getColor(jb),this.getColor(qb))}})),this._register(_(e,E.DRAG_END,()=>{this.groupTransfer.clearData(He.prototype)}))}doFillResourceDataTransfers(e,t){return e.length?(this.instantiationService.invokeFunction(Mh,e.map(i=>({editor:i,groupId:this.group.id})),t),!0):!1}onContextMenu(e,t,i){const o=this.resourceContext.get();this.resourceContext.set(Gd(ne.getOriginalUri(e,{supportSideBySide:J.PRIMARY})));const s=!!this.editorPinnedContext.get();this.editorPinnedContext.set(this.group.isPinned(e));const n=!!this.editorIsFirstContext.get();this.editorIsFirstContext.set(this.group.isFirst(e));const r=!!this.editorIsLastContext.get();this.editorIsLastContext.set(this.group.isLast(e));const a=!!this.editorStickyContext.get();this.editorStickyContext.set(this.group.isSticky(e));const d=!!this.groupLockedContext.get();this.groupLockedContext.set(this.group.isLocked);const l=!!this.editorCanSplitInGroupContext.get();this.editorCanSplitInGroupContext.set(e.hasCapability(32));const p=!!this.sideBySideEditorContext.get();this.sideBySideEditorContext.set(e.typeId===Et.ID);let g=i;if(t instanceof MouseEvent){const f=new bt(t);g={x:f.posx,y:f.posy}}this.contextMenuService.showContextMenu({getAnchor:()=>g,menuId:S.EditorTitleContext,menuActionOptions:{shouldForwardArgs:!0,arg:this.resourceContext.get()},contextKeyService:this.contextKeyService,getActionsContext:()=>({groupId:this.group.id,editorIndex:this.group.getIndexOfEditor(e)}),getKeyBinding:f=>this.getKeybinding(f),onHide:()=>{this.resourceContext.set(o||null),this.editorPinnedContext.set(s),this.editorIsFirstContext.set(n),this.editorIsLastContext.set(r),this.editorStickyContext.set(a),this.groupLockedContext.set(d),this.editorCanSplitInGroupContext.set(l),this.sideBySideEditorContext.set(p),this.accessor.activeGroup.focus()}})}getKeybinding(e){return this.keybindingService.lookupKeybinding(e.id,this.getEditorPaneAwareContextKeyService())}getKeybindingLabel(e){const t=this.getKeybinding(e);return t?At(t.getLabel()):void 0}dispose(){ie(this.breadcrumbsControl),this.breadcrumbsControl=void 0,super.dispose()}};mn=C([h(3,ke),h(4,I),h(5,G),h(6,ve),h(7,Ae),h(8,rt),h(9,ks),h(10,te),h(11,O),h(12,Ce)],mn);let ei=class Ke extends mn{constructor(e,t,i,o,s,n,r,a,d,l,p,g,f,b,m,y,D){super(e,t,i,o,s,n,r,a,d,l,p,g,f),this.editorService=b,this.pathService=m,this.editorGroupService=y,this.treeViewsDragAndDropService=D,this.closeEditorAction=this._register(this.instantiationService.createInstance(rr,rr.ID,rr.LABEL)),this.unpinEditorAction=this._register(this.instantiationService.createInstance(ar,ar.ID,ar.LABEL)),this.tabResourceLabels=this._register(this.instantiationService.createInstance(Ln,gc)),this.tabLabels=[],this.tabActionBars=[],this.tabDisposables=[],this.dimensions={container:q.None,available:q.None},this.layoutScheduler=this._register(new Ie),this.path=Vt?Jb:Kl,this.lastMouseWheelEventTime=0,this.isMouseOverTabs=!1,this.updateEditorLabelScheduler=this._register(new Ds(()=>this.doUpdateEditorLabels(),0)),(async()=>this.path=await this.pathService.path)(),this._register(this.tabResourceLabels.onDidChangeDecorations(()=>this.doHandleDecorationsChange()))}create(e){this.titleContainer=e,this.tabsAndActionsContainer=document.createElement("div"),this.tabsAndActionsContainer.classList.add("tabs-and-actions-container"),this.titleContainer.appendChild(this.tabsAndActionsContainer),this.tabsContainer=document.createElement("div"),this.tabsContainer.setAttribute("role","tablist"),this.tabsContainer.draggable=!0,this.tabsContainer.classList.add("tabs-container"),this._register(Yt.addTarget(this.tabsContainer)),this.tabSizingFixedDisposables=this._register(new x),this.updateTabSizing(!1),this.tabsScrollbar=this._register(this.createTabsScrollbar(this.tabsContainer)),this.tabsAndActionsContainer.appendChild(this.tabsScrollbar.getDomNode()),this.registerTabsContainerListeners(this.tabsContainer,this.tabsScrollbar),this.editorToolbarContainer=document.createElement("div"),this.editorToolbarContainer.classList.add("editor-actions"),this.tabsAndActionsContainer.appendChild(this.editorToolbarContainer),this.createEditorActionsToolBar(this.editorToolbarContainer);const t=document.createElement("div");t.classList.add("tabs-breadcrumbs"),this.titleContainer.appendChild(t),this.createBreadcrumbsControl(t,{showFileIcons:!0,showSymbolIcons:!0,showDecorationColors:!1,showPlaceholder:!0})}createTabsScrollbar(e){const t=new Xb(e,{horizontal:1,horizontalScrollbarSize:this.getTabsScrollbarSizing(),vertical:2,scrollYToX:!0,useShadows:!1});return t.onScroll(i=>{i.scrollLeftChanged&&(e.scrollLeft=i.scrollLeft)}),t}updateTabsScrollbarSizing(){var e;(e=this.tabsScrollbar)==null||e.updateOptions({horizontalScrollbarSize:this.getTabsScrollbarSizing()})}updateTabSizing(e){const[t,i]=Ji(this.tabsContainer,this.tabSizingFixedDisposables);i.clear();const o=this.accessor.partOptions;o.tabSizing==="fixed"?(t.style.setProperty("--tab-sizing-fixed-min-width",`${o.tabSizingFixedMinWidth}px`),t.style.setProperty("--tab-sizing-fixed-max-width",`${o.tabSizingFixedMaxWidth}px`),i.add(_(t,E.MOUSE_ENTER,()=>{this.isMouseOverTabs=!0})),i.add(_(t,E.MOUSE_LEAVE,()=>{this.isMouseOverTabs=!1,this.updateTabsFixedWidth(!1)}))):e&&(t.style.removeProperty("--tab-sizing-fixed-min-width"),t.style.removeProperty("--tab-sizing-fixed-max-width"),this.updateTabsFixedWidth(!1))}updateTabsFixedWidth(e){this.forEachTab((t,i,o)=>{if(e){const{width:s}=o.getBoundingClientRect();o.style.setProperty("--tab-sizing-current-width",`${s}px`)}else o.style.removeProperty("--tab-sizing-current-width")})}getTabsScrollbarSizing(){return this.accessor.partOptions.titleScrollbarSizing!=="large"?Ke.SCROLLBAR_SIZES.default:Ke.SCROLLBAR_SIZES.large}registerTabsContainerListeners(e,t){this.enableGroupDragging(e),this._register(_(e,E.SCROLL,()=>{e.classList.contains("scroll")&&t.setScrollPosition({scrollLeft:e.scrollLeft})}));for(const o of[Ve.Tap,E.DBLCLICK])this._register(_(e,o,s=>{if(o===E.DBLCLICK){if(s.target!==e)return}else if(s.tapCount!==2||s.initialTarget!==e)return;X.stop(s),this.editorService.openEditor({resource:void 0,options:{pinned:!0,index:this.group.count,override:We.id}},this.group.id)}));this._register(_(e,E.MOUSE_DOWN,o=>{o.button===1&&o.preventDefault()})),this._register(new Hr(e,{onDragEnter:o=>{if(e.classList.add("scroll"),o.target!==e){this.updateDropFeedback(e,!1);return}if(!this.isSupportedDropTransfer(o)){o.dataTransfer&&(o.dataTransfer.dropEffect="none");return}let s=!1;if(this.editorTransfer.hasData(_e.prototype)){s=!0;const n=this.editorTransfer.getData(_e.prototype);if(Array.isArray(n)){const r=n[0].identifier;if(this.group.id===r.groupId&&this.group.getIndexOfEditor(r.editor)===this.group.count-1){o.dataTransfer&&(o.dataTransfer.dropEffect="none");return}}}s||o.dataTransfer&&(o.dataTransfer.dropEffect="copy"),this.updateDropFeedback(e,!0)},onDragLeave:o=>{this.updateDropFeedback(e,!1),e.classList.remove("scroll")},onDragEnd:o=>{this.updateDropFeedback(e,!1),e.classList.remove("scroll")},onDrop:o=>{this.updateDropFeedback(e,!1),e.classList.remove("scroll"),o.target===e&&this.onDrop(o,this.group.count,e)}})),this._register(_(e,E.MOUSE_WHEEL,o=>{const s=this.group.activeEditor;if(!s||this.group.count<2)return;if(this.accessor.partOptions.scrollToSwitchTabs===!0){if(o.shiftKey)return}else if(!o.shiftKey)return;const n=Date.now();if(n-this.lastMouseWheelEventTime<Ke.MOUSE_WHEEL_EVENT_THRESHOLD-2*(Math.abs(o.deltaX)+Math.abs(o.deltaY)))return;this.lastMouseWheelEventTime=n;let r;if(o.deltaX+o.deltaY<-Ke.MOUSE_WHEEL_DISTANCE_THRESHOLD)r=-1;else if(o.deltaX+o.deltaY>Ke.MOUSE_WHEEL_DISTANCE_THRESHOLD)r=1;else return;const a=this.group.getEditorByIndex(this.group.getIndexOfEditor(s)+r);a&&(this.group.openEditor(a),X.stop(o,!0))}));const i=o=>{X.stop(o);let s=e;if(o instanceof MouseEvent){const n=new bt(o);s={x:n.posx,y:n.posy}}this.contextMenuService.showContextMenu({getAnchor:()=>s,menuId:S.EditorTabsBarContext,contextKeyService:this.contextKeyService,menuActionOptions:{shouldForwardArgs:!0},getActionsContext:()=>({groupId:this.group.id}),getKeyBinding:n=>this.getKeybinding(n),onHide:()=>this.group.focus()})};this._register(_(e,Ve.Contextmenu,o=>i(o))),this._register(_(e,E.CONTEXT_MENU,o=>i(o)))}doHandleDecorationsChange(){this.layout(this.dimensions)}updateEditorActionsToolbar(){super.updateEditorActionsToolbar(),this.layout(this.dimensions)}openEditor(e){this.handleOpenedEditors()}openEditors(e){this.handleOpenedEditors()}handleOpenedEditors(){var n,r;const[e,t]=Ji(this.tabsContainer,this.tabsScrollbar);for(let a=e.children.length;a<this.group.count;a++)e.appendChild(this.createTab(a,e,t));const i=this.didActiveEditorChange(),o=this.activeTabLabel,s=this.tabLabels.length;this.computeTabLabels(),i||s!==this.tabLabels.length||!this.equalsEditorInputLabel(o,this.activeTabLabel)?(this.redraw({forceRevealActiveTab:!0}),(n=this.breadcrumbsControl)==null||n.update()):(this.layout(this.dimensions,{forceRevealActiveTab:!0}),(r=this.breadcrumbsControl)==null||r.revealLast())}didActiveEditorChange(){var e,t,i;return!!(!((e=this.activeTabLabel)!=null&&e.editor)&&this.group.activeEditor||(t=this.activeTabLabel)!=null&&t.editor&&!this.group.activeEditor||!((i=this.activeTabLabel)!=null&&i.editor)||!this.group.isActive(this.activeTabLabel.editor))}equalsEditorInputLabel(e,t){return e===t?!0:!e||!t?!1:e.name===t.name&&e.description===t.description&&e.forceDescription===t.forceDescription&&e.title===t.title&&e.ariaLabel===t.ariaLabel}beforeCloseEditor(e){if(this.isMouseOverTabs&&this.accessor.partOptions.tabSizing==="fixed"){const t=this.group.isLast(e);this.updateTabsFixedWidth(!t)}}closeEditor(e){this.handleClosedEditors()}closeEditors(e){this.handleClosedEditors()}handleClosedEditors(){var e,t;if(this.group.activeEditor){const i=K(this.tabsContainer);for(;i.children.length>this.group.count;)(e=i.lastChild)==null||e.remove(),ie(this.tabDisposables.pop());this.computeTabLabels(),this.redraw({forceRevealActiveTab:!0})}else this.tabsContainer&&Jt(this.tabsContainer),this.tabDisposables=ie(this.tabDisposables),this.tabResourceLabels.clear(),this.tabLabels=[],this.activeTabLabel=void 0,this.tabActionBars=[],this.clearEditorActionsToolbar(),(t=this.breadcrumbsControl)==null||t.update()}moveEditor(e,t,i){const o=this.tabLabels[t];this.tabLabels.splice(t,1),this.tabLabels.splice(i,0,o),this.forEachTab((s,n,r,a,d,l)=>{this.redrawTab(s,n,r,a,d,l)},Math.min(t,i),Math.max(t,i)),this.layout(this.dimensions,{forceRevealActiveTab:!0})}pinEditor(e){this.withTab(e,(t,i,o,s,n)=>this.redrawTabLabel(t,i,o,s,n))}stickEditor(e){this.doHandleStickyEditorChange(e)}unstickEditor(e){this.doHandleStickyEditorChange(e)}doHandleStickyEditorChange(e){this.withTab(e,(t,i,o,s,n,r)=>this.redrawTab(t,i,o,s,n,r)),this.forEachTab((t,i,o,s,n)=>{this.redrawTabBorders(i,o)}),this.layout(this.dimensions,{forceRevealActiveTab:!0})}setActive(e){this.forEachTab((t,i,o,s,n,r)=>{this.redrawTabActiveAndDirty(e,t,o,r)}),this.updateEditorActionsToolbar(),this.layout(this.dimensions,{forceRevealActiveTab:!0})}updateEditorLabel(e){this.updateEditorLabelScheduler.schedule()}doUpdateEditorLabels(){this.computeTabLabels(),this.forEachTab((e,t,i,o,s)=>{this.redrawTabLabel(e,t,i,o,s)}),this.layout(this.dimensions)}updateEditorDirty(e){this.withTab(e,(t,i,o,s,n,r)=>this.redrawTabActiveAndDirty(this.accessor.activeGroup===this.group,t,o,r))}updateOptions(e,t){e.labelFormat!==t.labelFormat&&this.computeTabLabels(),e.titleScrollbarSizing!==t.titleScrollbarSizing&&this.updateTabsScrollbarSizing(),(e.tabSizingFixedMinWidth!==t.tabSizingFixedMinWidth||e.tabSizingFixedMaxWidth!==t.tabSizingFixedMaxWidth||e.tabSizing!==t.tabSizing)&&this.updateTabSizing(!0),(e.labelFormat!==t.labelFormat||e.tabCloseButton!==t.tabCloseButton||e.tabSizing!==t.tabSizing||e.pinnedTabSizing!==t.pinnedTabSizing||e.showIcons!==t.showIcons||e.hasIcons!==t.hasIcons||e.highlightModifiedTabs!==t.highlightModifiedTabs||e.wrapTabs!==t.wrapTabs||!Uc(e.decorations,t.decorations))&&this.redraw()}updateStyles(){this.redraw()}forEachTab(e,t,i){this.group.editors.forEach((o,s)=>{typeof t=="number"&&t>s||typeof i=="number"&&i<s||this.doWithTab(s,o,e)})}withTab(e,t){this.doWithTab(this.group.getIndexOfEditor(e),e,t)}doWithTab(e,t,i){const s=K(this.tabsContainer).children[e],n=this.tabResourceLabels.get(e),r=this.tabLabels[e],a=this.tabActionBars[e];s&&n&&r&&i(t,e,s,n,r,a)}createTab(e,t,i){const o=document.createElement("div");o.draggable=!0,o.setAttribute("role","tab"),o.classList.add("tab"),this._register(Yt.addTarget(o));const s=document.createElement("div");s.classList.add("tab-border-top-container"),o.appendChild(s);const n=this.tabResourceLabels.create(o),r=document.createElement("div");r.classList.add("tab-actions"),o.appendChild(r);const a=new Yu({groupId:this.group.id,editorIndex:e}),d=new xo(r,{ariaLabel:u("ariaLabelTabActions","Tab actions"),actionRunner:a});d.onWillRun(f=>{f.action.id===this.closeEditorAction.id&&this.blockRevealActiveTabOnce()});const l=Br(d,Y(jl(this.tabActionBars,d))),p=document.createElement("div");p.classList.add("tab-border-bottom-container"),o.appendChild(p);const g=this.registerTabListeners(o,e,t,i);return this.tabDisposables.push(Br(g,l,a,n)),o}registerTabListeners(e,t,i,o){const s=new x,n=(a,d)=>{if(e.blur(),a instanceof MouseEvent&&(a.button!==0||De&&a.ctrlKey)){a.button===1&&a.preventDefault();return}if(this.originatesFromTabActionBar(a))return;const l=this.group.getEditorByIndex(t);l&&this.group.openEditor(l,{preserveFocus:d,activation:pi.ACTIVATE})},r=a=>{X.stop(a);const d=this.group.getEditorByIndex(t);d&&this.onContextMenu(d,a,e)};s.add(_(e,E.MOUSE_DOWN,a=>n(a,!1))),s.add(_(e,Ve.Tap,a=>n(a,!0))),s.add(_(e,Ve.Change,a=>{o.setScrollPosition({scrollLeft:o.getScrollPosition().scrollLeft-a.translationX})})),s.add(_(e,E.MOUSE_UP,a=>{X.stop(a),e.blur()})),s.add(_(e,E.AUXCLICK,a=>{a.button===1&&(X.stop(a,!0),this.blockRevealActiveTabOnce(),this.closeEditorAction.run({groupId:this.group.id,editorIndex:t}))})),s.add(_(e,E.KEY_DOWN,a=>{const d=new mt(a);d.shiftKey&&d.keyCode===68&&r(a)})),s.add(_(e,Ve.Contextmenu,a=>{r(a)})),s.add(_(e,E.KEY_UP,a=>{const d=new mt(a);let l=!1;if(d.equals(3)||d.equals(10)){l=!0;const p=this.group.getEditorByIndex(t);p&&this.group.openEditor(p)}else if([15,17,16,18,14,13].some(p=>d.equals(p))){let p;d.equals(15)||d.equals(16)?p=t-1:d.equals(17)||d.equals(18)?p=t+1:d.equals(14)?p=0:p=this.group.count-1;const g=this.group.getEditorByIndex(p);g&&(l=!0,this.group.openEditor(g,{preserveFocus:!0}),i.childNodes[p].focus())}l&&X.stop(a,!0),o.setScrollPosition({scrollLeft:i.scrollLeft})}));for(const a of[Ve.Tap,E.DBLCLICK])s.add(_(e,a,d=>{if(a===E.DBLCLICK)X.stop(d);else if(d.tapCount!==2)return;const l=this.group.getEditorByIndex(t);l&&this.group.isPinned(l)?this.accessor.partOptions.doubleClickTabToToggleEditorGroupSizes&&this.accessor.arrangeGroups(2,this.group):this.group.pinEditor(l)}));return s.add(_(e,E.CONTEXT_MENU,a=>{X.stop(a,!0);const d=this.group.getEditorByIndex(t);d&&this.onContextMenu(d,a,e)},!0)),s.add(_(e,E.DRAG_START,a=>{const d=this.group.getEditorByIndex(t);d&&(this.editorTransfer.setData([new _e({editor:d,groupId:this.group.id})],_e.prototype),a.dataTransfer&&(a.dataTransfer.effectAllowed="copyMove"),this.doFillResourceDataTransfers([d],a),e.classList.add("dragged"),Pr(()=>e.classList.remove("dragged")))})),s.add(new Hr(e,{onDragEnter:a=>{if(e.classList.add("dragged-over"),!this.isSupportedDropTransfer(a)){a.dataTransfer&&(a.dataTransfer.dropEffect="none");return}let d=!1;if(this.editorTransfer.hasData(_e.prototype)){d=!0;const l=this.editorTransfer.getData(_e.prototype);if(Array.isArray(l)){const p=l[0].identifier;if(p.editor===this.group.getEditorByIndex(t)&&p.groupId===this.group.id){a.dataTransfer&&(a.dataTransfer.dropEffect="none");return}}}d||a.dataTransfer&&(a.dataTransfer.dropEffect="copy"),this.updateDropFeedback(e,!0,t)},onDragOver:(a,d)=>{if(d>=Ke.DRAG_OVER_OPEN_TAB_THRESHOLD){const l=this.group.getEditorByIndex(t);l&&this.group.activeEditor!==l&&this.group.openEditor(l,{preserveFocus:!0})}},onDragLeave:()=>{e.classList.remove("dragged-over"),this.updateDropFeedback(e,!1,t)},onDragEnd:()=>{e.classList.remove("dragged-over"),this.updateDropFeedback(e,!1,t),this.editorTransfer.clearData(_e.prototype)},onDrop:a=>{e.classList.remove("dragged-over"),this.updateDropFeedback(e,!1,t),this.onDrop(a,t,i)}})),s}isSupportedDropTransfer(e){if(this.groupTransfer.hasData(He.prototype)){const t=this.groupTransfer.getData(He.prototype);return!(Array.isArray(t)&&t[0].identifier===this.group.id)}return!!(this.editorTransfer.hasData(_e.prototype)||e.dataTransfer&&e.dataTransfer.types.length>0)}updateDropFeedback(e,t,i){const o=typeof i=="number",s=typeof i=="number"?this.group.getEditorByIndex(i):void 0,n=o&&!!s&&this.group.isActive(s),r=o?this.getColor(n?Tr:Vr):"";e.style.backgroundColor=(t?this.getColor(On):r)||"";const a=this.getColor(lo);a&&t?(e.style.outlineWidth="2px",e.style.outlineStyle="dashed",e.style.outlineColor=a,e.style.outlineOffset=o?"-5px":"-3px"):(e.style.outlineWidth="",e.style.outlineStyle="",e.style.outlineColor=a||"",e.style.outlineOffset="")}computeTabLabels(){const{labelFormat:e}=this.accessor.partOptions,{verbosity:t,shortenDuplicates:i}=this.getLabelConfigFlags(e),o=[];let s=-1;for(let n=0;n<this.group.editors.length;n++){const r=this.group.editors[n];o.push({editor:r,name:r.getName(),description:r.getDescription(t),forceDescription:r.hasCapability(64),title:r.getTitle(2),ariaLabel:Tg(r,n,this.group,this.editorGroupService.count)}),r===this.group.activeEditor&&(s=n)}i&&this.shortenTabLabels(o),this.tabLabels=o,this.activeTabLabel=o[s]}shortenTabLabels(e){const t=new Map;for(const i of e)typeof i.description=="string"?gr(t,i.name,[]).push(i):i.description="";for(const[,i]of t){if(i.length===1&&!i[0].forceDescription){i[0].description="";continue}const o=new Map;for(const a of i)gr(o,a.description,[]).push(a);let s=!1;for(const[,a]of o)if(!s&&a.length>1){const[d,...l]=a.map(({editor:p})=>p.getDescription(2));s=l.some(p=>p!==d)}if(s){o.clear();for(const a of i)a.description=a.editor.getDescription(2),gr(o,a.description,[]).push(a)}const n=[];for(const[a]of o)n.push(a);if(n.length===1){for(const a of o.get(n[0])||[])a.forceDescription||(a.description="");continue}const r=Zb(n,this.path.sep);n.forEach((a,d)=>{for(const l of o.get(a)||[])l.description=r[d]})}}getLabelConfigFlags(e){switch(e){case"short":return{verbosity:0,shortenDuplicates:!1};case"medium":return{verbosity:1,shortenDuplicates:!1};case"long":return{verbosity:2,shortenDuplicates:!1};default:return{verbosity:1,shortenDuplicates:!0}}}redraw(e){if(this.tabsAndActionsContainer){let t=this.getColor(Vg);!t&&Hc(this.theme.type)&&(t=this.getColor(Ar)||this.getColor(Ze)),t?(this.tabsAndActionsContainer.classList.add("tabs-border-bottom"),this.tabsAndActionsContainer.style.setProperty("--tabs-border-bottom-color",t.toString())):(this.tabsAndActionsContainer.classList.remove("tabs-border-bottom"),this.tabsAndActionsContainer.style.removeProperty("--tabs-border-bottom-color"))}this.forEachTab((t,i,o,s,n,r)=>{this.redrawTab(t,i,o,s,n,r)}),this.updateEditorActionsToolbar(),this.layout(this.dimensions,e)}redrawTab(e,t,i,o,s,n){const r=this.group.isSticky(t),a=this.accessor.partOptions;this.redrawTabLabel(e,t,i,o,s);const d=r?this.unpinEditorAction:this.closeEditorAction;n.hasAction(d)||(n.isEmpty()||n.clear(),n.push(d,{icon:!0,label:!1,keybinding:this.getKeybindingLabel(d)}));const l=r&&a.pinnedTabSizing==="compact"?"off":a.tabCloseButton;for(const g of["off","left","right"])i.classList.toggle(`tab-actions-${g}`,l===g);const p=r&&a.pinnedTabSizing==="shrink"?"shrink":a.tabSizing;for(const g of["fit","shrink","fixed"])i.classList.toggle(`sizing-${g}`,p===g);i.classList.toggle("has-icon",a.showIcons&&a.hasIcons),i.classList.toggle("sticky",r);for(const g of["normal","compact","shrink"])i.classList.toggle(`sticky-${g}`,r&&a.pinnedTabSizing===g);if(!a.wrapTabs&&r&&a.pinnedTabSizing!=="normal"){let g=0;switch(a.pinnedTabSizing){case"compact":g=Ke.TAB_WIDTH.compact;break;case"shrink":g=Ke.TAB_WIDTH.shrink;break}i.style.left=`${t*g}px`}else i.style.left="auto";this.redrawTabBorders(t,i),this.redrawTabActiveAndDirty(this.accessor.activeGroup===this.group,e,i,n)}redrawTabLabel(e,t,i,o,s){var f,b,m;const n=this.accessor.partOptions;let r,a=!1,d=!!((f=n.decorations)!=null&&f.badges),l;n.pinnedTabSizing==="compact"&&this.group.isSticky(t)?(r=n.showIcons&&n.hasIcons?"":(b=s.name)==null?void 0:b.charAt(0).toUpperCase(),l="",a=!0,d=!1):(r=s.name,l=s.description||""),s.ariaLabel&&(i.setAttribute("aria-label",s.ariaLabel),i.setAttribute("aria-description",""));const p=s.title||"";i.title=p,o.setResource({name:r,description:l,resource:ne.getOriginalUri(e,{supportSideBySide:J.BOTH})},{title:p,extraClasses:Ge(["tab-label",d?"tab-label-has-badge":void 0].concat(e.getLabelExtraClasses())),italic:!this.group.isPinned(e),forceLabel:a,fileDecorations:{colors:!!((m=n.decorations)!=null&&m.colors),badges:d}});const g=ne.getOriginalUri(e,{supportSideBySide:J.PRIMARY});g?i.setAttribute("data-resource-name",Qb(g)):i.removeAttribute("data-resource-name")}redrawTabActiveAndDirty(e,t,i,o){const s=this.group.isActive(t),n=this.doRedrawTabDirty(e,s,t,i);this.doRedrawTabActive(e,!n,t,i,o)}doRedrawTabActive(e,t,i,o,s){if(this.group.isActive(i)){o.classList.add("active"),o.setAttribute("aria-selected","true"),o.tabIndex=0,o.style.backgroundColor=this.getColor(e?Tr:Fh)||"";const n=this.getColor(e?Og:Rg);n?(o.classList.add("tab-border-bottom"),o.style.setProperty("--tab-border-bottom-color",n.toString())):(o.classList.remove("tab-border-bottom"),o.style.removeProperty("--tab-border-bottom-color"));const r=t?this.getColor(e?Lg:Mg):void 0;r?(o.classList.add("tab-border-top"),o.style.setProperty("--tab-border-top-color",r.toString())):(o.classList.remove("tab-border-top"),o.style.removeProperty("--tab-border-top-color")),o.style.color=this.getColor(e?Bh:Wh)||"",s.setFocusable(!0)}else o.classList.remove("active"),o.setAttribute("aria-selected","false"),o.tabIndex=-1,o.style.backgroundColor=this.getColor(e?Vr:Nh)||"",o.style.boxShadow="",o.style.color=this.getColor(e?Pg:Fg)||"",s.setFocusable(!1)}doRedrawTabDirty(e,t,i,o){let s=!1;if(i.isDirty()&&!i.isSaving())if(o.classList.add("dirty"),this.accessor.partOptions.highlightModifiedTabs){let n;e&&t?n=this.getColor(Ng):e&&!t?n=this.getColor(Bg):!e&&t?n=this.getColor(Wg):n=this.getColor(Hg),n&&(s=!0,o.classList.add("dirty-border-top"),o.style.setProperty("--tab-dirty-border-top-color",n))}else o.classList.remove("dirty-border-top"),o.style.removeProperty("--tab-dirty-border-top-color");else o.classList.remove("dirty","dirty-border-top"),o.style.removeProperty("--tab-dirty-border-top-color");return s}redrawTabBorders(e,t){const s=(this.group.isSticky(e)&&this.group.stickyCount===e+1?this.getColor(Gg):void 0)||this.getColor(Ar)||this.getColor(Ze);t.style.borderRight=s?`1px solid ${s}`:"",t.style.outlineColor=this.getColor(lo)||""}prepareEditorActions(e){return this.accessor.activeGroup===this.group?e:{primary:e.primary.filter(i=>i.id===Hh),secondary:e.secondary}}getHeight(){const e=this.breadcrumbsControl&&!this.breadcrumbsControl.isHidden();return this.dimensions.used?{total:this.dimensions.used.height,offset:e?this.dimensions.used.height-B.HEIGHT:this.dimensions.used.height}:this.computeHeight()}computeHeight(){var i;let e;this.accessor.partOptions.wrapTabs&&((i=this.tabsAndActionsContainer)!=null&&i.classList.contains("wrapping"))?e=this.tabsAndActionsContainer.offsetHeight:e=Ke.TAB_HEIGHT;const t=e;return this.breadcrumbsControl&&!this.breadcrumbsControl.isHidden()&&(e+=B.HEIGHT),{total:e,offset:t}}layout(e,t){if(Object.assign(this.dimensions,e),!this.layoutScheduler.value){const i=Pr(()=>{var o;this.doLayout(this.dimensions,(o=this.layoutScheduler.value)==null?void 0:o.options),this.layoutScheduler.clear()});this.layoutScheduler.value={options:t,dispose:()=>i.dispose()}}return t!=null&&t.forceRevealActiveTab&&(this.layoutScheduler.value.options={...this.layoutScheduler.value.options,forceRevealActiveTab:!0}),this.dimensions.used||(this.dimensions.used=new q(e.container.width,this.computeHeight().total)),this.dimensions.used}doLayout(e,t){const i=this.group.activeEditor?this.getTabAndIndex(this.group.activeEditor):void 0;if(i&&e.container!==q.None&&e.available!==q.None){this.doLayoutBreadcrumbs(e);const[n,r]=i;this.doLayoutTabs(n,r,e,t)}const o=this.dimensions.used,s=this.dimensions.used=new q(e.container.width,this.computeHeight().total);o&&o.height!==s.height&&this.group.relayout()}handleBreadcrumbsEnablementChange(){this.group.relayout()}doLayoutBreadcrumbs(e){this.breadcrumbsControl&&!this.breadcrumbsControl.isHidden()&&this.breadcrumbsControl.layout(new q(e.container.width,B.HEIGHT))}doLayoutTabs(e,t,i,o){this.doLayoutTabsWrapping(i)||this.doLayoutTabsNonWrapping(e,t,o)}doLayoutTabsWrapping(e){const[t,i,o,s]=Ji(this.tabsAndActionsContainer,this.tabsContainer,this.editorToolbarContainer,this.tabsScrollbar),n=t.classList.contains("wrapping");let r=n;function a(d){r=d,t.classList.toggle("wrapping",r),i.style.setProperty("--last-tab-margin-right",r?`${o.offsetWidth}px`:"0")}if(this.accessor.partOptions.wrapTabs){const d=i.offsetWidth,l=i.scrollWidth,p=()=>{const g=this.getLastTab();return g?!(g.offsetWidth+o.offsetWidth-e.available.width>1):!0};(r||l>d&&p())&&a(!0),r&&(i.offsetHeight>e.available.height||l===d&&i.offsetHeight===Ke.TAB_HEIGHT||!p())&&a(!1)}else n&&a(!1);if(r&&!n){const d=i.offsetWidth;s.setScrollDimensions({width:d,scrollWidth:d})}if(r){const d=new Map;let l,p;for(const g of i.children){const f=g,b=f.offsetTop;b!==l&&(l=b,p&&d.set(p,!0)),p=f,d.set(f,!1)}p&&d.set(p,!0);for(const[g,f]of d)g.classList.toggle("last-in-row",f)}return r}doLayoutTabsNonWrapping(e,t,i){const[o,s]=Ji(this.tabsContainer,this.tabsScrollbar),n=o.offsetWidth,r=o.scrollWidth;let a=0;if(this.group.stickyCount>0){let $=0;switch(this.accessor.partOptions.pinnedTabSizing){case"compact":$=Ke.TAB_WIDTH.compact;break;case"shrink":$=Ke.TAB_WIDTH.shrink;break}a=this.group.stickyCount*$}let d=this.accessor.partOptions.pinnedTabSizing!=="normal"&&this.group.isSticky(t),l=n-a;this.group.stickyCount>0&&l<Ke.TAB_WIDTH.fit?(o.classList.add("disable-sticky-tabs"),l=n,a=0,d=!1):o.classList.remove("disable-sticky-tabs");let p,g;this.blockRevealActiveTab||(p=e.offsetLeft,g=e.offsetWidth);const{width:f,scrollWidth:b}=s.getScrollDimensions();s.setScrollDimensions({width:n,scrollWidth:r});const m=f!==n||b!==r;if(this.blockRevealActiveTab||typeof p!="number"||typeof g!="number"||d||!m&&!(i!=null&&i.forceRevealActiveTab)){this.blockRevealActiveTab=!1;return}const y=s.getScrollPosition().scrollLeft,D=g<=l,L=p-a;D&&y+l<L+g?s.setScrollPosition({scrollLeft:y+(L+g-(y+l))}):(y>L||!D)&&s.setScrollPosition({scrollLeft:L})}getTabAndIndex(e){const t=this.group.getIndexOfEditor(e),i=this.getTabAtIndex(t);if(i)return[i,t]}getTabAtIndex(e){if(e>=0)return K(this.tabsContainer).children[e]}getLastTab(){return this.getTabAtIndex(this.group.count-1)}blockRevealActiveTabOnce(){this.blockRevealActiveTab=!0}originatesFromTabActionBar(e){let t;return e instanceof MouseEvent?t=e.target||e.srcElement:t=e.initialTarget,!!tn(t,"action-item","tab")}async onDrop(e,t,i){if(X.stop(e,!0),this.updateDropFeedback(i,!1),i.classList.remove("scroll"),this.groupTransfer.hasData(He.prototype)){const o=this.groupTransfer.getData(He.prototype);if(Array.isArray(o)){const s=this.accessor.getGroup(o[0].identifier);if(s){const n={index:t};this.isMoveOperation(e,s.id)||(n.mode=0),this.accessor.mergeGroup(s,this.group,n)}this.group.focus(),this.groupTransfer.clearData(He.prototype)}}else if(this.editorTransfer.hasData(_e.prototype)){const o=this.editorTransfer.getData(_e.prototype);if(Array.isArray(o)){const s=o[0].identifier,n=this.accessor.getGroup(s.groupId);n&&(this.isMoveOperation(e,s.groupId,s.editor)?n.moveEditor(s.editor,this.group,{index:t}):n.copyEditor(s.editor,this.group,{index:t})),this.group.focus(),this.editorTransfer.clearData(_e.prototype)}}else if(this.treeItemsTransfer.hasData(kt.prototype)){const o=this.treeItemsTransfer.getData(kt.prototype);if(Array.isArray(o)){const s=[];for(const n of o){const r=await this.treeViewsDragAndDropService.removeDragOperationTransfer(n.identifier);if(r){const a=await Gh(r);s.push(...a.map(d=>({...d,options:{...d.options,pinned:!0,index:t}})))}}this.editorService.openEditors(s,this.group,{validateTrust:!0})}this.treeItemsTransfer.clearData(kt.prototype)}else this.instantiationService.createInstance(Uh,{allowWorkspaceOpen:!1}).handleDrop(e,()=>this.group,()=>this.group.focus(),t)}isMoveOperation(e,t,i){return i!=null&&i.hasCapability(8)?!0:!(e.ctrlKey&&!De||e.altKey&&De)||t===this.group.id}dispose(){super.dispose(),this.tabDisposables=ie(this.tabDisposables)}};ei.SCROLLBAR_SIZES={default:3,large:10};ei.TAB_WIDTH={compact:38,shrink:80,fit:120};ei.TAB_HEIGHT=35;ei.DRAG_OVER_OPEN_TAB_THRESHOLD=1500;ei.MOUSE_WHEEL_EVENT_THRESHOLD=150;ei.MOUSE_WHEEL_DISTANCE_THRESHOLD=1.5;ei=C([h(3,ke),h(4,I),h(5,G),h(6,ve),h(7,Ae),h(8,rt),h(9,ks),h(10,te),h(11,O),h(12,Ce),h(13,P),h(14,Mn),h(15,ee),h(16,Wc)],ei);Pc((c,e)=>{const t=c.getColor(Ar);t&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title > .tabs-and-actions-container.wrapping .tabs-container > .tab {
				border-bottom: 1px solid ${t};
			}
		`);const i=c.getColor(lo);i&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active,
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active:hover  {
				outline: 1px solid;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active {
				outline: 1px dotted;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {
				outline: 1px dashed;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active:hover > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.dirty > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.sticky > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-actions .action-label {
				opacity: 1 !important;
			}
		`);const o=c.getColor(Ze);o&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .editor-actions {
				outline: 1px solid ${o}
			}
		`);const s=c.getColor(_g);s&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:hover  {
				background-color: ${s} !important;
			}
		`);const n=c.getColor(Eg);n&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {
				background-color: ${n} !important;
			}
		`);const r=c.getColor(Dg);r&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:hover  {
				color: ${r} !important;
			}
		`);const a=c.getColor(kg);a&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {
				color: ${a} !important;
			}
		`);const d=c.getColor(xg);d&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:hover > .tab-border-bottom-container {
				display: block;
				position: absolute;
				left: 0;
				pointer-events: none;
				width: 100%;
				z-index: 10;
				bottom: 0;
				height: 1px;
				background-color: ${d};
			}
		`);const l=c.getColor(Ig);if(l&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-border-bottom-container  {
				display: block;
				position: absolute;
				left: 0;
				pointer-events: none;
				width: 100%;
				z-index: 10;
				bottom: 0;
				height: 1px;
				background-color: ${l};
			}
		`),!Hc(c.type)&&!Yb&&!i){const p=Ag(c),g=c.getColor(Gc),f=c.getColor(Ph),b=c.getColor(On);let m;f&&g&&(m=f.flatten(g,g,p));let y;f&&g&&b&&g&&(y=f.flatten(g,b,g,p));const D=(re,ae,dt=!1)=>`
			.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${dt?".active":""} > .title .tabs-container > .tab.sizing-shrink:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after,
			.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${dt?".active":""} > .title .tabs-container > .tab.sizing-fixed:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after {
				background: linear-gradient(to left, ${re}, transparent) !important;
			}

			.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${dt?".active":""} > .title .tabs-container > .tab.sizing-shrink:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after,
			.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${dt?".active":""} > .title .tabs-container > .tab.sizing-fixed:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after {
				background: linear-gradient(to left, ${ae}, transparent) !important;
			}
		`;if(s&&m&&y){const re=s.flatten(m),ae=s.flatten(y);e.addRule(D(re,ae,!0))}if(n&&m&&y){const re=n.flatten(m),ae=n.flatten(y);e.addRule(D(re,ae))}if(b&&y){const re=b.flatten(y);e.addRule(`
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.active):not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-fixed.dragged-over:not(.active):not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-fixed.dragged-over:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {
					background: linear-gradient(to left, ${re}, transparent) !important;
				}
		`)}const L=(re,ae,dt,ri)=>`
				.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${dt?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-shrink${ri?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${dt?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-fixed${ri?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {
					background: linear-gradient(to left, ${re}, transparent);
				}

				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${dt?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-shrink${ri?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${dt?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-fixed${ri?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {
					background: linear-gradient(to left, ${ae}, transparent);
				}
		`,$=c.getColor(Tr);if($&&m&&y){const re=$.flatten(m),ae=$.flatten(y);e.addRule(L(re,ae,!0,!0))}const Se=c.getColor(Fh);if(Se&&m&&y){const re=Se.flatten(m),ae=Se.flatten(y);e.addRule(L(re,ae,!1,!0))}const St=c.getColor(Vr);if(St&&m&&y){const re=St.flatten(m),ae=St.flatten(y);e.addRule(L(re,ae,!0,!1))}const F=c.getColor(Nh);if(F&&m&&y){const re=F.flatten(m),ae=F.flatten(y);e.addRule(L(re,ae,!1,!1))}}});let ga=class extends V{get minimumWidth(){var e;return((e=this._activeEditorPane)==null?void 0:e.minimumWidth)??Sd.width}get minimumHeight(){var e;return((e=this._activeEditorPane)==null?void 0:e.minimumHeight)??Sd.height}get maximumWidth(){var e;return((e=this._activeEditorPane)==null?void 0:e.maximumWidth)??_d.width}get maximumHeight(){var e;return((e=this._activeEditorPane)==null?void 0:e.maximumHeight)??_d.height}get activeEditorPane(){return this._activeEditorPane}constructor(e,t,i,o,s,n,r,a,d){super(),this.editorGroupParent=e,this.editorPanesParent=t,this.groupView=i,this.layoutService=o,this.instantiationService=s,this.editorProgressService=n,this.workspaceTrustService=r,this.logService=a,this.dialogService=d,this._onDidFocus=this._register(new w),this.onDidFocus=this._onDidFocus.event,this._onDidChangeSizeConstraints=this._register(new w),this.onDidChangeSizeConstraints=this._onDidChangeSizeConstraints.event,this._activeEditorPane=null,this.editorPanes=[],this.activeEditorPaneDisposables=this._register(new x),this.editorOperation=this._register(new tv(this.editorProgressService)),this.editorPanesRegistry=M.as(ii.EditorPane),this.registerListeners()}registerListeners(){this._register(this.workspaceTrustService.onDidChangeTrust(()=>this.onDidChangeWorkspaceTrust()))}onDidChangeWorkspaceTrust(){var i,o;const e=(i=this._activeEditorPane)==null?void 0:i.input,t=(o=this._activeEditorPane)==null?void 0:o.options;e!=null&&e.hasCapability(16)&&this.groupView.openEditor(e,t)}async openEditor(e,t,i=Object.create(null)){try{return await this.doOpenEditor(this.getEditorPaneDescriptor(e),e,t,i)}catch(o){return t!=null&&t.ignoreError?{error:o}:this.doShowError(o,e,t,i)}}async doShowError(e,t,i,o){this.logService.error(e);let s=!1;if((i==null?void 0:i.source)===Yl.USER&&(!Ed(e)||e.allowDialog)&&(s=await this.doShowErrorDialog(e,t)),s)return{error:e};const n={...i};return Ui(e)||(n.error=e),{...await this.doOpenEditor(Lw.DESCRIPTOR,t,n,o),error:e}}async doShowErrorDialog(e,t){let i=Ut.Error,o,s=go(e),n;Ed(e)&&(n=e.actions,i=e.forceSeverity??Ut.Error,e.forceMessage&&(o=e.message,s=void 0)),o||(o=u("editorOpenErrorDialog","Unable to open '{0}'",t.getName()));const r=[];if(n&&n.length>0)for(const p of n)r.push({label:p.label,run:()=>p});else r.push({label:u({key:"ok",comment:["&& denotes a mnemonic"]},"&&OK"),run:()=>{}});let a;r.length===1&&(a={run:()=>{d=!0}});let d=!1;const{result:l}=await this.dialogService.prompt({type:i,message:o,detail:s,buttons:r,cancelButton:a});if(l){const p=l.run();p instanceof Promise&&p.catch(g=>this.dialogService.error(go(g))),d=!0}return d}async doOpenEditor(e,t,i,o=Object.create(null)){const s=this.doShowEditorPane(e),n=document.activeElement,{changed:r,cancelled:a}=await this.doSetInput(s,t,i,o),d=!i||!i.preserveFocus;return!a&&d&&this.shouldRestoreFocus(n)&&s.focus(),{pane:s,changed:r,cancelled:a}}shouldRestoreFocus(e){if(!this.layoutService.isRestored()||!e)return!0;const t=document.activeElement;return!!(!t||t===document.body||e===t||t.tagName!=="INPUT"&&t.tagName!=="TEXTAREA"||Tt(t,this.editorGroupParent))}getEditorPaneDescriptor(e){return e.hasCapability(16)&&!this.workspaceTrustService.isWorkspaceTrusted()?Mw.DESCRIPTOR:K(this.editorPanesRegistry.getEditorPane(e))}doShowEditorPane(e){if(this._activeEditorPane&&e.describes(this._activeEditorPane))return this._activeEditorPane;this.doHideActiveEditorPane();const t=this.doCreateEditorPane(e);this.doSetActiveEditorPane(t);const i=K(t.getContainer());return this.editorPanesParent.appendChild(i),fi(i),t.setVisible(!0,this.groupView),this.pagePosition&&t.layout(new q(this.pagePosition.width,this.pagePosition.height),{top:this.pagePosition.top,left:this.pagePosition.left}),this.boundarySashes&&t.setBoundarySashes(this.boundarySashes),t}doCreateEditorPane(e){const t=this.doInstantiateEditorPane(e);if(!t.getContainer()){const i=document.createElement("div");i.classList.add("editor-instance"),t.create(i)}return t}doInstantiateEditorPane(e){const t=this.editorPanes.find(o=>e.describes(o));if(t)return t;const i=this._register(e.instantiate(this.instantiationService));return this.editorPanes.push(i),i}doSetActiveEditorPane(e){this._activeEditorPane=e,this.activeEditorPaneDisposables.clear(),e&&(this.activeEditorPaneDisposables.add(e.onDidChangeSizeConstraints(t=>this._onDidChangeSizeConstraints.fire(t))),this.activeEditorPaneDisposables.add(e.onDidFocus(()=>this._onDidFocus.fire()))),this._onDidChangeSizeConstraints.fire(void 0)}async doSetInput(e,t,i,o){var a;const s=(a=e.input)==null?void 0:a.matches(t);if(s&&!(i!=null&&i.forceReload))return e.setOptions(i),{changed:!1,cancelled:!1};const n=this.editorOperation.start(this.layoutService.isRestored()?800:3200);let r=!1;try{e.clearInput(),await e.setInput(t,i,o,n.token),n.isCurrent()||(r=!0)}catch(d){if(!n.isCurrent())r=!0;else throw d}finally{n.stop()}return{changed:!s,cancelled:r}}doHideActiveEditorPane(){if(!this._activeEditorPane)return;this.editorOperation.stop(),this.safeRun(()=>{var t;return(t=this._activeEditorPane)==null?void 0:t.clearInput()}),this.safeRun(()=>{var t;return(t=this._activeEditorPane)==null?void 0:t.setVisible(!1,this.groupView)});const e=this._activeEditorPane.getContainer();e&&(this.editorPanesParent.removeChild(e),mi(e)),this.doSetActiveEditorPane(null)}closeEditor(e){var t;(t=this._activeEditorPane)!=null&&t.input&&e.matches(this._activeEditorPane.input)&&this.doHideActiveEditorPane()}setVisible(e){this.safeRun(()=>{var t;return(t=this._activeEditorPane)==null?void 0:t.setVisible(e,this.groupView)})}layout(e){this.pagePosition=e,this.safeRun(()=>{var t;return(t=this._activeEditorPane)==null?void 0:t.layout(new q(e.width,e.height),e)})}setBoundarySashes(e){this.boundarySashes=e,this.safeRun(()=>{var t;return(t=this._activeEditorPane)==null?void 0:t.setBoundarySashes(e)})}safeRun(e){try{e()}catch(t){this.logService.error(t)}}};ga=C([h(3,st),h(4,I),h(5,Vc),h(6,ev),h(7,it),h(8,uc)],ga);var Iy='.monaco-workbench .part.editor>.content .editor-group-container>.title>.label-container{align-items:center;display:flex;flex:auto;height:35px;justify-content:flex-start;overflow:hidden}.monaco-workbench .part.editor>.content .editor-group-container>.title>.label-container>.title-label{line-height:35px;overflow:hidden;padding-left:20px;position:relative;text-overflow:ellipsis}.monaco-workbench .part.editor>.content .editor-group-container>.title>.label-container>.title-label>.monaco-icon-label-container{flex:initial}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .no-tabs.title-label{flex:none}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control{flex:1 50%;margin-left:.45em;overflow:hidden}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item{font-size:.9em}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control.preview .monaco-breadcrumb-item{font-style:italic}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item:before{background-image:none;content:"/";height:inherit;opacity:1;width:inherit}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control.backslash-path .monaco-breadcrumb-item:before{content:"\\\\"}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item.root_folder+.monaco-breadcrumb-item:before,.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item.root_folder:before,.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control.relative-path .monaco-breadcrumb-item:nth-child(2):before,.monaco-workbench.windows .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item:nth-child(2):before{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item.root_folder:after{content:"\\00a0\\00a0";padding:0}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item:last-child{padding-right:4px}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item .codicon[class*=codicon-symbol-]{padding:0 1px}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item .codicon:last-child{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-icon-label:before{height:18px;padding-right:2px}.monaco-workbench .part.editor>.content .editor-group-container>.title>.title-actions{display:flex;flex:initial;height:35px;opacity:.5;padding-right:8px}.monaco-workbench .part.editor>.content .editor-group-container>.title>.title-actions .action-item{margin-right:4px}.monaco-workbench .part.editor>.content .editor-group-container.active>.title>.title-actions{opacity:1}';he(Iy,{});class er extends mn{constructor(){super(...arguments),this.activeLabel=Object.create(null)}create(e){const t=this.titleContainer=e;t.draggable=!0,this.registerContainerListeners(t),this._register(Yt.addTarget(t));const i=document.createElement("div");i.classList.add("label-container"),t.appendChild(i),this.editorLabel=this._register(this.instantiationService.createInstance(Ug,i,void 0)).element,this._register(_(this.editorLabel.element,E.CLICK,s=>this.onTitleLabelClick(s))),this.createBreadcrumbsControl(i,{showFileIcons:!1,showSymbolIcons:!0,showDecorationColors:!1,widgetStyles:{...$l,breadcrumbsBackground:vi.transparent.toString()},showPlaceholder:!1}),t.classList.toggle("breadcrumbs",!!this.breadcrumbsControl),this._register(Y(()=>t.classList.remove("breadcrumbs")));const o=document.createElement("div");o.classList.add("title-actions"),t.appendChild(o),this.createEditorActionsToolBar(o)}registerContainerListeners(e){this.enableGroupDragging(e),this._register(_(e,E.DBLCLICK,t=>this.onTitleDoubleClick(t))),this._register(_(e,E.AUXCLICK,t=>this.onTitleAuxClick(t))),this._register(_(e,Ve.Tap,t=>this.onTitleTap(t)));for(const t of[E.CONTEXT_MENU,Ve.Contextmenu])this._register(_(e,t,i=>{this.group.activeEditor&&this.onContextMenu(this.group.activeEditor,i,e)}))}onTitleLabelClick(e){X.stop(e,!1),setTimeout(()=>this.quickInputService.quickAccess.show())}onTitleDoubleClick(e){X.stop(e),this.group.pinEditor()}onTitleAuxClick(e){e.button===1&&this.group.activeEditor&&(X.stop(e,!0),this.group.closeEditor(this.group.activeEditor))}onTitleTap(e){const t=e.initialTarget;!(t instanceof HTMLElement)||!this.editorLabel||!Tt(t,this.editorLabel.element)||setTimeout(()=>this.quickInputService.quickAccess.show(),50)}openEditor(e){this.doHandleOpenEditor()}openEditors(e){this.doHandleOpenEditor()}doHandleOpenEditor(){this.ifActiveEditorChanged(()=>this.redraw())||this.ifActiveEditorPropertiesChanged(()=>this.redraw())}beforeCloseEditor(e){}closeEditor(e){this.ifActiveEditorChanged(()=>this.redraw())}closeEditors(e){this.ifActiveEditorChanged(()=>this.redraw())}moveEditor(e,t,i){this.ifActiveEditorChanged(()=>this.redraw())}pinEditor(e){this.ifEditorIsActive(e,()=>this.redraw())}stickEditor(e){}unstickEditor(e){}setActive(e){this.redraw()}updateEditorLabel(e){this.ifEditorIsActive(e,()=>this.redraw())}updateEditorDirty(e){this.ifEditorIsActive(e,()=>{const t=K(this.titleContainer);e.isDirty()&&!e.isSaving()?t.classList.add("dirty"):t.classList.remove("dirty")})}updateOptions(e,t){(e.labelFormat!==t.labelFormat||!Uc(e.decorations,t.decorations))&&this.redraw()}updateStyles(){this.redraw()}handleBreadcrumbsEnablementChange(){K(this.titleContainer).classList.toggle("breadcrumbs",!!this.breadcrumbsControl),this.redraw()}ifActiveEditorChanged(e){return!this.activeLabel.editor&&this.group.activeEditor||this.activeLabel.editor&&!this.group.activeEditor||!this.activeLabel.editor||!this.group.isActive(this.activeLabel.editor)?(e(),!0):!1}ifActiveEditorPropertiesChanged(e){!this.activeLabel.editor||!this.group.activeEditor||this.activeLabel.pinned!==this.group.isPinned(this.group.activeEditor)&&e()}ifEditorIsActive(e,t){this.group.isActive(e)&&t()}redraw(){var r,a;const e=At(this.group.activeEditor),t=this.accessor.partOptions,i=e?this.group.isPinned(e):!1,o=this.accessor.activeGroup===this.group;this.activeLabel={editor:e,pinned:i},this.breadcrumbsControl&&(o?(this.breadcrumbsControl.update(),this.breadcrumbsControl.domNode.classList.toggle("preview",!i)):this.breadcrumbsControl.hide());const[s,n]=Ji(this.titleContainer,this.editorLabel);if(!e)s.classList.remove("dirty"),n.clear(),this.clearEditorActionsToolbar();else{this.updateEditorDirty(e);const{labelFormat:d}=this.accessor.partOptions;let l;this.breadcrumbsControl&&!this.breadcrumbsControl.isHidden()||d==="default"&&!o?l="":l=e.getDescription(this.getVerbosity(d))||"";let p=e.getTitle(2);l===p&&(p=""),n.setResource({resource:ne.getOriginalUri(e,{supportSideBySide:J.BOTH}),name:e.getName(),description:l},{title:p,italic:!i,extraClasses:["no-tabs","title-label"].concat(e.getLabelExtraClasses()),fileDecorations:{colors:!!((r=t.decorations)!=null&&r.colors),badges:!!((a=t.decorations)!=null&&a.badges)}}),o?s.style.color=this.getColor(Bh)||"":s.style.color=this.getColor(Wh)||"",this.updateEditorActionsToolbar()}}getVerbosity(e){switch(e){case"short":return 0;case"long":return 2;default:return 1}}prepareEditorActions(e){return this.accessor.activeGroup===this.group?e:{primary:e.primary.filter(i=>i.id===zh||i.id===Hh),secondary:e.secondary}}getHeight(){return{total:er.HEIGHT,offset:0}}layout(e){var t;return(t=this.breadcrumbsControl)==null||t.layout(void 0),new q(e.container.width,this.getHeight().total)}}er.HEIGHT=35;const Ju={text:u("watermark.showCommands","Show All Commands"),id:"workbench.action.showCommands"},Ay={text:u("watermark.quickAccess","Go to File"),id:"workbench.action.quickOpen"},Ty={text:u("watermark.openFile","Open File"),id:"workbench.action.files.openFile",mac:!1},Vy={text:u("watermark.openFolder","Open Folder"),id:"workbench.action.files.openFolder",mac:!1},Oy={text:u("watermark.openFileFolder","Open File or Folder"),id:"workbench.action.files.openFileFolder",mac:!0},Ry={text:u("watermark.openRecent","Open Recent"),id:"workbench.action.openRecent"},Ly={text:u("watermark.newUntitledFile","New Untitled Text File"),id:"workbench.action.files.newUntitledFile"},My=Object.assign({mac:!0},Ly),Py={text:u("watermark.findInFiles","Find in Files"),id:"workbench.action.findInFiles"},Fy={text:u({key:"watermark.toggleTerminal",comment:["toggle is a verb here"]},"Toggle Terminal"),id:"workbench.action.terminal.toggleTerminal",when:v.equals("terminalProcessSupported",!0)},Ny={text:u("watermark.startDebugging","Start Debugging"),id:"workbench.action.debug.start",when:v.equals("terminalProcessSupported",!0)},By={text:u({key:"watermark.toggleFullscreen",comment:["toggle is a verb here"]},"Toggle Full Screen"),id:"workbench.action.toggleFullScreen",when:v.equals("terminalProcessSupported",!0).negate()},Wy={text:u("watermark.showSettings","Show Settings"),id:"workbench.action.openSettings",when:v.equals("terminalProcessSupported",!0).negate()},fh=[Ju,Ty,Vy,Oy,Ry,My],mh=[Ju,Ay,Py,Ny,Fy,By,Wy];let fa=class extends V{constructor(e,t,i,o,s,n,r){super(),this.lifecycleService=t,this.keybindingService=i,this.contextService=o,this.contextKeyService=s,this.configurationService=n,this.telemetryService=r,this.transientDisposables=this._register(new x),this.enabled=!1;const a=fr(".editor-group-watermark",[fr(".letterpress"),fr(".shortcuts@shortcuts")]);de(e,a.root),this.shortcuts=a.shortcuts,this.registerListeners(),this.workbenchState=o.getWorkbenchState(),this.render()}registerListeners(){this.lifecycleService.onDidShutdown(()=>this.dispose()),this._register(this.configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration("workbench.tips.enabled")&&this.render()})),this._register(this.contextService.onDidChangeWorkbenchState(i=>{this.workbenchState!==i&&(this.workbenchState=i,this.render())}));const e=[...fh,...mh].filter(i=>i.when!==void 0).map(i=>i.when),t=new Set;e.forEach(i=>i.keys().forEach(o=>t.add(o))),this._register(this.contextKeyService.onDidChangeContext(i=>{i.affectsSome(t)&&this.render()}))}render(){const e=this.configurationService.getValue("workbench.tips.enabled");if(e===this.enabled||(this.enabled=e,this.clear(),!e))return;const t=de(this.shortcuts,z(".watermark-box"));(this.workbenchState!==1?mh:fh).filter(s=>!("when"in s)||this.contextKeyService.contextMatchesRules(s.when)).filter(s=>!("mac"in s)||s.mac===(De&&!pt)).filter(s=>!!Le.getCommand(s.id));const o=()=>{Jt(t)};o(),this.transientDisposables.add(this.keybindingService.onDidUpdateKeybindings(o)),this.telemetryService.publicLog("watermark:open")}clear(){Jt(this.shortcuts),this.transientDisposables.clear()}dispose(){super.dispose(),this.clear()}};fa=C([h(1,_o),h(2,ve),h(3,ze),h(4,G),h(5,O),h(6,Ne)],fa);let Qi=class ki extends Jn{static createNew(e,t,i){return i.createInstance(ki,e,null,t)}static createFromSerialized(e,t,i,o){return o.createInstance(ki,t,e,i)}static createCopy(e,t,i,o){return o.createInstance(ki,t,e,i)}constructor(e,t,i,o,s,n,r,a,d,l,p,g,f,b,m){super(n),this.accessor=e,this._index=i,this.instantiationService=o,this.contextKeyService=s,this.telemetryService=r,this.keybindingService=a,this.menuService=d,this.contextMenuService=l,this.fileDialogService=p,this.editorService=g,this.filesConfigurationService=f,this.uriIdentityService=b,this.logService=m,this._onDidFocus=this._register(new w),this.onDidFocus=this._onDidFocus.event,this._onWillDispose=this._register(new w),this.onWillDispose=this._onWillDispose.event,this._onDidModelChange=this._register(new w),this.onDidModelChange=this._onDidModelChange.event,this._onDidActiveEditorChange=this._register(new w),this.onDidActiveEditorChange=this._onDidActiveEditorChange.event,this._onDidOpenEditorFail=this._register(new w),this.onDidOpenEditorFail=this._onDidOpenEditorFail.event,this._onWillCloseEditor=this._register(new w),this.onWillCloseEditor=this._onWillCloseEditor.event,this._onDidCloseEditor=this._register(new w),this.onDidCloseEditor=this._onDidCloseEditor.event,this._onWillMoveEditor=this._register(new w),this.onWillMoveEditor=this._onWillMoveEditor.event,this._onWillOpenEditor=this._register(new w),this.onWillOpenEditor=this._onWillOpenEditor.event,this.disposedEditorsWorker=this._register(new Jl(D=>this.handleDisposedEditors(D),0)),this.mapEditorToPendingConfirmation=new Map,this.containerToolBarMenuDisposable=this._register(new Ie),this.whenRestoredPromise=new Gr,this.whenRestored=this.whenRestoredPromise.p,this._disposed=!1,this.element=document.createElement("div"),this._onDidChange=this._register(new qt),this.onDidChange=this._onDidChange.event,t instanceof ki?this.model=this._register(t.model.clone()):$h(t)?this.model=this._register(o.createInstance(Dd,t)):this.model=this._register(o.createInstance(Dd,void 0)),this.scopedContextKeyService=this._register(this.contextKeyService.createScoped(this.element)),this.element.classList.add("editor-group-container"),this.registerContainerListeners(),this.createContainerToolbar(),this.createContainerContextMenu(),this._register(this.instantiationService.createInstance(fa,this.element)),this.progressBar=this._register(new Rc(this.element,Lc)),this.progressBar.hide(),this.scopedInstantiationService=this.instantiationService.createChild(new Ol([G,this.scopedContextKeyService],[Vc,this._register(new zg(this.progressBar,this))])),this.handleGroupContextKeys(),this.titleContainer=document.createElement("div"),this.titleContainer.classList.add("title"),this.element.appendChild(this.titleContainer),this.titleAreaControl=this.createTitleAreaControl(),this.editorContainer=document.createElement("div"),this.editorContainer.classList.add("editor-container"),this.element.appendChild(this.editorContainer),this.editorPane=this._register(this.scopedInstantiationService.createInstance(ga,this.element,this.editorContainer,this)),this._onDidChange.input=this.editorPane.onDidChangeSizeConstraints,this.doTrackFocus(),this.updateTitleContainer(),this.updateContainer(),this.updateStyles(),(this.restoreEditors(t)??Promise.resolve()).finally(()=>{this.whenRestoredPromise.complete()}),this.registerListeners()}handleGroupContextKeys(){const e=Kg.bindTo(this.scopedContextKeyService),t=Th.bindTo(this.scopedContextKeyService),i=Vh.bindTo(this.scopedContextKeyService),o=Oh.bindTo(this.scopedContextKeyService),s=Rh.bindTo(this.scopedContextKeyService),n=$g.bindTo(this.scopedContextKeyService),r=Lh.bindTo(this.scopedContextKeyService),a=new Ie,d=()=>{a.clear();const l=this.model.activeEditor;l?(e.set(l.isDirty()&&!l.isSaving()),a.value=l.onDidChangeDirty(()=>{e.set(l.isDirty()&&!l.isSaving())})):e.set(!1)};this._register(this.onDidModelChange(l=>{switch(l.kind){case 2:r.set(this.isLocked);break;case 6:case 4:case 3:case 5:i.set(this.model.isFirst(this.model.activeEditor)),o.set(this.model.isLast(this.model.activeEditor));break;case 9:l.editor&&l.editor===this.model.activeEditor&&t.set(this.model.isPinned(this.model.activeEditor));break;case 10:l.editor&&l.editor===this.model.activeEditor&&s.set(this.model.isSticky(this.model.activeEditor));break}n.set(this.count)})),this._register(this.onDidActiveEditorChange(()=>{d()})),d()}registerContainerListeners(){this._register(_(this.element,E.DBLCLICK,e=>{this.isEmpty&&(X.stop(e),this.editorService.openEditor({resource:void 0,options:{pinned:!0,override:We.id}},this.id))})),this._register(_(this.element,E.AUXCLICK,e=>{this.isEmpty&&e.button===1&&(X.stop(e,!0),this.accessor.removeGroup(this))}))}createContainerToolbar(){const e=document.createElement("div");e.classList.add("editor-group-container-toolbar"),this.element.appendChild(e);const t=this._register(new xo(e,{ariaLabel:u("ariaLabelGroupActions","Empty editor group actions")})),i=this._register(this.menuService.createMenu(S.EmptyEditorGroup,this.scopedContextKeyService)),o=()=>{const s={primary:[],secondary:[]};this.containerToolBarMenuDisposable.value=Y(()=>t.clear()),Es(i,{arg:{groupId:this.id},shouldForwardArgs:!0},s,"navigation");for(const n of[...s.primary,...s.secondary]){const r=this.keybindingService.lookupKeybinding(n.id);t.push(n,{icon:!0,label:!1,keybinding:r==null?void 0:r.getLabel()})}};o(),this._register(i.onDidChange(o))}createContainerContextMenu(){this._register(_(this.element,E.CONTEXT_MENU,e=>this.onShowContainerContextMenu(e))),this._register(_(this.element,Ve.Contextmenu,()=>this.onShowContainerContextMenu()))}onShowContainerContextMenu(e){if(!this.isEmpty)return;let t=this.element;if(e instanceof MouseEvent){const i=new bt(e);t={x:i.posx,y:i.posy}}this.contextMenuService.showContextMenu({menuId:S.EmptyEditorGroupContext,contextKeyService:this.contextKeyService,getAnchor:()=>t,onHide:()=>{this.focus()}})}doTrackFocus(){const e=this._register(bi(this.element));this._register(e.onDidFocus(()=>{this.isEmpty&&this._onDidFocus.fire()}));const t=i=>{let o;if(i instanceof MouseEvent){if(i.button!==0||De&&i.ctrlKey)return;o=i.target}else o=i.initialTarget;tn(o,"monaco-action-bar",this.titleContainer)||tn(o,"monaco-breadcrumb-item",this.titleContainer)||setTimeout(()=>{this.focus()})};this._register(_(this.titleContainer,E.MOUSE_DOWN,i=>t(i))),this._register(_(this.titleContainer,Ve.Tap,i=>t(i))),this._register(this.editorPane.onDidFocus(()=>{this._onDidFocus.fire()}))}updateContainer(){this.isEmpty?(this.element.classList.add("empty"),this.element.tabIndex=0,this.element.setAttribute("aria-label",u("emptyEditorGroup","{0} (empty)",this.label))):(this.element.classList.remove("empty"),this.element.removeAttribute("tabIndex"),this.element.removeAttribute("aria-label")),this.updateStyles()}updateTitleContainer(){this.titleContainer.classList.toggle("tabs",this.accessor.partOptions.showTabs),this.titleContainer.classList.toggle("show-file-icons",this.accessor.partOptions.showIcons)}createTitleAreaControl(){return this.titleAreaControl&&(this.titleAreaControl.dispose(),Jt(this.titleContainer)),this.accessor.partOptions.showTabs?this.titleAreaControl=this.scopedInstantiationService.createInstance(ei,this.titleContainer,this.accessor,this):this.titleAreaControl=this.scopedInstantiationService.createInstance(er,this.titleContainer,this.accessor,this),this.titleAreaControl}restoreEditors(e){if(this.count===0)return;let t;e instanceof ki?t=Or(e):t=Object.create(null);const i=this.model.activeEditor;if(!i)return;t.pinned=this.model.isPinned(i),t.sticky=this.model.isSticky(i),t.preserveFocus=!0;const o=document.activeElement;return this.doShowEditor(i,{active:!0,isNew:!1},t).then(()=>{this.accessor.activeGroup===this&&o===document.activeElement&&this.focus()})}registerListeners(){this._register(this.model.onDidModelChange(e=>this.onDidGroupModelChange(e))),this._register(this.accessor.onDidChangeEditorPartOptions(e=>this.onDidChangeEditorPartOptions(e))),this._register(this.accessor.onDidVisibilityChange(e=>this.onDidVisibilityChange(e)))}onDidGroupModelChange(e){if(this._onDidModelChange.fire(e),!!e.editor)switch(e.kind){case 3:jg(e)&&this.onDidOpenEditor(e.editor,e.editorIndex);break;case 4:qg(e)&&this.handleOnDidCloseEditor(e.editor,e.editorIndex,e.context,e.sticky);break;case 12:this.onWillDisposeEditor(e.editor);break;case 11:this.onDidChangeEditorDirty(e.editor);break;case 7:this.onDidChangeEditorLabel(e.editor);break}}onDidOpenEditor(e,t){this.telemetryService.publicLog("editorOpened",this.toEditorTelemetryDescriptor(e)),this.updateContainer()}handleOnDidCloseEditor(e,t,i,o){this._onWillCloseEditor.fire({groupId:this.id,editor:e,context:i,index:t,sticky:o});const s=[e];e instanceof Et&&s.push(e.primary,e.secondary);for(const n of s)this.canDispose(n)&&n.dispose();this.telemetryService.publicLog("editorClosed",this.toEditorTelemetryDescriptor(e)),this.updateContainer(),this._onDidCloseEditor.fire({groupId:this.id,editor:e,context:i,index:t,sticky:o})}canDispose(e){for(const t of this.accessor.groups)if(t instanceof ki&&t.model.contains(e,{strictEquals:!0,supportSideBySide:J.ANY}))return!1;return!0}toEditorTelemetryDescriptor(e){const t=e.getTelemetryDescriptor(),i=ne.getOriginalUri(e),o=i?i.scheme===Q.file?i.fsPath:i.path:void 0;if(i&&o){let s=zt(i);const n=s.indexOf("?");return s=n!==-1?s.substr(0,n):s,t.resource={mimeType:new qh(iv(i).join(", ")),scheme:i.scheme,ext:s,path:Is(o)},t}return t}onWillDisposeEditor(e){this.disposedEditorsWorker.work(e)}handleDisposedEditors(e){let t;const i=[];for(const o of e)this.model.isActive(o)?t=o:this.model.contains(o)&&i.push(o);for(const o of i)this.doCloseEditor(o,!1);t&&this.doCloseEditor(t,!1)}onDidChangeEditorPartOptions(e){this.updateTitleContainer(),e.oldPartOptions.showTabs!==e.newPartOptions.showTabs?(this.createTitleAreaControl(),this.relayout(),this.model.activeEditor&&this.titleAreaControl.openEditor(this.model.activeEditor)):this.titleAreaControl.updateOptions(e.oldPartOptions,e.newPartOptions),this.updateStyles(),e.oldPartOptions.enablePreview&&!e.newPartOptions.enablePreview&&this.model.previewEditor&&this.pinEditor(this.model.previewEditor)}onDidChangeEditorDirty(e){this.pinEditor(e),this.titleAreaControl.updateEditorDirty(e)}onDidChangeEditorLabel(e){this.titleAreaControl.updateEditorLabel(e)}onDidVisibilityChange(e){this.editorPane.setVisible(e)}get index(){return this._index}get label(){return u("groupLabel","Group {0}",this._index+1)}get ariaLabel(){return u("groupAriaLabel","Editor Group {0}",this._index+1)}get disposed(){return this._disposed}get isEmpty(){return this.count===0}get titleHeight(){return this.titleAreaControl.getHeight()}notifyIndexChanged(e){this._index!==e&&(this._index=e,this.model.setIndex(e))}setActive(e){this.active=e,this.element.classList.toggle("active",e),this.element.classList.toggle("inactive",!e),this.titleAreaControl.setActive(e),this.updateStyles(),this.model.setActive(void 0)}get id(){return this.model.id}get editors(){return this.model.getEditors(1)}get count(){return this.model.count}get stickyCount(){return this.model.stickyCount}get activeEditorPane(){return this.editorPane?At(this.editorPane.activeEditorPane):void 0}get activeEditor(){return this.model.activeEditor}get previewEditor(){return this.model.previewEditor}isPinned(e){return this.model.isPinned(e)}isSticky(e){return this.model.isSticky(e)}isActive(e){return this.model.isActive(e)}contains(e,t){return this.model.contains(e,t)}getEditors(e,t){return this.model.getEditors(e,t)}findEditors(e,t){const i=this.uriIdentityService.asCanonicalUri(e);return this.getEditors(1).filter(o=>{if(o.resource&&Re(o.resource,i))return!0;if((t==null?void 0:t.supportSideBySide)===J.PRIMARY||(t==null?void 0:t.supportSideBySide)===J.ANY){const s=ne.getCanonicalUri(o,{supportSideBySide:J.PRIMARY});if(s&&Re(s,i))return!0}if((t==null?void 0:t.supportSideBySide)===J.SECONDARY||(t==null?void 0:t.supportSideBySide)===J.ANY){const s=ne.getCanonicalUri(o,{supportSideBySide:J.SECONDARY});if(s&&Re(s,i))return!0}return!1})}getEditorByIndex(e){return this.model.getEditorByIndex(e)}getIndexOfEditor(e){return this.model.indexOf(e)}isFirst(e){return this.model.isFirst(e)}isLast(e){return this.model.isLast(e)}focus(){this.activeEditorPane?this.activeEditorPane.focus():this.element.focus(),this._onDidFocus.fire()}pinEditor(e=this.activeEditor||void 0){if(e&&!this.model.isPinned(e)){const t=this.model.pin(e);t&&this.titleAreaControl.pinEditor(t)}}stickEditor(e=this.activeEditor||void 0){this.doStickEditor(e,!0)}unstickEditor(e=this.activeEditor||void 0){this.doStickEditor(e,!1)}doStickEditor(e,t){if(e&&this.model.isSticky(e)!==t){const i=this.getIndexOfEditor(e),o=t?this.model.stick(e):this.model.unstick(e);if(!o)return;const s=this.getIndexOfEditor(o);s!==i&&this.titleAreaControl.moveEditor(o,i,s),t?this.titleAreaControl.stickEditor(o):this.titleAreaControl.unstickEditor(o)}}async openEditor(e,t){return this.doOpenEditor(e,t,{supportSideBySide:J.BOTH})}async doOpenEditor(e,t,i){var p;if(!e||e.isDisposed())return;this._onWillOpenEditor.fire({editor:e,groupId:this.id});const o=(t==null?void 0:t.sticky)||!this.accessor.partOptions.enablePreview||e.isDirty()||((t==null?void 0:t.pinned)??typeof(t==null?void 0:t.index)=="number")||typeof(t==null?void 0:t.index)=="number"&&this.model.isSticky(t.index)||e.hasCapability(512),s={index:t?t.index:void 0,pinned:o,sticky:(t==null?void 0:t.sticky)||typeof(t==null?void 0:t.index)=="number"&&this.model.isSticky(t.index),active:this.count===0||!t||!t.inactive,supportSideBySide:i==null?void 0:i.supportSideBySide};t!=null&&t.sticky&&typeof(t==null?void 0:t.index)=="number"&&!this.model.isSticky(t.index)&&(s.sticky=!1),!s.active&&!s.pinned&&this.model.activeEditor&&!this.model.isPinned(this.model.activeEditor)&&(s.active=!0);let n=!1,r=!1;if((t==null?void 0:t.activation)===pi.ACTIVATE?n=!0:(t==null?void 0:t.activation)===pi.RESTORE?r=!0:(t==null?void 0:t.activation)===pi.PRESERVE?(n=!1,r=!1):s.active&&(n=!t||!t.preserveFocus,r=!n),typeof s.index=="number"){const g=this.model.indexOf(e);g!==-1&&g!==s.index&&this.doMoveEditorInsideGroup(e,s)}const{editor:a,isNew:d}=this.model.openEditor(e,s);d&&this.count===1&&this.accessor.groups.length>1&&a.editorId&&(p=this.accessor.partOptions.autoLockGroups)!=null&&p.has(a.editorId)&&this.lock(!0);const l=this.doShowEditor(a,{active:!!s.active,isNew:d},t,i);return n?this.accessor.activateGroup(this):r&&this.accessor.restoreGroup(this),l}doShowEditor(e,t,i,o){let s;return t.active?s=(async()=>{const{pane:n,changed:r,cancelled:a,error:d}=await this.editorPane.openEditor(e,i,{newInGroup:t.isNew});if(!a){if(r&&this._onDidActiveEditorChange.fire({editor:e}),d&&this._onDidOpenEditorFail.fire(e),!n&&this.activeEditor===e){const l=!i||!i.preserveFocus;this.doCloseEditor(e,l,{fromError:!0})}return n}})():s=Promise.resolve(void 0),o!=null&&o.skipTitleUpdate||this.titleAreaControl.openEditor(e),s}async openEditors(e){const t=Ge(e).filter(({editor:r})=>!r.isDisposed()),i=zc(t);if(!i)return;const o={supportSideBySide:J.BOTH};await this.doOpenEditor(i.editor,i.options,o);const s=t.slice(1),n=this.getIndexOfEditor(i.editor)+1;return await Go.settled(s.map(({editor:r,options:a},d)=>this.doOpenEditor(r,{...a,inactive:!0,pinned:!0,index:n+d},{...o,skipTitleUpdate:!0}))),this.titleAreaControl.openEditors(s.map(({editor:r})=>r)),At(this.editorPane.activeEditorPane)}moveEditors(e,t){const i={skipTitleUpdate:this!==t};for(const{editor:o,options:s}of e)this.moveEditor(o,t,s,i);if(i.skipTitleUpdate){const o=e.map(({editor:s})=>s);t.titleAreaControl.openEditors(o),this.titleAreaControl.closeEditors(o)}}moveEditor(e,t,i,o){this===t?this.doMoveEditorInsideGroup(e,i):this.doMoveOrCopyEditorAcrossGroups(e,t,i,{...o,keepCopy:!1})}doMoveEditorInsideGroup(e,t){const i=t?t.index:void 0;if(typeof i!="number")return;const o=this.model.indexOf(e);if(o===-1||o===i)return;const s=this.model.getEditorByIndex(o);s&&(this.model.moveEditor(s,i),this.model.pin(s),this.titleAreaControl.moveEditor(s,o,i),this.titleAreaControl.pinEditor(s))}doMoveOrCopyEditorAcrossGroups(e,t,i,o){const s=o==null?void 0:o.keepCopy,n=Or(this,e,{...i,pinned:!0,sticky:!s&&this.model.isSticky(e)});s||this._onWillMoveEditor.fire({groupId:this.id,editor:e,target:t.id}),t.doOpenEditor(s?e.copy():e,n,o),s||this.doCloseEditor(e,!1,{...o,context:xi.MOVE})}copyEditors(e,t){const i={skipTitleUpdate:this!==t};for(const{editor:o,options:s}of e)this.copyEditor(o,t,s,i);if(i.skipTitleUpdate){const o=e.map(({editor:s})=>s);t.titleAreaControl.openEditors(o)}}copyEditor(e,t,i,o){this===t?this.doMoveEditorInsideGroup(e,i):this.doMoveOrCopyEditorAcrossGroups(e,t,i,{...o,keepCopy:!0})}async closeEditor(e=this.activeEditor||void 0,t){return this.doCloseEditorWithConfirmationHandling(e,t)}async doCloseEditorWithConfirmationHandling(e=this.activeEditor||void 0,t,i){return!e||await this.handleCloseConfirmation([e])?!1:(this.doCloseEditor(e,t!=null&&t.preserveFocus?!1:void 0,i),!0)}doCloseEditor(e,t=this.accessor.activeGroup===this,i){i!=null&&i.skipTitleUpdate||this.titleAreaControl.beforeCloseEditor(e),this.model.isActive(e)?this.doCloseActiveEditor(t,i):this.doCloseInactiveEditor(e,i),i!=null&&i.skipTitleUpdate||this.titleAreaControl.closeEditor(e)}doCloseActiveEditor(e=this.accessor.activeGroup===this,t){const i=this.activeEditor,o=this.shouldRestoreFocus(this.element),s=this.accessor.partOptions.closeEmptyGroups;if(s&&this.active&&this.count===1){const a=this.accessor.getGroups(1)[1];a&&(o?a.focus():this.accessor.activateGroup(a))}i&&this.model.closeEditor(i,t==null?void 0:t.context);const n=this.model.activeEditor;if(n){const r=!e;let a;r&&this.accessor.activeGroup!==this&&(a=pi.PRESERVE);const d={preserveFocus:r,activation:a,ignoreError:t==null?void 0:t.fromError};this.doOpenEditor(n,d)}else i&&this.editorPane.closeEditor(i),o&&!s&&this.focus(),this._onDidActiveEditorChange.fire({editor:void 0}),s&&this.accessor.removeGroup(this)}shouldRestoreFocus(e){const t=document.activeElement;return t===document.body?!0:Tt(t,e)}doCloseInactiveEditor(e,t){this.model.closeEditor(e,t==null?void 0:t.context)}async handleCloseConfirmation(e){if(!e.length)return!1;const t=e.shift();let i=this.mapEditorToPendingConfirmation.get(t);i||(i=this.doHandleCloseConfirmation(t),this.mapEditorToPendingConfirmation.set(t,i));let o;try{o=await i}finally{this.mapEditorToPendingConfirmation.delete(t)}return o||this.handleCloseConfirmation(e)}async doHandleCloseConfirmation(e,t){var n;if(!this.shouldConfirmClose(e)||e instanceof Et&&this.model.contains(e.primary)||this.accessor.groups.some(r=>{if(r===this)return!1;const a=r;return!!(a.contains(e,{supportSideBySide:J.BOTH})||e instanceof Et&&a.contains(e.primary))}))return!1;let i=2,o=1,s=!1;if(!e.hasCapability(4)&&!(t!=null&&t.skipAutoSave)&&!e.closeHandler&&(this.filesConfigurationService.getAutoSaveMode()===3?(s=!0,i=0,o=3):Fc&&(Vt||ov)&&this.filesConfigurationService.getAutoSaveMode()===4&&(s=!0,i=0,o=4)),!s)if((!this.activeEditor||!this.activeEditor.matches(e))&&await this.doOpenEditor(e),typeof((n=e.closeHandler)==null?void 0:n.confirm)=="function")i=await e.closeHandler.confirm([{editor:e,groupId:this.id}]);else{let r;e instanceof Et?r=e.primary.getName():r=e.getName(),i=await this.fileDialogService.showSaveConfirm([r])}if(!e.closeHandler&&!this.shouldConfirmClose(e))return i===2;switch(i){case 0:return!await e.save(this.id,{reason:o})&&s?this.doHandleCloseConfirmation(e,{skipAutoSave:!0}):e.isDirty();case 1:try{return await e.revert(this.id),e.isDirty()}catch(r){return this.logService.error(r),await e.revert(this.id,{soft:!0}),e.isDirty()}case 2:return!0}}shouldConfirmClose(e){return e.closeHandler?e.closeHandler.showConfirm():e.isDirty()&&!e.isSaving()}async closeEditors(e,t){if(this.isEmpty)return!0;const i=this.doGetEditorsToClose(e);return await this.handleCloseConfirmation(i.slice(0))?!1:(this.doCloseEditors(i,t),!0)}doGetEditorsToClose(e){if(Array.isArray(e))return e;const t=e,i=typeof t.direction=="number";let o=this.model.getEditors(i?1:0,t);return t.savedOnly?o=o.filter(s=>!s.isDirty()||s.isSaving()):i&&t.except?o=t.direction===0?o.slice(0,this.model.indexOf(t.except,o)):o.slice(this.model.indexOf(t.except,o)+1):t.except&&(o=o.filter(s=>t.except&&!s.matches(t.except))),o}doCloseEditors(e,t){let i=!1;for(const o of e)this.isActive(o)?i=!0:this.doCloseInactiveEditor(o);i&&this.doCloseActiveEditor(t!=null&&t.preserveFocus?!1:void 0),e.length&&this.titleAreaControl.closeEditors(e)}async closeAllEditors(e){return this.isEmpty?(this.accessor.partOptions.closeEmptyGroups&&this.accessor.removeGroup(this),!0):await this.handleCloseConfirmation(this.model.getEditors(0,e))?!1:(this.doCloseAllEditors(e),!0)}doCloseAllEditors(e){const t=[];for(const i of this.model.getEditors(1,e))this.isActive(i)||this.doCloseInactiveEditor(i),t.push(i);this.activeEditor&&t.includes(this.activeEditor)&&this.doCloseActiveEditor(),t.length&&this.titleAreaControl.closeEditors(t)}async replaceEditors(e){let t;const i=[];for(let{editor:o,replacement:s,forceReplaceDirty:n,options:r}of e){const a=this.getIndexOfEditor(o);if(a>=0){const d=this.isActive(o);r?r.index=a:r={index:a},r.inactive=!d,r.pinned=r.pinned??!0;const l={editor:o,replacement:s,forceReplaceDirty:n,options:r};d?t=l:i.push(l)}}for(const{editor:o,replacement:s,forceReplaceDirty:n,options:r}of i)if(await this.doOpenEditor(s,r),!o.matches(s)){let a=!1;if(n?(this.doCloseEditor(o,!1,{context:xi.REPLACE}),a=!0):a=await this.doCloseEditorWithConfirmationHandling(o,{preserveFocus:!0},{context:xi.REPLACE}),!a)return}if(t){const o=this.doOpenEditor(t.replacement,t.options);t.editor.matches(t.replacement)||(t.forceReplaceDirty?this.doCloseEditor(t.editor,!1,{context:xi.REPLACE}):await this.doCloseEditorWithConfirmationHandling(t.editor,{preserveFocus:!0},{context:xi.REPLACE})),await o}}get isLocked(){return this.accessor.groups.length===1?!1:this.model.isLocked}lock(e){this.accessor.groups.length===1&&(e=!1),this.model.lock(e)}updateStyles(){const e=this.isEmpty;e?this.element.style.backgroundColor=this.getColor(Yg)||"":this.element.style.backgroundColor="";const t=this.getColor(Jg)||this.getColor(Ze);!e&&t?(this.titleContainer.classList.add("title-border-bottom"),this.titleContainer.style.setProperty("--title-border-bottom-color",t)):(this.titleContainer.classList.remove("title-border-bottom"),this.titleContainer.style.removeProperty("--title-border-bottom-color"));const{showTabs:i}=this.accessor.partOptions;this.titleContainer.style.backgroundColor=this.getColor(i?Ph:Xg)||"",this.editorContainer.style.backgroundColor=this.getColor(Gc)||""}get minimumWidth(){return this.editorPane.minimumWidth}get minimumHeight(){return this.editorPane.minimumHeight}get maximumWidth(){return this.editorPane.maximumWidth}get maximumHeight(){return this.editorPane.maximumHeight}get proportionalLayout(){return this.lastLayout?!(this.lastLayout.width===this.minimumWidth||this.lastLayout.height===this.minimumHeight):!0}layout(e,t,i,o){this.lastLayout={width:e,height:t,top:i,left:o},this.element.classList.toggle("max-height-478px",t<=478);const s=this.titleAreaControl.layout({container:new q(e,t),available:new q(e,t-this.editorPane.minimumHeight)}),n=Math.max(0,t-s.height);this.editorContainer.style.height=`${n}px`,this.editorPane.layout({width:e,height:n,top:i+s.height,left:o})}relayout(){if(this.lastLayout){const{width:e,height:t,top:i,left:o}=this.lastLayout;this.layout(e,t,i,o)}}setBoundarySashes(e){this.editorPane.setBoundarySashes(e)}toJSON(){return this.model.serialize()}dispose(){this._disposed=!0,this._onWillDispose.fire(),this.titleAreaControl.dispose(),super.dispose()}};Qi=C([h(3,I),h(4,G),h(5,te),h(6,Ne),h(7,ve),h(8,rt),h(9,ke),h(10,Kh),h(11,P),h(12,ms),h(13,si),h(14,it)],Qi);var Hy="#monaco-workbench-editor-drop-overlay{height:100%;left:0;position:absolute;width:100%;z-index:10000}#monaco-workbench-editor-drop-overlay>.editor-group-overlay-indicator{align-items:center;display:flex;height:100%;justify-content:center;left:0;opacity:0;pointer-events:none;position:absolute;top:0;width:100%}.monaco-workbench:not(.reduce-motion) #monaco-workbench-editor-drop-overlay>.editor-group-overlay-indicator{transition:opacity .15s ease-out}#monaco-workbench-editor-drop-overlay .editor-group-overlay-drop-into-prompt{line-height:normal;margin:.2em;opacity:0;padding:.6em;text-align:center}.monaco-workbench:not(.reduce-motion) #monaco-workbench-editor-drop-overlay .editor-group-overlay-drop-into-prompt{transition:opacity .15s ease-out}#monaco-workbench-editor-drop-overlay .editor-group-overlay-drop-into-prompt i{background-color:hsla(0,0%,100%,.05);border:1px solid hsla(0,0%,80%,.4);border-radius:5px;font-style:normal;margin:0 1px;padding:0 8px}.monaco-workbench:not(.reduce-motion) #monaco-workbench-editor-drop-overlay>.editor-group-overlay-indicator.overlay-move-transition{transition:top 70ms ease-out,left 70ms ease-out,width 70ms ease-out,height 70ms ease-out,opacity .15s ease-out}";he(Hy,{});function Xu(c){return c.getValue("editor.dropIntoEditor.enabled")}function Zu(c){return c.shiftKey}let bn=class Qu extends Jn{get disposed(){return!!this._disposed}constructor(e,t,i,o,s,n,r,a,d){super(i),this.accessor=e,this.groupView=t,this.configurationService=o,this.instantiationService=s,this.editorService=n,this.editorGroupService=r,this.treeViewsDragAndDropService=a,this.contextService=d,this.editorTransfer=jt.getInstance(),this.groupTransfer=jt.getInstance(),this.treeItemsTransfer=jt.getInstance(),this.cleanupOverlayScheduler=this._register(new Ds(()=>this.dispose(),300)),this.enableDropIntoEditor=Xu(this.configurationService)&&this.isDropIntoActiveEditorEnabled(),this.create()}create(){const e=this.getOverlayOffsetHeight(),t=this.container=document.createElement("div");t.id=Qu.OVERLAY_ID,t.style.top=`${e}px`,this.groupView.element.appendChild(t),this.groupView.element.classList.add("dragged-over"),this._register(Y(()=>{this.groupView.element.removeChild(t),this.groupView.element.classList.remove("dragged-over")})),this.overlay=document.createElement("div"),this.overlay.classList.add("editor-group-overlay-indicator"),t.appendChild(this.overlay),this.enableDropIntoEditor&&(this.dropIntoPromptElement=sv(u("dropIntoEditorPrompt","Hold __{0}__ to drop into editor",De?"":"Shift"),{}),this.dropIntoPromptElement.classList.add("editor-group-overlay-drop-into-prompt"),this.overlay.appendChild(this.dropIntoPromptElement)),this.registerListeners(t),this.updateStyles()}updateStyles(){const e=K(this.overlay);e.style.backgroundColor=this.getColor(On)||"";const t=this.getColor(lo);if(e.style.outlineColor=t||"",e.style.outlineOffset=t?"-2px":"",e.style.outlineStyle=t?"dashed":"",e.style.outlineWidth=t?"2px":"",this.dropIntoPromptElement){this.dropIntoPromptElement.style.backgroundColor=this.getColor(Zg)??"",this.dropIntoPromptElement.style.color=this.getColor(Qg)??"";const i=this.getColor(ef);i?(this.dropIntoPromptElement.style.borderWidth="1px",this.dropIntoPromptElement.style.borderStyle="solid",this.dropIntoPromptElement.style.borderColor=i):this.dropIntoPromptElement.style.borderWidth="0"}}registerListeners(e){this._register(new Hr(e,{onDragEnter:t=>{},onDragOver:t=>{if(this.enableDropIntoEditor&&Zu(t)){this.dispose();return}const i=this.groupTransfer.hasData(He.prototype),o=this.editorTransfer.hasData(_e.prototype);!o&&!i&&t.dataTransfer&&(t.dataTransfer.dropEffect="copy");let s=!0;if(i)s=this.isCopyOperation(t);else if(o){const r=this.editorTransfer.getData(_e.prototype);Array.isArray(r)&&(s=this.isCopyOperation(t,r[0].identifier))}if(!s){const r=this.findSourceGroupView();if(r===this.groupView&&(i||o&&r.count<2)){this.hideOverlay();return}}let n=!!this.editorGroupService.partOptions.splitOnDragAndDrop;this.isToggleSplitOperation(t)&&(n=!n),this.positionOverlay(t.offsetX,t.offsetY,i,n),this.cleanupOverlayScheduler.isScheduled()&&this.cleanupOverlayScheduler.cancel()},onDragLeave:t=>this.dispose(),onDragEnd:t=>this.dispose(),onDrop:t=>{X.stop(t,!0),this.dispose(),this.currentDropOperation&&this.handleDrop(t,this.currentDropOperation.splitDirection)}})),this._register(_(e,E.MOUSE_OVER,()=>{this.cleanupOverlayScheduler.isScheduled()||this.cleanupOverlayScheduler.schedule()}))}isDropIntoActiveEditorEnabled(){var e;return!!((e=this.groupView.activeEditor)!=null&&e.hasCapability(128))}findSourceGroupView(){if(this.groupTransfer.hasData(He.prototype)){const e=this.groupTransfer.getData(He.prototype);if(Array.isArray(e))return this.accessor.getGroup(e[0].identifier)}else if(this.editorTransfer.hasData(_e.prototype)){const e=this.editorTransfer.getData(_e.prototype);if(Array.isArray(e))return this.accessor.getGroup(e[0].identifier.groupId)}}async handleDrop(e,t){const i=()=>{let o;return typeof t=="number"?o=this.accessor.addGroup(this.groupView,t):o=this.groupView,o};if(this.groupTransfer.hasData(He.prototype)){const o=this.groupTransfer.getData(He.prototype);if(Array.isArray(o)){const s=this.accessor.getGroup(o[0].identifier);if(s){if(typeof t!="number"&&s===this.groupView)return;let n;if(typeof t=="number")this.isCopyOperation(e)?n=this.accessor.copyGroup(s,this.groupView,t):n=this.accessor.moveGroup(s,this.groupView,t);else{let r;this.isCopyOperation(e)&&(r={mode:0}),this.accessor.mergeGroup(s,this.groupView,r)}n&&this.accessor.activateGroup(n)}this.groupTransfer.clearData(He.prototype)}}else if(this.editorTransfer.hasData(_e.prototype)){const o=this.editorTransfer.getData(_e.prototype);if(Array.isArray(o)){const s=o[0].identifier,n=this.accessor.getGroup(s.groupId);if(n){const r=this.isCopyOperation(e,s);let a;if(this.editorGroupService.partOptions.closeEmptyGroups&&n.count===1&&typeof t=="number"&&!r)a=this.accessor.moveGroup(n,this.groupView,t);else{if(a=i(),n===a)return;const d=Or(n,s.editor,{pinned:!0,sticky:n.isSticky(s.editor)});r?n.copyEditor(s.editor,a,d):n.moveEditor(s.editor,a,d)}a.focus()}this.editorTransfer.clearData(_e.prototype)}}else if(this.treeItemsTransfer.hasData(kt.prototype)){const o=this.treeItemsTransfer.getData(kt.prototype);if(Array.isArray(o)){const s=[];for(const n of o){const r=await this.treeViewsDragAndDropService.removeDragOperationTransfer(n.identifier);if(r){const a=await Gh(r);s.push(...a.map(d=>({...d,options:{...d.options,pinned:!0}})))}}s.length&&this.editorService.openEditors(s,i(),{validateTrust:!0})}this.treeItemsTransfer.clearData(kt.prototype)}else this.instantiationService.createInstance(Uh,{allowWorkspaceOpen:!pt||nv(this.contextService.getWorkspace())}).handleDrop(e,()=>i(),s=>s==null?void 0:s.focus())}isCopyOperation(e,t){return t!=null&&t.editor.hasCapability(8)?!1:e.ctrlKey&&!De||e.altKey&&De}isToggleSplitOperation(e){return e.altKey&&!De||e.shiftKey&&De}positionOverlay(e,t,i,o){const s=this.accessor.partOptions.openSideBySideDirection==="right",n=this.groupView.element.clientWidth,r=this.groupView.element.clientHeight-this.getOverlayOffsetHeight();let a,d;o?(i?a=s?.3:.1:a=.1,i?d=s?.1:.3:d=.1):(a=0,d=0);const l=n*a,p=r*d,g=n/3,f=r/3;let b;switch(e>l&&e<n-l&&t>p&&t<r-p?b=void 0:s?e<g?b=2:e>g*2?b=3:t<r/2?b=0:b=1:t<f?b=0:t>f*2?b=1:e<n/2?b=2:b=3,b){case 0:this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"50%"}),this.toggleDropIntoPrompt(!1);break;case 1:this.doPositionOverlay({top:"50%",left:"0",width:"100%",height:"50%"}),this.toggleDropIntoPrompt(!1);break;case 2:this.doPositionOverlay({top:"0",left:"0",width:"50%",height:"100%"}),this.toggleDropIntoPrompt(!1);break;case 3:this.doPositionOverlay({top:"0",left:"50%",width:"50%",height:"100%"}),this.toggleDropIntoPrompt(!1);break;default:this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"100%"}),this.toggleDropIntoPrompt(!0)}const m=K(this.overlay);m.style.opacity="1",setTimeout(()=>m.classList.add("overlay-move-transition"),0),this.currentDropOperation={splitDirection:b}}doPositionOverlay(e){const[t,i]=Ji(this.container,this.overlay),o=this.getOverlayOffsetHeight();o?t.style.height=`calc(100% - ${o}px)`:t.style.height="100%",i.style.top=e.top,i.style.left=e.left,i.style.width=e.width,i.style.height=e.height}getOverlayOffsetHeight(){return!this.groupView.isEmpty&&this.accessor.partOptions.showTabs?this.groupView.titleHeight.offset:0}hideOverlay(){const e=K(this.overlay);this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"100%"}),e.style.opacity="0",e.classList.remove("overlay-move-transition"),this.currentDropOperation=void 0}toggleDropIntoPrompt(e){this.dropIntoPromptElement&&(this.dropIntoPromptElement.style.opacity=e?"1":"0")}contains(e){return e===this.container||e===this.overlay}dispose(){super.dispose(),this._disposed=!0}};bn.OVERLAY_ID="monaco-workbench-editor-drop-overlay";bn=C([h(2,te),h(3,O),h(4,I),h(5,P),h(6,ee),h(7,Wc),h(8,ze)],bn);let ma=class extends Jn{constructor(e,t,i,o,s,n){super(o),this.accessor=e,this.container=t,this.delegate=i,this.configurationService=s,this.instantiationService=n,this.counter=0,this.editorTransfer=jt.getInstance(),this.groupTransfer=jt.getInstance(),this.registerListeners()}get overlay(){if(this._overlay&&!this._overlay.disposed)return this._overlay}registerListeners(){this._register(_(this.container,E.DRAG_ENTER,e=>this.onDragEnter(e))),this._register(_(this.container,E.DRAG_LEAVE,()=>this.onDragLeave())),[this.container,window].forEach(e=>this._register(_(e,E.DRAG_END,()=>this.onDragEnd())))}onDragEnter(e){if(Xu(this.configurationService)&&Zu(e))return;if(this.counter++,!this.editorTransfer.hasData(_e.prototype)&&!this.groupTransfer.hasData(He.prototype)&&e.dataTransfer){const i=M.as(rv.DragAndDropContribution).getAll(),o=Array.from(i).map(s=>s.dataFormatKey);if(!av(e,oo.FILES,Ur.FILES,oo.RESOURCES,Ur.EDITORS,...o)){e.dataTransfer.dropEffect="none";return}}this.updateContainer(!0);const t=e.target;if(t&&(this.overlay&&!this.overlay.contains(t)&&this.disposeOverlay(),!this.overlay)){const i=this.findTargetGroupView(t);i&&(this._overlay=this.instantiationService.createInstance(bn,this.accessor,i))}}onDragLeave(){this.counter--,this.counter===0&&this.updateContainer(!1)}onDragEnd(){this.counter=0,this.updateContainer(!1),this.disposeOverlay()}findTargetGroupView(e){return this.accessor.groups.find(i=>{var o,s;return Tt(e,i.element)||((s=(o=this.delegate).containsGroup)==null?void 0:s.call(o,i))})}updateContainer(e){this.container.classList.toggle("dragged-over",e)}dispose(){super.dispose(),this.disposeOverlay()}disposeOverlay(){this.overlay&&(this.overlay.dispose(),this._overlay=void 0)}};ma=C([h(3,te),h(4,O),h(5,I)],ma);const Lo={targetWidth:900,leftMarginRatio:.1909,rightMarginRatio:.1909},wr={type:"distribute"};function bh(c){const e=z(".centered-layout-margin");return e.style.height="100%",c&&(e.style.backgroundColor=c.toString()),{element:e,layout:()=>{},minimumSize:60,maximumSize:Number.POSITIVE_INFINITY,onDidChange:A.None}}function Gy(c,e){return{element:c.element,get maximumSize(){return c.maximumWidth},get minimumSize(){return c.minimumWidth},onDidChange:A.map(c.onDidChange,t=>t&&t.width),layout:(t,i,o)=>c.layout(t,e(),(o==null?void 0:o.top)??0,((o==null?void 0:o.left)??0)+i)}}class Uy{constructor(e,t,i={...Lo}){this.container=e,this.view=t,this.state=i,this.lastLayoutPosition={width:0,height:0,left:0,top:0},this.didLayout=!1,this.splitViewDisposables=new x,this.centeredLayoutFixedWidth=!0,this._boundarySashes={},this.container.appendChild(this.view.element),this.container.style.overflow="hidden"}get minimumWidth(){return this.splitView?this.splitView.minimumSize:this.view.minimumWidth}get maximumWidth(){return this.splitView?this.splitView.maximumSize:this.view.maximumWidth}get minimumHeight(){return this.view.minimumHeight}get maximumHeight(){return this.view.maximumHeight}get onDidChange(){return this.view.onDidChange}get boundarySashes(){return this._boundarySashes}set boundarySashes(e){this._boundarySashes=e,this.splitView&&(this.splitView.orthogonalStartSash=e.top,this.splitView.orthogonalEndSash=e.bottom)}layout(e,t,i,o){this.lastLayoutPosition={width:e,height:t,top:i,left:o},this.splitView?(this.splitView.layout(e,this.lastLayoutPosition),(!this.didLayout||this.centeredLayoutFixedWidth)&&this.resizeSplitViews()):this.view.layout(e,t,i,o),this.didLayout=!0}resizeSplitViews(){if(this.splitView)if(this.centeredLayoutFixedWidth){const e=Math.min(this.lastLayoutPosition.width,this.state.targetWidth),t=(this.lastLayoutPosition.width-e)/2;this.splitView.resizeView(0,Math.floor(t)),this.splitView.resizeView(1,e),this.splitView.resizeView(2,Math.ceil(t))}else{const e=this.state.leftMarginRatio*this.lastLayoutPosition.width,t=this.state.rightMarginRatio*this.lastLayoutPosition.width,i=this.lastLayoutPosition.width-e-t;this.splitView.resizeView(0,e),this.splitView.resizeView(1,i),this.splitView.resizeView(2,t)}}setFixedWidth(e){this.centeredLayoutFixedWidth=e,this.splitView&&(this.updateState(),this.resizeSplitViews())}updateState(){this.splitView&&(this.state.targetWidth=this.splitView.getViewSize(1),this.state.leftMarginRatio=this.splitView.getViewSize(0)/this.lastLayoutPosition.width,this.state.rightMarginRatio=this.splitView.getViewSize(2)/this.lastLayoutPosition.width)}isActive(){return!!this.splitView}styles(e){this.style=e,this.splitView&&this.emptyViews&&(this.splitView.style(this.style),this.emptyViews[0].element.style.backgroundColor=this.style.background.toString(),this.emptyViews[1].element.style.backgroundColor=this.style.background.toString())}activate(e){var t;if(e!==this.isActive())if(e){this.container.removeChild(this.view.element),this.splitView=new ts(this.container,{inverseAltBehavior:!0,orientation:1,styles:this.style}),this.splitView.orthogonalStartSash=this.boundarySashes.top,this.splitView.orthogonalEndSash=this.boundarySashes.bottom,this.splitViewDisposables.add(this.splitView.onDidSashChange(()=>{this.splitView&&this.updateState()})),this.splitViewDisposables.add(this.splitView.onDidSashReset(()=>{this.state={...Lo},this.resizeSplitViews()})),this.splitView.layout(this.lastLayoutPosition.width,this.lastLayoutPosition);const i=this.style?this.style.background:void 0;this.emptyViews=[bh(i),bh(i)],this.splitView.addView(this.emptyViews[0],wr,0),this.splitView.addView(Gy(this.view,()=>this.lastLayoutPosition.height),wr,1),this.splitView.addView(this.emptyViews[1],wr,2),this.resizeSplitViews()}else this.splitView&&this.container.removeChild(this.splitView.el),this.splitViewDisposables.clear(),(t=this.splitView)==null||t.dispose(),this.splitView=void 0,this.emptyViews=void 0,this.container.appendChild(this.view.element),this.view.layout(this.lastLayoutPosition.width,this.lastLayoutPosition.height,this.lastLayoutPosition.top,this.lastLayoutPosition.left)}isDefault(e){return this.centeredLayoutFixedWidth?e.targetWidth===Lo.targetWidth:e.leftMarginRatio===Lo.leftMarginRatio&&e.rightMarginRatio===Lo.rightMarginRatio}dispose(){this.splitViewDisposables.dispose(),this.splitView&&(this.splitView.dispose(),this.splitView=void 0)}}function vn(c,e,t){const i=c.get(ee),o=c.get(O),s=zy(e,t,i,o);let n;return i.activeGroup!==s&&e.options&&!e.options.inactive&&e.options.preserveFocus&&typeof e.options.activation!="number"&&t!==gi&&(n=pi.ACTIVATE),[s,n]}function zy(c,e,t,i){let o;const s=io(c)?c.editor:c,n=c.options;if(e&&typeof e!="number")o=e;else if(typeof e=="number"&&e>=0)o=t.getGroup(e);else if(e===gi){const r=kd(i);let a=t.findGroup({direction:r});(!a||Gs(a,s))&&(a=t.addGroup(t.activeGroup,r)),o=a}else if(!n||typeof n.index!="number"){const r=t.getGroups(1);if(n!=null&&n.revealIfVisible){for(const a of r)if(Ky(a,s)){o=a;break}}if(!o&&(n!=null&&n.revealIfOpened||i.getValue("workbench.editor.revealIfOpen")||pe(s)&&s.hasCapability(8))){let a,d;for(const l of r)if(ep(l,s)&&(d||(d=l),!a&&l.isActive(s)&&(a=l)),d&&a)break;o=a||d}}if(!o){let r=t.activeGroup;if(Gs(r,s)){for(const a of t.getGroups(1))if(!Gs(a,s)){r=a;break}Gs(r,s)?o=t.addGroup(r,kd(i)):o=r}else o=r}return o}function Gs(c,e){return!(!c.isLocked||ep(c,e))}function Ky(c,e){return c.activeEditor?c.activeEditor.matches(e):!1}function ep(c,e){for(const t of c.editors)if(t.matches(e))return!0;return!1}class $y{constructor(){this.element=z(".grid-view-container"),this._onDidChange=new qt,this.onDidChange=this._onDidChange.event}get minimumWidth(){return this.gridWidget?this.gridWidget.minimumWidth:0}get maximumWidth(){return this.gridWidget?this.gridWidget.maximumWidth:Number.POSITIVE_INFINITY}get minimumHeight(){return this.gridWidget?this.gridWidget.minimumHeight:0}get maximumHeight(){return this.gridWidget?this.gridWidget.maximumHeight:Number.POSITIVE_INFINITY}get gridWidget(){return this._gridWidget}set gridWidget(e){this.element.innerText="",e?(this.element.appendChild(e.element),this._onDidChange.input=e.onDidChange):this._onDidChange.input=A.None,this._gridWidget=e}layout(e,t,i,o){var s;(s=this.gridWidget)==null||s.layout(e,t,i,o)}dispose(){this._onDidChange.dispose()}}let as=class hi extends Zn{constructor(e,t,i,o,s){super("workbench.parts.editor",{hasTitle:!1},t,o,s),this.instantiationService=e,this.configurationService=i,this._onDidLayout=this._register(new w),this.onDidLayout=this._onDidLayout.event,this._onDidChangeActiveGroup=this._register(new w),this.onDidChangeActiveGroup=this._onDidChangeActiveGroup.event,this._onDidChangeGroupIndex=this._register(new w),this.onDidChangeGroupIndex=this._onDidChangeGroupIndex.event,this._onDidChangeGroupLocked=this._register(new w),this.onDidChangeGroupLocked=this._onDidChangeGroupLocked.event,this._onDidActivateGroup=this._register(new w),this.onDidActivateGroup=this._onDidActivateGroup.event,this._onDidAddGroup=this._register(new w),this.onDidAddGroup=this._onDidAddGroup.event,this._onDidRemoveGroup=this._register(new w),this.onDidRemoveGroup=this._onDidRemoveGroup.event,this._onDidMoveGroup=this._register(new w),this.onDidMoveGroup=this._onDidMoveGroup.event,this.onDidSetGridWidget=this._register(new w),this._onDidChangeSizeConstraints=this._register(new qt),this.onDidChangeSizeConstraints=A.any(this.onDidSetGridWidget.event,this._onDidChangeSizeConstraints.event),this._onDidScroll=this._register(new qt),this.onDidScroll=A.any(this.onDidSetGridWidget.event,this._onDidScroll.event),this._onDidChangeEditorPartOptions=this._register(new w),this.onDidChangeEditorPartOptions=this._onDidChangeEditorPartOptions.event,this.workspaceMemento=this.getMemento(1,1),this.profileMemento=this.getMemento(0,1),this.groupViews=new Map,this.mostRecentActiveGroups=[],this.gridWidgetView=this._register(new $y),this.enforcedPartOptions=[],this._partOptions=xd(this.configurationService,this.themeService),this._top=0,this._left=0,this.sideGroup={openEditor:(n,r)=>{const[a]=this.instantiationService.invokeFunction(d=>vn(d,{editor:n,options:r},gi));return a.openEditor(n,r)}},this._isReady=!1,this.whenReadyPromise=new Gr,this.whenReady=this.whenReadyPromise.p,this.whenRestoredPromise=new Gr,this.whenRestored=this.whenRestoredPromise.p,this.priority=2,this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>this.onConfigurationUpdated(e))),this._register(this.themeService.onDidFileIconThemeChange(()=>this.handleChangedPartOptions()))}onConfigurationUpdated(e){tf(e)&&this.handleChangedPartOptions()}handleChangedPartOptions(){const e=this._partOptions,t=xd(this.configurationService,this.themeService);for(const i of this.enforcedPartOptions)Object.assign(t,i);this._partOptions=t,this._onDidChangeEditorPartOptions.fire({oldPartOptions:e,newPartOptions:t})}get partOptions(){return this._partOptions}enforcePartOptions(e){return this.enforcedPartOptions.push(e),this.handleChangedPartOptions(),Y(()=>{this.enforcedPartOptions.splice(this.enforcedPartOptions.indexOf(e),1),this.handleChangedPartOptions()})}get contentDimension(){return this._contentDimension}get activeGroup(){return this._activeGroup}get groups(){return Array.from(this.groupViews.values())}get count(){return this.groupViews.size}get orientation(){return this.gridWidget&&this.gridWidget.orientation===0?1:0}get isReady(){return this._isReady}get hasRestorableState(){return!!this.workspaceMemento[hi.EDITOR_PART_UI_STATE_STORAGE_KEY]}getGroups(e=0){switch(e){case 0:return this.groups;case 1:{const t=Ge(this.mostRecentActiveGroups.map(i=>this.getGroup(i)));return Li([...t,...this.groups])}case 2:{const t=[];return this.gridWidget&&this.fillGridNodes(t,this.gridWidget.getViews()),t}}}fillGridNodes(e,t){Mi(t)?t.children.forEach(i=>this.fillGridNodes(e,i)):e.push(t.view)}getGroup(e){return this.groupViews.get(e)}findGroup(e,t=this.activeGroup,i){if(typeof e.direction=="number")return this.doFindGroupByDirection(e.direction,t,i);if(typeof e.location=="number")return this.doFindGroupByLocation(e.location,t,i);throw new Error("invalid arguments")}doFindGroupByDirection(e,t,i){const o=this.assertGroupView(t),s=this.gridWidget.getNeighborViews(o,this.toGridViewDirection(e),i);return s.sort((n,r)=>this.mostRecentActiveGroups.indexOf(n.id)-this.mostRecentActiveGroups.indexOf(r.id)),s[0]}doFindGroupByLocation(e,t,i){const o=this.assertGroupView(t),s=this.getGroups(2),n=s.indexOf(o);switch(e){case 0:return s[0];case 1:return s[s.length-1];case 2:{let r=s[n+1];return!r&&i&&(r=this.doFindGroupByLocation(0,t)),r}case 3:{let r=s[n-1];return!r&&i&&(r=this.doFindGroupByLocation(1,t)),r}}}activateGroup(e){const t=this.assertGroupView(e);return this.doSetGroupActive(t),this._onDidActivateGroup.fire(t),t}restoreGroup(e){const t=this.assertGroupView(e);return this.doRestoreGroup(t),t}getSize(e){const t=this.assertGroupView(e);return this.gridWidget.getViewSize(t)}setSize(e,t){const i=this.assertGroupView(e);this.gridWidget.resizeView(i,t)}arrangeGroups(e,t=this.activeGroup){if(!(this.count<2)&&this.gridWidget)switch(e){case 1:this.gridWidget.distributeViewSizes();break;case 0:this.gridWidget.maximizeViewSize(t);break;case 2:this.isGroupMaximized(t)?this.arrangeGroups(1):this.arrangeGroups(0);break}}isGroupMaximized(e){return this.gridWidget.isViewSizeMaximized(e)}setGroupOrientation(e){if(!this.gridWidget)return;const t=e===0?1:0;this.gridWidget.orientation!==t&&(this.gridWidget.orientation=t)}applyLayout(e){const t=this.shouldRestoreFocus(this.container);let i=0;function o(a){for(const d of a)Array.isArray(d.groups)?o(d.groups):i++}o(e.groups);let s=this.getGroups(2);if(i<s.length){const a=s[i-1];s.forEach((d,l)=>{l>=i&&this.mergeGroup(d,a)}),s=this.getGroups(2)}const n=this.activeGroup,r=ju({orientation:this.toGridViewOrientation(e.orientation,this.isTwoDimensionalGrid()?this.gridWidget.orientation:xt(this.gridWidget.orientation)),groups:e.groups});this.doCreateGridControlWithState(r,n.id,s),this.doLayout(this._contentDimension),this.updateContainer();for(const a of this.getGroups(2))s.includes(a)||this._onDidAddGroup.fire(a);this.notifyGroupIndexChange(),t&&this._activeGroup.focus()}getLayout(){const e=this.gridWidget.serialize(),t=e.orientation===1?0:1,i=this.serializedNodeToGroupLayoutArgument(e.root);return{orientation:t,groups:i.groups}}serializedNodeToGroupLayoutArgument(e){return e.type==="branch"?{size:e.size,groups:e.data.map(t=>this.serializedNodeToGroupLayoutArgument(t))}:{size:e.size}}shouldRestoreFocus(e){if(!e)return!1;const t=document.activeElement;return t===document.body?!0:Tt(t,e)}isTwoDimensionalGrid(){const e=this.gridWidget.getViews();return Mi(e)?e.children.some(t=>Mi(t)):!1}addGroup(e,t,i){const o=this.assertGroupView(e),s=this.doAddGroup(o,t);return i!=null&&i.activate&&this.doSetGroupActive(s),s}doAddGroup(e,t,i){const o=this.groupViews.size>1&&this.isGroupMaximized(e),s=this.doCreateGroupView(i);return this.gridWidget.addView(s,this.getSplitSizingStyle(),e,this.toGridViewDirection(t)),this.updateContainer(),this._onDidAddGroup.fire(s),this.notifyGroupIndexChange(),o&&this.arrangeGroups(0,s),s}getSplitSizingStyle(){switch(this._partOptions.splitSizing){case"distribute":return ao.Distribute;case"split":return ao.Split;default:return ao.Auto}}doCreateGroupView(e){let t;e instanceof Qi?t=Qi.createCopy(e,this,this.count,this.instantiationService):$h(e)?t=Qi.createFromSerialized(e,this,this.count,this.instantiationService):t=Qi.createNew(this,this.count,this.instantiationService),this.groupViews.set(t.id,t);const i=new x;return i.add(t.onDidFocus(()=>{this.doSetGroupActive(t)})),i.add(t.onDidModelChange(o=>{switch(o.kind){case 2:this._onDidChangeGroupLocked.fire(t);break;case 1:this._onDidChangeGroupIndex.fire(t);break}})),i.add(t.onDidActiveEditorChange(()=>{this.updateContainer()})),A.once(t.onWillDispose)(()=>{ie(i),this.groupViews.delete(t.id),this.doUpdateMostRecentActive(t)}),t}doSetGroupActive(e){if(this._activeGroup===e)return;const t=this._activeGroup;this._activeGroup=e,this.doUpdateMostRecentActive(e,!0),t==null||t.setActive(!1),e.setActive(!0),this.doRestoreGroup(e),this._onDidChangeActiveGroup.fire(e)}doRestoreGroup(e){if(this.gridWidget){const t=this.gridWidget.getViewSize(e);(t.width===e.minimumWidth||t.height===e.minimumHeight)&&this.arrangeGroups(0,e)}}doUpdateMostRecentActive(e,t){const i=this.mostRecentActiveGroups.indexOf(e.id);i!==-1&&this.mostRecentActiveGroups.splice(i,1),t&&this.mostRecentActiveGroups.unshift(e.id)}toGridViewDirection(e){switch(e){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3}}toGridViewOrientation(e,t){return typeof e=="number"?e===0?1:0:t}removeGroup(e){const t=this.assertGroupView(e);if(this.count!==1){if(t.isEmpty)return this.doRemoveEmptyGroup(t);this.doRemoveGroupWithEditors(t)}}doRemoveGroupWithEditors(e){const t=this.getGroups(1);let i;this._activeGroup===e?i=t[1]:i=t[0],this.mergeGroup(e,i)}doRemoveEmptyGroup(e){var i;const t=this.shouldRestoreFocus(this.container);if(this._activeGroup===e){const s=this.getGroups(1)[1];this.activateGroup(s)}this.gridWidget.removeView(e,this.getSplitSizingStyle()),e.dispose(),t&&this._activeGroup.focus(),this.notifyGroupIndexChange(),this.updateContainer(),this.count===1&&((i=zc(this.groups))==null||i.lock(!1)),this._onDidRemoveGroup.fire(e)}moveGroup(e,t,i){const o=this.assertGroupView(e),s=this.assertGroupView(t);if(o.id===s.id)throw new Error("Cannot move group into its own");const n=this.shouldRestoreFocus(o.element);return this.gridWidget.moveView(o,this.getSplitSizingStyle(),s,this.toGridViewDirection(i)),n&&o.focus(),this._onDidMoveGroup.fire(o),this.notifyGroupIndexChange(),o}copyGroup(e,t,i){const o=this.assertGroupView(e),s=this.assertGroupView(t),n=this.shouldRestoreFocus(o.element),r=this.doAddGroup(s,i,o);return n&&r.focus(),r}mergeGroup(e,t,i){const o=this.assertGroupView(e),s=this.assertGroupView(t),n=[];let r=i&&typeof i.index=="number"?i.index:s.count;for(const a of o.editors){const d=!o.isActive(a)||this._activeGroup!==o,p={index:o.isSticky(a)?void 0:r,inactive:d,preserveFocus:d};n.push({editor:a,options:p}),r++}return(i==null?void 0:i.mode)===0?o.copyEditors(n,s):o.moveEditors(n,s),o.isEmpty&&!o.disposed&&this.removeGroup(o),s}mergeAllGroups(e=this.activeGroup){for(const t of this.getGroups(1))t!==e&&this.mergeGroup(t,e);return e}assertGroupView(e){let t;if(typeof e=="number"?t=this.getGroup(e):t=e,!t)throw new Error("Invalid editor group provided!");return t}createEditorDropTarget(e,t){return this.instantiationService.createInstance(ma,this,e,t)}get minimumWidth(){return Math.min(this.centeredLayoutWidget.minimumWidth,this.layoutService.getMaximumEditorDimensions().width)}get maximumWidth(){return this.centeredLayoutWidget.maximumWidth}get minimumHeight(){return Math.min(this.centeredLayoutWidget.minimumHeight,this.layoutService.getMaximumEditorDimensions().height)}get maximumHeight(){return this.centeredLayoutWidget.maximumHeight}get snap(){return this.layoutService.getPanelAlignment()==="center"}get onDidChange(){return A.any(this.centeredLayoutWidget.onDidChange,this.onDidSetGridWidget.event)}get gridSeparatorBorder(){return this.theme.getColor(of)||this.theme.getColor(Ze)||vi.transparent}updateStyles(){const e=K(this.container);e.style.backgroundColor=this.getColor(Gc)||"";const t={separatorBorder:this.gridSeparatorBorder,background:this.theme.getColor(sf)||vi.transparent};this.gridWidget.style(t),this.centeredLayoutWidget.styles(t)}createContentArea(e,t){return this.element=e,this.container=document.createElement("div"),this.container.classList.add("content"),e.appendChild(this.container),this.doCreateGridControl(t),this.centeredLayoutWidget=this._register(new Uy(this.container,this.gridWidgetView,this.profileMemento[hi.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY])),this._register(this.onDidChangeEditorPartOptions(i=>this.centeredLayoutWidget.setFixedWidth(i.newPartOptions.centeredLayoutFixedWidth??!1))),this.setupDragAndDropSupport(e,this.container),this.whenReadyPromise.complete(),this._isReady=!0,Go.settled(this.groups.map(i=>i.whenRestored)).finally(()=>{this.whenRestoredPromise.complete()}),this.container}setupDragAndDropSupport(e,t){this._register(this.createEditorDropTarget(t,Object.create(null)));const i=document.createElement("div");i.classList.add("drop-block-overlay"),e.appendChild(i),this._register(cv(i,()=>i.classList.remove("visible"))),this._register(Yo.INSTANCE.registerTarget(this.element,{onDragStart:l=>i.classList.add("visible"),onDragEnd:l=>i.classList.remove("visible")}));let o,s,n,r;const a=l=>{!this.layoutService.isVisible("workbench.parts.panel")&&l===this.layoutService.getPanelPosition()?this.layoutService.setPartHidden(!1,"workbench.parts.panel"):!this.layoutService.isVisible("workbench.parts.auxiliarybar")&&l===(this.layoutService.getSideBarPosition()===1?0:1)&&this.layoutService.setPartHidden(!1,"workbench.parts.auxiliarybar")},d=()=>{o&&(clearTimeout(o),o=void 0),s&&(clearTimeout(s),s=void 0)};this._register(Yo.INSTANCE.registerTarget(i,{onDragOver:l=>{X.stop(l.eventData,!0),l.eventData.dataTransfer&&(l.eventData.dataTransfer.dropEffect="none");const p=i.getBoundingClientRect();let g,f;const b=100;l.eventData.clientX<p.left+b&&(g=0),l.eventData.clientX>p.right-b&&(g=1),l.eventData.clientY>p.bottom-b&&(f=2),o&&g!==n&&(clearTimeout(o),o=void 0),s&&f!==r&&(clearTimeout(s),s=void 0),!o&&g!==void 0&&(n=g,o=setTimeout(()=>a(g),200)),!s&&f!==void 0&&(r=f,s=setTimeout(()=>a(f),200))},onDragLeave:()=>d(),onDragEnd:()=>d(),onDrop:()=>d()}))}centerLayout(e){this.centeredLayoutWidget.activate(e),this._activeGroup.focus()}isLayoutCentered(){return this.centeredLayoutWidget?this.centeredLayoutWidget.isActive():!1}doCreateGridControl(e){let t=!1;if((!e||e.restorePreviousState)&&(t=!this.doCreateGridControlWithPreviousState()),!this.gridWidget||t){const i=this.doCreateGroupView();this.doSetGridWidget(new Oi(i)),this.doSetGroupActive(i)}this.updateContainer(),this.notifyGroupIndexChange()}doCreateGridControlWithPreviousState(){const e=this.workspaceMemento[hi.EDITOR_PART_UI_STATE_STORAGE_KEY];if(e!=null&&e.serializedGrid)try{this.mostRecentActiveGroups=e.mostRecentActiveGroups,this.doCreateGridControlWithState(e.serializedGrid,e.activeGroup),this._activeGroup.focus()}catch(t){return po(new Error(`Error restoring editor grid widget: ${t} (with state: ${JSON.stringify(e)})`)),this.groupViews.forEach(i=>i.dispose()),this.groupViews.clear(),this.mostRecentActiveGroups=[],!1}return!0}doCreateGridControlWithState(e,t,i){let o;i?o=i.slice(0):o=[];const s=[],n=Oi.deserialize(e,{fromJSON:r=>{let a;return o.length>0?a=o.shift():a=this.doCreateGroupView(r),s.push(a),a.id===t&&this.doSetGroupActive(a),a}},{styles:{separatorBorder:this.gridSeparatorBorder}});this._activeGroup||this.doSetGroupActive(s[0]),this.mostRecentActiveGroups.some(r=>!this.getGroup(r))&&(this.mostRecentActiveGroups=s.map(r=>r.id)),this.doSetGridWidget(n)}doSetGridWidget(e){let t={};this.gridWidget&&(t=this.gridWidget.boundarySashes,this.gridWidget.dispose()),this.gridWidget=e,this.gridWidget.boundarySashes=t,this.gridWidgetView.gridWidget=e,this._onDidChangeSizeConstraints.input=e.onDidChange,this._onDidScroll.input=e.onDidScroll,this.onDidSetGridWidget.fire(void 0)}updateContainer(){K(this.container).classList.toggle("empty",this.isEmpty)}notifyGroupIndexChange(){this.getGroups(2).forEach((e,t)=>e.notifyIndexChanged(t))}get isEmpty(){return this.count===1&&this._activeGroup.isEmpty}setBoundarySashes(e){this.gridWidget.boundarySashes=e,this.centeredLayoutWidget.boundarySashes=e}layout(e,t,i,o){this._top=i,this._left=o;const s=super.layoutContents(e,t).contentSize;this.doLayout(q.lift(s),i,o)}doLayout(e,t=this._top,i=this._left){this._contentDimension=e,this.centeredLayoutWidget.layout(this._contentDimension.width,this._contentDimension.height,t,i),this._onDidLayout.fire(e)}saveState(){if(this.gridWidget){const e={serializedGrid:this.gridWidget.serialize(),activeGroup:this._activeGroup.id,mostRecentActiveGroups:this.mostRecentActiveGroups};this.isEmpty?delete this.workspaceMemento[hi.EDITOR_PART_UI_STATE_STORAGE_KEY]:this.workspaceMemento[hi.EDITOR_PART_UI_STATE_STORAGE_KEY]=e}if(this.centeredLayoutWidget){const e=this.centeredLayoutWidget.state;this.centeredLayoutWidget.isDefault(e)?delete this.profileMemento[hi.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY]:this.profileMemento[hi.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY]=e}super.saveState()}toJSON(){return{type:"workbench.parts.editor"}}dispose(){var e;this.groupViews.forEach(t=>t.dispose()),this.groupViews.clear(),(e=this.gridWidget)==null||e.dispose(),super.dispose()}};as.EDITOR_PART_UI_STATE_STORAGE_KEY="editorpart.state";as.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY="editorpart.centeredview";as=C([h(0,I),h(1,te),h(2,O),h(3,oe),h(4,st)],as);k.registerCommandAndKeybindingRule({weight:200,when:nf,primary:2051,mac:{primary:259},id:jh,handler:async(c,e)=>{const t=c.get(P),i=c.get(N),o=c.get(Ce),s=c.get(nt),n=bs(e,i,t,s);if(n.length){const r=n.filter(g=>g.scheme===Q.untitled),a=n.filter(g=>g.scheme!==Q.untitled),p=(await Promise.all(a.map(async g=>{const f=s.findClosest(g);return f||await o.stat(g)}))).filter(g=>!g.isDirectory).map(g=>({resource:g.resource,options:{pinned:!0}})).concat(...r.map(g=>({resource:g,options:{pinned:!0}})));await t.openEditors(p,gi)}}});k.registerCommandAndKeybindingRule({weight:200+10,when:v.and(je,et.toNegated()),primary:3,mac:{primary:2066},id:"explorer.openAndPassFocus",handler:async(c,e)=>{const t=c.get(P),o=c.get(nt).getContext(!0);o.length&&await t.openEditors(o.map(s=>({resource:s.resource,options:{preserveFocus:!1,pinned:!0}})))}});const yr="showModifications";let di=[];k.registerCommandAndKeybindingRule({id:fc,when:void 0,weight:200,primary:vt(2089,34),handler:async(c,e)=>{const t=c.get(I),i=c.get(Ki),o=c.get(P),s=c.get(Ce);let n=!1;if(di.length===0){n=!0;const a=t.createInstance(Qs);di.push(a),di.push(i.registerTextModelContentProvider(yr,a))}const r=vs(e,c.get(N),o);if(r&&s.hasProvider(r)){const a=Me(r),d=u("modifiedLabel","{0} (in file)  {1}",a,a);try{await Qs.open(r,yr,d,o,{pinned:!0}),n&&di.push(o.onDidVisibleEditorsChange(()=>{o.editors.some(l=>!!ne.getCanonicalUri(l,{supportSideBySide:J.SECONDARY,filterByScheme:yr}))||(di=ie(di))}))}catch{di=ie(di)}}}});let ba,Cr;Le.registerCommand({id:Yh,handler:(c,e)=>{const t=c.get(N);ba=vs(e,t,c.get(P)),Cr||(Cr=mc.bindTo(c.get(G))),Cr.set(!0)}});Le.registerCommand({id:Jh,handler:async(c,e)=>{const t=c.get(P),i=c.get(nt),o=bs(e,c.get(N),t,i);return o.length===2?t.openEditor({original:{resource:o[0]},modified:{resource:o[1]},options:{pinned:!0}}):!0}});Le.registerCommand({id:Xh,handler:(c,e)=>{const t=c.get(P),i=c.get(N),o=vs(e,i,t);ba&&o&&t.openEditor({original:{resource:ba},modified:{resource:o},options:{pinned:!0}})}});async function ad(c,e,t,i,o){if(c.length){const s=Vt?`\r
`:`
`;let n;if(e){const a=o.getValue("explorer.copyRelativePathSeparator");(a==="/"||a==="\\")&&(n=a)}const r=c.map(a=>i.getUriLabel(a,{relative:e,noPrefix:!0,separator:n})).join(s);await t.writeText(r)}}const tp=async(c,e)=>{const t=bs(e,c.get(N),c.get(P),c.get(nt));await ad(t,!1,c.get(qn),c.get(Ft),c.get(O))};k.registerCommandAndKeybindingRule({weight:200,when:$i.focus.toNegated(),primary:2593,win:{primary:1569},id:ws,handler:tp});k.registerCommandAndKeybindingRule({weight:200,when:$i.focus,primary:vt(2089,2593),win:{primary:1569},id:ws,handler:tp});const ip=async(c,e)=>{const t=bs(e,c.get(N),c.get(P),c.get(nt));await ad(t,!0,c.get(qn),c.get(Ft),c.get(O))};k.registerCommandAndKeybindingRule({weight:200,when:$i.focus.toNegated(),primary:3617,win:{primary:vt(2089,3105)},id:ys,handler:ip});k.registerCommandAndKeybindingRule({weight:200,when:$i.focus,primary:vt(2089,3617),win:{primary:vt(2089,3105)},id:ys,handler:ip});k.registerCommandAndKeybindingRule({weight:200,when:void 0,primary:vt(2089,46),id:"workbench.action.files.copyPathOfActiveFile",handler:async c=>{const t=c.get(P).activeEditor,i=ne.getOriginalUri(t,{supportSideBySide:J.PRIMARY});await ad(i?[i]:[],!1,c.get(qn),c.get(Ft),c.get(O))}});Le.registerCommand({id:Zh,handler:async(c,e)=>{const t=c.get(Pn),i=c.get(ze),o=c.get(nt),s=vs(e,c.get(N),c.get(P));if(s&&i.isInsideWorkspace(s)){const n=await t.openView(rf,!1);n&&(n.setExpanded(!0),await o.select(s,"force"),n.focus())}else{const n=await t.openView(af.ID,!1);n&&(n.setExpanded(!0),n.focus())}}});Le.registerCommand({id:Qh,handler:async(c,e)=>{const t=c.get(P),i=vs(e,c.get(N),c.get(P));if(i)return t.openEditor({resource:i,options:{override:Uo.PICK,source:Yl.USER}})}});async function cd(c,e){var a;const t=c.get(N),i=c.get(ee),o=c.get(qi),s=c.get(Eo);let n=ol(t);if(!n){const d=i.activeGroup;d.activeEditor&&(n=[],d.activeEditor instanceof Et&&!(e!=null&&e.saveAs)&&!(d.activeEditor.primary.hasCapability(4)||d.activeEditor.secondary.hasCapability(4))?(n.push({groupId:d.id,editor:d.activeEditor.primary}),n.push({groupId:d.id,editor:d.activeEditor.secondary})):n.push({groupId:d.id,editor:d.activeEditor}))}if(!n||n.length===0)return;await dd(c,n,e);const r=o.getFocusedCodeEditor();if(r instanceof Kc){const d=(a=r.getModel())==null?void 0:a.uri;if(d&&!n.some(({editor:l})=>Re(ne.getCanonicalUri(l,{supportSideBySide:J.PRIMARY}),d))){const l=s.files.get(d);l!=null&&l.isReadonly()||await s.save(d,e)}}}function op(c,e,t){const i=[];for(const o of e)for(const s of o.getEditors(0))s.isDirty()&&i.push({groupId:o.id,editor:s});return dd(c,i,t)}async function dd(c,e,t){const i=c.get(P),o=c.get(Ae),s=c.get(I);try{await i.save(e,t)}catch(n){Ui(n)||o.notify({id:e.map(({editor:r})=>{var a;return Is((a=r.resource)==null?void 0:a.toString())}).join(),severity:Fi.Error,message:u({key:"genericSaveError",comment:["{0} is the resource that failed to save and {1} the error message"]},"Failed to save '{0}': {1}",e.map(({editor:r})=>r.getName()).join(", "),go(n,!1)),actions:{primary:[Ee({id:"workbench.action.files.saveEditors",label:u("retry","Retry"),run:()=>s.invokeFunction(r=>dd(r,e,t))}),Ee({id:"workbench.action.files.revertEditors",label:u("discard","Discard"),run:()=>i.revert(e)})]}})}}k.registerCommandAndKeybindingRule({when:void 0,weight:200,primary:2097,id:bc,handler:c=>cd(c,{reason:1,force:!0})});k.registerCommandAndKeybindingRule({when:void 0,weight:200,primary:vt(2089,49),win:{primary:vt(2089,3121)},id:el,handler:c=>cd(c,{reason:1,force:!0,skipSaveParticipants:!0})});k.registerCommandAndKeybindingRule({id:tl,weight:200,when:void 0,primary:3121,handler:c=>cd(c,{reason:1,saveAs:!0})});k.registerCommandAndKeybindingRule({when:void 0,weight:200,primary:void 0,mac:{primary:2609},win:{primary:vt(2089,49)},id:cf,handler:c=>op(c,c.get(ee).getGroups(1),{reason:1})});Le.registerCommand({id:vc,handler:(c,e,t)=>{const i=c.get(ee),o=df(t,c.get(N),c.get(ee));let s;return o.length?s=Ge(o.map(n=>i.getGroup(n.groupId))):s=i.getGroups(1),op(c,s,{reason:1})}});Le.registerCommand({id:il,handler:async c=>(await c.get(P).saveAll({includeUntitled:!1,reason:1})).success});Le.registerCommand({id:wc,handler:async c=>{const e=c.get(Ae),t=c.get(N),i=c.get(ee),o=c.get(P);let s=ol(t);if(!s){const n=i.activeGroup;n.activeEditor&&(s=[{groupId:n.id,editor:n.activeEditor}])}if(!(!s||s.length===0))try{await o.revert(s.filter(({editor:n})=>!n.hasCapability(4)),{force:!0})}catch(n){e.error(u("genericRevertError","Failed to revert '{0}': {1}",s.map(({editor:r})=>r.getName()).join(", "),go(n,!1)))}}});Le.registerCommand({id:sl,handler:(c,e)=>{const t=c.get(hf),i=c.get(ze),o=c.get(si),s=i.getWorkspace(),n=bs(e,c.get(N),c.get(P),c.get(nt)).filter(r=>s.folders.some(a=>o.extUri.isEqual(a.uri,r)));return n.length===0?c.get(Io).executeCommand(lf.ID):t.removeFolders(n)}});k.registerCommandAndKeybindingRule({weight:200+10,when:v.and(je,Fn,nl.negate()),primary:15,id:uf,handler:c=>{const t=c.get(Si).getActivePaneComposite(0);if((t==null?void 0:t.getId())!==$t)return;t.getViewPaneContainer().getExplorerView().previousCompressedStat()}});k.registerCommandAndKeybindingRule({weight:200+10,when:v.and(je,Fn,rl.negate()),primary:17,id:pf,handler:c=>{const t=c.get(Si).getActivePaneComposite(0);if((t==null?void 0:t.getId())!==$t)return;t.getViewPaneContainer().getExplorerView().nextCompressedStat()}});k.registerCommandAndKeybindingRule({weight:200+10,when:v.and(je,Fn,nl.negate()),primary:14,id:gf,handler:c=>{const t=c.get(Si).getActivePaneComposite(0);if((t==null?void 0:t.getId())!==$t)return;t.getViewPaneContainer().getExplorerView().firstCompressedStat()}});k.registerCommandAndKeybindingRule({weight:200+10,when:v.and(je,Fn,rl.negate()),primary:13,id:ff,handler:c=>{const t=c.get(Si).getActivePaneComposite(0);if((t==null?void 0:t.getId())!==$t)return;t.getViewPaneContainer().getExplorerView().lastCompressedStat()}});k.registerCommandAndKeybindingRule({weight:200,when:null,primary:pt?Vt?vt(2089,44):2604:2092,secondary:pt?[2092]:void 0,id:yc,description:{description:al,args:[{isOptional:!0,name:"New Untitled Text File arguments",description:"The editor view type or language ID if known",schema:{type:"object",properties:{viewType:{type:"string"},languageId:{type:"string"}}}}]},handler:async(c,e)=>{await c.get(P).openEditor({resource:void 0,options:{override:e==null?void 0:e.viewType,pinned:!0},languageId:e==null?void 0:e.languageId})}});Le.registerCommand({id:mf,handler:async(c,e)=>{const t=c.get(P),i=c.get(Kh),o=c.get(Ce),s=u("newFileCommand.saveLabel","Create File"),n=Qo(await i.defaultFilePath(),(e==null?void 0:e.fileName)??"Untitled.txt"),r=await i.showSaveDialog({saveLabel:s,title:s,defaultUri:n});r&&(await o.createFile(r,void 0,{overwrite:!0}),await t.openEditor({resource:r,options:{override:e==null?void 0:e.viewType,pinned:!0},languageId:e==null?void 0:e.languageId}))}});let Ot=class sp extends bf{get typeId(){return Cc}get editorId(){return We.id}get capabilities(){let e=32;return this.model?this.model.isReadonly()&&(e|=2):this.fileService.hasProvider(this.resource)?this.filesConfigurationService.isReadonly(this.resource)&&(e|=2):e|=4,e&2||(e|=128),e}constructor(e,t,i,o,s,n,r,a,d,l,p,g,f,b,m,y){super(e,t,b,d,p,g,f),this.instantiationService=a,this.textModelResolverService=l,this.pathService=m,this.textResourceConfigurationService=y,this.forceOpenAs=0,this.model=void 0,this.cachedTextFileModelReference=void 0,this.modelListeners=this._register(new x),this.model=this.textFileService.files.get(e),i&&this.setPreferredName(i),o&&this.setPreferredDescription(o),s&&this.setPreferredEncoding(s),n&&this.setPreferredLanguageId(n),typeof r=="string"&&this.setPreferredContents(r),this._register(this.textFileService.files.onDidCreate(D=>this.onDidCreateTextFileModel(D))),this.model&&this.registerModelListeners(this.model)}onDidCreateTextFileModel(e){Re(e.resource,this.resource)&&(this.model=e,this.registerModelListeners(e))}registerModelListeners(e){this.modelListeners.clear(),this.modelListeners.add(e.onDidChangeDirty(()=>this._onDidChangeDirty.fire())),this.modelListeners.add(e.onDidChangeReadonly(()=>this._onDidChangeCapabilities.fire())),this.modelListeners.add(e.onDidSaveError(()=>this._onDidChangeDirty.fire())),this.modelListeners.add(A.once(e.onWillDispose)(()=>{this.modelListeners.clear(),this.model=void 0}))}getName(){return this.preferredName||super.getName()}setPreferredName(e){this.allowLabelOverride()&&this.preferredName!==e&&(this.preferredName=e,this._onDidChangeLabel.fire())}allowLabelOverride(){return this.resource.scheme!==this.pathService.defaultUriScheme&&this.resource.scheme!==Q.vscodeUserData&&this.resource.scheme!==Q.file&&this.resource.scheme!==Q.vscodeRemote}getPreferredName(){return this.preferredName}isReadonly(){return this.model?this.model.isReadonly():this.filesConfigurationService.isReadonly(this.resource)}getDescription(e){return this.preferredDescription||super.getDescription(e)}setPreferredDescription(e){this.allowLabelOverride()&&this.preferredDescription!==e&&(this.preferredDescription=e,this._onDidChangeLabel.fire())}getPreferredDescription(){return this.preferredDescription}getEncoding(){return this.model?this.model.getEncoding():this.preferredEncoding}getPreferredEncoding(){return this.preferredEncoding}async setEncoding(e,t){var i;return this.setPreferredEncoding(e),(i=this.model)==null?void 0:i.setEncoding(e,t)}setPreferredEncoding(e){this.preferredEncoding=e,this.setForceOpenAsText()}getLanguageId(){return this.model?this.model.getLanguageId():this.preferredLanguageId}getPreferredLanguageId(){return this.preferredLanguageId}setLanguageId(e,t){var i;this.setPreferredLanguageId(e),(i=this.model)==null||i.setLanguageId(e,t)}setPreferredLanguageId(e){this.preferredLanguageId=e,this.setForceOpenAsText()}setPreferredContents(e){this.preferredContents=e,this.setForceOpenAsText()}setForceOpenAsText(){this.forceOpenAs=1}setForceOpenAsBinary(){this.forceOpenAs=2}isDirty(){var e;return!!((e=this.model)!=null&&e.isDirty())}isSaving(){var e,t,i;return(e=this.model)!=null&&e.hasState(0)||(t=this.model)!=null&&t.hasState(3)||(i=this.model)!=null&&i.hasState(5)?!1:this.filesConfigurationService.getAutoSaveMode()===1?!0:super.isSaving()}prefersEditorPane(e){return this.forceOpenAs===2?e.find(t=>t.typeId===cl):e.find(t=>t.typeId===dl)}resolve(e){return this.forceOpenAs===2?this.doResolveAsBinary():this.doResolveAsText(e)}async doResolveAsText(e){try{const t=this.preferredContents;this.preferredContents=void 0,await this.textFileService.files.resolve(this.resource,{languageId:this.preferredLanguageId,encoding:this.preferredEncoding,contents:typeof t=="string"?dv(t):void 0,reload:{async:!0},allowBinary:this.forceOpenAs===1,reason:1,limits:this.ensureLimits(e)}),this.cachedTextFileModelReference||(this.cachedTextFileModelReference=await this.textModelResolverService.createModelReference(this.resource));const i=this.cachedTextFileModelReference.object;return this.isDisposed()&&this.disposeModelReference(),i}catch(t){if(t.textFileOperationResult===0)return this.doResolveAsBinary();throw t}}ensureLimits(e){if(e!=null&&e.limits)return e.limits;const t=hv(this.resource);let i;const o=this.textResourceConfigurationService.inspect(this.resource,null,"workbench.editorLargeFileConfirmation");return lv(o)&&(i=o.value*Xl.MB),{size:i??t}}async doResolveAsBinary(){const e=this.instantiationService.createInstance(Eu,this.preferredResource,this.getName());return await e.resolve(),e}isResolved(){return!!this.model}async rename(e,t){return{editor:{resource:t,encoding:this.getEncoding(),options:{viewState:Id(this,e,this.editorService)}}}}toUntyped(e){const t={resource:this.preferredResource,forceFile:!0,options:{override:this.editorId}};return typeof(e==null?void 0:e.preserveViewState)=="number"&&(t.encoding=this.getEncoding(),t.languageId=this.getLanguageId(),t.contents=(()=>{const i=this.textFileService.files.get(this.resource);if(i!=null&&i.isDirty())return i.textEditorModel.getValue()})(),t.options={...t.options,viewState:Id(this,e.preserveViewState,this.editorService)}),t}matches(e){return this===e?!0:e instanceof sp?Re(e.resource,this.resource):Jo(e)?super.matches(e):!1}dispose(){this.model=void 0,this.disposeModelReference(),super.dispose()}disposeModelReference(){ie(this.cachedTextFileModelReference),this.cachedTextFileModelReference=void 0}};Ot=C([h(7,I),h(8,Eo),h(9,Ki),h(10,Ft),h(11,Ce),h(12,ms),h(13,P),h(14,Mn),h(15,To)],Ot);const np="saveConflictResolutionContext",va="conflictResolution",hd="learnMoreDirtyWriteError",rp=u("userGuide","Use the actions in the editor tool bar to either undo your changes or overwrite the content of the file with your changes.");let wa=class extends V{constructor(e,t,i,o,s,n,r){super(),this.notificationService=e,this.textFileService=t,this.contextKeyService=i,this.editorService=o,this.instantiationService=n,this.storageService=r,this.messages=new ot,this.conflictResolutionContext=new U(np,!1,!0).bindTo(this.contextKeyService),this.activeConflictResolutionResource=void 0;const a=this._register(n.createInstance(Qs));this._register(s.registerTextModelContentProvider(va,a)),this.textFileService.files.saveErrorHandler=this,this.registerListeners()}registerListeners(){this._register(this.textFileService.files.onDidSave(e=>this.onFileSavedOrReverted(e.model.resource))),this._register(this.textFileService.files.onDidRevert(e=>this.onFileSavedOrReverted(e.resource))),this._register(this.editorService.onDidActiveEditorChange(()=>this.onActiveEditorChanged()))}onActiveEditorChanged(){let e=!1,t;const i=this.editorService.activeEditor;if(i instanceof Nn){const o=i.original.resource;(o==null?void 0:o.scheme)===va&&(e=!0,t=i.modified.resource)}this.conflictResolutionContext.set(e),this.activeConflictResolutionResource=t}onFileSavedOrReverted(e){const t=this.messages.get(e);t&&(t.close(),this.messages.delete(e))}onSaveError(e,t){var l;const i=e,o=t.resource;let s;const n=[],r=[];if(i.fileOperationResult===3)if(this.activeConflictResolutionResource&&Re(this.activeConflictResolutionResource,t.resource)){if(this.storageService.getBoolean(hd,-1))return;s=rp,n.push(this.instantiationService.createInstance(wn)),r.push(this.instantiationService.createInstance(ya))}else s=u("staleSaveError","Failed to save '{0}': The content of the file is newer. Please compare your version with the file contents or overwrite the content of the file with your changes.",Me(o)),n.push(this.instantiationService.createInstance(Ca,t)),n.push(this.instantiationService.createInstance(Xy,t)),r.push(this.instantiationService.createInstance(_a));else{const p=i.fileOperationResult===5,g=p&&((l=i.options)==null?void 0:l.unlock),f=i.fileOperationResult===6,b=o.scheme===Q.file;b&&(f||g)?n.push(this.instantiationService.createInstance(qy,t,!!g)):p?n.push(this.instantiationService.createInstance(Jy,t)):n.push(this.instantiationService.createInstance(jy,t)),n.push(this.instantiationService.createInstance(Sa,t)),n.push(this.instantiationService.createInstance(Yy,t)),p?g&&b?s=Vt?u("readonlySaveErrorAdmin","Failed to save '{0}': File is read-only. Select 'Overwrite as Admin' to retry as administrator.",Me(o)):u("readonlySaveErrorSudo","Failed to save '{0}': File is read-only. Select 'Overwrite as Sudo' to retry as superuser.",Me(o)):s=u("readonlySaveError","Failed to save '{0}': File is read-only. Select 'Overwrite' to attempt to make it writeable.",Me(o)):b&&f?s=Vt?u("permissionDeniedSaveError","Failed to save '{0}': Insufficient permissions. Select 'Retry as Admin' to retry as administrator.",Me(o)):u("permissionDeniedSaveErrorSudo","Failed to save '{0}': Insufficient permissions. Select 'Retry as Sudo' to retry as superuser.",Me(o)):s=u({key:"genericSaveError",comment:["{0} is the resource that failed to save and {1} the error message"]},"Failed to save '{0}': {1}",Me(o),go(e,!1))}const a={primary:n,secondary:r},d=this.notificationService.notify({id:`${Is(t.resource.toString())}`,severity:Fi.Error,message:s,actions:a});A.once(d.onDidClose)(()=>{ie(n),ie(r)}),this.messages.set(t.resource,d)}dispose(){super.dispose(),this.messages.clear()}};wa=C([h(0,Ae),h(1,Eo),h(2,G),h(3,P),h(4,Ki),h(5,I),h(6,oe)],wa);let wn=class extends Z{constructor(e){super("workbench.files.action.resolveConflictLearnMore",u("learnMore","Learn More")),this.openerService=e}async run(){await this.openerService.open(T.parse("https://go.microsoft.com/fwlink/?linkid=868264"))}};wn=C([h(0,zi)],wn);let ya=class extends Z{constructor(e){super("workbench.files.action.resolveConflictLearnMoreDoNotShowAgain",u("dontShowAgain","Don't Show Again")),this.storageService=e}async run(e){this.storageService.store(hd,!0,-1,0),e.dispose()}};ya=C([h(0,oe)],ya);let Ca=class extends Z{constructor(e,t,i,o,s){super("workbench.files.action.resolveConflict",u("compareChanges","Compare")),this.model=e,this.editorService=t,this.notificationService=i,this.instantiationService=o,this.productService=s}async run(){if(!this.model.isDisposed()){const e=this.model.resource,t=Me(e),i=u("saveConflictDiffLabel","{0} (in file)  {1} (in {2}) - Resolve save conflict",t,t,this.productService.nameLong);await Qs.open(e,va,i,this.editorService,{pinned:!0});const o={primary:[this.instantiationService.createInstance(wn)]},s=this.notificationService.notify({id:`${Is(e.toString())}`,severity:Fi.Info,message:rp,actions:o,neverShowAgain:{id:hd,isSecondary:!0}});A.once(s.onDidClose)(()=>ie(o.primary))}}};Ca=C([h(1,P),h(2,Ae),h(3,I),h(4,Eh)],Ca);class qy extends Z{constructor(e,t){super("workbench.files.action.saveModelElevated",t?Vt?u("overwriteElevated","Overwrite as Admin..."):u("overwriteElevatedSudo","Overwrite as Sudo..."):Vt?u("saveElevated","Retry as Admin..."):u("saveElevatedSudo","Retry as Sudo...")),this.model=e,this.triedToUnlock=t}async run(){this.model.isDisposed()||await this.model.save({writeElevated:!0,writeUnlock:this.triedToUnlock,reason:1})}}class jy extends Z{constructor(e){super("workbench.files.action.saveModel",u("retry","Retry")),this.model=e}async run(){this.model.isDisposed()||await this.model.save({reason:1})}}class Yy extends Z{constructor(e){super("workbench.files.action.discardModel",u("discard","Discard")),this.model=e}async run(){this.model.isDisposed()||await this.model.revert()}}let Sa=class extends Z{constructor(e,t){super("workbench.files.action.saveModelAs",hl),this.model=e,this.editorService=t}async run(){if(!this.model.isDisposed()){const e=this.findEditor();e&&await this.editorService.save(e,{saveAs:!0,reason:1})}}findEditor(){let e;const t=this.editorService.findEditors(this.model.resource,{supportSideBySide:J.PRIMARY});for(const i of t)if(i.editor instanceof Ot){e=i;break}else e||(e=i);return e}};Sa=C([h(1,P)],Sa);class Jy extends Z{constructor(e){super("workbench.files.action.unlock",u("overwrite","Overwrite")),this.model=e}async run(){this.model.isDisposed()||await this.model.save({writeUnlock:!0,reason:1})}}class Xy extends Z{constructor(e){super("workbench.files.action.saveIgnoreModifiedSince",u("overwrite","Overwrite")),this.model=e}async run(){this.model.isDisposed()||await this.model.save({ignoreModifiedSince:!0,reason:1})}}let _a=class extends Z{constructor(e){super("workbench.files.action.configureSaveConflict",u("configure","Configure")),this.preferencesService=e}async run(){this.preferencesService.openSettings({query:"files.saveConflictResolution"})}};_a=C([h(0,pc)],_a);const ni=10,ap="renameFile";k.registerCommandAndKeybindingRule({id:ap,weight:200+ni,when:v.and(je,Ct.toNegated(),Ue),primary:60,mac:{primary:3},handler:vf});const cp="moveFileToTrash";k.registerCommandAndKeybindingRule({id:cp,weight:200+ni,when:v.and(je,Ue,Bn),primary:20,mac:{primary:2049,secondary:[20]},handler:wf});const tr="deleteFile";k.registerCommandAndKeybindingRule({id:tr,weight:200+ni,when:v.and(je,Ue),primary:1044,mac:{primary:2561},handler:ll});k.registerCommandAndKeybindingRule({id:tr,weight:200+ni,when:v.and(je,Ue,Bn.toNegated()),primary:20,mac:{primary:2049},handler:ll});const dp="filesExplorer.cut";k.registerCommandAndKeybindingRule({id:dp,weight:200+ni,when:v.and(je,Ct.toNegated(),Ue),primary:2102,handler:yf});const hp="filesExplorer.copy";k.registerCommandAndKeybindingRule({id:hp,weight:200+ni,when:v.and(je,Ct.toNegated()),primary:2081,handler:Cf});const lp="filesExplorer.paste";k.registerCommandAndKeybindingRule({id:lp,weight:200+ni,when:v.and(je,Ue),primary:2100,handler:Sf});k.registerCommandAndKeybindingRule({id:"filesExplorer.cancelCut",weight:200+ni,when:v.and(je,_f),primary:9,handler:async c=>{await c.get(nt).setToCopy([],!0)}});k.registerCommandAndKeybindingRule({id:"filesExplorer.openFilePreserveFocus",weight:200+ni,when:v.and(je,et.toNegated()),primary:10,handler:Ef});const ld={id:ws,title:u("copyPath","Copy Path")},ud={id:ys,title:u("copyRelativePath","Copy Relative Path")};pd(ws,ld.title,we.IsFileSystemResource,"1_cutcopypaste");pd(ys,ud.title,we.IsFileSystemResource,"1_cutcopypaste");pd(Zh,u("revealInSideBar","Reveal in Explorer View"),we.IsFileSystemResource,"2_files",1);function pd(c,e,t,i,o){R.appendMenuItem(S.EditorTitleContext,{command:{id:c,title:e},when:t,group:i,order:o})}up("workbench.files.action.acceptLocalChanges",u("acceptLocalChanges","Use your changes and overwrite file contents"),le.check,-10);up("workbench.files.action.revertLocalChanges",u("revertLocalChanges","Discard your changes and revert to file contents"),le.discard,-9);function up(c,e,t,i,o){R.appendMenuItem(S.EditorTitle,{command:{id:c,title:e,icon:t},when:v.equals(np,!0),group:"navigation",order:i})}function ct(c,e,t,i){R.appendMenuItem(S.CommandPalette,{command:{id:c,title:e,category:t},when:i})}ct(ws,{value:u("copyPathOfActive","Copy Path of Active File"),original:"Copy Path of Active File"},fe.File);ct(ys,{value:u("copyRelativePathOfActive","Copy Relative Path of Active File"),original:"Copy Relative Path of Active File"},fe.File);ct(bc,{value:ul,original:"Save"},fe.File);ct(el,{value:Df,original:"Save without Formatting"},fe.File);ct(vc,{value:u("saveAllInGroup","Save All in Group"),original:"Save All in Group"},fe.File);ct(il,{value:u("saveFiles","Save All Files"),original:"Save All Files"},fe.File);ct(wc,{value:u("revert","Revert File"),original:"Revert File"},fe.File);ct(fc,{value:u("compareActiveWithSaved","Compare Active File with Saved"),original:"Compare Active File with Saved"},fe.File);ct(tl,{value:hl,original:"Save As..."},fe.File);ct(gl,{value:pl,original:"New File"},fe.File,Sc.notEqualsTo("0"));ct(ml,{value:fl,original:"New Folder"},fe.File,Sc.notEqualsTo("0"));ct(yc,{value:al,original:"New Untitled Text File"},fe.File);const ir=v.or(we.IsFileSystemResource,we.Scheme.isEqualTo(Q.untitled)),pp={id:jh,title:u("openToSide","Open to the Side")};R.appendMenuItem(S.OpenEditorsContext,{group:"navigation",order:10,command:pp,when:ir});R.appendMenuItem(S.OpenEditorsContext,{group:"1_open",order:10,command:{id:kf,title:u("reopenWith","Reopen Editor With...")},when:xf});R.appendMenuItem(S.OpenEditorsContext,{group:"1_cutcopypaste",order:10,command:ld,when:we.IsFileSystemResource});R.appendMenuItem(S.OpenEditorsContext,{group:"1_cutcopypaste",order:20,command:ud,when:we.IsFileSystemResource});R.appendMenuItem(S.OpenEditorsContext,{group:"2_save",order:10,command:{id:bc,title:ul,precondition:_c},when:v.or(we.Scheme.isEqualTo(Q.untitled),v.and(Cs.toNegated(),bl.toNegated(),Ec.toNegated()))});R.appendMenuItem(S.OpenEditorsContext,{group:"2_save",order:20,command:{id:wc,title:u("revert","Revert File"),precondition:_c},when:v.and(Cs.toNegated(),bl.toNegated(),we.Scheme.notEqualsTo(Q.untitled),Ec.toNegated())});R.appendMenuItem(S.OpenEditorsContext,{group:"2_save",order:30,command:{id:vc,title:u("saveAll","Save All"),precondition:If},when:Cs});R.appendMenuItem(S.OpenEditorsContext,{group:"3_compare",order:10,command:{id:fc,title:u("compareWithSaved","Compare with Saved"),precondition:_c},when:v.and(we.IsFileSystemResource,Ec.toNegated(),ji.toNegated())});const gp={id:Xh,title:u("compareWithSelected","Compare with Selected")};R.appendMenuItem(S.OpenEditorsContext,{group:"3_compare",order:20,command:gp,when:v.and(we.HasResource,mc,ir,ji.toNegated())});const fp={id:Yh,title:u("compareSource","Select for Compare")};R.appendMenuItem(S.OpenEditorsContext,{group:"3_compare",order:30,command:fp,when:v.and(we.HasResource,ir,ji.toNegated())});const mp={id:Jh,title:u("compareSelected","Compare Selected")};R.appendMenuItem(S.OpenEditorsContext,{group:"3_compare",order:30,command:mp,when:v.and(we.HasResource,ji,ir)});R.appendMenuItem(S.OpenEditorsContext,{group:"4_close",order:10,command:{id:zh,title:u("close","Close")},when:Cs.toNegated()});R.appendMenuItem(S.OpenEditorsContext,{group:"4_close",order:20,command:{id:Af,title:u("closeOthers","Close Others")},when:Cs.toNegated()});R.appendMenuItem(S.OpenEditorsContext,{group:"4_close",order:30,command:{id:Tf,title:u("closeSaved","Close Saved")}});R.appendMenuItem(S.OpenEditorsContext,{group:"4_close",order:40,command:{id:Vf,title:u("closeAll","Close All")}});R.appendMenuItem(S.ExplorerContext,{group:"navigation",order:4,command:{id:gl,title:pl,precondition:Ue},when:et});R.appendMenuItem(S.ExplorerContext,{group:"navigation",order:6,command:{id:ml,title:fl,precondition:Ue},when:et});R.appendMenuItem(S.ExplorerContext,{group:"navigation",order:10,command:pp,when:v.and(et.toNegated(),we.HasResource)});R.appendMenuItem(S.ExplorerContext,{group:"navigation",order:20,command:{id:Qh,title:u("explorerOpenWith","Open With...")},when:v.and(et.toNegated(),Of)});R.appendMenuItem(S.ExplorerContext,{group:"3_compare",order:20,command:gp,when:v.and(et.toNegated(),we.HasResource,mc,ji.toNegated())});R.appendMenuItem(S.ExplorerContext,{group:"3_compare",order:30,command:fp,when:v.and(et.toNegated(),we.HasResource,ji.toNegated())});R.appendMenuItem(S.ExplorerContext,{group:"3_compare",order:30,command:mp,when:v.and(et.toNegated(),we.HasResource,ji)});R.appendMenuItem(S.ExplorerContext,{group:"5_cutcopypaste",order:8,command:{id:dp,title:u("cut","Cut")},when:v.and(Ct.toNegated(),Ue)});R.appendMenuItem(S.ExplorerContext,{group:"5_cutcopypaste",order:10,command:{id:hp,title:Rf},when:Ct.toNegated()});R.appendMenuItem(S.ExplorerContext,{group:"5_cutcopypaste",order:20,command:{id:lp,title:Lf,precondition:v.and(Ue,Mf)},when:et});R.appendMenuItem(S.ExplorerContext,{group:"5b_importexport",order:10,command:{id:Pf,title:Ff},when:v.or(v.and(Wo.toNegated(),we.Scheme.notEqualsTo(Q.file)),v.and(Wo,et.toNegated(),Ct.toNegated()),v.and(Wo,Nf))});R.appendMenuItem(S.ExplorerContext,{group:"5b_importexport",order:20,command:{id:Bf,title:Wf},when:v.and(Wo,et,Ue)});R.appendMenuItem(S.ExplorerContext,{group:"6_copypath",order:10,command:ld,when:we.IsFileSystemResource});R.appendMenuItem(S.ExplorerContext,{group:"6_copypath",order:20,command:ud,when:we.IsFileSystemResource});R.appendMenuItem(S.ExplorerContext,{group:"2_workspace",order:10,command:{id:Hf,title:Gf},when:v.and(Ct,v.or(vl,wl.isEqualTo("workspace")))});R.appendMenuItem(S.ExplorerContext,{group:"2_workspace",order:30,command:{id:sl,title:Uf},when:v.and(Ct,et,v.and(Sc.notEqualsTo("0"),v.or(vl,wl.isEqualTo("workspace"))))});R.appendMenuItem(S.ExplorerContext,{group:"7_modification",order:10,command:{id:ap,title:zf,precondition:Ue},when:Ct.toNegated()});R.appendMenuItem(S.ExplorerContext,{group:"7_modification",order:20,command:{id:cp,title:Kf,precondition:Ue},alt:{id:tr,title:u("deleteFile","Delete Permanently"),precondition:Ue},when:v.and(Ct.toNegated(),Bn)});R.appendMenuItem(S.ExplorerContext,{group:"7_modification",order:20,command:{id:tr,title:u("deleteFile","Delete Permanently"),precondition:Ue},when:v.and(Ct.toNegated(),Bn.toNegated())});for(const c of[S.EmptyEditorGroupContext,S.EditorTabsBarContext])R.appendMenuItem(c,{command:{id:yc,title:u("newFile","New Text File")},group:"1_file",order:10}),R.appendMenuItem(c,{command:{id:"workbench.action.quickOpen",title:u("openFile","Open File...")},group:"1_file",order:20});R.appendMenuItem(S.MenubarGoMenu,{group:"3_global_nav",command:{id:"workbench.action.quickOpen",title:u({key:"miGotoFile",comment:["&& denotes a mnemonic"]},"Go to &&File...")},order:1});var Zy=".monaco-workbench .call-hierarchy .message,.monaco-workbench .call-hierarchy .results{display:none}.monaco-workbench .call-hierarchy[data-state=data] .results{display:inherit;height:100%}.monaco-workbench .call-hierarchy[data-state=message] .message{align-items:center;display:flex;height:100%;justify-content:center}.monaco-workbench .call-hierarchy .editor,.monaco-workbench .call-hierarchy .tree{height:100%}.monaco-editor .call-hierarchy .tree{background-color:var(--vscode-peekViewResult-background);color:var(--vscode-peekViewResult-fileForeground)}.monaco-workbench .call-hierarchy .tree .callhierarchy-element{align-items:center;display:flex;flex:1;flex-flow:row nowrap}.monaco-workbench .call-hierarchy .tree .callhierarchy-element .monaco-icon-label{padding-left:4px}.monaco-editor .call-hierarchy .tree .monaco-list:focus .monaco-list-rows>.monaco-list-row.selected:not(.highlighted){background-color:var(--vscode-peekViewResult-selectionBackground);color:var(--vscode-peekViewResult-selectionForeground)!important}.monaco-editor .call-hierarchy .call-decoration{background-color:var(--vscode-peekViewEditor-matchHighlightBackground);border:2px solid var(--vscode-peekViewEditor-matchHighlightBorder);box-sizing:border-box}.monaco-editor .call-hierarchy .editor .monaco-editor .inputarea.ime-input,.monaco-editor .call-hierarchy .editor .monaco-editor .monaco-editor-background{background-color:var(--vscode-peekViewEditor-background)}.monaco-editor .call-hierarchy .editor .monaco-editor .margin{background-color:var(--vscode-peekViewEditorGutter-background)}";he(Zy,{});class Js{constructor(e,t,i,o){this.item=e,this.locations=t,this.model=i,this.parent=o}static compare(e,t){let i=Zl(e.item.uri.toString(),t.item.uri.toString());return i===0&&(i=Fe.compareRangesUsingStarts(e.item.range,t.item.range)),i}}let Qy=class{constructor(e){this.getDirection=e}hasChildren(){return!0}async getChildren(e){if(e instanceof yl)return e.roots.map(o=>new Js(o,void 0,e,void 0));const{model:t,item:i}=e;return this.getDirection()==="outgoingCalls"?(await t.resolveOutgoingCalls(i,Bi.None)).map(o=>new Js(o.to,o.fromRanges.map(s=>({range:s,uri:i.uri})),t,e)):(await t.resolveIncomingCalls(i,Bi.None)).map(o=>new Js(o.from,o.fromRanges.map(s=>({range:s,uri:o.from.uri})),t,e))}},eC=class{compare(e,t){return Js.compare(e,t)}},tC=class{constructor(e){this.getDirection=e}getId(e){let t=this.getDirection()+JSON.stringify(e.item.uri)+JSON.stringify(e.item.range);return e.parent&&(t+=this.getId(e.parent)),t}};class iC{constructor(e,t){this.icon=e,this.label=t}}class Os{constructor(){this.templateId=Os.id}renderTemplate(e){e.classList.add("callhierarchy-element");const t=document.createElement("div");e.appendChild(t);const i=new $c(e,{supportHighlights:!0});return new iC(t,i)}renderElement(e,t,i){var r;const{element:o,filterData:s}=e,n=(r=o.item.tags)==null?void 0:r.includes(1);i.icon.className="",i.icon.classList.add("inline",...ge.asClassNameArray(qc.toIcon(o.item.kind))),i.label.setLabel(o.item.name,o.item.detail,{labelEscapeNewLines:!0,matches:Ni(s),strikethrough:n})}disposeTemplate(e){e.label.dispose()}}Os.id="CallRenderer";let oC=class{getHeight(e){return 22}getTemplateId(e){return Os.id}},sC=class{constructor(e){this.getDirection=e}getWidgetAriaLabel(){return u("tree.aria","Call Hierarchy")}getAriaLabel(e){return this.getDirection()==="outgoingCalls"?u("from","calls from {0}",e.item.name):u("to","callers of {0}",e.item.name)}},vh=class{static store(e,t){t.store("callHierarchyPeekLayout",JSON.stringify(e),0,1)}static retrieve(e){const t=e.get("callHierarchyPeekLayout",0,"{}"),i={ratio:.7,height:17};try{return{...i,...JSON.parse(t)}}catch{return i}}constructor(e,t){this.ratio=e,this.height=t}};class nC extends xs{}let Wi=class bp extends eu{constructor(e,t,i,o,s,n,r,a,d,l,p){super(e,{showFrame:!0,showArrow:!0,isResizeable:!0,isAccessible:!0},p),this._where=t,this._direction=i,this._peekViewService=s,this._editorService=n,this._textModelService=r,this._storageService=a,this._menuService=d,this._contextKeyService=l,this._instantiationService=p,this._treeViewStates=new Map,this._previewDisposable=new x,this.create(),this._peekViewService.addExclusiveWidget(e,this),this._applyTheme(o.getColorTheme()),this._disposables.add(o.onDidColorThemeChange(this._applyTheme,this)),this._disposables.add(this._previewDisposable)}dispose(){vh.store(this._layoutInfo,this._storageService),this._splitView.dispose(),this._tree.dispose(),this._editor.dispose(),super.dispose()}get direction(){return this._direction}_applyTheme(e){const t=e.getColor(tu)||vi.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(iu)||vi.transparent,primaryHeadingColor:e.getColor(ou),secondaryHeadingColor:e.getColor(su)})}_fillHead(e){super._fillHead(e,!0);const t=this._menuService.createMenu(bp.TitleMenu,this._contextKeyService),i=()=>{const o=[];Es(t,void 0,o),this._actionbarWidget.clear(),this._actionbarWidget.push(o,{label:!1,icon:!0})};this._disposables.add(t),this._disposables.add(t.onDidChange(i)),i()}_fillBody(e){this._layoutInfo=vh.retrieve(this._storageService),this._dim=new q(0,0),this._parent=e,e.classList.add("call-hierarchy");const t=document.createElement("div");t.classList.add("message"),e.appendChild(t),this._message=t,this._message.tabIndex=0;const i=document.createElement("div");i.classList.add("results"),e.appendChild(i),this._splitView=new ts(i,{orientation:1});const o=document.createElement("div");o.classList.add("editor"),i.appendChild(o);const s={scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}};this._editor=this._instantiationService.createInstance(Kc,o,s,{},this.editor);const n=document.createElement("div");n.classList.add("tree"),i.appendChild(n);const r={sorter:new eC,accessibilityProvider:new sC(()=>this._direction),identityProvider:new tC(()=>this._direction),expandOnlyOnTwistieClick:!0,overrideStyles:{listBackground:cu}};this._tree=this._instantiationService.createInstance(nC,"CallHierarchyPeek",n,new oC,[this._instantiationService.createInstance(Os)],this._instantiationService.createInstance(Qy,()=>this._direction),r),this._splitView.addView({onDidChange:A.None,element:o,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:a=>{this._dim.height&&this._editor.layout({height:this._dim.height,width:a})}},Je.Distribute),this._splitView.addView({onDidChange:A.None,element:n,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:a=>{this._dim.height&&this._tree.layout(this._dim.height,a)}},Je.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this._layoutInfo.ratio=this._splitView.getViewSize(0)/this._dim.width)})),this._disposables.add(this._tree.onDidChangeFocus(this._updatePreview,this)),this._disposables.add(this._editor.onMouseDown(a=>{const{event:d,target:l}=a;if(d.detail!==2)return;const[p]=this._tree.getFocus();p&&(this.dispose(),this._editorService.openEditor({resource:p.item.uri,options:{selection:l.range}}))})),this._disposables.add(this._tree.onMouseDblClick(a=>{a.target!==nu.Twistie&&a.element&&(this.dispose(),this._editorService.openEditor({resource:a.element.item.uri,options:{selection:a.element.item.selectionRange,pinned:!0}}))})),this._disposables.add(this._tree.onDidChangeSelection(a=>{const[d]=a.elements;d&&a.browserEvent instanceof KeyboardEvent&&(this.dispose(),this._editorService.openEditor({resource:d.item.uri,options:{selection:d.item.selectionRange,pinned:!0}}))}))}async _updatePreview(){const[e]=this._tree.getFocus();if(!e)return;this._previewDisposable.clear();const t={description:"call-hierarchy-decoration",stickiness:1,className:"call-decoration",overviewRuler:{color:Xi(ru),position:au.Center}};let i;this._direction==="outgoingCalls"?i=e.parent?e.parent.item.uri:e.model.root.uri:i=e.item.uri;const o=await this._textModelService.createModelReference(i);this._editor.setModel(o.object.textEditorModel);const s=[];let n,r=e.locations;r||(r=[{uri:e.item.uri,range:e.item.selectionRange}]);for(const d of r)d.uri.toString()===i.toString()&&(s.push({range:d.range,options:t}),n=n?Fe.plusRange(d.range,n):d.range);if(n){this._editor.revealRangeInCenter(n,1);const d=this._editor.createDecorationsCollection(s);this._previewDisposable.add(Y(()=>d.clear()))}this._previewDisposable.add(o);const a=this._direction==="outgoingCalls"?u("callFrom","Calls from '{0}'",e.model.root.name):u("callsTo","Callers of '{0}'",e.model.root.name);this.setTitle(a)}showLoading(){this._parent.dataset.state="loading",this.setTitle(u("title.loading","Loading...")),this._show()}showMessage(e){this._parent.dataset.state="message",this.setTitle(""),this.setMetaTitle(""),this._message.innerText=e,this._show(),this._message.focus()}async showModel(e){this._show();const t=this._treeViewStates.get(this._direction);await this._tree.setInput(e,t);const i=this._tree.getNode(e).children[0];await this._tree.expand(i.element),i.children.length===0?this.showMessage(this._direction==="outgoingCalls"?u("empt.callsFrom","No calls from '{0}'",e.root.name):u("empt.callsTo","No callers of '{0}'",e.root.name)):(this._parent.dataset.state="data",(!t||this._tree.getFocus().length===0)&&this._tree.setFocus([i.children[0].element]),this._tree.domFocus(),this._updatePreview())}getModel(){return this._tree.getInput()}getFocused(){return this._tree.getFocus()[0]}async updateDirection(e){const t=this._tree.getInput();t&&e!==this._direction&&(this._treeViewStates.set(this._direction,this._tree.getViewState()),this._direction=e,await this.showModel(t))}_show(){this._isShowing||(this.editor.revealLineInCenterIfOutsideViewport(this._where.lineNumber,0),super.show(Fe.fromPositions(this._where),this._layoutInfo.height))}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){(this._dim.height!==e||this._dim.width!==t)&&(super._doLayoutBody(e,t),this._dim=new q(t,e),this._layoutInfo.height=this._viewZone?this._viewZone.heightInLines:this._layoutInfo.height,this._splitView.layout(t),this._splitView.resizeView(0,t*this._layoutInfo.ratio))}};Wi.TitleMenu=new S("callhierarchy/title");Wi=C([h(3,te),h(4,Ql),h(5,P),h(6,Ki),h(7,oe),h(8,rt),h(9,G),h(10,I)],Wi);const Ea=new U("editorHasCallHierarchyProvider",!1,u("editorHasCallHierarchyProvider","Whether a call hierarchy provider is available")),Rs=new U("callHierarchyVisible",!1,u("callHierarchyVisible","Whether call hierarchy peek is currently showing")),cs=new U("callHierarchyDirection",void 0,{type:"string",description:u("callHierarchyDirection","Whether call hierarchy shows incoming or outgoing calls")});function rC(c){return c==="outgoingCalls"||c==="incomingCalls"?c:"incomingCalls"}let wt=class Po{static get(e){return e.getContribution(Po.Id)}constructor(e,t,i,o,s){this._editor=e,this._contextKeyService=t,this._storageService=i,this._editorService=o,this._instantiationService=s,this._dispoables=new x,this._sessionDisposables=new x,this._ctxIsVisible=Rs.bindTo(this._contextKeyService),this._ctxHasProvider=Ea.bindTo(this._contextKeyService),this._ctxDirection=cs.bindTo(this._contextKeyService),this._dispoables.add(A.any(e.onDidChangeModel,e.onDidChangeModelLanguage,cr.onDidChange)(()=>{this._ctxHasProvider.set(e.hasModel()&&cr.has(e.getModel()))})),this._dispoables.add(this._sessionDisposables)}dispose(){this._ctxHasProvider.reset(),this._ctxIsVisible.reset(),this._dispoables.dispose()}async startCallHierarchyFromEditor(){if(this._sessionDisposables.clear(),!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getPosition();if(!cr.has(e))return;const i=new qe,o=yl.create(e,t,i.token),s=rC(this._storageService.get(Po._StorageDirection,0,"incomingCalls"));this._showCallHierarchyWidget(t,s,o,i)}async startCallHierarchyFromCallHierarchy(){var s;if(!this._widget)return;const e=this._widget.getModel(),t=this._widget.getFocused();if(!t||!e)return;const i=await this._editorService.openCodeEditor({resource:t.item.uri},this._editor);if(!i)return;const o=e.fork(t.item);this._sessionDisposables.clear(),(s=Po.get(i))==null||s._showCallHierarchyWidget(Fe.lift(o.root.selectionRange).getStartPosition(),this._widget.direction,Promise.resolve(o),new qe)}_showCallHierarchyWidget(e,t,i,o){this._ctxIsVisible.set(!0),this._ctxDirection.set(t),A.any(this._editor.onDidChangeModel,this._editor.onDidChangeModelLanguage)(this.endCallHierarchy,this,this._sessionDisposables),this._widget=this._instantiationService.createInstance(Wi,this._editor,e,t),this._widget.showLoading(),this._sessionDisposables.add(this._widget.onDidClose(()=>{this.endCallHierarchy(),this._storageService.store(Po._StorageDirection,this._widget.direction,0,0)})),this._sessionDisposables.add({dispose(){o.dispose(!0)}}),this._sessionDisposables.add(this._widget),i.then(s=>{o.token.isCancellationRequested||(s?(this._sessionDisposables.add(s),this._widget.showModel(s)):this._widget.showMessage(u("no.item","No results")))}).catch(s=>{if(Ui(s)){this.endCallHierarchy();return}this._widget.showMessage(u("error","Failed to show call hierarchy"))})}showOutgoingCalls(){var e;(e=this._widget)==null||e.updateDirection("outgoingCalls"),this._ctxDirection.set("outgoingCalls")}showIncomingCalls(){var e;(e=this._widget)==null||e.updateDirection("incomingCalls"),this._ctxDirection.set("incomingCalls")}endCallHierarchy(){this._sessionDisposables.clear(),this._ctxIsVisible.set(!1),this._editor.focus()}};wt.Id="callHierarchy";wt._StorageDirection="callHierarchy/defaultDirection";wt=C([h(1,G),h(2,oe),h(3,qi),h(4,I)],wt);du(wt.Id,wt,0);j(class extends Nt{constructor(){super({id:"editor.showCallHierarchy",title:{value:u("title","Peek Call Hierarchy"),original:"Peek Call Hierarchy"},menu:{id:S.EditorContextPeek,group:"navigation",order:1e3,when:v.and(Ea,on.notInPeekEditor)},keybinding:{when:$i.editorTextFocus,weight:200,primary:1024+512+38},precondition:v.and(Ea,on.notInPeekEditor)})}async runEditorCommand(c,e){var t;return(t=wt.get(e))==null?void 0:t.startCallHierarchyFromEditor()}});j(class extends Nt{constructor(){super({id:"editor.showIncomingCalls",title:{value:u("title.incoming","Show Incoming Calls"),original:"Show Incoming Calls"},icon:Ao("callhierarchy-incoming",le.callIncoming,u("showIncomingCallsIcons","Icon for incoming calls in the call hierarchy view.")),precondition:v.and(Rs,cs.isEqualTo("outgoingCalls")),keybinding:{weight:200,primary:1024+512+38},menu:{id:Wi.TitleMenu,when:cs.isEqualTo("outgoingCalls"),order:1}})}runEditorCommand(c,e){var t;return(t=wt.get(e))==null?void 0:t.showIncomingCalls()}});j(class extends Nt{constructor(){super({id:"editor.showOutgoingCalls",title:{value:u("title.outgoing","Show Outgoing Calls"),original:"Show Outgoing Calls"},icon:Ao("callhierarchy-outgoing",le.callOutgoing,u("showOutgoingCallsIcon","Icon for outgoing calls in the call hierarchy view.")),precondition:v.and(Rs,cs.isEqualTo("incomingCalls")),keybinding:{weight:200,primary:1024+512+38},menu:{id:Wi.TitleMenu,when:cs.isEqualTo("incomingCalls"),order:1}})}runEditorCommand(c,e){var t;return(t=wt.get(e))==null?void 0:t.showOutgoingCalls()}});j(class extends Nt{constructor(){super({id:"editor.refocusCallHierarchy",title:{value:u("title.refocus","Refocus Call Hierarchy"),original:"Refocus Call Hierarchy"},precondition:Rs,keybinding:{weight:200,primary:1024+3}})}async runEditorCommand(c,e){var t;return(t=wt.get(e))==null?void 0:t.startCallHierarchyFromCallHierarchy()}});j(class extends Nt{constructor(){super({id:"editor.closeCallHierarchy",title:u("close","Close"),icon:le.close,precondition:Rs,keybinding:{weight:200+10,primary:9,when:v.not("config.editor.stablePeek")},menu:{id:Wi.TitleMenu,order:1e3}})}runEditorCommand(c,e){var t;return(t=wt.get(e))==null?void 0:t.endCallHierarchy()}});var aC=".monaco-workbench .type-hierarchy .message,.monaco-workbench .type-hierarchy .results{display:none}.monaco-workbench .type-hierarchy[data-state=data] .results{display:inherit;height:100%}.monaco-workbench .type-hierarchy[data-state=message] .message{align-items:center;display:flex;height:100%;justify-content:center}.monaco-workbench .type-hierarchy .editor,.monaco-workbench .type-hierarchy .tree{height:100%}.monaco-editor .type-hierarchy .tree{background-color:var(--vscode-peekViewResult-background);color:var(--vscode-peekViewResult-fileForeground)}.monaco-editor .type-hierarchy .tree .monaco-list:focus .monaco-list-rows>.monaco-list-row.selected:not(.highlighted){background-color:var(--vscode-peekViewResult-selectionBackground);color:var(--vscode-peekViewResult-selectionForeground)!important}.monaco-workbench .type-hierarchy .tree .typehierarchy-element{align-items:center;display:flex;flex:1;flex-flow:row nowrap}.monaco-workbench .type-hierarchy .tree .typehierarchy-element .monaco-icon-label{padding-left:4px}.monaco-editor .type-hierarchy .type-decoration{background-color:var(--vscode-peekViewEditor-matchHighlightBackground);border:2px solid var(--vscode-peekViewEditor-matchHighlightBorder);box-sizing:border-box}.monaco-editor .type-hierarchy .editor .monaco-editor .inputarea.ime-input,.monaco-editor .type-hierarchy .editor .monaco-editor .monaco-editor-background{background-color:var(--vscode-peekViewEditor-background)}.monaco-editor .type-hierarchy .editor .monaco-editor .margin{background-color:var(--vscode-peekViewEditorGutter-background)}";he(aC,{});class Xs{constructor(e,t,i){this.item=e,this.model=t,this.parent=i}static compare(e,t){let i=Zl(e.item.uri.toString(),t.item.uri.toString());return i===0&&(i=Fe.compareRangesUsingStarts(e.item.range,t.item.range)),i}}class cC{constructor(e){this.getDirection=e}hasChildren(){return!0}async getChildren(e){if(e instanceof Cl)return e.roots.map(o=>new Xs(o,e,void 0));const{model:t,item:i}=e;return this.getDirection()==="supertypes"?(await t.provideSupertypes(i,Bi.None)).map(o=>new Xs(o,t,e)):(await t.provideSubtypes(i,Bi.None)).map(o=>new Xs(o,t,e))}}class dC{compare(e,t){return Xs.compare(e,t)}}class hC{constructor(e){this.getDirection=e}getId(e){let t=this.getDirection()+JSON.stringify(e.item.uri)+JSON.stringify(e.item.range);return e.parent&&(t+=this.getId(e.parent)),t}}class lC{constructor(e,t){this.icon=e,this.label=t}}class Ls{constructor(){this.templateId=Ls.id}renderTemplate(e){e.classList.add("typehierarchy-element");const t=document.createElement("div");e.appendChild(t);const i=new $c(e,{supportHighlights:!0});return new lC(t,i)}renderElement(e,t,i){var r;const{element:o,filterData:s}=e,n=(r=o.item.tags)==null?void 0:r.includes(1);i.icon.classList.add("inline",...ge.asClassNameArray(qc.toIcon(o.item.kind))),i.label.setLabel(o.item.name,o.item.detail,{labelEscapeNewLines:!0,matches:Ni(s),strikethrough:n})}disposeTemplate(e){e.label.dispose()}}Ls.id="TypeRenderer";class uC{getHeight(e){return 22}getTemplateId(e){return Ls.id}}class pC{constructor(e){this.getDirection=e}getWidgetAriaLabel(){return u("tree.aria","Type Hierarchy")}getAriaLabel(e){return this.getDirection()==="supertypes"?u("supertypes","supertypes of {0}",e.item.name):u("subtypes","subtypes of {0}",e.item.name)}}class wh{static store(e,t){t.store("typeHierarchyPeekLayout",JSON.stringify(e),0,1)}static retrieve(e){const t=e.get("typeHierarchyPeekLayout",0,"{}"),i={ratio:.7,height:17};try{return{...i,...JSON.parse(t)}}catch{return i}}constructor(e,t){this.ratio=e,this.height=t}}class gC extends xs{}let Hi=class vp extends eu{constructor(e,t,i,o,s,n,r,a,d,l,p){super(e,{showFrame:!0,showArrow:!0,isResizeable:!0,isAccessible:!0},p),this._where=t,this._direction=i,this._peekViewService=s,this._editorService=n,this._textModelService=r,this._storageService=a,this._menuService=d,this._contextKeyService=l,this._instantiationService=p,this._treeViewStates=new Map,this._previewDisposable=new x,this.create(),this._peekViewService.addExclusiveWidget(e,this),this._applyTheme(o.getColorTheme()),this._disposables.add(o.onDidColorThemeChange(this._applyTheme,this)),this._disposables.add(this._previewDisposable)}dispose(){wh.store(this._layoutInfo,this._storageService),this._splitView.dispose(),this._tree.dispose(),this._editor.dispose(),super.dispose()}get direction(){return this._direction}_applyTheme(e){const t=e.getColor(tu)||vi.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(iu)||vi.transparent,primaryHeadingColor:e.getColor(ou),secondaryHeadingColor:e.getColor(su)})}_fillHead(e){super._fillHead(e,!0);const t=this._menuService.createMenu(vp.TitleMenu,this._contextKeyService),i=()=>{const o=[];Es(t,void 0,o),this._actionbarWidget.clear(),this._actionbarWidget.push(o,{label:!1,icon:!0})};this._disposables.add(t),this._disposables.add(t.onDidChange(i)),i()}_fillBody(e){this._layoutInfo=wh.retrieve(this._storageService),this._dim=new q(0,0),this._parent=e,e.classList.add("type-hierarchy");const t=document.createElement("div");t.classList.add("message"),e.appendChild(t),this._message=t,this._message.tabIndex=0;const i=document.createElement("div");i.classList.add("results"),e.appendChild(i),this._splitView=new ts(i,{orientation:1});const o=document.createElement("div");o.classList.add("editor"),i.appendChild(o);const s={scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}};this._editor=this._instantiationService.createInstance(Kc,o,s,{},this.editor);const n=document.createElement("div");n.classList.add("tree"),i.appendChild(n);const r={sorter:new dC,accessibilityProvider:new pC(()=>this._direction),identityProvider:new hC(()=>this._direction),expandOnlyOnTwistieClick:!0,overrideStyles:{listBackground:cu}};this._tree=this._instantiationService.createInstance(gC,"TypeHierarchyPeek",n,new uC,[this._instantiationService.createInstance(Ls)],this._instantiationService.createInstance(cC,()=>this._direction),r),this._splitView.addView({onDidChange:A.None,element:o,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:a=>{this._dim.height&&this._editor.layout({height:this._dim.height,width:a})}},Je.Distribute),this._splitView.addView({onDidChange:A.None,element:n,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:a=>{this._dim.height&&this._tree.layout(this._dim.height,a)}},Je.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this._layoutInfo.ratio=this._splitView.getViewSize(0)/this._dim.width)})),this._disposables.add(this._tree.onDidChangeFocus(this._updatePreview,this)),this._disposables.add(this._editor.onMouseDown(a=>{const{event:d,target:l}=a;if(d.detail!==2)return;const[p]=this._tree.getFocus();p&&(this.dispose(),this._editorService.openEditor({resource:p.item.uri,options:{selection:l.range}}))})),this._disposables.add(this._tree.onMouseDblClick(a=>{a.target!==nu.Twistie&&a.element&&(this.dispose(),this._editorService.openEditor({resource:a.element.item.uri,options:{selection:a.element.item.selectionRange,pinned:!0}}))})),this._disposables.add(this._tree.onDidChangeSelection(a=>{const[d]=a.elements;d&&a.browserEvent instanceof KeyboardEvent&&(this.dispose(),this._editorService.openEditor({resource:d.item.uri,options:{selection:d.item.selectionRange,pinned:!0}}))}))}async _updatePreview(){const[e]=this._tree.getFocus();if(!e)return;this._previewDisposable.clear();const t={description:"type-hierarchy-decoration",stickiness:1,className:"type-decoration",overviewRuler:{color:Xi(ru),position:au.Center}};let i;this._direction==="supertypes"?i=e.parent?e.parent.item.uri:e.model.root.uri:i=e.item.uri;const o=await this._textModelService.createModelReference(i);this._editor.setModel(o.object.textEditorModel);const s=[];let n;const r={uri:e.item.uri,range:e.item.selectionRange};if(r.uri.toString()===i.toString()&&(s.push({range:r.range,options:t}),n=n?Fe.plusRange(r.range,n):r.range),n){this._editor.revealRangeInCenter(n,1);const d=this._editor.createDecorationsCollection(s);this._previewDisposable.add(Y(()=>d.clear()))}this._previewDisposable.add(o);const a=this._direction==="supertypes"?u("supertypes","Supertypes of '{0}'",e.model.root.name):u("subtypes","Subtypes of '{0}'",e.model.root.name);this.setTitle(a)}showLoading(){this._parent.dataset.state="loading",this.setTitle(u("title.loading","Loading...")),this._show()}showMessage(e){this._parent.dataset.state="message",this.setTitle(""),this.setMetaTitle(""),this._message.innerText=e,this._show(),this._message.focus()}async showModel(e){this._show();const t=this._treeViewStates.get(this._direction);await this._tree.setInput(e,t);const i=this._tree.getNode(e).children[0];await this._tree.expand(i.element),i.children.length===0?this.showMessage(this._direction==="supertypes"?u("empt.supertypes","No supertypes of '{0}'",e.root.name):u("empt.subtypes","No subtypes of '{0}'",e.root.name)):(this._parent.dataset.state="data",(!t||this._tree.getFocus().length===0)&&this._tree.setFocus([i.children[0].element]),this._tree.domFocus(),this._updatePreview())}getModel(){return this._tree.getInput()}getFocused(){return this._tree.getFocus()[0]}async updateDirection(e){const t=this._tree.getInput();t&&e!==this._direction&&(this._treeViewStates.set(this._direction,this._tree.getViewState()),this._direction=e,await this.showModel(t))}_show(){this._isShowing||(this.editor.revealLineInCenterIfOutsideViewport(this._where.lineNumber,0),super.show(Fe.fromPositions(this._where),this._layoutInfo.height))}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){(this._dim.height!==e||this._dim.width!==t)&&(super._doLayoutBody(e,t),this._dim=new q(t,e),this._layoutInfo.height=this._viewZone?this._viewZone.heightInLines:this._layoutInfo.height,this._splitView.layout(t),this._splitView.resizeView(0,t*this._layoutInfo.ratio))}};Hi.TitleMenu=new S("typehierarchy/title");Hi=C([h(3,te),h(4,Ql),h(5,P),h(6,Ki),h(7,oe),h(8,rt),h(9,G),h(10,I)],Hi);const Da=new U("editorHasTypeHierarchyProvider",!1,u("editorHasTypeHierarchyProvider","Whether a type hierarchy provider is available")),Ms=new U("typeHierarchyVisible",!1,u("typeHierarchyVisible","Whether type hierarchy peek is currently showing")),ds=new U("typeHierarchyDirection",void 0,{type:"string",description:u("typeHierarchyDirection","whether type hierarchy shows super types or subtypes")});function fC(c){return c==="subtypes"||c==="supertypes"?c:"subtypes"}let yt=class Fo{static get(e){return e.getContribution(Fo.Id)}constructor(e,t,i,o,s){this._editor=e,this._contextKeyService=t,this._storageService=i,this._editorService=o,this._instantiationService=s,this._disposables=new x,this._sessionDisposables=new x,this._ctxHasProvider=Da.bindTo(this._contextKeyService),this._ctxIsVisible=Ms.bindTo(this._contextKeyService),this._ctxDirection=ds.bindTo(this._contextKeyService),this._disposables.add(A.any(e.onDidChangeModel,e.onDidChangeModelLanguage,dr.onDidChange)(()=>{this._ctxHasProvider.set(e.hasModel()&&dr.has(e.getModel()))})),this._disposables.add(this._sessionDisposables)}dispose(){this._disposables.dispose()}async startTypeHierarchyFromEditor(){if(this._sessionDisposables.clear(),!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getPosition();if(!dr.has(e))return;const i=new qe,o=Cl.create(e,t,i.token),s=fC(this._storageService.get(Fo._storageDirectionKey,0,"subtypes"));this._showTypeHierarchyWidget(t,s,o,i)}_showTypeHierarchyWidget(e,t,i,o){this._ctxIsVisible.set(!0),this._ctxDirection.set(t),A.any(this._editor.onDidChangeModel,this._editor.onDidChangeModelLanguage)(this.endTypeHierarchy,this,this._sessionDisposables),this._widget=this._instantiationService.createInstance(Hi,this._editor,e,t),this._widget.showLoading(),this._sessionDisposables.add(this._widget.onDidClose(()=>{this.endTypeHierarchy(),this._storageService.store(Fo._storageDirectionKey,this._widget.direction,0,0)})),this._sessionDisposables.add({dispose(){o.dispose(!0)}}),this._sessionDisposables.add(this._widget),i.then(s=>{o.token.isCancellationRequested||(s?(this._sessionDisposables.add(s),this._widget.showModel(s)):this._widget.showMessage(u("no.item","No results")))}).catch(s=>{if(Ui(s)){this.endTypeHierarchy();return}this._widget.showMessage(u("error","Failed to show type hierarchy"))})}async startTypeHierarchyFromTypeHierarchy(){var s;if(!this._widget)return;const e=this._widget.getModel(),t=this._widget.getFocused();if(!t||!e)return;const i=await this._editorService.openCodeEditor({resource:t.item.uri},this._editor);if(!i)return;const o=e.fork(t.item);this._sessionDisposables.clear(),(s=Fo.get(i))==null||s._showTypeHierarchyWidget(Fe.lift(o.root.selectionRange).getStartPosition(),this._widget.direction,Promise.resolve(o),new qe)}showSupertypes(){var e;(e=this._widget)==null||e.updateDirection("supertypes"),this._ctxDirection.set("supertypes")}showSubtypes(){var e;(e=this._widget)==null||e.updateDirection("subtypes"),this._ctxDirection.set("subtypes")}endTypeHierarchy(){this._sessionDisposables.clear(),this._ctxIsVisible.set(!1),this._editor.focus()}};yt.Id="typeHierarchy";yt._storageDirectionKey="typeHierarchy/defaultDirection";yt=C([h(1,G),h(2,oe),h(3,qi),h(4,I)],yt);du(yt.Id,yt,0);j(class extends Nt{constructor(){super({id:"editor.showTypeHierarchy",title:{value:u("title","Peek Type Hierarchy"),original:"Peek Type Hierarchy"},menu:{id:S.EditorContextPeek,group:"navigation",order:1e3,when:v.and(Da,on.notInPeekEditor)},precondition:v.and(Da,on.notInPeekEditor)})}async runEditorCommand(c,e){var t;return(t=yt.get(e))==null?void 0:t.startTypeHierarchyFromEditor()}});j(class extends Nt{constructor(){super({id:"editor.showSupertypes",title:{value:u("title.supertypes","Show Supertypes"),original:"Show Supertypes"},icon:le.typeHierarchySuper,precondition:v.and(Ms,ds.isEqualTo("subtypes")),keybinding:{weight:200,primary:1024+512+38},menu:{id:Hi.TitleMenu,when:ds.isEqualTo("subtypes"),order:1}})}runEditorCommand(c,e){var t;return(t=yt.get(e))==null?void 0:t.showSupertypes()}});j(class extends Nt{constructor(){super({id:"editor.showSubtypes",title:{value:u("title.subtypes","Show Subtypes"),original:"Show Subtypes"},icon:le.typeHierarchySub,precondition:v.and(Ms,ds.isEqualTo("supertypes")),keybinding:{weight:200,primary:1024+512+38},menu:{id:Hi.TitleMenu,when:ds.isEqualTo("supertypes"),order:1}})}runEditorCommand(c,e){var t;return(t=yt.get(e))==null?void 0:t.showSubtypes()}});j(class extends Nt{constructor(){super({id:"editor.refocusTypeHierarchy",title:{value:u("title.refocusTypeHierarchy","Refocus Type Hierarchy"),original:"Refocus Type Hierarchy"},precondition:Ms,keybinding:{weight:200,primary:1024+3}})}async runEditorCommand(c,e){var t;return(t=yt.get(e))==null?void 0:t.startTypeHierarchyFromTypeHierarchy()}});j(class extends Nt{constructor(){super({id:"editor.closeTypeHierarchy",title:u("close","Close"),icon:le.close,precondition:Ms,keybinding:{weight:200+10,primary:9,when:v.not("config.editor.stablePeek")},menu:{id:Hi.TitleMenu,order:1e3}})}runEditorCommand(c,e){var t;return(t=yt.get(e))==null?void 0:t.endTypeHierarchy()}});var mC=".monaco-list .monaco-list-row.focused.selected .outline-element .monaco-highlighted-label,.monaco-list .monaco-list-row.focused.selected .outline-element-decoration{color:inherit!important}.monaco-list .outline-element{align-items:center;display:flex;flex:1;flex-flow:row nowrap}.monaco-list .outline-element .monaco-highlighted-label{color:var(--outline-element-color)}.monaco-breadcrumbs .outline-element .outline-element-decoration,.monaco-list .outline-element .outline-element-decoration{color:var(--outline-element-color);font-size:90%;font-weight:600;margin-left:auto;opacity:.75;padding:0 12px 0 5px;text-align:center}.monaco-breadcrumbs .outline-element .monaco-icon-label-container .monaco-icon-description-container,.monaco-breadcrumbs .outline-element .outline-element-decoration{display:none}.monaco-list .outline-element .outline-element-decoration.bubble{font-family:codicon;font-size:14px;opacity:.4;padding-right:8px}.monaco-list .outline-element .outline-element-icon{margin-right:4px}";he(mC,{});class bC{getKeyboardNavigationLabel(e){return e instanceof ft?e.label:e.symbol.name}}class vC{constructor(e){this._ariaLabel=e}getWidgetAriaLabel(){return this._ariaLabel}getAriaLabel(e){return e instanceof ft?e.label:e.symbol.name}}class wC{getId(e){return e.id}}class yn{constructor(e,t){this.labelContainer=e,this.label=t}}Ns(yn,"id","DocumentSymbolGroupTemplate");class Cn{constructor(e,t,i,o){this.container=e,this.iconLabel=t,this.iconClass=i,this.decoration=o}}Ns(Cn,"id","DocumentSymbolTemplate");class yC{getHeight(e){return 22}getTemplateId(e){return e instanceof ft?yn.id:Cn.id}}class CC{constructor(){this.templateId=yn.id}renderTemplate(e){const t=z(".outline-element-label");return e.classList.add("outline-element"),de(e,t),new yn(t,new gv(t))}renderElement(e,t,i){i.label.set(e.element.label,Ni(e.filterData))}disposeTemplate(e){}}let Sn=class wp{constructor(e,t,i){this._renderMarker=e,this._configurationService=t,this._themeService=i,this.templateId=Cn.id}renderTemplate(e){e.classList.add("outline-element");const t=new $c(e,{supportHighlights:!0}),i=z(".outline-element-icon"),o=z(".outline-element-decoration");return e.prepend(i),e.appendChild(o),new Cn(e,t,i,o)}renderElement(e,t,i){const{element:o}=e,s=["nowrap"],n={matches:Ni(e.filterData),labelEscapeNewLines:!0,extraClasses:s,title:u("title.template","{0} ({1})",o.symbol.name,wp._symbolKindNames[o.symbol.kind])};this._configurationService.getValue("outline.icons")&&(i.iconClass.className="",i.iconClass.classList.add("outline-element-icon","inline",...ge.asClassNameArray(qc.toIcon(o.symbol.kind)))),o.symbol.tags.indexOf(1)>=0&&(s.push("deprecated"),n.matches=[]),i.iconLabel.setLabel(o.symbol.name,o.symbol.detail,n),this._renderMarker&&this._renderMarkerInfo(o,i)}_renderMarkerInfo(e,t){if(!e.marker){mi(t.decoration),t.container.style.removeProperty("--outline-element-color");return}const{count:i,topSev:o}=e.marker,s=this._themeService.getColorTheme().getColor(o===zr.Error?uv:pv),n=s?s.toString():"inherit";this._configurationService.getValue("outline.problems.colors")?t.container.style.setProperty("--outline-element-color",n):t.container.style.removeProperty("--outline-element-color"),this._configurationService.getValue("outline.problems.badges")?i>0?(fi(t.decoration),t.decoration.classList.remove("bubble"),t.decoration.innerText=i<10?i.toString():"+9",t.decoration.title=i===1?u("1.problem","1 problem in this element"):u("N.problem","{0} problems in this element",i),t.decoration.style.setProperty("--outline-element-color",n)):(fi(t.decoration),t.decoration.classList.add("bubble"),t.decoration.innerText="",t.decoration.title=u("deep.problem","Contains elements with problems"),t.decoration.style.setProperty("--outline-element-color",n)):mi(t.decoration)}disposeTemplate(e){e.iconLabel.dispose()}};Sn._symbolKindNames={17:u("Array","array"),16:u("Boolean","boolean"),4:u("Class","class"),13:u("Constant","constant"),8:u("Constructor","constructor"),9:u("Enum","enumeration"),21:u("EnumMember","enumeration member"),23:u("Event","event"),7:u("Field","field"),0:u("File","file"),11:u("Function","function"),10:u("Interface","interface"),19:u("Key","key"),5:u("Method","method"),1:u("Module","module"),2:u("Namespace","namespace"),20:u("Null","null"),15:u("Number","number"),18:u("Object","object"),24:u("Operator","operator"),3:u("Package","package"),6:u("Property","property"),14:u("String","string"),22:u("Struct","struct"),25:u("TypeParameter","type parameter"),12:u("Variable","variable")};Sn=C([h(1,O),h(2,te)],Sn);let fo=class yp{constructor(e,t){this._prefix=e,this._textResourceConfigService=t}filter(e){const t=jc.get(e);if(!(e instanceof gt))return!0;const i=yp.kindToConfigName[e.symbol.kind],o=`${this._prefix}.${i}`;return this._textResourceConfigService.getValue(t==null?void 0:t.uri,o)}};fo.kindToConfigName=Object.freeze({0:"showFiles",1:"showModules",2:"showNamespaces",3:"showPackages",4:"showClasses",5:"showMethods",6:"showProperties",7:"showFields",8:"showConstructors",9:"showEnums",10:"showInterfaces",11:"showFunctions",12:"showVariables",13:"showConstants",14:"showStrings",15:"showNumbers",16:"showBooleans",17:"showArrays",18:"showObjects",19:"showKeys",20:"showNull",21:"showEnumMembers",22:"showStructs",23:"showEvents",24:"showOperators",25:"showTypeParameters"});fo=C([h(1,To)],fo);class SC{constructor(){this._collator=new hu(()=>new Intl.Collator(void 0,{numeric:!0}))}compareByPosition(e,t){return e instanceof ft&&t instanceof ft?e.order-t.order:e instanceof gt&&t instanceof gt?Fe.compareRangesUsingStarts(e.symbol.range,t.symbol.range)||this._collator.value.compare(e.symbol.name,t.symbol.name):0}compareByType(e,t){return e instanceof ft&&t instanceof ft?e.order-t.order:e instanceof gt&&t instanceof gt?e.symbol.kind-t.symbol.kind||this._collator.value.compare(e.symbol.name,t.symbol.name):0}compareByName(e,t){return e instanceof ft&&t instanceof ft?e.order-t.order:e instanceof gt&&t instanceof gt?this._collator.value.compare(e.symbol.name,t.symbol.name)||Fe.compareRangesUsingStarts(e.symbol.range,t.symbol.range):0}}let ka=class{constructor(e,t){this._editor=e,this._textResourceConfigurationService=t,this._breadcrumbs=[]}getBreadcrumbElements(){return this._breadcrumbs}clear(){this._breadcrumbs=[]}update(e,t){const i=this._computeBreadcrumbs(e,t);this._breadcrumbs=i}_computeBreadcrumbs(e,t){let i=e.getItemEnclosingPosition(t);if(!i)return[];const o=[];for(;i;){o.push(i);const n=i.parent;if(n instanceof jc||n instanceof ft&&n.parent&&n.parent.children.size===1)break;i=n}const s=[];for(let n=o.length-1;n>=0;n--){const r=o[n];if(this._isFiltered(r))break;s.push(r)}return s.length===0?[]:s}_isFiltered(e){if(!(e instanceof gt))return!1;const t=`breadcrumbs.${fo.kindToConfigName[e.symbol.kind]}`;let i;return this._editor&&this._editor.getModel()&&(i=this._editor.getModel().uri),!this._textResourceConfigurationService.getValue(i,t)}};ka=C([h(1,To)],ka);let xa=class{get activeElement(){const e=this._editor.getPosition();if(!(!e||!this._outlineModel))return this._outlineModel.getItemEnclosingPosition(e)}constructor(e,t,i,o,s,n,r,a,d,l){var L;this._editor=e,this._languageFeaturesService=o,this._codeEditorService=s,this._outlineModelService=n,this._configurationService=r,this._markerDecorationsService=a,this._disposables=new x,this._onDidChange=new w,this.onDidChange=this._onDidChange.event,this._outlineDisposables=new x,this.outlineKind="documentSymbols",this._breadcrumbsDataSource=new ka(e,d);const p=new yC,g=[new CC,l.createInstance(Sn,!0)],f={getChildren:$=>$ instanceof gt||$ instanceof ft?$.children.values():$===this&&this._outlineModel?this._outlineModel.children.values():[]},b=new SC,m=d.getValue((L=e.getModel())==null?void 0:L.uri,"outline.collapseItems"),y={collapseByDefault:t===2||t===1&&m==="alwaysCollapse",expandOnlyOnTwistieClick:!0,multipleSelectionSupport:!1,identityProvider:new wC,keyboardNavigationLabelProvider:new bC,accessibilityProvider:new vC(u("document","Document Symbols")),filter:t===1?l.createInstance(fo,"outline"):t===2?l.createInstance(fo,"breadcrumbs"):void 0};this.config={breadcrumbsDataSource:this._breadcrumbsDataSource,delegate:p,renderers:g,treeDataSource:f,comparator:b,options:y,quickPickDataSource:{getQuickPickElements:()=>{throw new Error("not implemented")}}},this._disposables.add(o.documentSymbolProvider.onDidChange($=>this._createOutline())),this._disposables.add(this._editor.onDidChangeModel($=>this._createOutline())),this._disposables.add(this._editor.onDidChangeModelLanguage($=>this._createOutline()));const D=new Kr;this._disposables.add(D),this._disposables.add(this._editor.onDidChangeModelContent($=>{const Se=this._editor.getModel();if(Se){const St=n.getDebounceValue(Se);D.cancelAndSet(()=>this._createOutline($),St)}})),this._disposables.add(this._editor.onDidDispose(()=>this._outlineDisposables.clear())),this._createOutline().finally(()=>i.open())}dispose(){this._disposables.dispose(),this._outlineDisposables.dispose()}get isEmpty(){return!this._outlineModel||Ws.empty(this._outlineModel)}get uri(){var e;return(e=this._outlineModel)==null?void 0:e.uri}async reveal(e,t,i){const o=jc.get(e);!o||!(e instanceof gt)||await this._codeEditorService.openCodeEditor({resource:o.uri,options:{...t,selection:Fe.collapseToStart(e.symbol.selectionRange),selectionRevealType:3}},this._editor,i)}preview(e){if(!(e instanceof gt))return V.None;const{symbol:t}=e;this._editor.revealRangeInCenterIfOutsideViewport(t.range,0);const i=this._editor.createDecorationsCollection([{range:t.range,options:{description:"document-symbols-outline-range-highlight",className:"rangeHighlight",isWholeLine:!0}}]);return Y(()=>i.clear())}captureViewState(){const e=this._editor.saveViewState();return Y(()=>{e&&this._editor.restoreViewState(e)})}async _createOutline(e){if(this._outlineDisposables.clear(),e||this._setOutlineModel(void 0),!this._editor.hasModel())return;const t=this._editor.getModel();if(!this._languageFeaturesService.documentSymbolProvider.has(t))return;const i=new qe,o=t.getVersionId(),s=new Kr;this._outlineDisposables.add(s),this._outlineDisposables.add(Y(()=>i.dispose(!0)));try{const n=await this._outlineModelService.getOrCreate(t,i.token);if(i.token.isCancellationRequested)return;if(Ws.empty(n)||!this._editor.hasModel()){this._setOutlineModel(n);return}if(e&&this._outlineModel&&t.getLineCount()>=25){const r=Ws.size(n),a=t.getValueLength(),d=r/a,l=Ws.size(this._outlineModel),p=a-e.changes.reduce((f,b)=>f+b.rangeLength,0),g=l/p;if((d<=g*.5||d>=g*1.5)&&!await vv(Yn(2e3).then(()=>!0),i.token,!1))return}this._applyMarkersToOutline(n),this._outlineDisposables.add(this._markerDecorationsService.onDidChangeMarker(r=>{Re(n.uri,r.uri)&&(this._applyMarkersToOutline(n),this._onDidChange.fire({}))})),this._outlineDisposables.add(this._configurationService.onDidChangeConfiguration(r=>{r.affectsConfiguration("outline.problems.enabled")&&(this._configurationService.getValue("outline.problems.enabled")?this._applyMarkersToOutline(n):n.updateMarker([]),this._onDidChange.fire({})),r.affectsConfiguration("outline")&&this._onDidChange.fire({}),r.affectsConfiguration("breadcrumbs")&&this._editor.hasModel()&&(this._breadcrumbsDataSource.update(n,this._editor.getPosition()),this._onDidChange.fire({}))})),this._outlineDisposables.add(this._configurationService.onDidChangeConfiguration(r=>{r.affectsConfiguration("outline.icons")&&this._onDidChange.fire({}),r.affectsConfiguration("outline")&&this._onDidChange.fire({})})),this._outlineDisposables.add(this._editor.onDidChangeCursorPosition(r=>{s.cancelAndSet(()=>{!t.isDisposed()&&o===t.getVersionId()&&this._editor.hasModel()&&(this._breadcrumbsDataSource.update(n,this._editor.getPosition()),this._onDidChange.fire({affectOnlyActiveElement:!0}))},150)})),this._setOutlineModel(n)}catch(n){this._setOutlineModel(void 0),po(n)}}_applyMarkersToOutline(e){if(!e||!this._configurationService.getValue("outline.problems.enabled"))return;const t=[];for(const[i,o]of this._markerDecorationsService.getLiveMarkers(e.uri))(o.severity===zr.Error||o.severity===zr.Warning)&&t.push({...i,severity:o.severity});e.updateMarker(t)}_setOutlineModel(e){var i;const t=this._editor.getPosition();!t||!e?(this._outlineModel=void 0,this._breadcrumbsDataSource.clear()):((i=this._outlineModel)!=null&&i.merge(e)||(this._outlineModel=e),this._breadcrumbsDataSource.update(e,t)),this._onDidChange.fire({})}};xa=C([h(3,fv),h(4,qi),h(5,mv),h(6,O),h(7,bv),h(8,To),h(9,I)],xa);let Ia=class{constructor(e){const t=e.registerOutlineCreator(this);this.dispose=()=>t.dispose()}matches(e){const t=e.getControl();return so(t)||zo(t)}async createOutline(e,t,i){const o=e.getControl();let s;if(so(o)?s=o:zo(o)&&(s=o.getModifiedEditor()),!s)return;const n=new wv,r=s.invokeWithinContext(a=>a.get(I).createInstance(xa,s,t,n));return await n.wait(),r}};Ia=C([h(0,Rn)],Ia);M.as(tt.Workbench).registerWorkbenchContribution(Ia,4);var _C=".monaco-workbench .outline-pane{display:flex;flex-direction:column}.monaco-workbench .outline-pane .outline-progress{height:2px;padding-bottom:3px;position:absolute;width:100%}.monaco-workbench .outline-pane .outline-progress .monaco-progress-container,.monaco-workbench .outline-pane .outline-progress .monaco-progress-container .progress-bit{height:2px}.monaco-workbench .outline-pane .outline-tree{height:100%}.monaco-workbench .outline-pane .outline-message{display:none;opacity:.5;padding:10px 22px 0;pointer-events:none;position:absolute;z-index:1}.monaco-workbench .outline-pane.message .outline-message{display:inherit}.monaco-workbench .outline-pane.message .outline-progress{display:none}";he(_C,{});class EC{constructor(){this._followCursor=!1,this._filterOnType=!0,this._sortBy=0,this._onDidChange=new w,this.onDidChange=this._onDidChange.event}dispose(){this._onDidChange.dispose()}set followCursor(e){e!==this._followCursor&&(this._followCursor=e,this._onDidChange.fire({followCursor:!0}))}get followCursor(){return this._followCursor}get filterOnType(){return this._filterOnType}set filterOnType(e){e!==this._filterOnType&&(this._filterOnType=e,this._onDidChange.fire({filterOnType:!0}))}set sortBy(e){e!==this._sortBy&&(this._sortBy=e,this._onDidChange.fire({sortBy:!0}))}get sortBy(){return this._sortBy}persist(e){e.store("outline/state",JSON.stringify({followCursor:this.followCursor,sortBy:this.sortBy,filterOnType:this.filterOnType}),1,1)}restore(e){const t=e.get("outline/state",1);if(!t)return;let i;try{i=JSON.parse(t)}catch{return}this.followCursor=i.followCursor,this.sortBy=i.sortBy??0,typeof i.filterOnType=="boolean"&&(this.filterOnType=i.filterOnType)}}var Aa;(function(c){c.Id="outline"})(Aa||(Aa={}));const DC=new U("outlineFollowsCursor",!1),kC=new U("outlineFiltersOnType",!1),xC=new U("outlineSortMode",0),IC=new U("outlineAllCollapsed",!1);class AC{constructor(e,t){this._comparator=e,this.order=t}compare(e,t){return this.order===2?this._comparator.compareByType(e,t):this.order===1?this._comparator.compareByName(e,t):this._comparator.compareByPosition(e,t)}}let _n=class extends Wn{constructor(e,t,i,o,s,n,r,a,d,l,p,g,f){super(e,a,l,r,d,o,i,p,g,f),this._outlineService=t,this._instantiationService=i,this._storageService=s,this._editorService=n,this._disposables=new x,this._editorControlDisposables=new x,this._editorPaneDisposables=new x,this._outlineViewState=new EC,this._editorListener=new Ie,this._treeStates=new yv(10),this._outlineViewState.restore(this._storageService),this._disposables.add(this._outlineViewState),d.bufferChangeEvents(()=>{this._ctxFollowsCursor=DC.bindTo(d),this._ctxFilterOnType=kC.bindTo(d),this._ctxSortMode=xC.bindTo(d),this._ctxAllCollapsed=IC.bindTo(d)});const b=()=>{this._ctxFollowsCursor.set(this._outlineViewState.followCursor),this._ctxFilterOnType.set(this._outlineViewState.filterOnType),this._ctxSortMode.set(this._outlineViewState.sortBy)};b(),this._disposables.add(this._outlineViewState.onDidChange(b))}dispose(){this._disposables.dispose(),this._editorPaneDisposables.dispose(),this._editorControlDisposables.dispose(),this._editorListener.dispose(),super.dispose()}focus(){var e;(e=this._tree)==null||e.domFocus()}renderBody(e){super.renderBody(e),this._domNode=e,e.classList.add("outline-pane");const t=z(".outline-progress");this._message=z(".outline-message"),this._progressBar=new Rc(t,Lc),this._treeContainer=z(".outline-tree"),de(e,t,this._message,this._treeContainer),this._disposables.add(this.onDidChangeBodyVisibility(i=>{if(!i)this._editorListener.clear(),this._editorPaneDisposables.clear(),this._editorControlDisposables.clear();else if(!this._editorListener.value){const o=A.any(this._editorService.onDidActiveEditorChange,this._outlineService.onDidChange);this._editorListener.value=o(()=>this._handleEditorChanged(this._editorService.activeEditorPane)),this._handleEditorChanged(this._editorService.activeEditorPane)}}))}layoutBody(e,t){var i;super.layoutBody(e,t),(i=this._tree)==null||i.layout(e,t),this._treeDimensions=new q(t,e)}collapseAll(){var e;(e=this._tree)==null||e.collapseAll()}expandAll(){var e;(e=this._tree)==null||e.expandAll()}get outlineViewState(){return this._outlineViewState}_showMessage(e){this._domNode.classList.add("message"),this._progressBar.stop().hide(),this._message.innerText=e}_captureViewState(e){if(this._tree){const t=this._tree.getInput();if(e||(e=t==null?void 0:t.uri),t&&e)return this._treeStates.set(`${t.outlineKind}/${e}`,this._tree.getViewState()),!0}return!1}_handleEditorChanged(e){this._editorPaneDisposables.clear(),e&&this._editorPaneDisposables.add(e.onDidChangeControl(()=>{this._handleEditorControlChanged(e)})),this._handleEditorControlChanged(e)}async _handleEditorControlChanged(e){var f,b;const t=ne.getOriginalUri(e==null?void 0:e.input),i=this._captureViewState();if(this._editorControlDisposables.clear(),!e||!this._outlineService.canCreateOutline(e)||!t)return this._showMessage(u("no-editor","The active editor cannot provide outline information."));let o;i||(o=new Kr(()=>{this._showMessage(u("loading","Loading document symbols for '{0}'...",Me(t)))},100)),this._progressBar.infinite().show(500);const s=new qe;this._editorControlDisposables.add(Y(()=>s.dispose(!0)));const n=await this._outlineService.createOutline(e,1,s.token);if(o==null||o.dispose(),!n)return;if(s.token.isCancellationRequested){n==null||n.dispose();return}this._editorControlDisposables.add(n),this._progressBar.stop().hide();const r=new AC(n.config.comparator,this._outlineViewState.sortBy),a=this._instantiationService.createInstance(Bc,"OutlinePane",this._treeContainer,n.config.delegate,n.config.renderers,n.config.treeDataSource,{...n.config.options,sorter:r,expandOnDoubleClick:!1,expandOnlyOnTwistieClick:!0,multipleSelectionSupport:!1,hideTwistiesOfChildlessElements:!0,defaultFindMode:this._outlineViewState.filterOnType?ut.Filter:ut.Highlight,overrideStyles:{listBackground:this.getBackgroundColor()}}),d=()=>{if(n.isEmpty)this._showMessage(u("no-symbols","No symbols found in document '{0}'",Me(t))),this._captureViewState(t),a.setInput(void 0);else if(a.getInput())this._domNode.classList.remove("message"),a.updateChildren();else{this._domNode.classList.remove("message");const m=this._treeStates.get(`${n.outlineKind}/${n.uri}`);a.setInput(n,m&&Cv.lift(m))}};d(),this._editorControlDisposables.add(n.onDidChange(d)),a.findMode=this._outlineViewState.filterOnType?ut.Filter:ut.Highlight,this._editorControlDisposables.add(this.viewDescriptorService.onDidChangeLocation(({views:m})=>{m.some(y=>y.id===this.id)&&a.updateOptions({overrideStyles:{listBackground:this.getBackgroundColor()}})})),this._editorControlDisposables.add(a.onDidChangeFindMode(m=>this._outlineViewState.filterOnType=m===ut.Filter)),this._editorControlDisposables.add(a.onDidOpen(m=>n.reveal(m.element,m.editorOptions,m.sideBySide)));const l=()=>{if(!this._outlineViewState.followCursor||!n.activeElement)return;let m=n.activeElement;for(;m;){if(a.getRelativeTop(m)===null&&a.reveal(m,.5),a.getRelativeTop(m)!==null){a.setFocus([m]),a.setSelection([m]);break}m=a.getParentElement(m)}};l(),this._editorControlDisposables.add(n.onDidChange(l)),this._editorControlDisposables.add(this._outlineViewState.onDidChange(m=>{this._outlineViewState.persist(this._storageService),m.filterOnType&&(a.findMode=this._outlineViewState.filterOnType?ut.Filter:ut.Highlight),m.followCursor&&l(),m.sortBy&&(r.order=this._outlineViewState.sortBy,a.resort())}));let p;this._editorControlDisposables.add(a.onDidChangeFindPattern(m=>{a.findMode!==ut.Highlight&&(!p&&m?(p=a.getViewState(),a.expandAll()):!m&&p&&(a.setInput(a.getInput(),p),p=void 0))}));const g=()=>{this._ctxAllCollapsed.set(a.getNode(null).children.every(m=>!m.collapsible||m.collapsed))};this._editorControlDisposables.add(a.onDidChangeCollapseState(g)),this._editorControlDisposables.add(a.onDidChangeModel(g)),g(),a.layout((f=this._treeDimensions)==null?void 0:f.height,(b=this._treeDimensions)==null?void 0:b.width),this._tree=a,this._editorControlDisposables.add(Y(()=>{a.dispose(),this._tree=void 0}))}};_n.Id="outline";_n=C([h(1,Rn),h(2,I),h(3,Qe),h(4,oe),h(5,P),h(6,O),h(7,ve),h(8,G),h(9,ke),h(10,zi),h(11,te),h(12,Ne)],_n);const TC=Ao("outline-view-icon",le.symbolClass,u("outlineViewIcon","View icon of the outline view."));M.as(Xe.ViewsRegistry).registerViews([{id:Aa.Id,name:u("name","Outline"),containerIcon:TC,ctorDescriptor:new W(_n),canToggleVisibility:!0,canMoveView:!0,hideByDefault:!1,collapsed:!0,order:2,weight:30,focusCommand:{id:"outline.focus"}}],$f);M.as(Yc.Configuration).registerConfiguration({id:"outline",order:117,title:u("outlineConfigurationTitle","Outline"),type:"object",properties:{"outline.icons":{description:u("outline.showIcons","Render Outline elements with icons."),type:"boolean",default:!0},"outline.collapseItems":{description:u("outline.initialState","Controls whether Outline items are collapsed or expanded."),type:"string",scope:5,enum:["alwaysCollapse","alwaysExpand"],enumDescriptions:[u("outline.initialState.collapsed","Collapse all items."),u("outline.initialState.expanded","Expand all items.")],default:"alwaysExpand"},"outline.problems.enabled":{description:u("outline.showProblem","Show errors and warnings on Outline elements."),type:"boolean",default:!0},"outline.problems.colors":{description:u("outline.problem.colors","Use colors for errors and warnings on Outline elements."),type:"boolean",default:!0},"outline.problems.badges":{description:u("outline.problems.badges","Use badges for errors and warnings on Outline elements."),type:"boolean",default:!0},"outline.showFiles":{type:"boolean",scope:5,default:!0,markdownDescription:u("filteredTypes.file","When enabled, Outline shows `file`-symbols.")},"outline.showModules":{type:"boolean",scope:5,default:!0,markdownDescription:u("filteredTypes.module","When enabled, Outline shows `module`-symbols.")},"outline.showNamespaces":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.namespace","When enabled, Outline shows `namespace`-symbols.")},"outline.showPackages":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.package","When enabled, Outline shows `package`-symbols.")},"outline.showClasses":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.class","When enabled, Outline shows `class`-symbols.")},"outline.showMethods":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.method","When enabled, Outline shows `method`-symbols.")},"outline.showProperties":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.property","When enabled, Outline shows `property`-symbols.")},"outline.showFields":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.field","When enabled, Outline shows `field`-symbols.")},"outline.showConstructors":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.constructor","When enabled, Outline shows `constructor`-symbols.")},"outline.showEnums":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.enum","When enabled, Outline shows `enum`-symbols.")},"outline.showInterfaces":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.interface","When enabled, Outline shows `interface`-symbols.")},"outline.showFunctions":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.function","When enabled, Outline shows `function`-symbols.")},"outline.showVariables":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.variable","When enabled, Outline shows `variable`-symbols.")},"outline.showConstants":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.constant","When enabled, Outline shows `constant`-symbols.")},"outline.showStrings":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.string","When enabled, Outline shows `string`-symbols.")},"outline.showNumbers":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.number","When enabled, Outline shows `number`-symbols.")},"outline.showBooleans":{type:"boolean",scope:5,default:!0,markdownDescription:u("filteredTypes.boolean","When enabled, Outline shows `boolean`-symbols.")},"outline.showArrays":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.array","When enabled, Outline shows `array`-symbols.")},"outline.showObjects":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.object","When enabled, Outline shows `object`-symbols.")},"outline.showKeys":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.key","When enabled, Outline shows `key`-symbols.")},"outline.showNull":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.null","When enabled, Outline shows `null`-symbols.")},"outline.showEnumMembers":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.enumMember","When enabled, Outline shows `enumMember`-symbols.")},"outline.showStructs":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.struct","When enabled, Outline shows `struct`-symbols.")},"outline.showEvents":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.event","When enabled, Outline shows `event`-symbols.")},"outline.showOperators":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.operator","When enabled, Outline shows `operator`-symbols.")},"outline.showTypeParameters":{type:"boolean",default:!0,scope:5,markdownDescription:u("filteredTypes.typeParameter","When enabled, Outline shows `typeParameter`-symbols.")}}});function gd(c){c&&c.getHTMLElement()!==document.activeElement&&c.domFocus()}async function VC(c,e){if(!uu.getValue(c.contextKeyService))return e(c);const t=c.getFocus(),i=c.getSelection();await e(c);const o=c.getFocus();if(i.length>1||!wi(t,i)||wi(t,o))return;const s=new KeyboardEvent("keydown");c.setSelection(o,s)}async function Rt(c,e){if(!c)return;await VC(c,e);const t=c.getFocus();t.length&&c.reveal(t[0]),c.setAnchor(t[0]),gd(c)}k.registerCommandAndKeybindingRule({id:"list.focusDown",weight:200,when:se,primary:18,mac:{primary:18,secondary:[300]},handler:(c,e)=>{Rt(c.get(N).lastFocusedList,async t=>{const i=new KeyboardEvent("keydown");await t.focusNext(typeof e=="number"?e:1,!1,i)})}});k.registerCommandAndKeybindingRule({id:"list.focusUp",weight:200,when:se,primary:16,mac:{primary:16,secondary:[302]},handler:(c,e)=>{Rt(c.get(N).lastFocusedList,async t=>{const i=new KeyboardEvent("keydown");await t.focusPrevious(typeof e=="number"?e:1,!1,i)})}});k.registerCommandAndKeybindingRule({id:"list.focusPageDown",weight:200,when:se,primary:12,handler:c=>{Rt(c.get(N).lastFocusedList,async e=>{const t=new KeyboardEvent("keydown");await e.focusNextPage(t)})}});k.registerCommandAndKeybindingRule({id:"list.focusPageUp",weight:200,when:se,primary:11,handler:c=>{Rt(c.get(N).lastFocusedList,async e=>{const t=new KeyboardEvent("keydown");await e.focusPreviousPage(t)})}});k.registerCommandAndKeybindingRule({id:"list.focusFirst",weight:200,when:se,primary:14,handler:c=>{Rt(c.get(N).lastFocusedList,async e=>{const t=new KeyboardEvent("keydown");await e.focusFirst(t)})}});k.registerCommandAndKeybindingRule({id:"list.focusLast",weight:200,when:se,primary:13,handler:c=>{Rt(c.get(N).lastFocusedList,async e=>{const t=new KeyboardEvent("keydown");await e.focusLast(t)})}});function Cp(c,e){if(c instanceof As||c instanceof Ts||c instanceof Vs){const t=c,i=t.getFocus()?t.getFocus()[0]:void 0,o=t.getSelection();o&&typeof i=="number"&&o.indexOf(i)>=0?t.setSelection(o.filter(s=>s!==e)):typeof i=="number"&&t.setSelection(o.concat(i))}else if(c instanceof _i||c instanceof Ei||c instanceof at){const t=c,i=t.getFocus()?t.getFocus()[0]:void 0;if(e===i)return;const o=t.getSelection(),s=new KeyboardEvent("keydown",{shiftKey:!0});o&&o.indexOf(i)>=0?t.setSelection(o.filter(n=>n!==e),s):t.setSelection(o.concat(i),s)}}k.registerCommandAndKeybindingRule({id:"list.expandSelectionDown",weight:200,when:v.and(se,Jc),primary:1042,handler:(c,e)=>{const t=c.get(N).lastFocusedList;if(!t)return;const i=t.getFocus()?t.getFocus()[0]:void 0,o=new KeyboardEvent("keydown");t.focusNext(typeof e=="number"?e:1,!1,o),Cp(t,i);const s=t.getFocus();s.length&&t.reveal(s[0]),gd(t)}});k.registerCommandAndKeybindingRule({id:"list.expandSelectionUp",weight:200,when:v.and(se,Jc),primary:1040,handler:(c,e)=>{const t=c.get(N).lastFocusedList;if(!t)return;const i=t.getFocus()?t.getFocus()[0]:void 0,o=new KeyboardEvent("keydown");t.focusPrevious(typeof e=="number"?e:1,!1,o),Cp(t,i);const s=t.getFocus();s.length&&t.reveal(s[0]),gd(t)}});k.registerCommandAndKeybindingRule({id:"list.collapse",weight:200,when:v.and(se,v.or(Sv,_v)),primary:15,mac:{primary:15,secondary:[2064]},handler:c=>{const e=c.get(N).lastFocusedList;if(!e||!(e instanceof _i||e instanceof Ei||e instanceof at))return;const t=e,i=t.getFocus();if(i.length===0)return;const o=i[0];if(!t.collapse(o)){const s=t.getParentElement(o);s&&Rt(e,n=>{const r=new KeyboardEvent("keydown");n.setFocus([s],r)})}}});k.registerCommandAndKeybindingRule({id:"list.collapseAll",weight:200,when:se,primary:2063,mac:{primary:2063,secondary:[3088]},handler:c=>{const e=c.get(N).lastFocusedList;e&&!(e instanceof As||e instanceof Ts||e instanceof Vs)&&e.collapseAll()}});k.registerCommandAndKeybindingRule({id:"list.collapseAllToFocus",weight:200,when:se,handler:c=>{const e=c.get(N).lastFocusedList,t=lu("keydown",!0);if(e instanceof _i||e instanceof Ei||e instanceof at){const i=e,o=i.getFocus();o.length>0&&i.collapse(o[0],!0),i.setSelection(o,t),i.setAnchor(o[0])}}});k.registerCommandAndKeybindingRule({id:"list.focusParent",weight:200,when:se,handler:c=>{const e=c.get(N).lastFocusedList;if(!e||!(e instanceof _i||e instanceof Ei||e instanceof at))return;const t=e,i=t.getFocus();if(i.length===0)return;const o=i[0],s=t.getParentElement(o);s&&Rt(e,n=>{const r=new KeyboardEvent("keydown");n.setFocus([s],r)})}});k.registerCommandAndKeybindingRule({id:"list.expand",weight:200,when:v.and(se,v.or(Ev,Dv)),primary:17,handler:c=>{const e=c.get(N).lastFocusedList;if(e){if(e instanceof _i||e instanceof Ei){const t=e.getFocus();if(t.length===0)return;const i=t[0];if(!e.expand(i)){const o=e.getFirstElementChild(i);o&&e.getNode(o).visible&&Rt(e,n=>{const r=new KeyboardEvent("keydown");n.setFocus([o],r)})}}else if(e instanceof at){const t=e.getFocus();if(t.length===0)return;const i=t[0];e.expand(i).then(o=>{if(i&&!o){const s=e.getFirstElementChild(i);s&&e.getNode(s).visible&&Rt(e,r=>{const a=new KeyboardEvent("keydown");r.setFocus([s],a)})}})}}}});function fd(c,e){const t=c.get(N).lastFocusedList,i=lu("keydown",e);if(t instanceof As||t instanceof Ts||t instanceof Vs){const o=t;o.setSelection(o.getFocus(),i),o.setAnchor(o.getFocus()[0])}else if(t instanceof _i||t instanceof Ei||t instanceof at){const o=t,s=o.getFocus();if(s.length>0){let n=!0;(o.expandOnlyOnTwistieClick===!0||typeof o.expandOnlyOnTwistieClick!="boolean"&&o.expandOnlyOnTwistieClick(s[0]))&&(n=!1),n&&o.toggleCollapsed(s[0])}o.setSelection(s,i),o.setAnchor(s[0])}}k.registerCommandAndKeybindingRule({id:"list.select",weight:200,when:se,primary:3,mac:{primary:3,secondary:[2066]},handler:c=>{fd(c,!1)}});k.registerCommandAndKeybindingRule({id:"list.selectAndPreserveFocus",weight:200,when:se,handler:c=>{fd(c,!0)}});k.registerCommandAndKeybindingRule({id:"list.selectAll",weight:200,when:v.and(se,Jc),primary:2079,handler:c=>{const e=c.get(N).lastFocusedList;if(e instanceof As||e instanceof Ts||e instanceof Vs){const t=e,i=new KeyboardEvent("keydown");t.setSelection(kv(t.length),i)}else if(e instanceof _i||e instanceof Ei||e instanceof at){const t=e,i=t.getFocus(),o=t.getSelection();let s;i.length>0&&(o.length===0||!o.includes(i[0]))&&(s=i[0]),!s&&o.length>0&&(s=o[0]);let n;s?n=t.getParentElement(s):n=void 0;const r=[],a=l=>{for(const p of l.children)p.visible&&(r.push(p.element),p.collapsed||a(p))};a(t.getNode(n)),n&&o.length===r.length&&r.unshift(n);const d=new KeyboardEvent("keydown");t.setSelection(r,d)}}});k.registerCommandAndKeybindingRule({id:"list.toggleSelection",weight:200,when:se,primary:3075,handler:c=>{const e=c.get(N).lastFocusedList;if(!e)return;const t=e.getFocus();if(t.length===0)return;const i=e.getSelection(),o=i.indexOf(t[0]);o>-1?e.setSelection([...i.slice(0,o),...i.slice(o+1)]):e.setSelection([...i,t[0]])}});k.registerCommandAndKeybindingRule({id:"list.toggleExpand",weight:200,when:se,primary:10,handler:c=>{const e=c.get(N).lastFocusedList;if(e instanceof _i||e instanceof Ei||e instanceof at){const t=e,i=t.getFocus();if(i.length>0&&t.isCollapsible(i[0])){t.toggleCollapsed(i[0]);return}}fd(c,!0)}});k.registerCommandAndKeybindingRule({id:"list.clear",weight:200,when:v.and(se,xv),primary:9,handler:c=>{const e=c.get(N).lastFocusedList;if(!e)return;const t=e.getSelection(),i=new KeyboardEvent("keydown");if(t.length>1)if(uu.getValue(e.contextKeyService)){const s=e.getFocus();e.setSelection([s[0]],i)}else e.setSelection([],i);else e.setSelection([],i),e.setFocus([],i);e.setAnchor(void 0)}});Le.registerCommand({id:"list.triggerTypeNavigation",handler:c=>{const e=c.get(N).lastFocusedList;e==null||e.triggerTypeNavigation()}});Le.registerCommand({id:"list.toggleFindMode",handler:c=>{const e=c.get(N).lastFocusedList;if(e instanceof Xc||e instanceof at){const t=e;t.findMode=t.findMode===ut.Filter?ut.Highlight:ut.Filter}}});Le.registerCommandAlias("list.toggleKeyboardNavigation","list.triggerTypeNavigation");Le.registerCommandAlias("list.toggleFilterOnType","list.toggleFindMode");k.registerCommandAndKeybindingRule({id:"list.find",weight:200,when:v.and(pu,Iv),primary:2084,secondary:[61],handler:c=>{const e=c.get(N).lastFocusedList;e instanceof As||e instanceof Ts||e instanceof Vs||(e instanceof Xc||e instanceof at)&&e.openFind()}});k.registerCommandAndKeybindingRule({id:"list.closeFind",weight:200,when:v.and(pu,Av),primary:9,handler:c=>{const e=c.get(N).lastFocusedList;(e instanceof Xc||e instanceof at)&&e.closeFind()}});k.registerCommandAndKeybindingRule({id:"list.scrollUp",weight:200,when:se,primary:2064,handler:c=>{const e=c.get(N).lastFocusedList;e&&(e.scrollTop-=10)}});k.registerCommandAndKeybindingRule({id:"list.scrollDown",weight:200,when:se,primary:2066,handler:c=>{const e=c.get(N).lastFocusedList;e&&(e.scrollTop+=10)}});k.registerCommandAndKeybindingRule({id:"list.scrollLeft",weight:200,when:se,handler:c=>{const e=c.get(N).lastFocusedList;e&&(e.scrollLeft-=10)}});k.registerCommandAndKeybindingRule({id:"list.scrollRight",weight:200,when:se,handler:c=>{const e=c.get(N).lastFocusedList;e&&(e.scrollLeft+=10)}});var OC='.file-icon-themable-tree .align-icon-with-twisty .monaco-tl-twistie:not(.force-twistie):not(.collapsible),.file-icon-themable-tree .monaco-tl-twistie.force-no-twistie,.file-icon-themable-tree.align-icons-and-twisties .monaco-tl-twistie:not(.force-twistie):not(.collapsible),.file-icon-themable-tree.hide-arrows .monaco-tl-twistie:not(.force-twistie){background-image:none!important;padding-right:0!important;visibility:hidden;width:0!important}.file-icon-themable-tree .monaco-list-row .content .monaco-highlighted-label .highlight,.monaco-tl-contents .monaco-highlighted-label .highlight{background-color:var(--vscode-list-filterMatchBackground);color:unset!important;outline:1px dotted var(--vscode-list-filterMatchBorder);outline-offset:-1px}.monaco-workbench .tree-explorer-viewlet-tree-view{height:100%}.monaco-workbench .tree-explorer-viewlet-tree-view .message{display:flex;padding:4px 12px 4px 18px;user-select:text;-webkit-user-select:text}.monaco-workbench .tree-explorer-viewlet-tree-view .message p{margin-bottom:0;margin-top:0;padding-bottom:4px}.monaco-workbench .tree-explorer-viewlet-tree-view .message ul{padding-left:24px}.monaco-workbench .tree-explorer-viewlet-tree-view .message.hide{display:none}.monaco-workbench .tree-explorer-viewlet-tree-view .customview-tree{height:100%}.monaco-workbench .tree-explorer-viewlet-tree-view .customview-tree.hide{display:none}.monaco-workbench .pane>.pane-body>.welcome-view{box-sizing:border-box;display:flex;flex-direction:column;height:100%;width:100%}.monaco-workbench .pane>.pane-body.welcome>:not(.welcome-view),.monaco-workbench .pane>.pane-body:not(.welcome)>.welcome-view{display:none}.monaco-workbench .pane>.pane-body .welcome-view-content{align-items:center;box-sizing:border-box;display:flex;flex-direction:column;padding:0 20px 1em}.monaco-workbench .pane>.pane-body .welcome-view-content>.button-container{max-width:300px;width:100%}.monaco-workbench:not(.reduce-motion) .pane>.pane-body .welcome-view-content>.button-container{transition:max-width .2s ease-out}.monaco-workbench .pane>.pane-body .welcome-view-content.wide>.button-container{max-width:100%}.monaco-workbench .pane>.pane-body .welcome-view-content>.button-container>.monaco-button{max-width:300px}.monaco-workbench .pane>.pane-body .welcome-view-content>p{width:100%}.monaco-workbench .pane>.pane-body .welcome-view-content>*{margin-block-end:0;margin-block-start:1em;margin-inline-end:0;margin-inline-start:0}.customview-tree .monaco-list-row .monaco-tl-contents.align-icon-with-twisty:before{display:none}.customview-tree .monaco-list-row .monaco-tl-contents:not(.align-icon-with-twisty):before{display:inline-block}.customview-tree .monaco-list .monaco-list-row{padding-left:0;padding-right:12px}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item{display:flex;flex:1;flex-wrap:nowrap;height:22px;line-height:22px;overflow:hidden;padding-left:3px;text-overflow:ellipsis}.customview-tree .monaco-list .monaco-list-row.selected .custom-view-tree-node-item .custom-view-tree-node-item-checkbox{background-color:var(--vscode-checkbox-selectBackground);border:1px solid var(--vscode-checkbox-selectBorder)}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .custom-view-tree-node-item-checkbox{background-color:var(--vscode-checkbox-background);border:1px solid var(--vscode-checkbox-border);height:16px;margin:3px 6px 3px 0;opacity:1;padding:0;width:16px}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .custom-view-tree-node-item-checkbox.codicon{font-size:13px;line-height:15px}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .monaco-inputbox{flex:1;line-height:normal}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .custom-view-tree-node-item-resourceLabel{flex:1;overflow:hidden;text-overflow:ellipsis}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .monaco-icon-label-container:after{content:"";display:block}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item>.custom-view-tree-node-item-resourceLabel>.custom-view-tree-node-item-icon,.timeline-tree-view .monaco-list .monaco-list-row .custom-view-tree-node-item>.custom-view-tree-node-item-icon{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;align-items:center;background-position:0;background-repeat:no-repeat;background-size:16px;display:flex;height:22px;justify-content:center;padding-right:6px;width:16px}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item>.custom-view-tree-node-item-resourceLabel>.custom-view-tree-node-item-icon.disabled{opacity:.6}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item>.custom-view-tree-node-item-resourceLabel>.custom-view-tree-node-item-icon.codicon.codicon-modifier-spin{margin-left:-6px;padding-left:6px}.customview-tree .monaco-list .monaco-list-row.selected .custom-view-tree-node-item>.custom-view-tree-node-item-resourceLabel>.custom-view-tree-node-item-icon.codicon{color:currentColor!important}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .custom-view-tree-node-item-resourceLabel .monaco-icon-label-container>.monaco-icon-name-container{flex:1}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .custom-view-tree-node-item-resourceLabel:after{margin-right:4px;padding-right:0}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .actions{display:none}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .actions .action-label{padding:2px}.customview-tree .monaco-list .monaco-list-row.focused .custom-view-tree-node-item .actions,.customview-tree .monaco-list .monaco-list-row.selected .custom-view-tree-node-item .actions,.customview-tree .monaco-list .monaco-list-row:hover .custom-view-tree-node-item .actions{display:block}.viewpane-filter-container{cursor:default;display:flex}.viewpane-filter-container.grow{flex:1}.viewpane-filter-container>.viewpane-filter{align-items:center;display:flex;flex:1;position:relative}.viewpane-filter-container>.viewpane-filter .monaco-inputbox{flex:1;font-size:12px;height:24px}.pane-header .viewpane-filter-container>.viewpane-filter .monaco-inputbox .monaco-inputbox{height:20px;line-height:18px}.monaco-workbench.vs .viewpane-filter-container>.viewpane-filter .monaco-inputbox{height:25px}.viewpane-filter-container>.viewpane-filter>.viewpane-filter-controls{align-items:center;bottom:0;display:flex;position:absolute;right:0;top:0}.viewpane-filter-container>.viewpane-filter>.viewpane-filter-controls>.viewpane-filter-badge{border-radius:2px;margin:4px 0;padding:0 8px}.viewpane-filter.small>.viewpane-filter-controls>.viewpane-filter-badge,.viewpane-filter>.viewpane-filter-controls>.viewpane-filter-badge.hidden{display:none}.viewpane-filter>.viewpane-filter-controls>.monaco-action-bar .action-item .action-label.codicon.filter{padding:2px}.panel>.title .monaco-action-bar .action-item.viewpane-filter-container{margin-right:10px;max-width:400px;min-width:150px}.pane-body .viewpane-filter-container:not(:empty){flex:1;height:auto;margin:10px 20px}.pane-body .viewpane-filter-container>.viewpane-filter>.viewpane-filter-controls .monaco-action-bar .action-item{margin-right:4px}.viewpane-filter>.viewpane-filter-controls .monaco-action-bar .action-label.codicon.codicon-filter.checked{background-color:var(--vscode-inputOption-activeBackground);border-color:var(--vscode-inputOption-activeBorder);color:var(--vscode-inputOption-activeForeground)}';he(OC,{});class RC extends Z{constructor(e,t){super("vs.tree.collapse",u("collapse all","Collapse All"),"collapse-all",t),this.viewer=e}async run(){this.viewer.collapseAll(),this.viewer.setSelection([]),this.viewer.setFocus([])}}class LC extends V{constructor(){super(...arguments),this._onDidChangeCheckboxState=this._register(new w),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event}setCheckboxState(e){this._onDidChangeCheckboxState.fire([e])}}class Ps extends V{constructor(e,t,i){super(),this.checkboxStateHandler=t,this.hoverDelegate=i,this.isDisposed=!1,this._onDidChangeState=new w,this.onDidChangeState=this._onDidChangeState.event,this.checkboxContainer=e}render(e){e.checkbox&&(this.toggle?(this.toggle.checked=e.checkbox.isChecked,this.toggle.setIcon(this.toggle.checked?le.check:void 0)):this.createCheckbox(e))}createCheckbox(e){e.checkbox&&(this.toggle=new Tv({isChecked:e.checkbox.isChecked,title:"",icon:e.checkbox.isChecked?le.check:void 0,...gu}),this.setHover(e.checkbox),this.setAccessibilityInformation(e.checkbox),this.toggle.domNode.classList.add(Ps.checkboxClass),de(this.checkboxContainer,this.toggle.domNode),this.registerListener(e))}registerListener(e){this.toggle&&(this._register({dispose:()=>this.removeCheckbox()}),this._register(this.toggle),this._register(this.toggle.onChange(()=>{this.setCheckbox(e)})))}setHover(e){this.toggle&&(this.hover?this.hover.update(e.tooltip):(this.hover=fu(this.hoverDelegate,this.toggle.domNode,this.checkboxHoverContent(e)),this._register(this.hover)))}setCheckbox(e){this.toggle&&e.checkbox&&(e.checkbox.isChecked=this.toggle.checked,this.toggle.setIcon(this.toggle.checked?le.check:void 0),this.setHover(e.checkbox),this.setAccessibilityInformation(e.checkbox),this.checkboxStateHandler.setCheckboxState(e))}checkboxHoverContent(e){return e.tooltip?e.tooltip:e.isChecked?u("checked","Checked"):u("unchecked","Unchecked")}setAccessibilityInformation(e){this.toggle&&e.accessibilityInformation&&(this.toggle.domNode.ariaLabel=e.accessibilityInformation.label,e.accessibilityInformation.role&&(this.toggle.domNode.role=e.accessibilityInformation.role))}removeCheckbox(){const e=this.checkboxContainer.children;for(const t of e)this.checkboxContainer.removeChild(t)}}Ps.checkboxClass="custom-view-tree-node-item-checkbox";let Ta=class extends Wn{constructor(e,t,i,o,s,n,r,a,d,l,p){super({...e,titleMenuId:S.ViewTitle,donotForwardArgs:!1},t,i,o,s,n,r,a,d,l);const{treeView:g}=M.as(Xe.ViewsRegistry).getView(e.id);this.treeView=g,this._register(this.treeView.onDidChangeActions(()=>this.updateActions(),this)),this._register(this.treeView.onDidChangeTitle(f=>this.updateTitle(f))),this._register(this.treeView.onDidChangeDescription(f=>this.updateTitleDescription(f))),this._register(Y(()=>{this._container&&this.treeView.container&&this._container===this.treeView.container&&this.treeView.setVisibility(!1)})),this._register(this.onDidChangeBodyVisibility(()=>this.updateTreeVisibility())),this._register(this.treeView.onDidChangeWelcomeState(()=>this._onDidChangeViewWelcomeState.fire())),e.title!==this.treeView.title&&this.updateTitle(this.treeView.title),e.titleDescription!==this.treeView.description&&this.updateTitleDescription(this.treeView.description),this._actionRunner=new Dp(p,()=>this.treeView.getSelection()),this.updateTreeVisibility()}focus(){super.focus(),this.treeView.focus()}renderBody(e){this._container=e,super.renderBody(e),this.renderTreeView(e)}shouldShowWelcome(){return(this.treeView.dataProvider===void 0||!!this.treeView.dataProvider.isTreeEmpty)&&this.treeView.message===void 0}layoutBody(e,t){super.layoutBody(e,t),this.layoutTreeView(e,t)}getOptimalWidth(){return this.treeView.getOptimalWidth()}renderTreeView(e){this.treeView.show(e)}layoutTreeView(e,t){this.treeView.layout(e,t)}updateTreeVisibility(){this.treeView.setVisibility(this.isBodyVisible())}getActionRunner(){return this._actionRunner}getActionsContext(){return{$treeViewId:this.id,$focusedTreeItem:!0,$selectedTreeItems:!0}}};Ta=C([h(1,ve),h(2,ke),h(3,O),h(4,G),h(5,Qe),h(6,I),h(7,zi),h(8,te),h(9,Ne),h(10,Ae)],Ta);class Sr{constructor(){this.label={label:"root"},this.handle="0",this.parentHandle=void 0,this.collapsibleState=Dt.Expanded,this.children=void 0}}function Sp(c,e){const t=Le.getCommand(c.originalId?c.originalId:c.id);if(t){const i=R.getCommand(t.id),o=i&&i.precondition;if(o)return e.contextMatchesRules(o)}return!0}const MC=u("no-dataprovider","There is no data provider registered that can provide view data."),_p=new U("customTreeView",!1);class PC extends xs{}let Va=class extends V{constructor(e,t,i,o,s,n,r,a,d,l,p,g,f,b,m){super(),this.id=e,this._title=t,this.themeService=i,this.instantiationService=o,this.commandService=s,this.configurationService=n,this.progressService=r,this.contextMenuService=a,this.keybindingService=d,this.notificationService=l,this.viewDescriptorService=p,this.hoverService=g,this.contextKeyService=f,this.activityService=b,this.logService=m,this.isVisible=!1,this._hasIconForParentNode=!1,this._hasIconForLeafNode=!1,this.focused=!1,this._canSelectMany=!1,this._manuallyManageCheckboxes=!1,this.elementsToRefresh=[],this._onDidExpandItem=this._register(new w),this.onDidExpandItem=this._onDidExpandItem.event,this._onDidCollapseItem=this._register(new w),this.onDidCollapseItem=this._onDidCollapseItem.event,this._onDidChangeSelection=this._register(new w),this.onDidChangeSelection=this._onDidChangeSelection.event,this._onDidChangeFocus=this._register(new w),this.onDidChangeFocus=this._onDidChangeFocus.event,this._onDidChangeVisibility=this._register(new w),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._onDidChangeActions=this._register(new w),this.onDidChangeActions=this._onDidChangeActions.event,this._onDidChangeWelcomeState=this._register(new w),this.onDidChangeWelcomeState=this._onDidChangeWelcomeState.event,this._onDidChangeTitle=this._register(new w),this.onDidChangeTitle=this._onDidChangeTitle.event,this._onDidChangeDescription=this._register(new w),this.onDidChangeDescription=this._onDidChangeDescription.event,this._onDidChangeCheckboxState=this._register(new w),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event,this._onDidCompleteRefresh=this._register(new w),this._isInitialized=!1,this._height=0,this._width=0,this.refreshing=!1,this.root=new Sr}initialize(){this._isInitialized||(this._isInitialized=!0,this.contextKeyService.bufferChangeEvents(()=>{this.initializeShowCollapseAllAction(),this.initializeCollapseAllToggle(),this.initializeShowRefreshAction()}),this.treeViewDnd=this.instantiationService.createInstance(La,this.id),this._dragAndDropController&&(this.treeViewDnd.controller=this._dragAndDropController),this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration("explorer.decorations")&&this.doRefresh([this.root])})),this._register(this.viewDescriptorService.onDidChangeLocation(({views:e,from:t,to:i})=>{var o;e.some(s=>s.id===this.id)&&((o=this.tree)==null||o.updateOptions({overrideStyles:{listBackground:this.viewLocation===1?xr:Dr}}))})),this.registerActions(),this.create())}get viewContainer(){return this.viewDescriptorService.getViewContainerByViewId(this.id)}get viewLocation(){return this.viewDescriptorService.getViewLocationById(this.id)}get dragAndDropController(){return this._dragAndDropController}set dragAndDropController(e){this._dragAndDropController=e,this.treeViewDnd&&(this.treeViewDnd.controller=e)}get dataProvider(){return this._dataProvider}set dataProvider(e){if(e){const t=this;this._dataProvider=new class{constructor(){this._isEmpty=!0,this._onDidChangeEmpty=new w,this.onDidChangeEmpty=this._onDidChangeEmpty.event}get isTreeEmpty(){return this._isEmpty}async getChildren(i){let o;const s=[];if(i&&i.children?o=i.children:(i=i??t.root,i.children=await(i instanceof Sr?e.getChildren():e.getChildren(i)),o=i.children??[],o.forEach(n=>{var r,a;n.parent=i,!t.manuallyManageCheckboxes&&((r=i==null?void 0:i.checkbox)==null?void 0:r.isChecked)===!0&&((a=n.checkbox)==null?void 0:a.isChecked)===!1&&(n.checkbox.isChecked=!0,s.push(n))})),i instanceof Sr){const n=this._isEmpty;this._isEmpty=o.length===0,n!==this._isEmpty&&this._onDidChangeEmpty.fire()}return s.length>0&&t._onDidChangeCheckboxState.fire(s),o}},this._dataProvider.onDidChangeEmpty&&this._register(this._dataProvider.onDidChangeEmpty(()=>{this.updateCollapseAllToggle(),this._onDidChangeWelcomeState.fire()})),this.updateMessage(),this.refresh()}else this._dataProvider=void 0,this.updateMessage();this._onDidChangeWelcomeState.fire()}get message(){return this._message}set message(e){this._message=e,this.updateMessage(),this._onDidChangeWelcomeState.fire()}get title(){return this._title}set title(e){this._title=e,this._onDidChangeTitle.fire(this._title)}get description(){return this._description}set description(e){this._description=e,this._onDidChangeDescription.fire(this._description)}get badge(){return this._badge}set badge(e){var t,i;if(!(((t=this._badge)==null?void 0:t.value)===(e==null?void 0:e.value)&&((i=this._badge)==null?void 0:i.tooltip)===(e==null?void 0:e.tooltip))&&(this._badgeActivity&&(this._badgeActivity.dispose(),this._badgeActivity=void 0),this._badge=e,e)){const o={badge:new to(e.value,()=>e.tooltip),priority:50};this._badgeActivity=this.activityService.showViewActivity(this.id,o)}}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){var i;const t=this._canSelectMany;this._canSelectMany=e,this._canSelectMany!==t&&((i=this.tree)==null||i.updateOptions({multipleSelectionSupport:this.canSelectMany}))}get manuallyManageCheckboxes(){return this._manuallyManageCheckboxes}set manuallyManageCheckboxes(e){this._manuallyManageCheckboxes=e}get hasIconForParentNode(){return this._hasIconForParentNode}get hasIconForLeafNode(){return this._hasIconForLeafNode}get visible(){return this.isVisible}initializeShowCollapseAllAction(e=!1){return this.collapseAllContext||(this.collapseAllContextKey=new U(`treeView.${this.id}.enableCollapseAll`,e,u("treeView.enableCollapseAll","Whether the the tree view with id {0} enables collapse all.",this.id)),this.collapseAllContext=this.collapseAllContextKey.bindTo(this.contextKeyService)),!0}get showCollapseAllAction(){var e;return this.initializeShowCollapseAllAction(),!!((e=this.collapseAllContext)!=null&&e.get())}set showCollapseAllAction(e){var t;this.initializeShowCollapseAllAction(e),(t=this.collapseAllContext)==null||t.set(e)}initializeShowRefreshAction(e=!1){this.refreshContext||(this.refreshContextKey=new U(`treeView.${this.id}.enableRefresh`,e,u("treeView.enableRefresh","Whether the tree view with id {0} enables refresh.",this.id)),this.refreshContext=this.refreshContextKey.bindTo(this.contextKeyService))}get showRefreshAction(){var e;return this.initializeShowRefreshAction(),!!((e=this.refreshContext)!=null&&e.get())}set showRefreshAction(e){var t;this.initializeShowRefreshAction(e),(t=this.refreshContext)==null||t.set(e)}registerActions(){const e=this;this._register(j(class extends ye{constructor(){super({id:`workbench.actions.treeView.${e.id}.refresh`,title:u("refresh","Refresh"),menu:{id:S.ViewTitle,when:v.and(v.equals("view",e.id),e.refreshContextKey),group:"navigation",order:Number.MAX_SAFE_INTEGER-1},icon:le.refresh})}async run(){return e.refresh()}})),this._register(j(class extends ye{constructor(){super({id:`workbench.actions.treeView.${e.id}.collapseAll`,title:u("collapseAll","Collapse All"),menu:{id:S.ViewTitle,when:v.and(v.equals("view",e.id),e.collapseAllContextKey),group:"navigation",order:Number.MAX_SAFE_INTEGER},precondition:e.collapseAllToggleContextKey,icon:le.collapseAll})}async run(){if(e.tree)return new RC(e.tree,!0).run()}}))}setVisibility(e){this.initialize(),e=!!e,this.isVisible!==e&&(this.isVisible=e,this.tree&&(this.isVisible?fi(this.tree.getHTMLElement()):mi(this.tree.getHTMLElement()),this.isVisible&&this.elementsToRefresh.length&&this.dataProvider&&(this.doRefresh(this.elementsToRefresh),this.elementsToRefresh=[])),Vv(()=>{this.dataProvider&&this._onDidChangeVisibility.fire(this.isVisible)}),this.visible&&this.activate())}focus(e=!0,t){if(this.tree&&this.root.children&&this.root.children.length>0){const i=t??this.tree.getSelection()[0];i&&e&&this.tree.reveal(i,.5),this.tree.domFocus()}else this.tree?this.tree.domFocus():this.domNode.focus()}show(e){this._container=e,de(e,this.domNode)}create(){this.domNode=z(".tree-explorer-viewlet-tree-view"),this.messageElement=de(this.domNode,z(".message")),this.updateMessage(),this.treeContainer=de(this.domNode,z(".customview-tree")),this.treeContainer.classList.add("file-icon-themable-tree","show-file-icons");const e=this._register(bi(this.domNode));this._register(e.onDidFocus(()=>this.focused=!0)),this._register(e.onDidBlur(()=>this.focused=!1))}updateCheckboxes(e){const t=[];if(!this.manuallyManageCheckboxes){for(const i of e)if(i.checkbox!==void 0){let o=function(r){for(const a of r.children??[])a.checkbox!==void 0&&r.checkbox!==void 0&&a.checkbox.isChecked!==r.checkbox.isChecked&&(a.checkbox.isChecked=r.checkbox.isChecked,t.push(a),o(a))},n=function(r){if(r.parent&&r.parent.checkbox!==void 0&&r.parent.children){if(s.has(r.parent))return;s.add(r.parent);let a=!1,d=!1;for(const l of r.parent.children){if(a&&d)break;l.checkbox!==void 0&&(l.checkbox.isChecked?d=!0:a=!0)}d&&!a&&r.parent.checkbox.isChecked!==!0?(r.parent.checkbox.isChecked=!0,t.push(r.parent),n(r.parent)):a&&r.parent.checkbox.isChecked!==!1&&(r.parent.checkbox.isChecked=!1,t.push(r.parent),n(r.parent))}};o(i);const s=new Set;n(i)}}e=e.concat(t),e.forEach(i=>{var o;return(o=this.tree)==null?void 0:o.rerender(i)}),this._onDidChangeCheckboxState.fire(e)}createTree(){const e=Oc.bind(void 0,this.instantiationService),t=this._register(this.instantiationService.createInstance(Oa,this.id));this.treeLabels=this._register(this.instantiationService.createInstance(Ln,this));const i=this.instantiationService.createInstance(BC,this,l=>this.progressService.withProgress({location:this.id},()=>l)),o=new WC(this.themeService),s=this._register(new LC);this._register(s.onDidChangeCheckboxState(l=>{this.updateCheckboxes(l)}));const n=this.instantiationService.createInstance(Gi,this.id,t,this.treeLabels,e,o,s),r=this._title;this.tree=this._register(this.instantiationService.createInstance(PC,this.id,this.treeContainer,new NC,[n],i,{identityProvider:new FC,accessibilityProvider:{getAriaLabel(l){if(l.accessibilityInformation)return l.accessibilityInformation.label;if(es(l.tooltip))return l.tooltip;{if(l.resourceUri&&!l.label)return null;let p="";return l.label&&(p+=l.label.label+" "),l.description&&(p+=l.description),p}},getRole(l){var p;return((p=l.accessibilityInformation)==null?void 0:p.role)??"treeitem"},getWidgetAriaLabel(){return r}},keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:l=>l.label?l.label.label:l.resourceUri?Me(T.revive(l.resourceUri)):void 0},expandOnlyOnTwistieClick:l=>!!l.command||!!l.checkbox||this.configurationService.getValue("workbench.tree.expandMode")==="doubleClick",collapseByDefault:l=>l.collapsibleState!==Dt.Expanded,multipleSelectionSupport:this.canSelectMany,dnd:this.treeViewDnd,overrideStyles:{listBackground:this.viewLocation===1?xr:Dr}})),t.setContextKeyService(this.tree.contextKeyService),o.tree=this.tree;const a=new Dp(this.notificationService,()=>this.tree.getSelection());n.actionRunner=a,this.tree.contextKeyService.createKey(this.id,!0),_p.bindTo(this.tree.contextKeyService).set(!0),this._register(this.tree.onContextMenu(l=>this.onContextMenu(t,l,a))),this._register(this.tree.onDidChangeSelection(l=>this._onDidChangeSelection.fire(l.elements))),this._register(this.tree.onDidChangeFocus(l=>{l.elements.length&&this._onDidChangeFocus.fire(l.elements[0])})),this._register(this.tree.onDidChangeCollapseState(l=>{if(!l.node.element)return;const p=Array.isArray(l.node.element.element)?l.node.element.element[0]:l.node.element.element;l.node.collapsed?this._onDidCollapseItem.fire(p):this._onDidExpandItem.fire(p)})),this.tree.setInput(this.root).then(()=>this.updateContentAreas()),this._register(this.tree.onDidOpen(async l=>{if(!l.browserEvent||l.browserEvent.target&&l.browserEvent.target.classList.contains(Ps.checkboxClass))return;const p=this.tree.getSelection(),g=await this.resolveCommand(p.length===1?p[0]:void 0);if(g&&Sp(g,this.contextKeyService)){let f=g.arguments||[];(g.id===qf||g.id===jf)&&(f=[...f,l]);try{await this.commandService.executeCommand(g.id,...f)}catch(b){this.notificationService.error(b)}}})),this._register(t.onDidChange(l=>{var p,g;(p=this.tree)!=null&&p.hasNode(l)&&((g=this.tree)==null||g.rerender(l))}))}async resolveCommand(e){let t=e==null?void 0:e.command;return e&&!t&&e instanceof Dc&&e.hasResolve&&(await e.resolve(new qe().token),t=e.command),t}onContextMenu(e,t,i){this.hoverService.hideHover();const o=t.element;if(o===null)return;const s=t.browserEvent;s.preventDefault(),s.stopPropagation(),this.tree.setFocus([o]);const n=e.getResourceContextActions(o);n.length&&this.contextMenuService.showContextMenu({getAnchor:()=>t.anchor,getActions:()=>n,getActionViewItem:r=>{const a=this.keybindingService.lookupKeybinding(r.id);if(a)return new Ov(r,r,{label:!0,keybinding:a.getLabel()})},onHide:r=>{r&&this.tree.domFocus()},getActionsContext:()=>({$treeViewId:this.id,$treeItemHandle:o.handle}),actionRunner:i})}updateMessage(){this._message?this.showMessage(this._message):this.dataProvider?this.hideMessage():this.showMessage(MC),this.updateContentAreas()}showMessage(e){this._messageValue=e,this.messageElement&&(this.messageElement.classList.remove("hide"),this.resetMessageElement(),$r(this._message)||(this.messageElement.textContent=this._messageValue),this.layout(this._height,this._width))}hideMessage(){var e;this.resetMessageElement(),(e=this.messageElement)==null||e.classList.add("hide"),this.layout(this._height,this._width)}resetMessageElement(){this.messageElement&&Jt(this.messageElement)}layout(e,t){var i;if(e&&t&&this.messageElement&&this.treeContainer){this._height=e,this._width=t;const o=e-Rv(this.messageElement);this.treeContainer.style.height=o+"px",(i=this.tree)==null||i.layout(o,t)}}getOptimalWidth(){if(this.tree){const e=this.tree.getHTMLElement(),t=[].slice.call(e.querySelectorAll(".outline-item-label > a"));return Lv(e,t)}return 0}async refresh(e){if(this.dataProvider&&this.tree){this.refreshing&&await A.toPromise(this._onDidCompleteRefresh.event),e||(e=[this.root],this.elementsToRefresh=[]);for(const t of e)t.children=void 0;if(this.isVisible)return this.doRefresh(e);if(this.elementsToRefresh.length){const t=new Set;this.elementsToRefresh.forEach(i=>t.add(i.handle));for(const i of e)t.has(i.handle)||this.elementsToRefresh.push(i)}else this.elementsToRefresh.push(...e)}}async expand(e){const t=this.tree;if(t)try{e=Array.isArray(e)?e:[e];for(const i of e)await t.expand(i,!1)}catch{}}isCollapsed(e){var t;return!!((t=this.tree)!=null&&t.isCollapsed(e))}setSelection(e){var t;(t=this.tree)==null||t.setSelection(e)}getSelection(){var e;return((e=this.tree)==null?void 0:e.getSelection())??[]}setFocus(e){this.tree&&(e?(this.focus(!0,e),this.tree.setFocus([e])):this.tree.setFocus([]))}async reveal(e){if(this.tree)return this.tree.reveal(e)}async doRefresh(e){const t=this.tree;if(t&&this.visible){this.refreshing=!0;const i=t.getSelection();try{await Promise.all(e.map(s=>t.updateChildren(s,!0,!0)))}catch(s){this.logService.error(s)}const o=t.getSelection();(i.length!==o.length||i.some((s,n)=>s.handle!==o[n].handle))&&this._onDidChangeSelection.fire(o),this.refreshing=!1,this._onDidCompleteRefresh.fire(),this.updateContentAreas(),this.focused&&this.focus(!1),this.updateCollapseAllToggle()}}initializeCollapseAllToggle(){this.collapseAllToggleContext||(this.collapseAllToggleContextKey=new U(`treeView.${this.id}.toggleCollapseAll`,!1,u("treeView.toggleCollapseAll","Whether collapse all is toggled for the tree view with id {0}.",this.id)),this.collapseAllToggleContext=this.collapseAllToggleContextKey.bindTo(this.contextKeyService))}updateCollapseAllToggle(){var e;this.showCollapseAllAction&&(this.initializeCollapseAllToggle(),(e=this.collapseAllToggleContext)==null||e.set(!!this.root.children&&this.root.children.length>0&&this.root.children.some(t=>t.collapsibleState!==Dt.None)))}updateContentAreas(){const e=!this.root.children||this.root.children.length===0;this._messageValue&&e&&!this.refreshing&&this.treeContainer?(this.dragAndDropController||this.treeContainer.classList.add("hide"),this.domNode.setAttribute("tabindex","0")):this.treeContainer&&(this.treeContainer.classList.remove("hide"),this.domNode.removeAttribute("tabindex"))}get container(){return this._container}};Va=C([h(2,te),h(3,I),h(4,Io),h(5,O),h(6,jn),h(7,ke),h(8,ve),h(9,Ae),h(10,Qe),h(11,Mt),h(12,G),h(13,So),h(14,it)],Va);class FC{getId(e){return e.handle}}class NC{getHeight(e){return Gi.ITEM_HEIGHT}getTemplateId(e){return Gi.TREE_TEMPLATE_ID}}class BC{constructor(e,t){this.treeView=e,this.withProgress=t}hasChildren(e){return!!this.treeView.dataProvider&&e.collapsibleState!==Dt.None}async getChildren(e){let t=[];if(this.treeView.dataProvider)try{t=await this.withProgress(this.treeView.dataProvider.getChildren(e))??[]}catch(i){if(!i.message.startsWith("Bad progress location:"))throw i}return t}}let Gi=class Ep extends V{constructor(e,t,i,o,s,n,r,a,d,l,p,g){super(),this.treeViewId=e,this.menus=t,this.labels=i,this.actionViewItemProvider=o,this.aligner=s,this.checkboxStateHandler=n,this.themeService=r,this.configurationService=a,this.labelService=d,this.hoverService=l,this.treeViewsService=p,this.contextKeyService=g,this._hasCheckbox=!1,this._renderedElements=new Map,this._hoverDelegate={showHover:f=>this.hoverService.showHover(f),delay:this.configurationService.getValue("workbench.hover.delay")},this._register(this.themeService.onDidFileIconThemeChange(()=>this.rerender())),this._register(this.themeService.onDidColorThemeChange(()=>this.rerender()))}get templateId(){return Ep.TREE_TEMPLATE_ID}set actionRunner(e){this._actionRunner=e}renderTemplate(e){e.classList.add("custom-view-tree-node-item");const t=de(e,z("")),i=this.labels.create(e,{supportHighlights:!0,hoverDelegate:this._hoverDelegate}),o=Hl(i.element,z(".custom-view-tree-node-item-icon")),s=de(i.element,z(".actions")),n=new xo(s,{actionViewItemProvider:this.actionViewItemProvider});return{resourceLabel:i,icon:o,checkboxContainer:t,actionBar:n,container:e,elementDisposable:new x}}getHover(e,t,i){return!(i instanceof Dc)||!i.hasResolve?t&&!i.tooltip?void 0:i.tooltip===void 0?e:es(i.tooltip)?i.tooltip!==""?i.tooltip:void 0:{markdown:i.tooltip,markdownNotSupportedFallback:t?void 0:Mv(i.tooltip)}:{markdown:typeof i.tooltip=="string"?i.tooltip:o=>new Promise(s=>{i.resolve(o).then(()=>s(i.tooltip))}),markdownNotSupportedFallback:t?void 0:e??""}}renderElement(e,t,i){var m;const o=e.element,s=o.resourceUri?T.revive(o.resourceUri):null,n=o.label?o.label:s?{label:Me(s)}:void 0,r=es(o.description)?o.description:s&&o.description===!0?this.labelService.getUriLabel(Ti(s),{relative:!0}):void 0,a=n?n.label:void 0,d=n&&n.highlights&&a?n.highlights.map(([y,D])=>{if(y<0&&(y=a.length+y),D<0&&(D=a.length+D),y>=a.length||D>a.length)return{start:0,end:0};if(y>D){const L=y;y=D,D=L}return{start:y,end:D}}):void 0,l=this.themeService.getColorTheme().type===Zi.LIGHT?o.icon:o.iconDark,p=l?T.revive(l):void 0,g=this.getHover(a,s,o);i.actionBar.clear(),i.icon.style.color="";let f=!0;if(o.command&&(f=Sp(o.command,this.contextKeyService)),this.renderCheckbox(o,i),s){const y=this.configurationService.getValue("explorer.decorations"),D=s||T.parse("missing:_icon_resource");i.resourceLabel.setResource({name:a,description:r,resource:D},{fileKind:this.getFileKind(o),title:g,hideIcon:this.shouldHideResourceLabelIcon(p,o.themeIcon),fileDecorations:y,extraClasses:["custom-view-tree-node-item-resourceLabel"],matches:d||Ni(e.filterData),strikethrough:n==null?void 0:n.strikethrough,disabledCommand:!f,labelEscapeNewLines:!0})}else i.resourceLabel.setResource({name:a,description:r},{title:g,hideIcon:!0,extraClasses:["custom-view-tree-node-item-resourceLabel"],matches:d||Ni(e.filterData),strikethrough:n==null?void 0:n.strikethrough,disabledCommand:!f,labelEscapeNewLines:!0});if(p)i.icon.className="custom-view-tree-node-item-icon",i.icon.style.backgroundImage=Nc(p);else{let y;this.shouldShowThemeIcon(!!s,o.themeIcon)&&(y=ge.asClassName(o.themeIcon),o.themeIcon.color&&(i.icon.style.color=((m=this.themeService.getColorTheme().getColor(o.themeIcon.color.id))==null?void 0:m.toString())??"")),i.icon.className=y?`custom-view-tree-node-item-icon ${y}`:"",i.icon.style.backgroundImage=""}f||(i.icon.className=i.icon.className+" disabled",i.container.parentElement&&(i.container.parentElement.className=i.container.parentElement.className+" disabled")),i.actionBar.context={$treeViewId:this.treeViewId,$treeItemHandle:o.handle};const b=this.menus.getResourceActions(o);b.menu&&i.elementDisposable.add(b.menu),i.actionBar.push(b.actions,{icon:!0,label:!1}),this._actionRunner&&(i.actionBar.actionRunner=this._actionRunner),this.setAlignment(i.container,o),this.treeViewsService.addRenderedTreeItemElement(o,i.container),this._renderedElements.set(e,i)}rerender(){const e=new Set(this._renderedElements.keys());for(const t of e){const i=this._renderedElements.get(t);i&&(this.disposeElement(t,0,i),this.renderElement(t,0,i))}}renderCheckbox(e,t){if(e.checkbox){if(this._hasCheckbox||(this._hasCheckbox=!0,this.rerender()),!t.checkbox){const i=new Ps(t.checkboxContainer,this.checkboxStateHandler,this._hoverDelegate);t.checkbox=i}t.checkbox.render(e)}else t.checkbox&&(t.checkbox.dispose(),t.checkbox=void 0)}setAlignment(e,t){e.parentElement.classList.toggle("align-icon-with-twisty",!this._hasCheckbox&&this.aligner.alignIconWithTwisty(t))}shouldHideResourceLabelIcon(e,t){return!!e||!!t&&!this.isFileKindThemeIcon(t)}shouldShowThemeIcon(e,t){return t?!(e&&this.isFileKindThemeIcon(t)):!1}isFolderThemeIcon(e){return(e==null?void 0:e.id)===qr.id}isFileKindThemeIcon(e){return e?e.id===Ud.id||this.isFolderThemeIcon(e):!1}getFileKind(e){if(e.themeIcon)switch(e.themeIcon.id){case Ud.id:return Oe.FILE;case qr.id:return Oe.FOLDER}return e.collapsibleState===Dt.Collapsed||e.collapsibleState===Dt.Expanded?Oe.FOLDER:Oe.FILE}disposeElement(e,t,i){var o;i.elementDisposable.clear(),this._renderedElements.delete(e),this.treeViewsService.removeRenderedTreeItemElement(e.element),(o=i.checkbox)==null||o.dispose(),i.checkbox=void 0}disposeTemplate(e){e.resourceLabel.dispose(),e.actionBar.dispose(),e.elementDisposable.dispose()}};Gi.ITEM_HEIGHT=22;Gi.TREE_TEMPLATE_ID="treeExplorer";Gi=C([h(6,te),h(7,O),h(8,Ft),h(9,Mt),h(10,Sl),h(11,G)],Gi);class WC extends V{constructor(e){super(),this.themeService=e}set tree(e){this._tree=e}alignIconWithTwisty(e){if(e.collapsibleState!==Dt.None||!this.hasIcon(e))return!1;if(this._tree){const t=this._tree.getParentElement(e)||this._tree.getInput();return this.hasIcon(t)?!!t.children&&t.children.some(i=>i.collapsibleState!==Dt.None&&!this.hasIcon(i)):!!t.children&&t.children.every(i=>i.collapsibleState===Dt.None||!this.hasIcon(i))}else return!1}hasIcon(e){if(this.themeService.getColorTheme().type===Zi.LIGHT?e.icon:e.iconDark)return!0;if(e.resourceUri||e.themeIcon){const i=this.themeService.getFileIconTheme();return(e.themeIcon?e.themeIcon.id===qr.id:e.collapsibleState!==Dt.None)?i.hasFileIcons&&i.hasFolderIcons:i.hasFileIcons}return!1}}class Dp extends Kn{constructor(e,t){super(),this.getSelectedResources=t,this._register(this.onDidRun(i=>{i.error&&!Ui(i.error)&&e.error(u("command-error","Error running command {1}: {0}. This is likely caused by the extension that contributes {1}.",i.error.message,i.action.id))}))}async runAction(e,t){const i=this.getSelectedResources();let o,s=!1;i.length>1&&(o=i.map(n=>((n.handle===t.$treeItemHandle||t.$selectedTreeItems)&&(s=!0),{$treeViewId:t.$treeViewId,$treeItemHandle:n.handle}))),s||(o=void 0),await e.run(t,o)}}let Oa=class extends V{constructor(e,t){super(),this.id=e,this.menuService=t,this._onDidChange=new w,this.onDidChange=this._onDidChange.event}getResourceActions(e){const t=this.getActions(S.ViewItemContext,e,!0);return{menu:t.menu,actions:t.primary}}getResourceContextActions(e){return this.getActions(S.ViewItemContext,e).secondary}setContextKeyService(e){this.contextKeyService=e}getActions(e,t,i=!1){if(!this.contextKeyService)return{primary:[],secondary:[]};const o=this.contextKeyService.createOverlay([["view",this.id],["viewItem",t.contextValue]]),s=this.menuService.createMenu(e,o),a={primary:[],secondary:[],menu:s};return en(s,{shouldForwardArgs:!0},a,"inline"),i?this._register(s.onDidChange(()=>this._onDidChange.fire(t))):s.dispose(),a}dispose(){this.contextKeyService=void 0,super.dispose()}};Oa=C([h(1,rt)],Oa);let Ra=class extends Va{constructor(e,t,i,o,s,n,r,a,d,l,p,g,f,b,m,y,D,L){super(e,t,o,s,n,r,a,d,l,p,g,b,f,y,L),this.extensionId=i,this.extensionService=m,this.telemetryService=D,this.activated=!1}activate(){this.activated||(this.telemetryService.publicLog2("Extension:ViewActivate",{extensionId:new qh(this.extensionId),id:this.id}),this.createTree(),this.progressService.withProgress({location:this.id},()=>this.extensionService.activateByEvent(`onView:${this.id}`)).then(()=>Yn(2e3)).then(()=>{this.updateMessage()}),this.activated=!0)}};Ra=C([h(3,te),h(4,I),h(5,Io),h(6,O),h(7,jn),h(8,ke),h(9,ve),h(10,Ae),h(11,Qe),h(12,G),h(13,Mt),h(14,Ci),h(15,So),h(16,Ne),h(17,it)],Ra);let La=class{constructor(e,t,i,o,s){this.treeId=e,this.labelService=t,this.instantiationService=i,this.treeViewsDragAndDropService=o,this.logService=s,this.treeItemsTransfer=jt.getInstance(),this.treeMimeType=`application/vnd.code.tree.${e.toLowerCase()}`}set controller(e){this.dndController=e}handleDragAndLog(e,t,i,o){return e.handleDrag(t,i,o).then(s=>{if(s){const n=[];for(const r of s)r[0]!==this.treeMimeType&&e.dragMimeTypes.findIndex(a=>a===r[0])<0&&n.push(r[0]);n.length&&this.logService.warn(`Drag and drop controller for tree ${this.treeId} adds the following data transfer types but does not declare them in dragMimeTypes: ${n.join(", ")}`)}return s})}addExtensionProvidedTransferTypes(e,t){var o;if(!e.dataTransfer||!this.dndController)return;const i=Un();this.dragCancellationToken=new qe,this.treeViewsDragAndDropService.addDragOperationTransfer(i,this.handleDragAndLog(this.dndController,t,i,this.dragCancellationToken.token)),this.treeItemsTransfer.setData([new kt(i)],kt.prototype),e.dataTransfer.clearData(Ko.text),this.dndController.dragMimeTypes.find(s=>s===Ko.uriList)&&((o=e.dataTransfer)==null||o.setData(oo.RESOURCES,"")),this.dndController.dragMimeTypes.forEach(s=>{var n;(n=e.dataTransfer)==null||n.setData(s,"")})}addResourceInfoToTransfer(e,t){if(t.length&&e.dataTransfer){this.instantiationService.invokeFunction(o=>Mh(o,t,e));const i=t.filter(o=>o.scheme===Q.file).map(o=>o.fsPath);i.length&&e.dataTransfer.setData(Ur.FILES,JSON.stringify(i))}}onDragStart(e,t){if(t.dataTransfer){const i=e.getData(),o=[],s={id:this.treeId,itemHandles:[]};i.forEach(n=>{s.itemHandles.push(n.handle),n.resourceUri&&o.push(T.revive(n.resourceUri))}),this.addResourceInfoToTransfer(t,o),this.addExtensionProvidedTransferTypes(t,s.itemHandles),t.dataTransfer.setData(this.treeMimeType,JSON.stringify(s))}}debugLog(e){e.size?this.logService.debug(`TreeView dragged mime types: ${Array.from(e).join(", ")}`):this.logService.debug("TreeView dragged with no supported mime types.")}onDragOver(e,t,i,o){const s=zd(o.dataTransfer),n=new Set(Array.from(s,d=>d[0]));if(o.dataTransfer){for(const d of o.dataTransfer.items)if(d.kind==="file"||d.type===oo.RESOURCES.toLowerCase()){n.add(Ko.uriList);break}}this.debugLog(n);const r=this.dndController;return!r||!o.dataTransfer||r.dropMimeTypes.length===0?!1:Array.from(n).some((d,l)=>d===this.treeMimeType?!0:r.dropMimeTypes.indexOf(d)>=0)?{accept:!0,bubble:0,autoExpand:!0}:!1}getDragURI(e){return this.dndController?e.resourceUri?T.revive(e.resourceUri).toString():e.handle:null}getDragLabel(e){if(!this.dndController)return;if(e.length>1)return String(e.length);const t=e[0];return t.label?t.label.label:t.resourceUri?this.labelService.getUriLabel(T.revive(t.resourceUri)):void 0}async drop(e,t,i,o){const s=this.dndController;if(!o.dataTransfer||!s)return;let n,r;this.treeItemsTransfer.hasData(kt.prototype)&&(r=this.treeItemsTransfer.getData(kt.prototype)[0].identifier);const a=zd(o.dataTransfer,!0),d=new Pv;for(const[p,g]of a)if((p===this.treeMimeType||s.dropMimeTypes.includes(p)||g.asFile()&&s.dropMimeTypes.includes(oo.FILES.toLowerCase()))&&(d.append(p,g),p===this.treeMimeType))try{n=JSON.parse(await g.asString())}catch{}const l=await this.treeViewsDragAndDropService.removeDragOperationTransfer(r);if(l)for(const[p,g]of l)d.append(p,g);return s.handleDrop(d,t,Bi.None,r,n==null?void 0:n.id,n==null?void 0:n.itemHandles)}onDragEnd(e){var t,i;((t=e.dataTransfer)==null?void 0:t.dropEffect)==="none"&&((i=this.dragCancellationToken)==null||i.cancel())}};La=C([h(1,Ft),h(2,I),h(3,Wc),h(4,it)],La);const _r="workbench.view.remote",Er={webviewState:"webviewState"};let Ma=class kp extends Wn{static getOriginStore(e){return this._originStore??(this._originStore=new Yf("webviewViews.origins",e)),this._originStore}constructor(e,t,i,o,s,n,r,a,d,l,p,g,f,b,m,y,D){super({...e,titleMenuId:S.ViewTitle,showActionsAlways:!0},n,o,t,i,l,s,r,d,a),this.activityService=p,this.extensionService=g,this.progressService=f,this.storageService=b,this.viewService=m,this.webviewService=y,this.webviewViewService=D,this._webview=this._register(new Ie),this._webviewDisposables=this._register(new x),this._activated=!1,this._onDidChangeVisibility=this._register(new w),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._onDispose=this._register(new w),this.onDispose=this._onDispose.event,this.extensionId=e.fromExtensionId,this.defaultTitle=this.title,this.memento=new El(`webviewView.${this.id}`,b),this.viewState=this.memento.getMemento(1,1),this._register(this.onDidChangeBodyVisibility(()=>this.updateTreeVisibility())),this._register(this.webviewViewService.onNewResolverRegistered(L=>{L.viewType===this.id&&this.updateTreeVisibility()})),this.updateTreeVisibility()}dispose(){this._onDispose.fire(),clearTimeout(this._repositionTimeout),super.dispose()}focus(){var e;super.focus(),(e=this._webview.value)==null||e.focus()}renderBody(e){super.renderBody(e),this._container=e,this._rootContainer=void 0,this._resizeObserver||(this._resizeObserver=new ResizeObserver(()=>{setTimeout(()=>{this.layoutWebview()},0)}),this._register(Y(()=>{this._resizeObserver.disconnect()})),this._resizeObserver.observe(e))}saveState(){this._webview.value&&(this.viewState[Er.webviewState]=this._webview.value.state),this.memento.saveMemento(),super.saveState()}layoutBody(e,t){super.layoutBody(e,t),this.layoutWebview(new q(t,e))}updateTreeVisibility(){var e,t;this.isBodyVisible()?(this.activate(),(e=this._webview.value)==null||e.claim(this,void 0)):(t=this._webview.value)==null||t.release(this)}activate(){if(this._activated)return;this._activated=!0;const e=this.extensionId?kp.getOriginStore(this.storageService).getOrigin(this.id,this.extensionId):void 0,t=this.webviewService.createWebviewOverlay({origin:e,providedViewType:this.id,title:this.title,options:{purpose:"webviewView"},contentOptions:{},extension:this.extensionId?{id:this.extensionId}:void 0});t.state=this.viewState[Er.webviewState],this._webview.value=t,this._container&&this.layoutWebview(),this._webviewDisposables.add(Y(()=>{var o;(o=this._webview.value)==null||o.release(this)})),this._webviewDisposables.add(t.onDidUpdateState(()=>{this.viewState[Er.webviewState]=t.state}));for(const o of[E.DRAG,E.DRAG_END,E.DRAG_ENTER,E.DRAG_LEAVE,E.DRAG_START])this._webviewDisposables.add(_(this._webview.value.container,o,s=>{s.preventDefault(),s.stopImmediatePropagation(),this.dropTargetElement.dispatchEvent(new DragEvent(s.type,s))}));this._webviewDisposables.add(new Jf(()=>this._webview.value));const i=this._webviewDisposables.add(new qe);this.withProgress(async()=>{await this.extensionService.activateByEvent(`onView:${this.id}`);const o=this,s={webview:t,onDidChangeVisibility:this.onDidChangeBodyVisibility,onDispose:this.onDispose,get title(){return o.setTitle},set title(n){o.updateTitle(n)},get description(){return o.titleDescription},set description(n){o.updateTitleDescription(n)},get badge(){return o.badge},set badge(n){o.updateBadge(n)},dispose:()=>{this._activated=!1,this._webview.clear(),this._webviewDisposables.clear()},show:n=>{this.viewService.openView(this.id,!n)}};await this.webviewViewService.resolve(this.id,s,i.token)})}updateTitle(e){this.setTitle=e,super.updateTitle(typeof e=="string"?e:this.defaultTitle)}updateBadge(e){var t,i;if(!(((t=this.badge)==null?void 0:t.value)===(e==null?void 0:e.value)&&((i=this.badge)==null?void 0:i.tooltip)===(e==null?void 0:e.tooltip))&&(this.activity&&(this.activity.dispose(),this.activity=void 0),this.badge=e,e)){const o={badge:new to(e.value,()=>e.tooltip),priority:150};this.activityService.showViewActivity(this.id,o)}}async withProgress(e){return this.progressService.withProgress({location:this.id,delay:500},e)}onDidScrollRoot(){this.layoutWebview()}doLayoutWebview(e){const t=this._webview.value;!this._container||!t||((!this._rootContainer||!this._rootContainer.isConnected)&&(this._rootContainer=this.findRootContainer(this._container)),t.layoutWebviewOverElement(this._container,e,this._rootContainer))}layoutWebview(e){this.doLayoutWebview(e),clearTimeout(this._repositionTimeout),this._repositionTimeout=setTimeout(()=>this.doLayoutWebview(e),200)}findRootContainer(e){return At(tn(e,"monaco-scrollable-element"))}};Ma=C([h(1,O),h(2,G),h(3,ke),h(4,I),h(5,ve),h(6,zi),h(7,Ne),h(8,te),h(9,Qe),h(10,So),h(11,Ci),h(12,jn),h(13,oe),h(14,Pn),h(15,Do),h(16,_l)],Ma);const yh={type:"object",properties:{id:{description:u({key:"vscode.extension.contributes.views.containers.id",comment:["Contribution refers to those that an extension contributes to VS Code through an extension/contribution point. "]},"Unique id used to identify the container in which views can be contributed using 'views' contribution point"),type:"string",pattern:"^[a-zA-Z0-9_-]+$"},title:{description:u("vscode.extension.contributes.views.containers.title","Human readable string used to render the container"),type:"string"},icon:{description:u("vscode.extension.contributes.views.containers.icon","Path to the container icon. Icons are 24x24 centered on a 50x40 block and have a fill color of 'rgb(215, 218, 224)' or '#d7dae0'. It is recommended that icons be in SVG, though any image file type is accepted."),type:"string"}},required:["id","title","icon"]},HC={description:u("vscode.extension.contributes.viewsContainers","Contributes views containers to the editor"),type:"object",properties:{activitybar:{description:u("views.container.activitybar","Contribute views containers to Activity Bar"),type:"array",items:yh},panel:{description:u("views.container.panel","Contribute views containers to Panel"),type:"array",items:yh}}};var ui;(function(c){c.Tree="tree",c.Webview="webview"})(ui||(ui={}));var eo;(function(c){c.Visible="visible",c.Hidden="hidden",c.Collapsed="collapsed"})(eo||(eo={}));const Mo={type:"object",required:["id","name"],defaultSnippets:[{body:{id:"${1:id}",name:"${2:name}"}}],properties:{type:{markdownDescription:u("vscode.extension.contributes.view.type","Type of the view. This can either be `tree` for a tree view based view or `webview` for a webview based view. The default is `tree`."),type:"string",enum:["tree","webview"],markdownEnumDescriptions:[u("vscode.extension.contributes.view.tree","The view is backed by a `TreeView` created by `createTreeView`."),u("vscode.extension.contributes.view.webview","The view is backed by a `WebviewView` registered by `registerWebviewViewProvider`.")]},id:{markdownDescription:u("vscode.extension.contributes.view.id","Identifier of the view. This should be unique across all views. It is recommended to include your extension id as part of the view id. Use this to register a data provider through `vscode.window.registerTreeDataProviderForView` API. Also to trigger activating your extension by registering `onView:${id}` event to `activationEvents`."),type:"string"},name:{description:u("vscode.extension.contributes.view.name","The human-readable name of the view. Will be shown"),type:"string"},when:{description:u("vscode.extension.contributes.view.when","Condition which must be true to show this view"),type:"string"},icon:{description:u("vscode.extension.contributes.view.icon","Path to the view icon. View icons are displayed when the name of the view cannot be shown. It is recommended that icons be in SVG, though any image file type is accepted."),type:"string"},contextualTitle:{description:u("vscode.extension.contributes.view.contextualTitle","Human-readable context for when the view is moved out of its original location. By default, the view's container name will be used."),type:"string"},visibility:{description:u("vscode.extension.contributes.view.initialState","Initial state of the view when the extension is first installed. Once the user has changed the view state by collapsing, moving, or hiding the view, the initial state will not be used again."),type:"string",enum:["visible","hidden","collapsed"],default:"visible",enumDescriptions:[u("vscode.extension.contributes.view.initialState.visible","The default initial state for the view. In most containers the view will be expanded, however; some built-in containers (explorer, scm, and debug) show all contributed views collapsed regardless of the `visibility`."),u("vscode.extension.contributes.view.initialState.hidden","The view will not be shown in the view container, but will be discoverable through the views menu and other view entry points and can be un-hidden by the user."),u("vscode.extension.contributes.view.initialState.collapsed","The view will show in the view container, but will be collapsed.")]},initialSize:{type:"number",description:u("vscode.extension.contributs.view.size","The initial size of the view. The size will behave like the css 'flex' property, and will set the initial size when the view is first shown. In the side bar, this is the height of the view. This value is only respected when the same extension owns both the view and the view container.")}}},GC={type:"object",required:["id","name"],properties:{id:{description:u("vscode.extension.contributes.view.id","Identifier of the view. This should be unique across all views. It is recommended to include your extension id as part of the view id. Use this to register a data provider through `vscode.window.registerTreeDataProviderForView` API. Also to trigger activating your extension by registering `onView:${id}` event to `activationEvents`."),type:"string"},name:{description:u("vscode.extension.contributes.view.name","The human-readable name of the view. Will be shown"),type:"string"},when:{description:u("vscode.extension.contributes.view.when","Condition which must be true to show this view"),type:"string"},group:{description:u("vscode.extension.contributes.view.group","Nested group in the viewlet"),type:"string"},remoteName:{description:u("vscode.extension.contributes.view.remoteName","The name of the remote type associated with this view"),type:["string","array"],items:{type:"string"}}}},UC={description:u("vscode.extension.contributes.views","Contributes views to the editor"),type:"object",properties:{explorer:{description:u("views.explorer","Contributes views to Explorer container in the Activity bar"),type:"array",items:Mo,default:[]},debug:{description:u("views.debug","Contributes views to Debug container in the Activity bar"),type:"array",items:Mo,default:[]},scm:{description:u("views.scm","Contributes views to SCM container in the Activity bar"),type:"array",items:Mo,default:[]},test:{description:u("views.test","Contributes views to Test container in the Activity bar"),type:"array",items:Mo,default:[]},remote:{description:u("views.remote","Contributes views to Remote container in the Activity bar. To contribute to this container, enableProposedApi needs to be turned on"),type:"array",items:GC,default:[]}},additionalProperties:{description:u("views.contributed","Contributes views to contributed views container"),type:"array",items:Mo,default:[]}},xp=kc.registerExtensionPoint({extensionPoint:"viewsContainers",jsonSchema:HC}),zC=kc.registerExtensionPoint({extensionPoint:"views",deps:[xp],jsonSchema:UC,activationEventsGenerator:(c,e)=>{for(const t of c)for(const i of Object.values(t))for(const o of i)o.id&&e.push(`onView:${o.id}`)}}),KC=7;let Pa=class{constructor(e,t){this.instantiationService=e,this.logService=t,this.viewContainersRegistry=M.as(Xe.ViewContainersRegistry),this.viewsRegistry=M.as(Xe.ViewsRegistry),this.handleAndRegisterCustomViewContainers(),this.handleAndRegisterCustomViews();let i=new qe;k.registerCommandAndKeybindingRule({id:"workbench.action.showTreeHover",handler:async(o,...s)=>{i.cancel(),i=new qe;const n=o.get(N),r=o.get(Sl),a=o.get(Mt),d=n.lastFocusedList;if(!(d instanceof at))return;const l=d.getFocus();if(!l||l.length===0)return;const p=l[0];if(p instanceof Dc&&await p.resolve(i.token),!p.tooltip)return;const g=r.getRenderedTreeElement(p);g&&a.showHover({content:p.tooltip,target:g,hoverPosition:2,hideOnHover:!1},!0)},weight:200,primary:vt(2089,2087),when:v.and(_p,se)})}handleAndRegisterCustomViewContainers(){xp.setHandler((e,{added:t,removed:i})=>{i.length&&this.removeCustomViewContainers(i),t.length&&this.addCustomViewContainers(t,this.viewContainersRegistry.all)})}addCustomViewContainers(e,t){const i=M.as(Xe.ViewContainersRegistry);let o=KC+i.all.filter(n=>!!n.extensionId&&i.getViewContainerLocation(n)===0).length,s=5+i.all.filter(n=>!!n.extensionId&&i.getViewContainerLocation(n)===1).length+1;for(const{value:n,collector:r,description:a}of e)Object.entries(n).forEach(([d,l])=>{if(this.isValidViewsContainer(l,r))switch(d){case"activitybar":o=this.registerCustomViewContainers(l,a,o,t,0);break;case"panel":s=this.registerCustomViewContainers(l,a,s,t,1);break}})}removeCustomViewContainers(e){const t=M.as(Xe.ViewContainersRegistry),i=e.reduce((o,s)=>(o.add(s.description.identifier),o),new Kd);for(const o of t.all)if(o.extensionId&&i.has(o.extensionId)){const s=this.viewsRegistry.getViews(o);s.length&&this.viewsRegistry.moveViews(s,this.getDefaultViewContainer()),this.deregisterCustomViewContainer(o)}}isValidViewsContainer(e,t){if(!Array.isArray(e))return t.error(u("viewcontainer requirearray","views containers must be an array")),!1;for(const i of e){if(typeof i.id!="string"&&$r(i.id))return t.error(u("requireidstring","property `{0}` is mandatory and must be of type `string` with non-empty value. Only alphanumeric characters, '_', and '-' are allowed.","id")),!1;if(!/^[a-z0-9_-]+$/i.test(i.id))return t.error(u("requireidstring","property `{0}` is mandatory and must be of type `string` with non-empty value. Only alphanumeric characters, '_', and '-' are allowed.","id")),!1;if(typeof i.title!="string")return t.error(u("requirestring","property `{0}` is mandatory and must be of type `string`","title")),!1;if(typeof i.icon!="string")return t.error(u("requirestring","property `{0}` is mandatory and must be of type `string`","icon")),!1;if($r(i.title))return t.warn(u("requirenonemptystring","property `{0}` is mandatory and must be of type `string` with non-empty value","title")),!0}return!0}registerCustomViewContainers(e,t,i,o,s){return e.forEach(n=>{const a=ge.fromString(n.icon)||Qo(t.extensionLocation,n.icon),d=`workbench.view.extension.${n.id}`,l=n.title||d,p=this.registerCustomViewContainer(d,l,a,i++,t.identifier,s);if(o.length){const g=[];for(const f of o)p!==f&&g.push(...this.viewsRegistry.getViews(f).filter(b=>b.originalContainerId===n.id));g.length&&this.viewsRegistry.moveViews(g,p)}}),i}registerCustomViewContainer(e,t,i,o,s,n){let r=this.viewContainersRegistry.get(e);return r||(r=this.viewContainersRegistry.registerViewContainer({id:e,title:t,extensionId:s,ctorDescriptor:new W(hc,[e,{mergeViewWithContainerWhenSingleView:!0}]),hideIfEmpty:!0,order:o,icon:i},n)),r}deregisterCustomViewContainer(e){this.viewContainersRegistry.deregisterViewContainer(e),M.as(nn.Viewlets).deregisterPaneComposite(e.id)}handleAndRegisterCustomViews(){zC.setHandler((e,{added:t,removed:i})=>{i.length&&this.removeViews(i),t.length&&this.addViews(t)})}addViews(e){const t=new Set,i=[];for(const o of e){const{value:s,collector:n}=o;Object.entries(s).forEach(([r,a])=>{var g;if(!this.isValidViewDescriptors(a,n))return;if(r==="remote"&&!Xf(o.description,"contribViewsRemote")){n.warn(u("ViewContainerRequiresProposedAPI",`View container '{0}' requires 'enabledApiProposals: ["contribViewsRemote"]' to be added to 'Remote'.`,r));return}const d=this.getViewContainer(r);d||n.warn(u("ViewContainerDoesnotExist","View container '{0}' does not exist and all views registered to it will be added to 'Explorer'.",r));const l=d||this.getDefaultViewContainer(),p=[];for(let f=0;f<a.length;f++){const b=a[f];if(t.has(b.id)){n.error(u("duplicateView1","Cannot register multiple views with same id `{0}`",b.id));continue}if(this.viewsRegistry.getView(b.id)!==null){n.error(u("duplicateView2","A view with id `{0}` is already registered.",b.id));continue}const m=mu.equals(o.description.identifier,l.extensionId)?f+1:l.viewOrderDelegate?l.viewOrderDelegate.getOrder(b.group):void 0;let y;typeof b.icon=="string"&&(y=ge.fromString(b.icon)||Qo(o.description.extensionLocation,b.icon));const D=this.convertInitialVisibility(b.visibility),L=this.getViewType(b.type);if(!L){n.error(u("unknownViewType","Unknown view type `{0}`.",b.type));continue}let $;typeof b.initialSize=="number"&&(((g=l.extensionId)==null?void 0:g.value)===o.description.identifier.value?$=b.initialSize:this.logService.warn(`${o.description.identifier.value} tried to set the view size of ${b.id} but it was ignored because the view container does not belong to it.`));const Se={type:L,ctorDescriptor:L===ui.Tree?new W(Ta):new W(Ma),id:b.id,name:b.name,when:v.deserialize(b.when),containerIcon:y||(d==null?void 0:d.icon),containerTitle:b.contextualTitle||(d==null?void 0:d.title),canToggleVisibility:!0,canMoveView:(d==null?void 0:d.id)!==_r,treeView:L===ui.Tree?this.instantiationService.createInstance(Ra,b.id,b.name,o.description.identifier.value):void 0,collapsed:this.showCollapsed(l)||D===eo.Collapsed,order:m,extensionId:o.description.identifier,originalContainerId:r,group:b.group,remoteAuthority:b.remoteName||b.remoteAuthority,virtualWorkspace:b.virtualWorkspace,hideByDefault:D===eo.Hidden,workspace:(d==null?void 0:d.id)===_r?!0:void 0,weight:$};t.add(Se.id),p.push(Se)}i.push({viewContainer:l,views:p})})}this.viewsRegistry.registerViews2(i)}getViewType(e){if(e===ui.Webview)return ui.Webview;if(!e||e===ui.Tree)return ui.Tree}getDefaultViewContainer(){return this.viewContainersRegistry.get($t)}removeViews(e){const t=e.reduce((i,o)=>(i.add(o.description.identifier),i),new Kd);for(const i of this.viewContainersRegistry.all){const o=this.viewsRegistry.getViews(i).filter(s=>s.extensionId&&t.has(s.extensionId));if(o.length){this.viewsRegistry.deregisterViews(o,i);for(const s of o){const n=s;n.treeView&&n.treeView.dispose()}}}}convertInitialVisibility(e){if(Object.values(eo).includes(e))return e}isValidViewDescriptors(e,t){if(!Array.isArray(e))return t.error(u("requirearray","views must be an array")),!1;for(const i of e){if(typeof i.id!="string")return t.error(u("requirestring","property `{0}` is mandatory and must be of type `string`","id")),!1;if(typeof i.name!="string")return t.error(u("requirestring","property `{0}` is mandatory and must be of type `string`","name")),!1;if(i.when&&typeof i.when!="string")return t.error(u("optstring","property `{0}` can be omitted or must be of type `string`","when")),!1;if(i.icon&&typeof i.icon!="string")return t.error(u("optstring","property `{0}` can be omitted or must be of type `string`","icon")),!1;if(i.contextualTitle&&typeof i.contextualTitle!="string")return t.error(u("optstring","property `{0}` can be omitted or must be of type `string`","contextualTitle")),!1;if(i.visibility&&!this.convertInitialVisibility(i.visibility))return t.error(u("optenum","property `{0}` can be omitted or must be one of {1}","visibility",Object.values(eo).join(", "))),!1}return!0}getViewContainer(e){switch(e){case"explorer":return this.viewContainersRegistry.get($t);case"debug":return this.viewContainersRegistry.get(Td);case"scm":return this.viewContainersRegistry.get(Ad);case"remote":return this.viewContainersRegistry.get(_r);default:return this.viewContainersRegistry.get(`workbench.view.extension.${e}`)}}showCollapsed(e){switch(e.id){case $t:case Ad:case Td:return!0}return!1}};Pa=C([h(0,I),h(1,it)],Pa);const $C=M.as(tt.Workbench);$C.registerWorkbenchContribution(Pa,1);let En=class{constructor(e){this._webviewWorkbenchService=e}canSerialize(e){return this._webviewWorkbenchService.shouldPersist(e)}serialize(e){if(!this._webviewWorkbenchService.shouldPersist(e))return;const t=this.toJson(e);try{return JSON.stringify(t)}catch{return}}deserialize(e,t){const i=this.fromJson(JSON.parse(t));return this._webviewWorkbenchService.openRevivedWebview({webviewInitInfo:{providedViewType:i.providedId,origin:i.origin,title:i.title,options:i.webviewOptions,contentOptions:i.contentOptions,extension:i.extension},viewType:i.viewType,title:i.title,iconPath:i.iconPath,state:i.state,group:i.group})}fromJson(e){return{...e,extension:Ip(e.extensionId,e.extensionLocation),iconPath:qC(e.iconPath),state:jC(e.state),webviewOptions:e.options,contentOptions:Ap(e.options)}}toJson(e){var t,i;return{origin:e.webview.origin,viewType:e.viewType,providedId:e.providedId,title:e.getName(),options:{...e.webview.options,...e.webview.contentOptions},extensionLocation:(t=e.extension)==null?void 0:t.location,extensionId:(i=e.extension)==null?void 0:i.id.value,state:e.webview.state,iconPath:e.iconPath?{light:e.iconPath.light,dark:e.iconPath.dark}:void 0,group:e.group}}};En.ID=Xo.typeId;En=C([h(0,xc)],En);function Ip(c,e){if(!c)return;const t=Dn(e);if(t)return{id:new mu(c),location:t}}function qC(c){if(!c)return;const e=Dn(c.light),t=Dn(c.dark);return e&&t?{light:e,dark:t}:void 0}function Dn(c){if(c)try{return typeof c=="string"?T.parse(c):T.from(c)}catch{return}}function jC(c){return typeof c=="string"?c:void 0}function Ap(c){var e;return{...c,localResourceRoots:(e=c.localResourceRoots)==null?void 0:e.map(t=>Dn(t))}}let Fa=class extends En{constructor(e,t,i){super(e),this._instantiationService=t,this._webviewService=i}serialize(e){const t=e.isDirty(),i={...this.toJson(e),editorResource:e.resource.toJSON(),dirty:t,backupId:t?e.backupId:void 0};try{return JSON.stringify(i)}catch{return}}fromJson(e){return{...super.fromJson(e),editorResource:T.from(e.editorResource),dirty:e.dirty}}deserialize(e,t){const i=this.fromJson(JSON.parse(t)),o=Tp(this._webviewService,i),s=this._instantiationService.createInstance($e,{resource:i.editorResource,viewType:i.viewType},o,{startsDirty:i.dirty,backupId:i.backupId});return typeof i.group=="number"&&s.updateGroup(i.group),s}};Fa.ID=$e.typeId;Fa=C([h(0,xc),h(1,I),h(2,Do)],Fa);function Tp(c,e){const t=c.createWebviewOverlay({providedViewType:e.viewType,origin:e.origin,title:void 0,options:{purpose:"customEditor",enableFindWidget:e.webviewOptions.enableFindWidget,retainContextWhenHidden:e.webviewOptions.retainContextWhenHidden},contentOptions:e.contentOptions,extension:e.extension});return t.state=e.state,t}let Na=class extends V{constructor(e,t,i,o,s){super(),this._instantiationService=e,this._workingCopyBackupService=i,this._webviewService=o,this._register(t.registerHandler(this))}handles(e){return e.resource.scheme===Q.vscodeCustomEditor}isOpen(e,t){if(!this.handles(e))return!1;if(e.resource.authority==="jupyter-notebook-ipynb"&&t instanceof Qf)try{const i=JSON.parse(e.resource.query),o=T.from(i);return Re(o,t.resource)}catch{return!1}if(!(t instanceof $e)||e.resource.authority!==t.viewType.replace(/[^a-z0-9\-_]/gi,"-").toLowerCase())return!1;try{const i=JSON.parse(e.resource.query),o=T.from(i);return Re(o,t.resource)}catch{return!1}}async createEditor(e){var r,a;const t=await this._workingCopyBackupService.resolve(e);if(!(t!=null&&t.meta))throw new Error(`No backup found for custom editor: ${e.resource}`);const i=t.meta,o=Ip((r=i.extension)==null?void 0:r.id,(a=i.extension)==null?void 0:a.location),s=Tp(this._webviewService,{viewType:i.viewType,origin:i.webview.origin,webviewOptions:i.webview.options,contentOptions:Ap(i.webview.options),state:i.webview.state,extension:o}),n=this._instantiationService.createInstance($e,{resource:T.revive(i.editorResource),viewType:i.viewType},s,{backupId:i.backupId});return n.updateGroup(0),n}};Na=C([h(0,I),h(1,Ic),h(2,Zf),h(3,Do),h(4,Dl)],Na);M.as(ii.EditorPane).registerEditorPane(Ss.create(Zo,Zo.ID,"Webview Editor"),[new W($e)]);M.as(tt.Workbench).registerWorkbenchContribution(Na,1);const or=v.and(v.equals("activeEditor",Zo.ID),$i.focus.toNegated());class mo extends ye{constructor(){super({id:mo.ID,title:mo.LABEL,keybinding:{when:v.and(or,kl),primary:2084,weight:100}})}run(e){var t;(t=sr(e))==null||t.showFind()}}mo.ID="editor.action.webvieweditor.showFind";mo.LABEL=u("editor.action.webvieweditor.showFind","Show find");class bo extends ye{constructor(){super({id:bo.ID,title:bo.LABEL,keybinding:{when:v.and(or,xl),primary:9,weight:100}})}run(e){var t;(t=sr(e))==null||t.hideFind()}}bo.ID="editor.action.webvieweditor.hideFind";bo.LABEL=u("editor.action.webvieweditor.hideFind","Stop find");class vo extends ye{constructor(){super({id:vo.ID,title:vo.LABEL,keybinding:{when:v.and(or,Ac),primary:3,weight:100}})}run(e){var t;(t=sr(e))==null||t.runFindAction(!1)}}vo.ID="editor.action.webvieweditor.findNext";vo.LABEL=u("editor.action.webvieweditor.findNext","Find next");class wo extends ye{constructor(){super({id:wo.ID,title:wo.LABEL,keybinding:{when:v.and(or,Ac),primary:1027,weight:100}})}run(e){var t;(t=sr(e))==null||t.runFindAction(!0)}}wo.ID="editor.action.webvieweditor.findPrevious";wo.LABEL=u("editor.action.webvieweditor.findPrevious","Find previous");class yo extends ye{constructor(){super({id:yo.ID,title:{value:yo.LABEL,original:"Reload Webviews"},category:fe.Developer,menu:[{id:S.CommandPalette}]})}async run(e){const t=e.get(Do);for(const i of t.webviews)i.reload()}}yo.ID="workbench.action.webview.reloadWebviewAction";yo.LABEL=u("refreshWebviewLabel","Reload Webviews");function sr(c){const t=c.get(P).activeEditor;return t instanceof Xo?t.webview:void 0}M.as(ii.EditorPane).registerEditorPane(Ss.create(Zo,Zo.ID,u("webview.editor.label","webview editor")),[new W(Xo)]);let Ba=class extends V{constructor(e){super(),this.editorGroupService=e,this.editorGroupService.whenReady.then(()=>this.editorGroupService.groups.forEach(t=>{this.registerGroupListener(t)})),this._register(this.editorGroupService.onDidAddGroup(t=>this.registerGroupListener(t)))}registerGroupListener(e){const t=e.onWillOpenEditor(i=>this.onEditorOpening(i.editor,e));A.once(e.onWillDispose)(()=>{t.dispose()})}onEditorOpening(e,t){if(!(e instanceof Xo)||e.typeId!==Xo.typeId||t.contains(e))return;let i;const o=this.editorGroupService.groups;for(const s of o)if(s.contains(e)){i=s;break}i&&i.closeEditor(e)}};Ba=C([h(0,ee)],Ba);const YC=M.as(tt.Workbench);YC.registerWorkbenchContribution(Ba,1);j(mo);j(bo);j(vo);j(wo);j(yo);M.as(Yc.Configuration).registerConfiguration(em);var JC='@keyframes wiggle{0%{transform:rotate(0) scale(1)}15%,45%{transform:rotate(.04turn) scale(1.1)}30%,60%{transform:rotate(-.04turn) scale(1.2)}to{transform:rotate(0) scale(1)}}.monaco-workbench .statusbar DIV#status\\.languageStatus A>SPAN.codicon.wiggle{animation-duration:.8s;animation-iteration-count:1;animation-name:wiggle}@keyframes flash{0%{background-color:initial}50%{background-color:var(--vscode-statusBarItem-prominentBackground)}to{background-color:initial}}.monaco-workbench .statusbar DIV#status\\.languageStatus.flash A{animation-duration:.8s;animation-iteration-count:1;animation-name:flash}.monaco-workbench .hover-language-status{display:flex;padding:4px 8px}.monaco-workbench .hover-language-status:not(:last-child){border-bottom:1px solid var(--vscode-notifications-border)}.monaco-workbench .hover-language-status>.severity{display:none;flex:1;margin:auto;padding-right:8px}.monaco-workbench .hover-language-status>.severity.sev3{color:var(--vscode-notificationsErrorIcon-foreground)}.monaco-workbench .hover-language-status>.severity.sev2{color:var(--vscode-notificationsInfoIcon-foreground)}.monaco-workbench .hover-language-status>.severity.show{display:inherit}.monaco-workbench .hover-language-status>.element{display:flex;flex-grow:100;justify-content:space-between;vertical-align:middle}.monaco-workbench .hover-language-status>.element>.left>.detail:not(:empty):before{content:"\\2013";opacity:.6;padding:0 4px}.monaco-workbench .hover-language-status>.element>.left>.label:empty{display:none}.monaco-workbench .hover-language-status>.element .left{margin:auto 0}.monaco-workbench .hover-language-status>.element .right{display:flex;margin:auto 0}.monaco-workbench .hover-language-status>.element .right:not(:empty){padding-left:16px}.monaco-workbench .hover-language-status>.element .right .monaco-link{margin:auto 0;white-space:nowrap}.monaco-workbench .hover-language-status>.element .right .monaco-action-bar:not(:first-child){padding-left:8px}';he(JC,{});class Ch{constructor(e,t){this.combined=e,this.dedicated=t}isEqual(e){return wi(this.combined,e.combined)&&wi(this.dedicated,e.dedicated)}}let Wa=class{constructor(e,t){this._storageService=e,this._key=t}get value(){return this._storageService.getNumber(this._key,0,0)}increment(){const e=this.value+1;return this._storageService.store(this._key,e,0,1),e}};Wa=C([h(0,oe)],Wa);let hs=class Ht{constructor(e,t,i,o,s){this._languageStatusService=e,this._statusBarService=t,this._editorService=i,this._openerService=o,this._storageService=s,this._disposables=new x,this._dedicated=new Set,this._dedicatedEntries=new Map,this._renderDisposables=new x,s.onDidChangeValue(this._handleStorageChange,this,this._disposables),this._restoreState(),this._interactionCounter=new Wa(s,"languageStatus.interactCount"),e.onDidChange(this._update,this,this._disposables),i.onDidActiveEditorChange(this._update,this,this._disposables),this._update(),t.onDidChangeEntryVisibility(n=>{!n.visible&&this._dedicated.has(n.id)&&(this._dedicated.delete(n.id),this._update(),this._storeState())},this._disposables)}dispose(){var e;this._disposables.dispose(),(e=this._combinedEntry)==null||e.dispose(),ie(this._dedicatedEntries.values()),this._renderDisposables.dispose()}_handleStorageChange(e){e.key===Ht._keyDedicatedItems&&(this._restoreState(),this._update())}_restoreState(){const e=this._storageService.get(Ht._keyDedicatedItems,0,"[]");try{const t=JSON.parse(e);this._dedicated=new Set(t)}catch{this._dedicated.clear()}}_storeState(){if(this._dedicated.size===0)this._storageService.remove(Ht._keyDedicatedItems,0);else{const e=JSON.stringify(Array.from(this._dedicated.keys()));this._storageService.store(Ht._keyDedicatedItems,e,0,0)}}_createViewModel(e){if(!(e!=null&&e.hasModel()))return new Ch([],[]);const t=this._languageStatusService.getLanguageStatus(e.getModel()),i=[],o=[];for(const s of t)this._dedicated.has(s.id)&&o.push(s),i.push(s);return new Ch(i,o)}_update(){var o,s;const e=Zc(this._editorService.activeTextEditorControl),t=this._createViewModel(e);if((o=this._model)!=null&&o.isEqual(t))return;if(this._renderDisposables.clear(),this._model=t,e==null||e.onDidChangeModelLanguage(this._update,this,this._renderDisposables),t.combined.length===0)(s=this._combinedEntry)==null||s.dispose(),this._combinedEntry=void 0;else{const[n]=t.combined,r=n.severity>=Ut.Warning,a=Ht._severityToComboCodicon(n.severity);let d=!1;const l=[],p=document.createElement("div");for(const y of t.combined){const D=t.dedicated.includes(y);p.appendChild(this._renderStatus(y,r,D,this._renderDisposables)),l.push(this._asAriaLabel(y)),d=d||!D&&y.busy}const g={name:u("langStatus.name","Editor Language Status"),ariaLabel:u("langStatus.aria","Editor Language Status: {0}",l.join(", next: ")),tooltip:p,command:Rr,text:d?`${a}$(sync~spin)`:a};this._combinedEntry?this._combinedEntry.update(g):this._combinedEntry=this._statusBarService.addEntry(g,Ht._id,1,{id:"status.editor.mode",alignment:0,compact:!0});const f=this._interactionCounter.value>=3,b=document.querySelector(".monaco-workbench .statusbar DIV#status\\.languageStatus A>SPAN.codicon"),m=document.querySelector(".monaco-workbench .statusbar DIV#status\\.languageStatus");if(b instanceof HTMLElement&&m){const y="wiggle",D="flash";d?(b.classList.remove(y),m.classList.remove(D)):(b.classList.toggle(y,r||!f),this._renderDisposables.add(_(b,"animationend",L=>b.classList.remove(y))),m.classList.toggle(D,r),this._renderDisposables.add(_(m,"animationend",L=>m.classList.remove(D))))}if(!f){const y=document.querySelector(".monaco-workbench .context-view");if(y instanceof HTMLElement){const D=new MutationObserver(()=>{document.contains(p)&&(this._interactionCounter.increment(),D.disconnect())});D.observe(y,{childList:!0,subtree:!0}),this._renderDisposables.add(Y(()=>D.disconnect()))}}}const i=new Map;for(const n of t.dedicated){const r=Ht._asStatusbarEntry(n);let a=this._dedicatedEntries.get(n.id);a?(a.update(r),this._dedicatedEntries.delete(n.id)):a=this._statusBarService.addEntry(r,n.id,1,{id:"status.editor.mode",alignment:1}),i.set(n.id,a)}ie(this._dedicatedEntries.values()),this._dedicatedEntries=i}_renderStatus(e,t,i,o){const s=document.createElement("div");s.classList.add("hover-language-status");const n=document.createElement("div");n.classList.add("severity",`sev${e.severity}`),n.classList.toggle("show",t);const r=Ht._severityToSingleCodicon(e.severity);de(n,...qs(r)),s.appendChild(n);const a=document.createElement("div");a.classList.add("element"),s.appendChild(a);const d=document.createElement("div");d.classList.add("left"),a.appendChild(d);const l=document.createElement("span");l.classList.add("label"),de(l,...qs(e.busy?`$(sync~spin)${e.label}`:e.label)),d.appendChild(l);const p=document.createElement("span");p.classList.add("detail"),this._renderTextPlus(p,e.detail,o),d.appendChild(p);const g=document.createElement("div");g.classList.add("right"),a.appendChild(g);const{command:f}=e;f&&o.add(new $d(g,{label:f.title,title:f.tooltip,href:T.from({scheme:"command",path:f.id,query:f.arguments&&JSON.stringify(f.arguments)}).toString()},void 0,this._openerService));const b=new xo(g,{});o.add(b);let m;return i?m=new Z("unpin",u("unpin","Remove from Status Bar"),ge.asClassName(le.pinned),!0,()=>{this._dedicated.delete(e.id),this._statusBarService.updateEntryVisibility(e.id,!1),this._update(),this._storeState()}):m=new Z("pin",u("pin","Add to Status Bar"),ge.asClassName(le.pin),!0,()=>{this._dedicated.add(e.id),this._statusBarService.updateEntryVisibility(e.id,!0),this._update(),this._storeState()}),b.push(m,{icon:!0,label:!1}),o.add(m),s}static _severityToComboCodicon(e){switch(e){case Ut.Error:return"$(bracket-error)";case Ut.Warning:return"$(bracket-dot)";default:return"$(bracket)"}}static _severityToSingleCodicon(e){switch(e){case Ut.Error:return"$(error)";case Ut.Warning:return"$(info)";default:return"$(check)"}}_renderTextPlus(e,t,i){for(const o of Fv(t).nodes)if(typeof o=="string"){const s=qs(o);de(e,...s)}else i.add(new $d(e,o,void 0,this._openerService))}_asAriaLabel(e){return e.accessibilityInfo?e.accessibilityInfo.label:e.detail?u("aria.1","{0}, {1}",e.label,e.detail):u("aria.2","{0}",e.label)}static _asStatusbarEntry(e){var o,s,n;let t,i;return e.severity===Ut.Warning?(t=Xi(im),i=Xi(om)):e.severity===Ut.Error&&(t=Xi(sm),i=Xi(nm)),{name:u("name.pattern","{0} (Language Status)",e.name),text:e.busy?`${e.label}$(sync~spin)`:e.label,ariaLabel:((o=e.accessibilityInfo)==null?void 0:o.label)??e.label,role:(s=e.accessibilityInfo)==null?void 0:s.role,tooltip:((n=e.command)==null?void 0:n.tooltip)||new Nv(e.detail,{isTrusted:!0,supportThemeIcons:!0}),color:t,backgroundColor:i,command:e.command}}};hs._id="status.languageStatus";hs._keyDedicatedItems="languageStatus.dedicated";hs=C([h(0,tm),h(1,oi),h(2,P),h(3,zi),h(4,oe)],hs);M.as(tt.Workbench).registerWorkbenchContribution(hs,3);j(class extends ye{constructor(){super({id:"editor.inlayHints.Reset",title:{value:u("reset","Reset Language Status Interaction Counter"),original:"Reset Language Status Interaction Counter"},category:fe.View,f1:!0})}run(c){c.get(oe).remove("languageStatus.interactCount",0)}});const XC=new U("notebookEditable",!0),Ha="editor.detectLanguage";let kn=class Vp{constructor(e,t,i,o,s,n){this._languageDetectionService=e,this._statusBarService=t,this._configurationService=i,this._editorService=o,this._languageService=s,this._keybindingService=n,this._disposables=new x,this._delayer=new bu(1e3),this._renderDisposables=new x,o.onDidActiveEditorChange(()=>this._update(!0),this,this._disposables),this._update(!1)}dispose(){var e;this._disposables.dispose(),this._delayer.dispose(),(e=this._combinedEntry)==null||e.dispose(),this._renderDisposables.dispose()}_update(e){var t;e&&((t=this._combinedEntry)==null||t.dispose(),this._combinedEntry=void 0),this._delayer.trigger(()=>this._doUpdate())}async _doUpdate(){var a,d;const e=Zc(this._editorService.activeTextEditorControl);this._renderDisposables.clear(),e==null||e.onDidChangeModelLanguage(()=>this._update(!0),this,this._renderDisposables),e==null||e.onDidChangeModelContent(()=>this._update(!1),this,this._renderDisposables);const t=e==null?void 0:e.getModel(),i=t==null?void 0:t.uri,o=t==null?void 0:t.getLanguageId(),s=this._configurationService.getValue("workbench.editor.languageDetectionHints");if(!(typeof s=="object"&&(s==null?void 0:s.untitledEditors))||(i==null?void 0:i.scheme)!==Q.untitled||!o||!i)(a=this._combinedEntry)==null||a.dispose(),this._combinedEntry=void 0;else{const l=await this._languageDetectionService.detectLanguage(i),p={jsonc:"json"},g=t.getLanguageId();if(l&&l!==g&&p[g]!==l){const f=this._languageService.getLanguageName(l)||l;let b=u("status.autoDetectLanguage","Accept Detected Language: {0}",f);const m=this._keybindingService.lookupKeybinding(Ha),y=m==null?void 0:m.getLabel();y&&(b+=` (${y})`);const D={name:u("langDetection.name","Language Detection"),ariaLabel:u("langDetection.aria","Change to Detected Language: {0}",l),tooltip:b,command:Ha,text:"$(lightbulb-autofix)"};this._combinedEntry?this._combinedEntry.update(D):this._combinedEntry=this._statusBarService.addEntry(D,Vp._id,1,{id:"status.editor.mode",alignment:1,compact:!0})}else(d=this._combinedEntry)==null||d.dispose(),this._combinedEntry=void 0}}};kn._id="status.languageDetectionStatus";kn=C([h(0,Il),h(1,oi),h(2,O),h(3,P),h(4,Fl),h(5,ve)],kn);M.as(tt.Workbench).registerWorkbenchContribution(kn,3);j(class extends ye{constructor(){super({id:Ha,title:{value:u("detectlang","Detect Language from Content"),original:"Detect Language from Content"},f1:!0,precondition:v.and(XC.toNegated(),$i.editorTextFocus),keybinding:{primary:1570,weight:200}})}async run(c){var n,r;const e=c.get(P),t=c.get(Il),i=Zc(e.activeTextEditorControl),o=c.get(Ae),s=(n=i==null?void 0:i.getModel())==null?void 0:n.uri;if(s){const a=await t.detectLanguage(s);a?(r=i.getModel())==null||r.setLanguage(a,rm):o.warn(u("noDetection","Unable to detect editor language"))}}});let Ga=class extends V{constructor(e,t,i,o,s,n,r){super(),this.editorService=e,this.textFileService=t,this.lifecycleService=i,this.hostService=o,this.codeEditorService=s,this.filesConfigurationService=n,this.workingCopyEditorService=r,this.ensureDirtyFilesAreOpenedWorker=this._register(new Jl(a=>this.ensureDirtyTextFilesAreOpened(a),this.getDirtyTextFileTrackerDelay())),this.registerListeners()}registerListeners(){this._register(this.textFileService.files.onDidChangeDirty(e=>this.ensureDirtyFilesAreOpenedWorker.work(e.resource))),this._register(this.textFileService.files.onDidSaveError(e=>this.ensureDirtyFilesAreOpenedWorker.work(e.resource))),this._register(this.textFileService.untitled.onDidChangeDirty(e=>this.ensureDirtyFilesAreOpenedWorker.work(e.resource))),this._register(this.hostService.onDidChangeFocus(e=>e?this.reloadVisibleTextFileEditors():void 0)),this.lifecycleService.onDidShutdown(()=>this.dispose())}getDirtyTextFileTrackerDelay(){return 800}ensureDirtyTextFilesAreOpened(e){this.doEnsureDirtyTextFilesAreOpened(Li(e.filter(t=>{if(!this.textFileService.isDirty(t))return!1;const i=this.textFileService.files.get(t);if(i!=null&&i.hasState(2)||t.scheme!==Q.untitled&&this.filesConfigurationService.getAutoSaveMode()===1&&!(i!=null&&i.hasState(5))||this.editorService.isOpened({resource:t,typeId:t.scheme===Q.untitled?am.ID:Cc,editorId:We.id}))return!1;const o=i??this.textFileService.untitled.get(t);return!(o&&this.workingCopyEditorService.findEditor(o))}),t=>t.toString()))}doEnsureDirtyTextFilesAreOpened(e){e.length&&this.editorService.openEditors(e.map(t=>({resource:t,options:{inactive:!0,pinned:!0,preserveFocus:!0}})))}reloadVisibleTextFileEditors(){Li(Ge(this.codeEditorService.listCodeEditors().map(e=>{var o;const t=(o=e.getModel())==null?void 0:o.uri;if(!t)return;const i=this.textFileService.files.get(t);if(!(!i||i.isDirty()||!i.isResolved()))return i})),e=>e.resource.toString()).forEach(e=>this.textFileService.files.resolve(e.resource,{reload:{async:!0}}))}};Ga=C([h(0,P),h(1,Eo),h(2,_o),h(3,ti),h(4,qi),h(5,ms),h(6,Ic)],Ga);let ls=class Op extends Pw{constructor(e,t,i,o,s){super(Op.ID,{openInternal:(n,r)=>this.openInternal(n,r)},e,t,o),this.editorResolverService=i,this.editorGroupService=s}async openInternal(e,t){var i;if(e instanceof Ot&&((i=this.group)!=null&&i.activeEditor)){const o=this.group.activeEditor,s=o==null?void 0:o.toUntyped();if(!s)return;let n=await this.editorResolverService.resolveEditor({...s,options:{...t,override:Uo.PICK}},this.group);if(n===2)n=void 0;else if(n===1)return;if(io(n))for(const r of n.editor instanceof Nn?[n.editor.original,n.editor.modified]:[n.editor])r instanceof Ot&&(r.setForceOpenAsText(),r.setPreferredLanguageId(Tc));await(this.group??this.editorGroupService.activeGroup).replaceEditors([{editor:o,replacement:(n==null?void 0:n.editor)??e,options:{...(n==null?void 0:n.options)??t}}])}}getTitle(){return this.input?this.input.getName():u("binaryFileEditor","Binary File Viewer")}};ls.ID=cl;ls=C([h(0,Ne),h(1,te),h(2,_s),h(3,oe),h(4,ee)],ls);let Ua=class extends V{constructor(e,t,i,o,s,n,r){super(),this.fileService=e,this.configurationService=t,this.contextService=i,this.notificationService=o,this.openerService=s,this.uriIdentityService=n,this.hostService=r,this.watchedWorkspaces=new ot(a=>this.uriIdentityService.extUri.getComparisonKey(a)),this.registerListeners(),this.refresh()}registerListeners(){this._register(this.contextService.onDidChangeWorkspaceFolders(e=>this.onDidChangeWorkspaceFolders(e))),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.onDidChangeWorkbenchState())),this._register(this.configurationService.onDidChangeConfiguration(e=>this.onDidChangeConfiguration(e))),this._register(this.fileService.onDidWatchError(e=>this.onDidWatchError(e)))}onDidChangeWorkspaceFolders(e){for(const t of e.removed)this.unwatchWorkspace(t);for(const t of e.added)this.watchWorkspace(t)}onDidChangeWorkbenchState(){this.refresh()}onDidChangeConfiguration(e){(e.affectsConfiguration("files.watcherExclude")||e.affectsConfiguration("files.watcherInclude"))&&this.refresh()}onDidWatchError(e){const t=e.toString();t.indexOf("ENOSPC")>=0?this.notificationService.prompt(Fi.Warning,u("enospcError","Unable to watch for file changes in this large workspace folder. Please follow the instructions link to resolve this issue."),[{label:u("learnMore","Instructions"),run:()=>this.openerService.open(T.parse("https://go.microsoft.com/fwlink/?linkid=867693"))}],{sticky:!0,neverShowAgain:{id:"ignoreEnospcError",isSecondary:!0,scope:Bv.WORKSPACE}}):t.indexOf("EUNKNOWN")>=0&&this.notificationService.prompt(Fi.Warning,u("eshutdownError","File changes watcher stopped unexpectedly. A reload of the window may enable the watcher again unless the workspace cannot be watched for file changes."),[{label:u("reload","Reload"),run:()=>this.hostService.reload()}],{sticky:!0,priority:Wv.SILENT})}watchWorkspace(e){var n,r;const t=[],i=this.configurationService.getValue({resource:e.uri});if((n=i.files)!=null&&n.watcherExclude)for(const a in i.files.watcherExclude)i.files.watcherExclude[a]===!0&&t.push(a);const o=new ot(a=>this.uriIdentityService.extUri.getComparisonKey(a));if(o.set(e.uri,e.uri),(r=i.files)!=null&&r.watcherInclude){for(const a of i.files.watcherInclude)if(a)if(Hv(a)){const d=T.file(a).with({scheme:e.uri.scheme});this.uriIdentityService.extUri.isEqualOrParent(d,e.uri)&&o.set(d,d)}else{const d=e.toResource(a);o.set(d,d)}}const s=new x;for(const[,a]of o)s.add(this.fileService.watch(a,{recursive:!0,excludes:t}));this.watchedWorkspaces.set(e.uri,s)}unwatchWorkspace(e){this.watchedWorkspaces.has(e.uri)&&(ie(this.watchedWorkspaces.get(e.uri)),this.watchedWorkspaces.delete(e.uri))}refresh(){this.unwatchWorkspaces();for(const e of this.contextService.getWorkspace().folders)this.watchWorkspace(e)}unwatchWorkspaces(){for(const[,e]of this.watchedWorkspaces)e.dispose();this.watchedWorkspaces.clear()}dispose(){super.dispose(),this.unwatchWorkspaces()}};Ua=C([h(0,cm),h(1,O),h(2,ze),h(3,Ae),h(4,zi),h(5,si),h(6,ti)],Ua);let za=class extends V{constructor(e,t,i,o){super(),this.lifecycleService=e,this.activityService=t,this.workingCopyService=i,this.filesConfigurationService=o,this.badgeHandle=this._register(new Ie),this.lastKnownDirtyCount=0,this.updateActivityBadge(),this.registerListeners()}registerListeners(){this._register(this.workingCopyService.onDidChangeDirty(e=>this.onWorkingCopyDidChangeDirty(e))),this.lifecycleService.onDidShutdown(()=>this.dispose())}onWorkingCopyDidChangeDirty(e){const t=e.isDirty();t&&!(e.capabilities&2)&&this.filesConfigurationService.getAutoSaveMode()===1||(t||this.lastKnownDirtyCount>0)&&this.updateActivityBadge()}updateActivityBadge(){const e=this.lastKnownDirtyCount=this.workingCopyService.dirtyCount;e>0?this.badgeHandle.value=this.activityService.showViewContainerActivity($t,{badge:new to(e,t=>t===1?u("dirtyFile","1 unsaved file"):u("dirtyFiles","{0} unsaved files",e)),clazz:"explorer-viewlet-label"}):this.badgeHandle.clear()}};za=C([h(0,_o),h(1,So),h(2,Al),h(3,ms)],za);let Ka=class extends V{constructor(e,t,i){super(),this.textEditorService=t,this.fileService=i,this._register(e.registerHandler(this))}handles(e){return e.typeId===Vd&&this.fileService.canHandleResource(e.resource)}handlesSync(e){return e.typeId===Vd&&this.fileService.hasProvider(e.resource)}isOpen(e,t){return this.handlesSync(e)?Re(e.resource,t.resource):!1}createEditor(e){return this.textEditorService.createTextEditor({resource:e.resource,forceFile:!0})}};Ka=C([h(0,Ic),h(1,Hn),h(2,Ce)],Ka);let us=class Rp extends dm{constructor(e,t,i,o,s,n,r,a,d,l,p,g,f,b,m,y,D){super(Rp.ID,e,o,n,r,d,a,l,t),this.paneCompositeService=i,this.contextService=s,this.textFileService=p,this.explorerService=g,this.uriIdentityService=f,this.pathService=b,this.configurationService=m,this.preferencesService=y,this.hostService=D,this._register(this.fileService.onDidFilesChange(L=>this.onDidFilesChange(L))),this._register(this.fileService.onDidRunOperation(L=>this.onDidRunOperation(L)))}onDidFilesChange(e){for(const t of e.rawDeleted)this.clearEditorViewState(t)}onDidRunOperation(e){e.operation===2&&e.target&&this.moveEditorViewState(e.resource,e.target.resource,this.uriIdentityService.extUri)}getTitle(){return this.input?this.input.getName():u("textFileEditor","Text File Editor")}get input(){return this._input}async setInput(e,t,i,o){Hs("code/willSetInputToTextFileEditor"),await super.setInput(e,t,i,o);try{const s=await e.resolve(t);if(o.isCancellationRequested)return;if(s instanceof Eu)return this.openAsBinary(e,t);const n=s,r=K(this.editorControl);if(r.setModel(n.textEditorModel),!hm(t==null?void 0:t.viewState)){const a=this.loadEditorViewState(e,i);a&&(t!=null&&t.selection&&(a.cursorState=[]),r.restoreViewState(a))}t&&lm(t,r,1),r.updateOptions(this.getReadonlyConfiguration(n.isReadonly()))}catch(s){await this.handleSetInputError(s,e,t)}Hs("code/didSetInputToTextFileEditor")}async handleSetInputError(e,t,i){if(e.textFileOperationResult===0)return this.openAsBinary(t,i);if(e.fileOperationResult===0){const o=[];throw o.push(Ee({id:"workbench.files.action.openFolder",label:u("openFolder","Open Folder"),run:async()=>this.hostService.openWindow([{folderUri:t.resource}],{forceNewWindow:!0})})),this.contextService.isInsideWorkspace(t.preferredResource)&&o.push(Ee({id:"workbench.files.action.reveal",label:u("reveal","Reveal Folder"),run:async()=>(await this.paneCompositeService.openPaneComposite($t,0,!0),this.explorerService.select(t.preferredResource,!0))})),Od(u("fileIsDirectory","The file is not displayed in the text editor because it is a directory."),o,{forceMessage:!0})}if(e.fileOperationResult===7&&this.group){let o;throw e instanceof Gv?o=u("fileTooLargeForHeapErrorWithSize","The file is not displayed in the text editor because it is very large ({0}).",Xl.formatSize(e.size)):o=u("fileTooLargeForHeapErrorWithoutSize","The file is not displayed in the text editor because it is very large."),um(this.group,t,i,o,this.preferencesService)}throw e.fileOperationResult===1&&await this.pathService.hasValidBasename(t.preferredResource)?Od(new vu(u("unavailableResourceErrorEditorText","The editor could not be opened because the file was not found."),1),[Ee({id:"workbench.files.action.createMissingFile",label:u("createFile","Create File"),run:async()=>(await this.textFileService.create([{resource:t.preferredResource}]),this.editorService.openEditor({resource:t.preferredResource,options:{pinned:!0}}))})],{allowDialog:!0}):e}openAsBinary(e,t){const i=this.configurationService.getValue("workbench.editor.defaultBinaryEditor"),o=this.group??this.editorGroupService.activeGroup,s={...t,activation:pi.PRESERVE};i&&i!==""&&i!==We.id?this.doOpenAsBinaryInDifferentEditor(o,i,e,s):this.doOpenAsBinaryInSameEditor(o,i,e,s)}doOpenAsBinaryInDifferentEditor(e,t,i,o){this.editorService.replaceEditors([{editor:i,replacement:{resource:i.resource,options:{...o,override:t}}}],e)}doOpenAsBinaryInSameEditor(e,t,i,o){t===We.id?(i.setForceOpenAsText(),i.setPreferredLanguageId(Tc),o={...o,forceReload:!0}):i.setForceOpenAsBinary(),e.openEditor(i,o)}clearInput(){var e;super.clearInput(),(e=this.editorControl)==null||e.setModel(null)}createEditorControl(e,t){Hs("code/willCreateTextFileEditorControl"),super.createEditorControl(e,t),Hs("code/didCreateTextFileEditorControl")}tracksEditorViewState(e){return e instanceof Ot}tracksDisposedEditorViewState(){return!0}};us.ID=dl;us=C([h(0,Ne),h(1,Ce),h(2,Si),h(3,I),h(4,ze),h(5,oe),h(6,To),h(7,P),h(8,te),h(9,ee),h(10,Eo),h(11,nt),h(12,si),h(13,Mn),h(14,O),h(15,pc),h(16,ti)],us);let $a=class{constructor(e){e.registerFormatter({scheme:Q.file,formatting:{label:"${authority}${path}",separator:$o,tildify:!Vt,normalizeDriveLetter:Vt,authorityPrefix:$o+$o,workspaceSuffix:""}})}};$a=C([h(0,Ft)],$a);M.as(ii.EditorPane).registerEditorPane(Ss.create(us,us.ID,u("textFileEditor","Text File Editor")),[new W(Ot)]);M.as(ii.EditorPane).registerEditorPane(Ss.create(ls,ls.ID,u("binaryFileEditor","Binary File Editor")),[new W(Ot)]);M.as(ii.EditorFactory).registerFileEditorFactory({typeId:Cc,createFileEditor:(c,e,t,i,o,s,n,r)=>r.createInstance(Ot,c,e,t,i,o,s,n),isFileEditor:c=>c instanceof Ot});M.as(tt.Workbench).registerWorkbenchContribution(Ka,2);M.as(tt.Workbench).registerWorkbenchContribution(pm,1);M.as(tt.Workbench).registerWorkbenchContribution(Ga,1);M.as(tt.Workbench).registerWorkbenchContribution(wa,1);M.as(tt.Workbench).registerWorkbenchContribution($a,1);M.as(tt.Workbench).registerWorkbenchContribution(Ua,3);M.as(tt.Workbench).registerWorkbenchContribution(za,1);wu.addImplementation(110,"explorer",c=>{const e=c.get(Xn),t=c.get(nt),o=c.get(O).getValue().explorer.enableUndo;return t.hasViewFocus()&&e.canUndo(rs)&&o?(e.undo(rs),!0):!1});yu.addImplementation(110,"explorer",c=>{const e=c.get(Xn),t=c.get(nt),o=c.get(O).getValue().explorer.enableUndo;return t.hasViewFocus()&&e.canRedo(rs)&&o?(e.redo(rs),!0):!1});Uv.registerLanguage({id:Tc,aliases:["Binary"],mimetypes:["text/x-code-binary"]});let xn=class Zs extends V{get count(){return this.mostRecentEditorsMap.size}get editors(){return[...this.mostRecentEditorsMap.values()]}hasEditor(e){const t=this.editorsPerResourceCounter.get(e.resource);return(t==null?void 0:t.has(this.toIdentifier(e)))??!1}hasEditors(e){return this.editorsPerResourceCounter.has(e)}toIdentifier(e,t){return typeof e!="string"?this.toIdentifier(e.typeId,e.editorId):t?`${e}/${t}`:e}constructor(e,t){super(),this.editorGroupsService=e,this.storageService=t,this.keyMap=new Map,this.mostRecentEditorsMap=new zv,this.editorsPerResourceCounter=new ot,this._onDidMostRecentlyActiveEditorsChange=this._register(new w),this.onDidMostRecentlyActiveEditorsChange=this._onDidMostRecentlyActiveEditorsChange.event,this.registerListeners()}registerListeners(){this._register(this.storageService.onWillSaveState(()=>this.saveState())),this._register(this.editorGroupsService.onDidAddGroup(e=>this.onGroupAdded(e))),this._register(this.editorGroupsService.onDidChangeEditorPartOptions(e=>this.onDidChangeEditorPartOptions(e))),this.editorGroupsService.whenReady.then(()=>this.loadState())}onGroupAdded(e){const t=e.getEditors(0);for(let i=t.length-1;i>=0;i--)this.addMostRecentEditor(e,t[i],!1,!0);this.editorGroupsService.activeGroup===e&&e.activeEditor&&this.addMostRecentEditor(e,e.activeEditor,!0,!1),this.registerGroupListeners(e)}registerGroupListeners(e){const t=new x;t.add(e.onDidModelChange(i=>{switch(i.kind){case 0:{this.editorGroupsService.activeGroup===e&&e.activeEditor&&this.addMostRecentEditor(e,e.activeEditor,!0,!1);break}case 3:{i.editor&&(this.addMostRecentEditor(e,i.editor,!1,!0),this.ensureOpenedEditorsLimit({groupId:e.id,editor:i.editor},e.id));break}}})),t.add(e.onDidCloseEditor(i=>{this.removeMostRecentEditor(e,i.editor)})),t.add(e.onDidActiveEditorChange(i=>{i.editor&&this.addMostRecentEditor(e,i.editor,this.editorGroupsService.activeGroup===e,!1)})),A.once(e.onWillDispose)(()=>ie(t))}onDidChangeEditorPartOptions(e){if(!Uc(e.newPartOptions.limit,e.oldPartOptions.limit)){const t=this.editorGroupsService.activeGroup;let i;t.activeEditor&&(i={editor:t.activeEditor,groupId:t.id}),this.ensureOpenedEditorsLimit(i)}}addMostRecentEditor(e,t,i,o){const s=this.ensureKey(e,t),n=this.mostRecentEditorsMap.first;i||!n?this.mostRecentEditorsMap.set(s,s,n?1:void 0):(this.mostRecentEditorsMap.set(s,s,1),this.mostRecentEditorsMap.set(n,n,1)),o&&this.updateEditorResourcesMap(t,!0),this._onDidMostRecentlyActiveEditorsChange.fire()}updateEditorResourcesMap(e,t){let i,o,s;if(e instanceof Et?(i=e.primary.resource,o=e.primary.typeId,s=e.primary.editorId):(i=e.resource,o=e.typeId,s=e.editorId),!i)return;const n=this.toIdentifier(o,s);if(t){let r=this.editorsPerResourceCounter.get(i);r||(r=new Map,this.editorsPerResourceCounter.set(i,r)),r.set(n,(r.get(n)??0)+1)}else{const r=this.editorsPerResourceCounter.get(i);if(r){const a=r.get(n)??0;a>1?r.set(n,a-1):(r.delete(n),r.size===0&&this.editorsPerResourceCounter.delete(i))}}}removeMostRecentEditor(e,t){this.updateEditorResourcesMap(t,!1);const i=this.findKey(e,t);if(i){this.mostRecentEditorsMap.delete(i);const o=this.keyMap.get(e.id);o&&o.delete(i.editor)&&o.size===0&&this.keyMap.delete(e.id),this._onDidMostRecentlyActiveEditorsChange.fire()}}findKey(e,t){const i=this.keyMap.get(e.id);if(i)return i.get(t)}ensureKey(e,t){let i=this.keyMap.get(e.id);i||(i=new Map,this.keyMap.set(e.id,i));let o=i.get(t);return o||(o={groupId:e.id,editor:t},i.set(t,o)),o}async ensureOpenedEditorsLimit(e,t){var o,s;if(!((o=this.editorGroupsService.partOptions.limit)!=null&&o.enabled)||typeof this.editorGroupsService.partOptions.limit.value!="number"||this.editorGroupsService.partOptions.limit.value<=0)return;const i=this.editorGroupsService.partOptions.limit.value;if((s=this.editorGroupsService.partOptions.limit)!=null&&s.perEditorGroup)if(typeof t=="number"){const n=this.editorGroupsService.getGroup(t);n&&await this.doEnsureOpenedEditorsLimit(i,n.getEditors(0).map(r=>({editor:r,groupId:t})),e)}else for(const n of this.editorGroupsService.groups)await this.ensureOpenedEditorsLimit(e,n.id);else await this.doEnsureOpenedEditorsLimit(i,[...this.mostRecentEditorsMap.values()],e)}async doEnsureOpenedEditorsLimit(e,t,i){var a;let o;if((a=this.editorGroupsService.partOptions.limit)!=null&&a.excludeDirty?o=t.filter(({editor:d})=>!(d.isDirty()&&!d.isSaving()||d.hasCapability(512))):o=t,e>=o.length)return;const s=o.reverse().filter(({editor:d,groupId:l})=>{var p;return!(d.isDirty()&&!d.isSaving()||d.hasCapability(512)||i&&d===i.editor&&l===i.groupId||(p=this.editorGroupsService.getGroup(l))!=null&&p.isSticky(d))});let n=o.length-e;const r=new Map;for(const{groupId:d,editor:l}of s){let p=r.get(d);if(p||(p=[],r.set(d,p)),p.push(l),n--,n===0)break}for(const[d,l]of r){const p=this.editorGroupsService.getGroup(d);p&&await p.closeEditors(l,{preserveFocus:!0})}}saveState(){this.mostRecentEditorsMap.isEmpty()?this.storageService.remove(Zs.STORAGE_KEY,1):this.storageService.store(Zs.STORAGE_KEY,JSON.stringify(this.serialize()),1,1)}serialize(){const e=M.as(ii.EditorFactory),t=[...this.mostRecentEditorsMap.values()],i=new Map;return{entries:Ge(t.map(({editor:o,groupId:s})=>{const n=this.editorGroupsService.getGroup(s);if(!n)return;let r=i.get(n);r||(r=n.getEditors(1).filter(d=>{const l=e.getEditorSerializer(d);return l==null?void 0:l.canSerialize(d)}),i.set(n,r));const a=r.indexOf(o);if(a!==-1)return{groupId:s,index:a}}))}}loadState(){const e=this.storageService.get(Zs.STORAGE_KEY,1);if(e)this.deserialize(JSON.parse(e));else{const t=this.editorGroupsService.getGroups(1);for(let i=t.length-1;i>=0;i--){const o=t[i],s=o.getEditors(0);for(let n=s.length-1;n>=0;n--)this.addMostRecentEditor(o,s[n],!0,!0)}}for(const t of this.editorGroupsService.groups)this.registerGroupListeners(t)}deserialize(e){const t=[];for(const{groupId:i,index:o}of e.entries){const s=this.editorGroupsService.getGroup(i);if(!s)continue;const n=s.getEditorByIndex(o);if(!n)continue;const r=this.ensureKey(s,n);t.push([r,r]),this.updateEditorResourcesMap(n,!0)}this.mostRecentEditorsMap.fromJSON(t)}};xn.STORAGE_KEY="editors.mru";xn=C([h(0,ee),h(1,oe)],xn);let qa=class extends V{constructor(e,t,i,o,s,n,r,a,d,l){super(),this.editorGroupService=e,this.instantiationService=t,this.fileService=i,this.configurationService=o,this.contextService=s,this.uriIdentityService=n,this.editorResolverService=r,this.workspaceTrustRequestService=a,this.hostService=d,this.textEditorService=l,this._onDidActiveEditorChange=this._register(new w),this.onDidActiveEditorChange=this._onDidActiveEditorChange.event,this._onDidVisibleEditorsChange=this._register(new w),this.onDidVisibleEditorsChange=this._onDidVisibleEditorsChange.event,this._onDidEditorsChange=this._register(new w),this.onDidEditorsChange=this._onDidEditorsChange.event,this._onDidCloseEditor=this._register(new w),this.onDidCloseEditor=this._onDidCloseEditor.event,this._onDidOpenEditorFail=this._register(new w),this.onDidOpenEditorFail=this._onDidOpenEditorFail.event,this._onDidMostRecentlyActiveEditorsChange=this._register(new w),this.onDidMostRecentlyActiveEditorsChange=this._onDidMostRecentlyActiveEditorsChange.event,this.lastActiveEditor=void 0,this.activeOutOfWorkspaceWatchers=new ot,this.closeOnFileDelete=!1,this.editorsObserver=this._register(this.instantiationService.createInstance(xn)),this.onConfigurationUpdated(),this.registerListeners()}registerListeners(){this.editorGroupService.whenReady.then(()=>this.onEditorGroupsReady()),this.editorGroupService.onDidChangeActiveGroup(e=>this.handleActiveEditorChange(e)),this.editorGroupService.onDidAddGroup(e=>this.registerGroupListeners(e)),this.editorsObserver.onDidMostRecentlyActiveEditorsChange(()=>this._onDidMostRecentlyActiveEditorsChange.fire()),this._register(this.onDidVisibleEditorsChange(()=>this.handleVisibleEditorsChange())),this._register(this.fileService.onDidRunOperation(e=>this.onDidRunFileOperation(e))),this._register(this.fileService.onDidFilesChange(e=>this.onDidFilesChange(e))),this._register(this.configurationService.onDidChangeConfiguration(e=>this.onConfigurationUpdated(e)))}onEditorGroupsReady(){for(const e of this.editorGroupService.groups)this.registerGroupListeners(e);this.activeEditor&&(this.doHandleActiveEditorChangeEvent(),this._onDidVisibleEditorsChange.fire())}handleActiveEditorChange(e){e===this.editorGroupService.activeGroup&&(!this.lastActiveEditor&&!e.activeEditor||this.doHandleActiveEditorChangeEvent())}doHandleActiveEditorChangeEvent(){const e=this.editorGroupService.activeGroup;this.lastActiveEditor=At(e.activeEditor),this._onDidActiveEditorChange.fire()}registerGroupListeners(e){const t=new x;t.add(e.onDidModelChange(i=>{this._onDidEditorsChange.fire({groupId:e.id,event:i})})),t.add(e.onDidActiveEditorChange(()=>{this.handleActiveEditorChange(e),this._onDidVisibleEditorsChange.fire()})),t.add(e.onDidCloseEditor(i=>{this._onDidCloseEditor.fire(i)})),t.add(e.onDidOpenEditorFail(i=>{this._onDidOpenEditorFail.fire({editor:i,groupId:e.id})})),A.once(e.onWillDispose)(()=>{ie(t)})}handleVisibleEditorsChange(){const e=new jr;for(const t of this.visibleEditors){const i=Li(Ge([ne.getCanonicalUri(t,{supportSideBySide:J.PRIMARY}),ne.getCanonicalUri(t,{supportSideBySide:J.SECONDARY})]),o=>o.toString());for(const o of i)this.fileService.hasProvider(o)&&!this.contextService.isInsideWorkspace(o)&&e.add(o)}for(const t of this.activeOutOfWorkspaceWatchers.keys())e.has(t)||(ie(this.activeOutOfWorkspaceWatchers.get(t)),this.activeOutOfWorkspaceWatchers.delete(t));for(const t of e.keys())if(!this.activeOutOfWorkspaceWatchers.get(t)){const i=this.fileService.watch(t);this.activeOutOfWorkspaceWatchers.set(t,i)}}async onDidRunFileOperation(e){e.isOperation(2)&&this.handleMovedFile(e.resource,e.target.resource),(e.isOperation(1)||e.isOperation(2))&&this.handleDeletedFile(e.resource,!1,e.target?e.target.resource:void 0)}onDidFilesChange(e){e.gotDeleted()&&this.handleDeletedFile(e,!0)}async handleMovedFile(e,t){for(const i of this.editorGroupService.groups){const o=[];for(const s of i.editors){const n=s.resource;if(!n||!this.uriIdentityService.extUri.isEqualOrParent(n,e))continue;let r;if(this.uriIdentityService.extUri.isEqual(e,n))r=t;else{const l=Kv(n.path,e.path,this.uriIdentityService.extUri.ignorePathCasing(n));r=Qo(t,n.path.substr(l+e.path.length+1))}const a=await s.rename(i.id,r);if(!a)return;const d={preserveFocus:!0,pinned:i.isPinned(s),sticky:i.isSticky(s),index:i.getIndexOfEditor(s),inactive:!i.isActive(s)};pe(a.editor)?o.push({editor:s,replacement:a.editor,options:{...a.options,...d}}):o.push({editor:s,replacement:{...a.editor,options:{...a.editor.options,...d}}})}o.length&&this.replaceEditors(o,i)}}onConfigurationUpdated(e){var i,o;if(e&&!e.affectsConfiguration("workbench.editor.closeOnFileDelete"))return;const t=this.configurationService.getValue();typeof((o=(i=t.workbench)==null?void 0:i.editor)==null?void 0:o.closeOnFileDelete)=="boolean"?this.closeOnFileDelete=t.workbench.editor.closeOnFileDelete:this.closeOnFileDelete=!1}handleDeletedFile(e,t,i){for(const o of this.getAllNonDirtyEditors({includeUntitled:!1,supportSideBySide:!0}))(async()=>{const s=o.resource;if(s&&(this.closeOnFileDelete||!t)){if(i&&this.uriIdentityService.extUri.isEqualOrParent(s,i))return;let n=!1;if(e instanceof no?n=e.contains(s,2):n=this.uriIdentityService.extUri.isEqualOrParent(s,e),!n)return;let r=!1;t&&this.fileService.hasProvider(s)&&(await Yn(100),r=await this.fileService.exists(s)),!r&&!o.isDisposed()&&o.dispose()}})()}getAllNonDirtyEditors(e){const t=[];function i(o){o.hasCapability(4)&&!e.includeUntitled||o.isDirty()||t.push(o)}for(const o of this.editors)e.supportSideBySide&&o instanceof Et?(i(o.primary),i(o.secondary)):i(o);return t}get activeEditorPane(){var e;return(e=this.editorGroupService.activeGroup)==null?void 0:e.activeEditorPane}get activeTextEditorControl(){const e=this.activeEditorPane;if(e){const t=e.getControl();if(so(t)||zo(t))return t;if($v(t)&&so(t.activeCodeEditor))return t.activeCodeEditor}}get activeTextEditorLanguageId(){var i;let e;const t=this.activeTextEditorControl;return zo(t)?e=t.getModifiedEditor():e=t,(i=e==null?void 0:e.getModel())==null?void 0:i.getLanguageId()}get count(){return this.editorsObserver.count}get editors(){return this.getEditors(1).map(({editor:e})=>e)}getEditors(e,t){switch(e){case 0:return t!=null&&t.excludeSticky?this.editorsObserver.editors.filter(({groupId:i,editor:o})=>{var s;return!((s=this.editorGroupService.getGroup(i))!=null&&s.isSticky(o))}):this.editorsObserver.editors;case 1:{const i=[];for(const o of this.editorGroupService.getGroups(2))i.push(...o.getEditors(1,t).map(s=>({editor:s,groupId:o.id})));return i}}}get activeEditor(){const e=this.editorGroupService.activeGroup;return e?At(e.activeEditor):void 0}get visibleEditorPanes(){return Ge(this.editorGroupService.groups.map(e=>e.activeEditorPane))}get visibleTextEditorControls(){const e=[];for(const t of this.visibleEditorPanes){const i=t.getControl();(so(i)||zo(i))&&e.push(i)}return e}get visibleEditors(){return Ge(this.editorGroupService.groups.map(e=>e.activeEditor))}async openEditor(e,t,i){let o,s=pe(e)?t:e.options,n;if(gm(t)&&(i=t),!pe(e)){const r=await this.editorResolverService.resolveEditor(e,i);if(r===1)return;Bo(r)&&(o=r.editor,s=r.options,n=r.group)}if(o||(o=pe(e)?e:await this.textEditorService.resolveTextEditor(e)),!n){let r;[n,r]=this.instantiationService.invokeFunction(vn,{editor:o,options:s},i),r&&(s={...s,activation:r})}return n.openEditor(o,s)}async openEditors(e,t,i){if(i!=null&&i.validateTrust&&!await this.handleWorkspaceTrust(e))return[];const o=new Map;for(const n of e){let r,a;if(!io(n)){const l=await this.editorResolverService.resolveEditor(n,t);if(l===1)continue;Bo(l)&&(r=l,a=l.group)}r||(r=io(n)?n:{editor:await this.textEditorService.resolveTextEditor(n),options:n.options}),a||([a]=this.instantiationService.invokeFunction(vn,r,t));let d=o.get(a);d||(d=[],o.set(a,d)),d.push(r)}const s=[];for(const[n,r]of o)s.push(n.openEditors(r));return Ge(await Go.settled(s))}async handleWorkspaceTrust(e){const{resources:t,diffMode:i,mergeMode:o}=this.extractEditorResources(e);switch(await this.workspaceTrustRequestService.requestOpenFilesTrust(t)){case 1:return!0;case 2:return await this.hostService.openWindow(t.map(n=>({fileUri:n})),{forceNewWindow:!0,diffMode:i,mergeMode:o}),!1;case 3:return!1}}extractEditorResources(e){const t=new jr;let i=!1,o=!1;for(const s of e)if(io(s)){const n=ne.getOriginalUri(s.editor,{supportSideBySide:J.BOTH});T.isUri(n)?t.add(n):n&&(n.primary&&t.add(n.primary),n.secondary&&t.add(n.secondary),i=s.editor instanceof Nn)}else Tl(s)&&(T.isUri(s.input1)&&t.add(s.input1.resource),T.isUri(s.input2)&&t.add(s.input2.resource),T.isUri(s.base)&&t.add(s.base.resource),T.isUri(s.result)&&t.add(s.result.resource),o=!0),zs(s)?(T.isUri(s.original.resource)&&t.add(s.original.resource),T.isUri(s.modified.resource)&&t.add(s.modified.resource),i=!0):Jo(s)&&t.add(s.resource);return{resources:Array.from(t.keys()),diffMode:i,mergeMode:o}}isOpened(e){return this.editorsObserver.hasEditor({resource:this.uriIdentityService.asCanonicalUri(e.resource),typeId:e.typeId,editorId:e.editorId})}isVisible(e){var t;for(const i of this.editorGroupService.groups)if((t=i.activeEditor)!=null&&t.matches(e))return!0;return!1}async closeEditor({editor:e,groupId:t},i){const o=this.editorGroupService.getGroup(t);await(o==null?void 0:o.closeEditor(e,i))}async closeEditors(e,t){const i=new Map;for(const{editor:o,groupId:s}of e){const n=this.editorGroupService.getGroup(s);if(!n)continue;let r=i.get(n);r||(r=[],i.set(n,r)),r.push(o)}for(const[o,s]of i)await o.closeEditors(s,t)}findEditors(e,t,i){const o=T.isUri(e)?e:e.resource,s=T.isUri(e)?void 0:e.typeId;if((t==null?void 0:t.supportSideBySide)!==J.ANY&&(t==null?void 0:t.supportSideBySide)!==J.SECONDARY&&!this.editorsObserver.hasEditors(o))return T.isUri(e)||Ai(i)?[]:void 0;if(Ai(i)){const n=[];for(const r of this.editorGroupService.getGroups(1)){const a=[];if(T.isUri(e))a.push(...this.findEditors(e,t,r));else{const d=this.findEditors(e,t,r);d&&a.push(d)}n.push(...a.map(d=>({editor:d,groupId:r.id})))}return n}else{const n=typeof i=="number"?this.editorGroupService.getGroup(i):i;if(T.isUri(e))return n?n.findEditors(o,t):[];{if(!n)return;const r=n.findEditors(o,t);for(const a of r)if(a.typeId===s)return a;return}}}async replaceEditors(e,t){const i=typeof t=="number"?this.editorGroupService.getGroup(t):t,o=[];for(const s of e){let n;if(!pe(s.replacement)){const r=await this.editorResolverService.resolveEditor(s.replacement,i);if(r===1)continue;Bo(r)&&(n={editor:s.editor,replacement:r.editor,options:r.options,forceReplaceDirty:s.forceReplaceDirty})}n||(n={editor:s.editor,replacement:Rd(s)?s.replacement:await this.textEditorService.resolveTextEditor(s.replacement),options:Rd(s)?s.options:s.replacement.options,forceReplaceDirty:s.forceReplaceDirty}),o.push(n)}return i==null?void 0:i.replaceEditors(o)}async save(e,t){Array.isArray(e)||(e=[e]);const i=this.getUniqueEditors(e),o=[],s=[];if(t!=null&&t.saveAs)s.push(...i);else for(const{groupId:r,editor:a}of i)a.hasCapability(4)?s.push({groupId:r,editor:a}):o.push({groupId:r,editor:a});const n=await Go.settled(o.map(({groupId:r,editor:a})=>{var d;return(t==null?void 0:t.reason)===1&&((d=this.editorGroupService.getGroup(r))==null||d.pinEditor(a)),a.save(r,t)}));for(const{groupId:r,editor:a}of s){if(a.isDisposed())continue;const d=await this.openEditor(a,r),l={pinned:!0,viewState:d==null?void 0:d.getViewState()},p=t!=null&&t.saveAs?await a.saveAs(r,t):await a.save(r,t);if(n.push(p),!p)break;if(!a.matches(p)){const g=a.hasCapability(4)?this.editorGroupService.groups.map(f=>f.id):[r];for(const f of g)p instanceof Vl?await this.replaceEditors([{editor:a,replacement:p,options:l}],f):await this.replaceEditors([{editor:a,replacement:{...p,options:l}}],f)}}return{success:n.every(r=>!!r),editors:Ge(n)}}saveAll(e){return this.save(this.getAllModifiedEditors(e),e)}async revert(e,t){Array.isArray(e)||(e=[e]);const i=this.getUniqueEditors(e);return await Go.settled(i.map(async({groupId:o,editor:s})=>{var n;return(n=this.editorGroupService.getGroup(o))==null||n.pinEditor(s),s.revert(o,t)})),!i.some(({editor:o})=>o.isDirty())}async revertAll(e){return this.revert(this.getAllModifiedEditors(e),e)}getAllModifiedEditors(e){var i;const t=[];for(const o of this.editorGroupService.getGroups(1))for(const s of o.getEditors(0))s.isModified()&&((typeof(e==null?void 0:e.includeUntitled)=="boolean"||!((i=e==null?void 0:e.includeUntitled)!=null&&i.includeScratchpad))&&s.hasCapability(512)||!(e!=null&&e.includeUntitled)&&s.hasCapability(4)||e!=null&&e.excludeSticky&&o.isSticky(s)||t.push({groupId:o.id,editor:s}));return t}getUniqueEditors(e){const t=[];for(const{editor:i,groupId:o}of e)t.some(s=>s.editor.matches(i))||t.push({editor:i,groupId:o});return t}dispose(){super.dispose(),this.activeOutOfWorkspaceWatchers.forEach(e=>ie(e)),this.activeOutOfWorkspaceWatchers.clear()}};qa=C([h(0,ee),h(1,I),h(2,Ce),h(3,O),h(4,ze),h(5,si),h(6,_s),h(7,Cu),h(8,ti),h(9,Hn)],qa);let Co=class li extends V{constructor(e,t,i,o,s,n,r,a,d){super(),this.editorGroupService=e,this.instantiationService=t,this.configurationService=i,this.quickInputService=o,this.notificationService=s,this.telemetryService=n,this.storageService=r,this.extensionService=a,this.logService=d,this._onDidChangeEditorRegistrations=this._register(new qv),this.onDidChangeEditorRegistrations=this._onDidChangeEditorRegistrations.event,this._editors=new Map,this._flattenedEditors=new Map,this._shouldReFlattenEditors=!0,this.cache=new Set(JSON.parse(this.storageService.get(li.cacheStorageID,0,JSON.stringify([])))),this.storageService.remove(li.cacheStorageID,0),this._register(this.storageService.onWillSaveState(()=>{this.cacheEditors()})),this.extensionService.onDidRegisterExtensions(()=>{this.cache=void 0})}resolveUntypedInputAndGroup(e,t){const i=e,[o,s]=this.instantiationService.invokeFunction(vn,i,t);return[i,o,s]}async resolveEditor(e,t){var p,g,f,b;if(this._flattenedEditors=this._flattenEditorsMap(),Ld(e))return this.doResolveSideBySideEditor(e,t);const i=this.resolveUntypedInputAndGroup(e,t);if(!i)return 2;const[o,s,n]=i;n&&(o.options={...o.options,activation:n});let r=ne.getCanonicalUri(o,{supportSideBySide:J.PRIMARY});if(this.cache&&r&&this.resourceMatchesCache(r)&&await this.extensionService.whenInstalledExtensionsRegistered(),r===void 0)r=T.from({scheme:Q.untitled});else if(r.scheme===void 0||r===null)return 2;if(((p=o.options)==null?void 0:p.override)===Uo.PICK){const m=await this.doPickEditor(o);if(!m)return 1;o.options=m}let{editor:a,conflictingDefault:d}=this.getEditor(r,(g=o.options)==null?void 0:g.override);if(!a&&((f=o.options)!=null&&f.override||io(e)))return 2;if(!a){const m=this.getEditor(r,We.id);if(a=m==null?void 0:m.editor,d=m==null?void 0:m.conflictingDefault,!a)return 2}if(zs(o)&&((b=o.options)==null?void 0:b.override)===void 0){let m=ne.getCanonicalUri(o,{supportSideBySide:J.SECONDARY});m||(m=T.from({scheme:Q.untitled}));const{editor:y}=this.getEditor(m,void 0);if(!y||a.editorInfo.id!==y.editorInfo.id){const{editor:D,conflictingDefault:L}=this.getEditor(r,We.id);a=D,d=L}if(!a)return 2}if(o.options={override:a.editorInfo.id,...o.options},a.editorFactoryObject.createDiffEditorInput===void 0&&zs(o))return 2;const l=await this.doResolveEditor(o,s,a);return d&&l&&await this.doHandleConflictingDefaults(r,a.editorInfo.label,o,l.editor,s),l?(this.sendEditorResolutionTelemetry(l.editor),l.editor.editorId!==a.editorInfo.id&&this.logService.warn(`Editor ID Mismatch: ${l.editor.editorId} !== ${a.editorInfo.id}. This will cause bugs. Please ensure editorInput.editorId matches the registered id`),{...l,group:s}):1}async doResolveSideBySideEditor(e,t){const i=await this.resolveEditor(e.primary,t);if(!Bo(i))return 2;const o=await this.resolveEditor(e.secondary,i.group??t);return Bo(o)?{group:i.group??o.group,editor:this.instantiationService.createInstance(Et,e.label,e.description,o.editor,i.editor),options:e.options}:2}bufferChangeEvents(e){this._onDidChangeEditorRegistrations.pause();try{e()}finally{this._onDidChangeEditorRegistrations.resume()}}registerEditor(e,t,i,o){let s=this._editors.get(e);s===void 0&&(s=new Map,this._editors.set(e,s));let n=s.get(t.id);n===void 0&&(n=[]);const r=jl(n,{globPattern:e,editorInfo:t,options:i,editorFactoryObject:o});return s.set(t.id,n),this._shouldReFlattenEditors=!0,this._onDidChangeEditorRegistrations.fire(),Y(()=>{r(),n&&n.length===0&&(s==null||s.delete(t.id)),this._shouldReFlattenEditors=!0,this._onDidChangeEditorRegistrations.fire()})}getAssociationsForResource(e){const i=this.getAllUserAssociations().filter(s=>s.filenamePattern&&hr(s.filenamePattern,e)),o=this._registeredEditors;return i.filter(s=>o.find(n=>n.editorInfo.id===s.viewType))}getAllUserAssociations(){const e=this.configurationService.inspect(Md)||{},t=e.workspaceValue??{},i=e.userValue??{},o={...t};for(const[n,r]of Object.entries(i))o[n]===void 0&&(o[n]=r);const s=[];for(const[n,r]of Object.entries(o)){const a={filenamePattern:n,viewType:r};s.push(a)}return s}_flattenEditorsMap(){if(!this._shouldReFlattenEditors)return this._flattenedEditors;this._shouldReFlattenEditors=!1;const e=new Map;for(const[t,i]of this._editors){const o=[];for(const s of i.values()){let n;for(const r of s)n||(n={editorInfo:r.editorInfo,globPattern:r.globPattern,options:{},editorFactoryObject:{}}),n.options={...n.options,...r.options},n.editorFactoryObject={...n.editorFactoryObject,...r.editorFactoryObject};n&&o.push(n)}e.set(t,o)}return e}get _registeredEditors(){return jv(Array.from(this._flattenedEditors.values()))}updateUserAssociations(e,t){const i={viewType:t,filenamePattern:e},o=this.getAllUserAssociations(),s=Object.create(null);for(const n of[...o,i])n.filenamePattern&&(s[n.filenamePattern]=n.viewType);this.configurationService.updateValue(Md,s)}findMatchingEditors(e){const t=this.getAssociationsForResource(e),i=[];for(const[o,s]of this._flattenedEditors)for(const n of s)(t.find(a=>a.viewType===n.editorInfo.id)&&n.editorInfo.priority!==Te.exclusive||hr(o,e))&&i.push(n);return i.sort((o,s)=>ai(s.editorInfo.priority)===ai(o.editorInfo.priority)&&typeof s.globPattern=="string"&&typeof o.globPattern=="string"?s.globPattern.length-o.globPattern.length:ai(s.editorInfo.priority)-ai(o.editorInfo.priority))}getEditors(e){if(this._flattenedEditors=this._flattenEditorsMap(),T.isUri(e)){const t=this.findMatchingEditors(e);return t.find(i=>i.editorInfo.priority===Te.exclusive)?[]:t.map(i=>i.editorInfo)}return Li(this._registeredEditors.map(t=>t.editorInfo),t=>t.id)}getEditor(e,t){var l;const i=(p,g)=>p.find(f=>f.options&&f.options.canSupportResource!==void 0?f.editorInfo.id===g&&f.options.canSupportResource(e):f.editorInfo.id===g);if(t&&t!==Uo.EXCLUSIVE_ONLY){const p=this._registeredEditors;return{editor:i(p,t),conflictingDefault:!1}}const o=this.findMatchingEditors(e),s=this.getAssociationsForResource(e),n=t===Uo.EXCLUSIVE_ONLY?Te.exclusive:Te.builtin;let r=o.filter(p=>ai(p.editorInfo.priority)>=ai(n)&&p.editorInfo.id!==We.id);if(r.length===0)return{editor:s[0]&&n!==Te.exclusive?i(o,s[0].viewType):void 0,conflictingDefault:!1};const a=r[0].editorInfo.priority===Te.exclusive?r[0].editorInfo.id:((l=s[0])==null?void 0:l.viewType)||r[0].editorInfo.id;let d=!1;return r=r.filter(p=>p.editorInfo.priority!==Te.exclusive),s.length===0&&r.length>1&&(d=!0),{editor:i(o,a),conflictingDefault:d}}async doResolveEditor(e,t,i){var d,l;let o=e.options;const s=ne.getCanonicalUri(e,{supportSideBySide:J.PRIMARY});if(o&&typeof o.activation>"u"&&(o={...o,activation:o.preserveFocus?pi.RESTORE:void 0}),Tl(e)){if(!i.editorFactoryObject.createMergeEditorInput)return;const p=await i.editorFactoryObject.createMergeEditorInput(e,t);return{editor:p.editor,options:p.options??o}}if(zs(e)){if(!i.editorFactoryObject.createDiffEditorInput)return;const p=await i.editorFactoryObject.createDiffEditorInput(e,t);return{editor:p.editor,options:p.options??o}}if(Ld(e))throw new Error("Untyped side by side editor input not supported here.");if(fm(e)){if(!i.editorFactoryObject.createUntitledEditorInput)return;const p=await i.editorFactoryObject.createUntitledEditorInput(e,t);return{editor:p.editor,options:p.options??o}}if(s===void 0)throw new Error("Undefined resource on non untitled editor input.");if(typeof((d=i.options)==null?void 0:d.singlePerResource)=="function"?i.options.singlePerResource():(l=i.options)==null?void 0:l.singlePerResource){const p=await this.moveExistingEditorForResource(s,i.editorInfo.id,t);if(p)return{editor:p,options:o}}if(!i.editorFactoryObject.createEditorInput)return;const r=await i.editorFactoryObject.createEditorInput(e,t);return o=r.options??o,{editor:r.editor,options:o}}async moveExistingEditorForResource(e,t,i){const o=this.findExistingEditorsForResource(e,t);if(!o.length)return;const s=o[0];for(const{editor:n,group:r}of o)if(n!==s.editor&&!await r.closeEditor(n))return;if(i.id!==s.group.id)return s.group.moveEditor(s.editor,i),s.editor}findExistingEditorsForResource(e,t){const i=[],o=Li([...this.editorGroupService.groups]);for(const s of o)for(const n of s.editors)Re(n.resource,e)&&n.editorId===t&&i.push({editor:n,group:s});return i}async doHandleConflictingDefaults(e,t,i,o,s){const n=this.findMatchingEditors(e),r=JSON.parse(this.storageService.get(li.conflictingDefaultsStorageID,0,"{}")),a=`*${zt(e)}`,d=()=>{r[a]=[],n.forEach(g=>r[a].push(g.editorInfo.id)),this.storageService.store(li.conflictingDefaultsStorageID,JSON.stringify(r),0,1)};if(r[a]&&r[a].find(g=>g===o.editorId))return;const p=this.notificationService.prompt(Fi.Warning,u("editorResolver.conflictingDefaults","There are multiple default editors available for the resource."),[{label:u("editorResolver.configureDefault","Configure Default"),run:async()=>{const g=await this.doPickEditor(i,!0);if(!g)return;i.options=g;const f=await this.resolveEditor(i,s);f===1||f===2||s.replaceEditors([{editor:o,replacement:f.editor,options:f.options??g}])}},{label:u("editorResolver.keepDefault","Keep {0}",t),run:d}]).onDidClose(()=>{d(),p.dispose()})}mapEditorsToQuickPickEntry(e,t){var p,g,f;const i=zc(this.editorGroupService.activeGroup.findEditors(e));let o=e.scheme===Q.untitled?this._registeredEditors.filter(b=>b.editorInfo.priority!==Te.exclusive):this.findMatchingEditors(e);o=Li(o,b=>b.editorInfo.id);const s=(p=this.getAssociationsForResource(e)[0])==null?void 0:p.viewType;o=o.sort((b,m)=>b.editorInfo.id===We.id?-1:m.editorInfo.id===We.id?1:ai(m.editorInfo.priority)-ai(b.editorInfo.priority));const n=[],r=u("promptOpenWith.currentlyActive","Active"),a=u("promptOpenWith.currentDefault","Default"),d=u("promptOpenWith.currentDefaultAndActive","Active and Default");let l=s;if(!l&&o.length>2&&((g=o[1])==null?void 0:g.editorInfo.priority)!==Te.option&&(l=(f=o[1])==null?void 0:f.editorInfo.id),l||(l=We.id),o.forEach(b=>{const m=(i==null?void 0:i.editorId)??We.id,y=i?b.editorInfo.id===m:!1,D=b.editorInfo.id===l,L={id:b.editorInfo.id,label:b.editorInfo.label,description:y&&D?d:y?r:D?a:void 0,detail:b.editorInfo.detail??b.editorInfo.priority};n.push(L)}),!t&&zt(e)!==""){const b={type:"separator"};n.push(b);const m={id:li.configureDefaultID,label:u("promptOpenWith.configureDefault","Configure default editor for '{0}'...",`*${zt(e)}`)};n.push(m)}return n}async doPickEditor(e,t){var d;let i=ne.getOriginalUri(e,{supportSideBySide:J.PRIMARY});i===void 0&&(i=T.from({scheme:Q.untitled}));const o=this.mapEditorsToQuickPickEntry(i,t),s=this.quickInputService.createQuickPick(),n=t?u("promptOpenWith.updateDefaultPlaceHolder","Select new default editor for '{0}'",`*${zt(i)}`):u("promptOpenWith.placeHolder","Select editor for '{0}'",Me(i));s.placeholder=n,s.canAcceptInBackground=!0,s.items=o;const r=s.items.find(l=>l.type==="item");r&&(s.selectedItems=[r]);const a=await new Promise(l=>{s.onDidAccept(p=>{let g;s.selectedItems.length===1&&(g={item:s.selectedItems[0],keyMods:s.keyMods,openInBackground:p.inBackground}),i&&t&&(g!=null&&g.item.id)&&this.updateUserAssociations(`*${zt(i)}`,g.item.id),l(g)}),s.onDidHide(()=>l(void 0)),s.onDidTriggerItemButton(p=>{l({item:p.item,openInBackground:!1}),i&&p.item&&p.item.id&&this.updateUserAssociations(`*${zt(i)}`,p.item.id)}),s.show()});if(s.dispose(),a)return a.item.id===li.configureDefaultID?this.doPickEditor(e,!0):{...e.options,override:a.item.id,preserveFocus:a.openInBackground||((d=e.options)==null?void 0:d.preserveFocus)}}sendEditorResolutionTelemetry(e){e.editorId&&this.telemetryService.publicLog2("override.viewType",{viewType:e.editorId})}cacheEditors(){const e=new Set;for(const[i,o]of this._flattenedEditors)o.find(n=>n.editorInfo.priority!==Te.option&&n.editorInfo.id!==We.id)&&(Yv(i)?e.add(`${i.pattern}`):e.add(i));const t=this.getAllUserAssociations();for(const i of t)i.filenamePattern&&e.add(i.filenamePattern);this.storageService.store(li.cacheStorageID,JSON.stringify(Array.from(e)),0,1)}resourceMatchesCache(e){if(!this.cache)return!1;for(const t of this.cache)if(hr(t,e))return!0;return!1}};Co.configureDefaultID="promptOpenWith.configureDefault";Co.cacheStorageID="editorOverrideService.cache";Co.conflictingDefaultsStorageID="editorOverrideService.conflictingDefaults";Co=C([h(0,ee),h(1,I),h(2,O),h(3,ks),h(4,Ae),h(5,Ne),h(6,oe),h(7,Ci),h(8,it)],Co);var ZC='.monaco-workbench .part.statusbar{box-sizing:border-box;cursor:default;display:flex;font-size:12px;height:22px;overflow:hidden;width:100%}.monaco-workbench:not(.reduce-motion) .part.statusbar{transition:background-color .15s ease-out}.monaco-workbench .part.statusbar.status-border-top:after{background-color:var(--status-border-top-color);content:"";height:1px;left:0;pointer-events:none;position:absolute;top:0;width:100%;z-index:5}.monaco-workbench .part.statusbar>.left-items,.monaco-workbench .part.statusbar>.right-items{display:flex}.monaco-workbench .part.statusbar>.right-items{flex-direction:row-reverse;flex-wrap:wrap}.monaco-workbench .part.statusbar>.left-items{flex-grow:1}.monaco-workbench .part.statusbar>.items-container>.statusbar-item{display:inline-block;font-variant-numeric:tabular-nums;height:100%;line-height:22px;max-width:40vw;vertical-align:top}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.has-beak{position:relative}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.has-beak>.status-bar-item-beak-container{height:5px;left:calc(50% - 5px);position:absolute;top:-5px;width:10px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.has-beak>.status-bar-item-beak-container:before{border-bottom-style:solid;border-bottom-width:5px;border-left:5px solid transparent;border-right:5px solid transparent;content:"";position:fixed}.monaco-workbench .part.statusbar>.items-container>.statusbar-item>.statusbar-item-label{margin-left:3px;margin-right:3px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.compact-left>.statusbar-item-label{margin-left:0;margin-right:3px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.compact-right>.statusbar-item-label{margin-left:3px;margin-right:0}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.left.first-visible-item{padding-left:7px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.right.last-visible-item{margin-right:7px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.has-background-color.left.first-visible-item,.monaco-workbench .part.statusbar>.items-container>.statusbar-item.has-background-color.right.last-visible-item{padding-left:0;padding-right:0}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.has-background-color>.statusbar-item-label{margin-left:0;margin-right:0;padding-left:10px;padding-right:10px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.compact-left.has-background-color>.statusbar-item-label{padding-left:3px;padding-right:10px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.compact-right.has-background-color>.statusbar-item-label{padding-left:10px;padding-right:3px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item>.statusbar-item-label{align-items:center;cursor:pointer;display:flex;height:100%;outline-width:0;overflow:hidden;padding:0 5px;text-overflow:ellipsis;white-space:pre}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.compact-left>.statusbar-item-label,.monaco-workbench .part.statusbar>.items-container>.statusbar-item.compact-right>.statusbar-item-label{padding:0 3px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item>a:hover:not(.disabled){text-decoration:none}.monaco-workbench .part.statusbar>.items-container>.statusbar-item>a.disabled{cursor:default}.monaco-workbench .part.statusbar>.items-container>.statusbar-item span.codicon{color:inherit;font-size:14px;text-align:center}.monaco-workbench .part.statusbar>.items-container>.statusbar-item .status-bar-info{background-color:var(--vscode-statusBarItem-prominentBackground);color:var(--vscode-statusBarItem-prominentForeground)}.monaco-workbench .part.statusbar>.items-container>.statusbar-item a.status-bar-info:hover:not(.disabled){background-color:var(--vscode-statusBarItem-prominentHoverBackground)}.monaco-workbench .part.statusbar>.items-container>.statusbar-item a:active:not(.disabled){outline:1px solid var(--vscode-contrastActiveBorder)!important;outline-offset:-1px}.monaco-workbench:not(.hc-light):not(.hc-black) .part.statusbar>.items-container>.statusbar-item a:active:not(.disabled){background-color:var(--vscode-statusBarItem-activeBackground)!important}.monaco-workbench .part.statusbar>.items-container>.statusbar-item a:hover:not(.disabled){outline:1px dashed var(--vscode-contrastActiveBorder);outline-offset:-1px}.monaco-workbench:not(.hc-light):not(.hc-black) .part.statusbar>.items-container>.statusbar-item a:hover:not(.disabled){background-color:var(--vscode-statusBarItem-hoverBackground)}';he(ZC,{});class QC extends Z{constructor(e,t,i){super(e,t,void 0,!0),this.model=i,this.checked=!i.isHidden(e)}async run(){this.model.isHidden(this.id)?this.model.show(this.id):this.model.hide(this.id)}}class eS extends Z{constructor(e,t,i){super(e,u("hide","Hide '{0}'",t),void 0,!0),this.model=i}async run(){this.model.hide(this.id)}}k.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusPrevious",weight:200,primary:15,secondary:[16],when:ko,handler:c=>{c.get(oi).focusPreviousEntry()}});k.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusNext",weight:200,primary:17,secondary:[18],when:ko,handler:c=>{c.get(oi).focusNextEntry()}});k.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusFirst",weight:200,primary:14,when:ko,handler:c=>{const e=c.get(oi);e.focus(!1),e.focusNextEntry()}});k.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusLast",weight:200,primary:13,when:ko,handler:c=>{const e=c.get(oi);e.focus(!1),e.focusPreviousEntry()}});k.registerCommandAndKeybindingRule({id:"workbench.statusBar.clearFocus",weight:200,primary:9,when:ko,handler:c=>{const e=c.get(oi),t=c.get(P);e.isEntryFocused()?e.focus(!1):t.activeEditorPane&&t.activeEditorPane.focus()}});class tS extends ye{constructor(){super({id:"workbench.action.focusStatusBar",title:{value:u("focusStatusBar","Focus Status Bar"),original:"Focus Status Bar"},category:fe.View,f1:!0})}async run(e){e.get(st).focusPart("workbench.parts.statusbar")}}j(tS);class Ri extends V{get entries(){return this._entries.slice(0)}get lastFocusedEntry(){return this._lastFocusedEntry&&!this.isHidden(this._lastFocusedEntry.id)?this._lastFocusedEntry:void 0}constructor(e){super(),this.storageService=e,this._onDidChangeEntryVisibility=this._register(new w),this.onDidChangeEntryVisibility=this._onDidChangeEntryVisibility.event,this._entries=[],this.hidden=new Set,this.restoreState(),this.registerListeners()}restoreState(){const e=this.storageService.get(Ri.HIDDEN_ENTRIES_KEY,0);if(e)try{const t=JSON.parse(e);this.hidden=new Set(t)}catch{}}registerListeners(){this._register(this.storageService.onDidChangeValue(e=>this.onDidStorageValueChange(e)))}onDidStorageValueChange(e){if(e.key===Ri.HIDDEN_ENTRIES_KEY&&e.scope===0){const t=new Set(this.hidden);this.hidden.clear(),this.restoreState();const i=new Set;for(const o of t)this.hidden.has(o)||i.add(o);for(const o of this.hidden)t.has(o)||i.add(o);if(i.size>0)for(const o of this._entries)i.has(o.id)&&(this.updateVisibility(o.id,!0),i.delete(o.id))}}add(e){this._entries.push(e),this.updateVisibility(e,!1),this.sort(),this.markFirstLastVisibleEntry()}remove(e){const t=this._entries.indexOf(e);t>=0&&(this._entries.splice(t,1),this._entries.some(i=>Ks(i.priority.primary)&&i.priority.primary.id===e.id)&&this.sort(),this.markFirstLastVisibleEntry())}isHidden(e){return this.hidden.has(e)}hide(e){this.hidden.has(e)||(this.hidden.add(e),this.updateVisibility(e,!0),this.saveState())}show(e){this.hidden.has(e)&&(this.hidden.delete(e),this.updateVisibility(e,!0),this.saveState())}findEntry(e){return this._entries.find(t=>t.container===e)}getEntries(e){return this._entries.filter(t=>t.alignment===e)}focusNextEntry(){this.focusEntry(1,0)}focusPreviousEntry(){this.focusEntry(-1,this.entries.length-1)}isEntryFocused(){return!!this.getFocusedEntry()}getFocusedEntry(){return this._entries.find(e=>Tt(document.activeElement,e.container))}focusEntry(e,t){const i=n=>{let r=n,a=r>=0&&r<this._entries.length?this._entries[r]:void 0;for(;a&&this.isHidden(a.id);)r+=e,a=r>=0&&r<this._entries.length?this._entries[r]:void 0;return a},o=this.getFocusedEntry();if(o){const n=i(this._entries.indexOf(o)+e);if(n){this._lastFocusedEntry=n,n.labelContainer.focus();return}}const s=i(t);s&&(this._lastFocusedEntry=s,s.labelContainer.focus())}updateVisibility(e,t){if(typeof e=="string"){const i=e;for(const o of this._entries)o.id===i&&this.updateVisibility(o,t)}else{const i=e,o=this.isHidden(i.id);o?mi(i.container):fi(i.container),t&&this._onDidChangeEntryVisibility.fire({id:i.id,visible:!o}),this.markFirstLastVisibleEntry()}}saveState(){this.hidden.size>0?this.storageService.store(Ri.HIDDEN_ENTRIES_KEY,JSON.stringify(Array.from(this.hidden.values())),0,0):this.storageService.remove(Ri.HIDDEN_ENTRIES_KEY,0)}sort(){const e=new Map,t=new Map;for(let s=0;s<this._entries.length;s++){const n=this._entries[s];if(typeof n.priority.primary=="number")e.set(n,s);else{let r=t.get(n.priority.primary.id);r||(r=[],t.set(n.priority.primary.id,r)),r.push(n)}}const i=Array.from(e.keys());i.sort((s,n)=>s.alignment===n.alignment?s.priority.primary!==n.priority.primary?Number(n.priority.primary)-Number(s.priority.primary):s.priority.secondary!==n.priority.secondary?n.priority.secondary-s.priority.secondary:e.get(s)-e.get(n):s.alignment===0?-1:n.alignment===0?1:0);let o;if(t.size>0){o=[];for(const s of i){const n=t.get(s.id);n&&o.push(...n.filter(r=>Ks(r.priority.primary)&&r.priority.primary.alignment===0)),o.push(s),n&&o.push(...n.filter(r=>Ks(r.priority.primary)&&r.priority.primary.alignment===1)),t.delete(s.id)}for(const[,s]of t)o.push(...s)}else o=i;this._entries=o}markFirstLastVisibleEntry(){this.doMarkFirstLastVisibleStatusbarItem(this.getEntries(0)),this.doMarkFirstLastVisibleStatusbarItem(this.getEntries(1))}doMarkFirstLastVisibleStatusbarItem(e){let t,i;for(const o of e)o.container.classList.remove("first-visible-item","last-visible-item"),!this.isHidden(o.id)&&(t||(t=o),i=o);t==null||t.container.classList.add("first-visible-item"),i==null||i.container.classList.add("last-visible-item")}}Ri.HIDDEN_ENTRIES_KEY="workbench.statusbar.hidden";let ja=class extends V{get name(){return K(this.entry).name}get hasCommand(){var e;return typeof((e=this.entry)==null?void 0:e.command)<"u"}constructor(e,t,i,o,s,n,r){super(),this.container=e,this.hoverDelegate=i,this.commandService=o,this.notificationService=s,this.telemetryService=n,this.themeService=r,this.entry=void 0,this.foregroundListener=this._register(new Ie),this.backgroundListener=this._register(new Ie),this.commandMouseListener=this._register(new Ie),this.commandTouchListener=this._register(new Ie),this.commandKeyboardListener=this._register(new Ie),this.hover=void 0,this.labelContainer=document.createElement("a"),this.labelContainer.tabIndex=-1,this.labelContainer.setAttribute("role","button"),this.labelContainer.className="statusbar-item-label",this._register(Yt.addTarget(this.labelContainer)),this.label=new iS(this.labelContainer),this.container.appendChild(this.labelContainer),this.beakContainer=document.createElement("div"),this.beakContainer.className="status-bar-item-beak-container",this.container.appendChild(this.beakContainer),this.update(t)}update(e){if(this.label.showProgress=e.showProgress??!1,(!this.entry||e.text!==this.entry.text)&&(this.label.text=e.text,e.text?fi(this.labelContainer):mi(this.labelContainer)),(!this.entry||e.ariaLabel!==this.entry.ariaLabel)&&(this.container.setAttribute("aria-label",e.ariaLabel),this.labelContainer.setAttribute("aria-label",e.ariaLabel)),(!this.entry||e.role!==this.entry.role)&&this.labelContainer.setAttribute("role",e.role||"button"),!this.entry||!this.isEqualTooltip(this.entry,e)){const t=Ho(e.tooltip)?{markdown:e.tooltip,markdownNotSupportedFallback:void 0}:e.tooltip;this.hover?this.hover.update(t):this.hover=this._register(fu(this.hoverDelegate,this.container,t))}if(!this.entry||e.command!==this.entry.command){this.commandMouseListener.clear(),this.commandTouchListener.clear(),this.commandKeyboardListener.clear();const t=e.command;t&&(t!==Rr||this.hover)?(this.commandMouseListener.value=_(this.labelContainer,E.CLICK,()=>this.executeCommand(t)),this.commandTouchListener.value=_(this.labelContainer,Ve.Tap,()=>this.executeCommand(t)),this.commandKeyboardListener.value=_(this.labelContainer,E.KEY_DOWN,i=>{const o=new mt(i);(o.equals(10)||o.equals(3))&&(X.stop(i),this.executeCommand(t))}),this.labelContainer.classList.remove("disabled")):this.labelContainer.classList.add("disabled")}(!this.entry||e.showBeak!==this.entry.showBeak)&&(e.showBeak?this.container.classList.add("has-beak"):this.container.classList.remove("has-beak")),(!this.entry||e.color!==this.entry.color)&&this.applyColor(this.labelContainer,e.color),(!this.entry||e.backgroundColor!==this.entry.backgroundColor)&&(this.container.classList.toggle("has-background-color",!!e.backgroundColor),this.applyColor(this.container,e.backgroundColor,!0)),this.entry=e}isEqualTooltip({tooltip:e},{tooltip:t}){return e===void 0?t===void 0:Ho(e)?Ho(t)&&Jv(e,t):e===t}async executeCommand(e){var t;if(e===Rr)(t=this.hover)==null||t.show(!0);else{const i=typeof e=="string"?e:e.id,o=typeof e=="string"?[]:e.arguments??[];this.telemetryService.publicLog2("workbenchActionExecuted",{id:i,from:"status bar"});try{await this.commandService.executeCommand(i,...o)}catch(s){this.notificationService.error(go(s))}}}applyColor(e,t,i){var s;let o;if(i?this.backgroundListener.clear():this.foregroundListener.clear(),t)if(Xv(t)){o=(s=this.themeService.getColorTheme().getColor(t.id))==null?void 0:s.toString();const n=this.themeService.onDidColorThemeChange(r=>{var d;const a=(d=r.getColor(t.id))==null?void 0:d.toString();i?e.style.backgroundColor=a??"":e.style.color=a??""});i?this.backgroundListener.value=n:this.foregroundListener.value=n}else o=t;i?e.style.backgroundColor=o??"":e.style.color=o??""}};ja=C([h(3,Io),h(4,Ae),h(5,Ne),h(6,te)],ja);class iS extends Hw{constructor(e){super(e),this.container=e,this.progressCodicon=qd(jd),this.currentText="",this.currentShowProgress=!1}set showProgress(e){this.currentShowProgress!==e&&(this.currentShowProgress=e,this.progressCodicon=qd(e==="loading"?Zv:jd),this.text=this.currentText)}set text(e){if(this.currentShowProgress){this.container.firstChild!==this.progressCodicon&&this.container.appendChild(this.progressCodicon);for(const i of Array.from(this.container.childNodes))i!==this.progressCodicon&&i.remove();let t=e??"";t&&(t=` ${t}`),de(this.container,...qs(t))}else super.text=e}}let Ya=class extends Zn{constructor(e,t,i,o,s,n,r,a,d){super("workbench.parts.statusbar",{hasTitle:!1},t,o,s),this.instantiationService=e,this.contextService=i,this.storageService=o,this.contextMenuService=n,this.contextKeyService=r,this.hoverService=a,this.configurationService=d,this.minimumWidth=0,this.maximumWidth=Number.POSITIVE_INFINITY,this.minimumHeight=22,this.maximumHeight=22,this.pendingEntries=[],this.viewModel=this._register(new Ri(this.storageService)),this.onDidChangeEntryVisibility=this.viewModel.onDidChangeEntryVisibility,this.hoverDelegate=new class{get delay(){return Date.now()-this.lastHoverHideTime<200?0:this.configurationService.getValue("workbench.hover.delay")}constructor(l,p){this.configurationService=l,this.hoverService=p,this.lastHoverHideTime=0,this.placement="element"}showHover(l,p){return this.hoverService.showHover({...l,hideOnKeyDown:!0},p)}onDidHideHover(){this.lastHoverHideTime=Date.now()}}(this.configurationService,this.hoverService),this.compactEntriesDisposable=this._register(new Ie),this.styleOverrides=new Set,this.registerListeners()}registerListeners(){this._register(this.onDidChangeEntryVisibility(()=>this.updateCompactEntries())),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.updateStyles()))}addEntry(e,t,i,o=0){let s;return mm(o)?s=o:s={primary:o,secondary:Is(t)},this.element?this.doAddEntry(e,t,i,s):this.doAddPendingEntry(e,t,i,s)}doAddPendingEntry(e,t,i,o){const s={entry:e,id:t,alignment:i,priority:o};return this.pendingEntries.push(s),{update:r=>{s.accessor?s.accessor.update(r):s.entry=r},dispose:()=>{s.accessor?s.accessor.dispose():this.pendingEntries=this.pendingEntries.filter(r=>r!==s)}}}doAddEntry(e,t,i,o){const s=this.doCreateStatusItem(t,i,...Ge([e.showBeak?"has-beak":void 0])),n=this.instantiationService.createInstance(ja,s,e,this.hoverDelegate),r=new class{constructor(){this.id=t,this.alignment=i,this.priority=o,this.container=s,this.labelContainer=n.labelContainer}get name(){return n.name}get hasCommand(){return n.hasCommand}},{needsFullRefresh:a}=this.doAddOrRemoveModelEntry(r,!0);return a?this.appendStatusbarEntries():this.appendStatusbarEntry(r),{update:d=>{n.update(d)},dispose:()=>{const{needsFullRefresh:d}=this.doAddOrRemoveModelEntry(r,!1);d?this.appendStatusbarEntries():s.remove(),ie(n)}}}doCreateStatusItem(e,t,...i){const o=document.createElement("div");return o.id=e,o.classList.add("statusbar-item"),i&&o.classList.add(...i),t===1?o.classList.add("right"):o.classList.add("left"),o}doAddOrRemoveModelEntry(e,t){const i=this.viewModel.entries;t?this.viewModel.add(e):this.viewModel.remove(e);const o=this.viewModel.entries;return t?i.splice(o.indexOf(e),0,e):i.splice(i.indexOf(e),1),{needsFullRefresh:!wi(i,o)}}isEntryVisible(e){return!this.viewModel.isHidden(e)}updateEntryVisibility(e,t){t?this.viewModel.show(e):this.viewModel.hide(e)}focusNextEntry(){this.viewModel.focusNextEntry()}focusPreviousEntry(){this.viewModel.focusPreviousEntry()}isEntryFocused(){return this.viewModel.isEntryFocused()}focus(e=!0){var i;(i=this.getContainer())==null||i.focus();const t=this.viewModel.lastFocusedEntry;e&&t&&setTimeout(()=>t.labelContainer.focus(),0)}createContentArea(e){this.element=e;const t=this.contextKeyService.createScoped(this.element);return ko.bindTo(t).set(!0),this.leftItemsContainer=document.createElement("div"),this.leftItemsContainer.classList.add("left-items","items-container"),this.element.appendChild(this.leftItemsContainer),this.element.tabIndex=0,this.rightItemsContainer=document.createElement("div"),this.rightItemsContainer.classList.add("right-items","items-container"),this.element.appendChild(this.rightItemsContainer),this._register(_(e,E.CONTEXT_MENU,i=>this.showContextMenu(i))),this._register(Yt.addTarget(e)),this._register(_(e,Ve.Contextmenu,i=>this.showContextMenu(i))),this.createInitialStatusbarEntries(),this.element}createInitialStatusbarEntries(){for(this.appendStatusbarEntries();this.pendingEntries.length;){const e=this.pendingEntries.shift();e&&(e.accessor=this.addEntry(e.entry,e.id,e.alignment,e.priority.primary))}}appendStatusbarEntries(){const e=K(this.leftItemsContainer),t=K(this.rightItemsContainer);Jt(e),Jt(t);for(const i of[...this.viewModel.getEntries(0),...this.viewModel.getEntries(1).reverse()])(i.alignment===0?e:t).appendChild(i.container);this.updateCompactEntries()}appendStatusbarEntry(e){const t=this.viewModel.getEntries(e.alignment);e.alignment===1&&t.reverse();const i=K(e.alignment===0?this.leftItemsContainer:this.rightItemsContainer),o=t.indexOf(e);o+1===t.length?i.appendChild(e.container):i.insertBefore(e.container,t[o+1].container),this.updateCompactEntries()}updateCompactEntries(){const e=this.viewModel.entries,t=new Map;for(const n of e)this.viewModel.isHidden(n.id)||t.set(n.id,n),n.container.classList.remove("compact-left","compact-right");const i=new Map;for(const n of t.values())if(Ks(n.priority.primary)&&n.priority.primary.compact){const r=n.priority.primary.id,a=t.get(r);if(!a)continue;let d=i.get(r);d?d.add(n):(d=new Set([n,a]),i.set(r,d)),n.priority.primary.alignment===0?(a.container.classList.add("compact-left"),n.container.classList.add("compact-right")):(a.container.classList.add("compact-right"),n.container.classList.add("compact-left"))}const o=this.getColor(bm),s=this.getColor(vm);if(this.compactEntriesDisposable.value=new x,o&&s&&!Hc(this.theme.type))for(const[,n]of i)for(const r of n)r.hasCommand&&(this.compactEntriesDisposable.value.add(_(r.labelContainer,E.MOUSE_OVER,()=>{n.forEach(a=>a.labelContainer.style.backgroundColor=o),r.labelContainer.style.backgroundColor=s})),this.compactEntriesDisposable.value.add(_(r.labelContainer,E.MOUSE_OUT,()=>{n.forEach(a=>a.labelContainer.style.backgroundColor="")})))}showContextMenu(e){X.stop(e,!0);const t=new bt(e);let i;this.contextMenuService.showContextMenu({getAnchor:()=>({x:t.posx,y:t.posy}),getActions:()=>(i=this.getContextMenuActions(t),i),onHide:()=>{i&&Qv(i)}})}getContextMenuActions(e){const t=[];t.push(Ee({id:rh.ID,label:u("hideStatusBar","Hide Status Bar"),run:()=>this.instantiationService.invokeFunction(s=>new rh().run(s))})),t.push(new Pe);const i=new Set;for(const s of this.viewModel.entries)i.has(s.id)||(t.push(new QC(s.id,s.name,this.viewModel)),i.add(s.id));let o;for(let s=e.target;s;s=s.parentElement){const n=this.viewModel.findEntry(s);if(n){o=n;break}}return o&&(t.push(new Pe),t.push(new eS(o.id,o.name,this.viewModel))),t}updateStyles(){super.updateStyles();const e=K(this.getContainer()),t=[...this.styleOverrides].sort((a,d)=>a.priority-d.priority)[0],i=this.getColor((t==null?void 0:t.background)??(this.contextService.getWorkbenchState()!==1?wm:ym))||"";e.style.backgroundColor=i;const o=this.getColor((t==null?void 0:t.foreground)??(this.contextService.getWorkbenchState()!==1?Cm:Sm))||"";e.style.color=o;const s=this.getColor(_m),n=this.getColor((t==null?void 0:t.border)??(this.contextService.getWorkbenchState()!==1?Em:Dm))||this.getColor(Ze);n?(e.classList.add("status-border-top"),e.style.setProperty("--status-border-top-color",n)):(e.classList.remove("status-border-top"),e.style.removeProperty("--status-border-top-color"));const r=this.getColor(km);this.styleElement||(this.styleElement=Ul(e)),this.styleElement.textContent=`

				/* Status bar focus outline */
				.monaco-workbench .part.statusbar:focus {
					outline-color: ${r};
				}

				/* Status bar item focus outline */
				.monaco-workbench .part.statusbar > .items-container > .statusbar-item a:focus-visible:not(.disabled) {
					outline: 1px solid ${this.getColor(lo)??s};
					outline-offset: ${n?"-2px":"-1px"};
				}

				/* Notification Beak */
				.monaco-workbench .part.statusbar > .items-container > .statusbar-item.has-beak > .status-bar-item-beak-container:before {
					border-bottom-color: ${i};
				}
			`}layout(e,t,i,o){super.layout(e,t,i,o),super.layoutContents(e,t)}overrideStyle(e){return this.styleOverrides.add(e),this.updateStyles(),Y(()=>{this.styleOverrides.delete(e),this.updateStyles()})}toJSON(){return{type:"workbench.parts.statusbar"}}};Ya=C([h(0,I),h(1,te),h(2,ze),h(3,oe),h(4,st),h(5,ke),h(6,G),h(7,Mt),h(8,O)],Ya);let yi=class Gt extends V{constructor(e,t,i,o,s,n,r,a,d,l){super(),this.editorService=e,this.editorGroupService=t,this.contextService=i,this.storageService=o,this.configurationService=s,this.fileService=n,this.workspacesService=r,this.instantiationService=a,this.layoutService=d,this.contextKeyService=l,this.activeEditorListeners=this._register(new x),this.lastActiveEditor=void 0,this.editorHelper=this.instantiationService.createInstance(In),this.canNavigateBackContextKey=new U("canNavigateBack",!1,u("canNavigateBack","Whether it is possible to navigate back in editor history")).bindTo(this.contextKeyService),this.canNavigateForwardContextKey=new U("canNavigateForward",!1,u("canNavigateForward","Whether it is possible to navigate forward in editor history")).bindTo(this.contextKeyService),this.canNavigateBackInNavigationsContextKey=new U("canNavigateBackInNavigationLocations",!1,u("canNavigateBackInNavigationLocations","Whether it is possible to navigate back in editor navigation locations history")).bindTo(this.contextKeyService),this.canNavigateForwardInNavigationsContextKey=new U("canNavigateForwardInNavigationLocations",!1,u("canNavigateForwardInNavigationLocations","Whether it is possible to navigate forward in editor navigation locations history")).bindTo(this.contextKeyService),this.canNavigateToLastNavigationLocationContextKey=new U("canNavigateToLastNavigationLocation",!1,u("canNavigateToLastNavigationLocation","Whether it is possible to navigate to the last editor navigation location")).bindTo(this.contextKeyService),this.canNavigateBackInEditsContextKey=new U("canNavigateBackInEditLocations",!1,u("canNavigateBackInEditLocations","Whether it is possible to navigate back in editor edit locations history")).bindTo(this.contextKeyService),this.canNavigateForwardInEditsContextKey=new U("canNavigateForwardInEditLocations",!1,u("canNavigateForwardInEditLocations","Whether it is possible to navigate forward in editor edit locations history")).bindTo(this.contextKeyService),this.canNavigateToLastEditLocationContextKey=new U("canNavigateToLastEditLocation",!1,u("canNavigateToLastEditLocation","Whether it is possible to navigate to the last editor edit location")).bindTo(this.contextKeyService),this.canReopenClosedEditorContextKey=new U("canReopenClosedEditor",!1,u("canReopenClosedEditor","Whether it is possible to reopen the last closed editor")).bindTo(this.contextKeyService),this._onDidChangeEditorNavigationStack=this._register(new w),this.onDidChangeEditorNavigationStack=this._onDidChangeEditorNavigationStack.event,this.defaultScopedEditorNavigationStack=void 0,this.editorGroupScopedNavigationStacks=new Map,this.editorScopedNavigationStacks=new Map,this.editorNavigationScope=0,this.recentlyUsedEditorsStack=void 0,this.recentlyUsedEditorsStackIndex=0,this.recentlyUsedEditorsInGroupStack=void 0,this.recentlyUsedEditorsInGroupStackIndex=0,this.navigatingInRecentlyUsedEditorsStack=!1,this.navigatingInRecentlyUsedEditorsInGroupStack=!1,this.recentlyClosedEditors=[],this.ignoreEditorCloseEvent=!1,this.history=void 0,this.editorHistoryListeners=new Map,this.resourceExcludeMatcher=this._register(new hu(()=>{const p=this._register(this.instantiationService.createInstance(Ah,g=>xm(g?this.configurationService.getValue({resource:g}):this.configurationService.getValue())||Object.create(null),g=>g.affectsConfiguration(ew)||g.affectsConfiguration(Im)));return this._register(p.onExpressionChange(()=>this.removeExcludedFromHistory())),p})),this.registerListeners(),this.editorService.activeEditorPane&&this.onDidActiveEditorChange()}registerListeners(){this.registerMouseNavigationListener(),this._register(this.editorService.onDidActiveEditorChange(()=>this.onDidActiveEditorChange())),this._register(this.editorService.onDidOpenEditorFail(e=>this.remove(e.editor))),this._register(this.editorService.onDidCloseEditor(e=>this.onDidCloseEditor(e))),this._register(this.editorService.onDidMostRecentlyActiveEditorsChange(()=>this.handleEditorEventInRecentEditorsStack())),this._register(this.editorGroupService.onDidRemoveGroup(e=>this.onDidRemoveGroup(e))),this._register(this.fileService.onDidFilesChange(e=>this.onDidFilesChange(e))),this._register(this.fileService.onDidRunOperation(e=>this.onDidFilesChange(e))),this._register(this.storageService.onWillSaveState(()=>this.saveState())),this.registerEditorNavigationScopeChangeListener(),this._register(this.onDidChangeEditorNavigationStack(()=>this.updateContextKeys())),this._register(this.editorGroupService.onDidChangeActiveGroup(()=>this.updateContextKeys()))}onDidCloseEditor(e){this.handleEditorCloseEventInHistory(e),this.handleEditorCloseEventInReopen(e)}registerMouseNavigationListener(){const e=this._register(new x),t=()=>{e.clear(),this.configurationService.getValue(Gt.MOUSE_NAVIGATION_SETTING)&&(e.add(_(this.layoutService.container,E.MOUSE_DOWN,i=>this.onMouseDownOrUp(i,!0))),e.add(_(this.layoutService.container,E.MOUSE_UP,i=>this.onMouseDownOrUp(i,!1))))};this._register(this.configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration(Gt.MOUSE_NAVIGATION_SETTING)&&t()})),t()}onMouseDownOrUp(e,t){switch(e.button){case 3:X.stop(e),t&&this.goBack();break;case 4:X.stop(e),t&&this.goForward();break}}onDidRemoveGroup(e){this.handleEditorGroupRemoveInNavigationStacks(e)}onDidActiveEditorChange(){const e=this.editorGroupService.activeGroup,t=e.activeEditorPane;this.lastActiveEditor&&this.editorHelper.matchesEditorIdentifier(this.lastActiveEditor,t)||(this.lastActiveEditor=t!=null&&t.input&&t.group?{editor:t.input,groupId:t.group.id}:void 0,this.activeEditorListeners.clear(),this.handleActiveEditorChange(e,t),Lr(t)&&this.activeEditorListeners.add(t.onDidChangeSelection(i=>this.handleActiveEditorSelectionChangeEvent(e,t,i))),this.updateContextKeys())}onDidFilesChange(e){e instanceof no?e.gotDeleted()&&this.remove(e):e.isOperation(1)?this.remove(e):e.isOperation(2)&&e.target.isFile&&this.move(e)}handleActiveEditorChange(e,t){this.handleActiveEditorChangeInHistory(t),this.handleActiveEditorChangeInNavigationStacks(e,t)}handleActiveEditorSelectionChangeEvent(e,t,i){this.handleActiveEditorSelectionChangeInNavigationStacks(e,t,i)}move(e){this.moveInHistory(e),this.moveInEditorNavigationStacks(e)}remove(e){this.removeFromHistory(e),this.removeFromEditorNavigationStacks(e),this.removeFromRecentlyClosedEditors(e),this.removeFromRecentlyOpened(e)}removeFromRecentlyOpened(e){let t;pe(e)?t=ne.getOriginalUri(e):e instanceof no||(t=e.resource),t&&this.workspacesService.removeRecentlyOpened([t])}clear(){this.clearRecentlyOpened(),this.clearEditorNavigationStacks(),this.recentlyClosedEditors=[],this.updateContextKeys()}updateContextKeys(){this.contextKeyService.bufferChangeEvents(()=>{const e=this.getStack();this.canNavigateBackContextKey.set(e.canGoBack(0)),this.canNavigateForwardContextKey.set(e.canGoForward(0)),this.canNavigateBackInNavigationsContextKey.set(e.canGoBack(2)),this.canNavigateForwardInNavigationsContextKey.set(e.canGoForward(2)),this.canNavigateToLastNavigationLocationContextKey.set(e.canGoLast(2)),this.canNavigateBackInEditsContextKey.set(e.canGoBack(1)),this.canNavigateForwardInEditsContextKey.set(e.canGoForward(1)),this.canNavigateToLastEditLocationContextKey.set(e.canGoLast(1)),this.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length>0)})}registerEditorNavigationScopeChangeListener(){const e=()=>{this.disposeEditorNavigationStacks();const t=this.configurationService.getValue(Gt.NAVIGATION_SCOPE_SETTING);t==="editorGroup"?this.editorNavigationScope=1:t==="editor"?this.editorNavigationScope=2:this.editorNavigationScope=0};this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration(Gt.NAVIGATION_SCOPE_SETTING)&&e()})),e()}getStack(e=this.editorGroupService.activeGroup,t=e.activeEditor){var i,o;switch(this.editorNavigationScope){case 2:{if(!t)return new oS;let s=this.editorScopedNavigationStacks.get(e.id);s||(s=new Map,this.editorScopedNavigationStacks.set(e.id,s));let n=(i=s.get(t))==null?void 0:i.stack;if(!n){const r=new x;n=r.add(this.instantiationService.createInstance(jo,2)),r.add(n.onDidChange(()=>this._onDidChangeEditorNavigationStack.fire())),s.set(t,{stack:n,disposable:r})}return n}case 1:{let s=(o=this.editorGroupScopedNavigationStacks.get(e.id))==null?void 0:o.stack;if(!s){const n=new x;s=n.add(this.instantiationService.createInstance(jo,1)),n.add(s.onDidChange(()=>this._onDidChangeEditorNavigationStack.fire())),this.editorGroupScopedNavigationStacks.set(e.id,{stack:s,disposable:n})}return s}case 0:return this.defaultScopedEditorNavigationStack||(this.defaultScopedEditorNavigationStack=this._register(this.instantiationService.createInstance(jo,0)),this._register(this.defaultScopedEditorNavigationStack.onDidChange(()=>this._onDidChangeEditorNavigationStack.fire()))),this.defaultScopedEditorNavigationStack}}goForward(e){return this.getStack().goForward(e)}goBack(e){return this.getStack().goBack(e)}goPrevious(e){return this.getStack().goPrevious(e)}goLast(e){return this.getStack().goLast(e)}handleActiveEditorChangeInNavigationStacks(e,t){this.getStack(e,t==null?void 0:t.input).handleActiveEditorChange(t)}handleActiveEditorSelectionChangeInNavigationStacks(e,t,i){this.getStack(e,t.input).handleActiveEditorSelectionChange(t,i)}handleEditorCloseEventInHistory(e){const t=this.editorScopedNavigationStacks.get(e.groupId);if(t){const i=t.get(e.editor);i&&(i.disposable.dispose(),t.delete(e.editor)),t.size===0&&this.editorScopedNavigationStacks.delete(e.groupId)}}handleEditorGroupRemoveInNavigationStacks(e){var i;(i=this.defaultScopedEditorNavigationStack)==null||i.remove(e.id);const t=this.editorGroupScopedNavigationStacks.get(e.id);t&&(t.disposable.dispose(),this.editorGroupScopedNavigationStacks.delete(e.id))}clearEditorNavigationStacks(){this.withEachEditorNavigationStack(e=>e.clear())}removeFromEditorNavigationStacks(e){this.withEachEditorNavigationStack(t=>t.remove(e))}moveInEditorNavigationStacks(e){this.withEachEditorNavigationStack(t=>t.move(e))}withEachEditorNavigationStack(e){this.defaultScopedEditorNavigationStack&&e(this.defaultScopedEditorNavigationStack);for(const[,t]of this.editorGroupScopedNavigationStacks)e(t.stack);for(const[,t]of this.editorScopedNavigationStacks)for(const[,i]of t)e(i.stack)}disposeEditorNavigationStacks(){var e;(e=this.defaultScopedEditorNavigationStack)==null||e.dispose(),this.defaultScopedEditorNavigationStack=void 0;for(const[,t]of this.editorGroupScopedNavigationStacks)t.disposable.dispose();this.editorGroupScopedNavigationStacks.clear();for(const[,t]of this.editorScopedNavigationStacks)for(const[,i]of t)i.disposable.dispose();this.editorScopedNavigationStacks.clear()}openNextRecentlyUsedEditor(e){const[t,i]=this.ensureRecentlyUsedStack(o=>o-1,e);return this.doNavigateInRecentlyUsedEditorsStack(t[i],e)}openPreviouslyUsedEditor(e){const[t,i]=this.ensureRecentlyUsedStack(o=>o+1,e);return this.doNavigateInRecentlyUsedEditorsStack(t[i],e)}async doNavigateInRecentlyUsedEditorsStack(e,t){if(e){const i=typeof t!="number"||!this.editorGroupService.getGroup(t);i?this.navigatingInRecentlyUsedEditorsStack=!0:this.navigatingInRecentlyUsedEditorsInGroupStack=!0;const o=this.editorGroupService.getGroup(e.groupId)??this.editorGroupService.activeGroup;try{await o.openEditor(e.editor)}finally{i?this.navigatingInRecentlyUsedEditorsStack=!1:this.navigatingInRecentlyUsedEditorsInGroupStack=!1}}}ensureRecentlyUsedStack(e,t){let i,o;const s=typeof t=="number"?this.editorGroupService.getGroup(t):void 0;s?(i=this.recentlyUsedEditorsInGroupStack||s.getEditors(0).map(r=>({groupId:s.id,editor:r})),o=this.recentlyUsedEditorsInGroupStackIndex):(i=this.recentlyUsedEditorsStack||this.editorService.getEditors(0),o=this.recentlyUsedEditorsStackIndex);let n=e(o);return n<0?n=0:n>i.length-1&&(n=i.length-1),s?(this.recentlyUsedEditorsInGroupStack=i,this.recentlyUsedEditorsInGroupStackIndex=n):(this.recentlyUsedEditorsStack=i,this.recentlyUsedEditorsStackIndex=n),[i,n]}handleEditorEventInRecentEditorsStack(){this.navigatingInRecentlyUsedEditorsStack||(this.recentlyUsedEditorsStack=void 0,this.recentlyUsedEditorsStackIndex=0),this.navigatingInRecentlyUsedEditorsInGroupStack||(this.recentlyUsedEditorsInGroupStack=void 0,this.recentlyUsedEditorsInGroupStackIndex=0)}handleEditorCloseEventInReopen(e){if(this.ignoreEditorCloseEvent)return;const{editor:t,context:i}=e;if(i===xi.REPLACE||i===xi.MOVE)return;const o=t.toUntyped();if(!o)return;const s=[],n=ne.getOriginalUri(t,{supportSideBySide:J.BOTH});T.isUri(n)?s.push(n):n&&s.push(...Ge([n.primary,n.secondary])),this.removeFromRecentlyClosedEditors(t),this.recentlyClosedEditors.push({editorId:t.editorId,editor:o,resource:ne.getOriginalUri(t),associatedResources:s,index:e.index,sticky:e.sticky}),this.recentlyClosedEditors.length>Gt.MAX_RECENTLY_CLOSED_EDITORS&&this.recentlyClosedEditors.shift(),this.canReopenClosedEditorContextKey.set(!0)}async reopenLastClosedEditor(){const e=this.recentlyClosedEditors.pop();let t;return e&&(t=this.doReopenLastClosedEditor(e)),this.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length>0),t}async doReopenLastClosedEditor(e){const t={pinned:!0,sticky:e.sticky,index:e.index,ignoreError:!0};(e.sticky&&!this.editorGroupService.activeGroup.isSticky(e.index)||!e.sticky&&this.editorGroupService.activeGroup.isSticky(e.index))&&(t.index=void 0);let i;if(!this.editorGroupService.activeGroup.contains(e.editor)){this.ignoreEditorCloseEvent=!0;try{i=await this.editorService.openEditor({...e.editor,options:{...e.editor.options,...t}})}finally{this.ignoreEditorCloseEvent=!1}}i||(tw(this.recentlyClosedEditors,e),this.reopenLastClosedEditor())}removeFromRecentlyClosedEditors(e){this.recentlyClosedEditors=this.recentlyClosedEditors.filter(t=>pe(e)&&t.editorId!==e.editorId?!0:!(t.resource&&this.editorHelper.matchesFile(t.resource,e)||t.associatedResources.some(i=>this.editorHelper.matchesFile(i,e)))),this.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length>0)}handleActiveEditorChangeInHistory(e){const t=e==null?void 0:e.input;!t||t.isDisposed()||!this.includeInHistory(t)||(this.removeFromHistory(t),this.addToHistory(t))}addToHistory(e,t=!0){this.ensureHistoryLoaded(this.history);const i=this.editorHelper.preferResourceEditorInput(e);i&&(t?this.history.unshift(i):this.history.push(i),this.history.length>Gt.MAX_HISTORY_ITEMS&&this.editorHelper.clearOnEditorDispose(this.history.pop(),this.editorHistoryListeners),pe(i)&&this.editorHelper.onEditorDispose(i,()=>this.updateHistoryOnEditorDispose(i),this.editorHistoryListeners))}updateHistoryOnEditorDispose(e){if(!Am(e))this.removeFromHistory(e);else{const t=[],i=e.primary.matches(e.secondary)?[e.primary]:[e.primary,e.secondary];for(const o of i){const s=this.editorHelper.preferResourceEditorInput(o);Jo(s)&&t.push(s)}this.replaceInHistory(e,...t)}}includeInHistory(e){return pe(e)?!0:!this.resourceExcludeMatcher.value.matches(e.resource)}removeExcludedFromHistory(){this.ensureHistoryLoaded(this.history),this.history=this.history.filter(e=>{const t=this.includeInHistory(e);return t||this.editorHelper.clearOnEditorDispose(e,this.editorHistoryListeners),t})}moveInHistory(e){e.isOperation(2)&&this.removeFromHistory(e)&&this.addToHistory({resource:e.target.resource})}removeFromHistory(e){let t=!1;return this.ensureHistoryLoaded(this.history),this.history=this.history.filter(i=>{const o=this.editorHelper.matchesEditor(e,i);return o&&(this.editorHelper.clearOnEditorDispose(e,this.editorHistoryListeners),t=!0),!o}),t}replaceInHistory(e,...t){this.ensureHistoryLoaded(this.history);let i=!1;const o=[];for(const s of this.history)this.editorHelper.matchesEditor(e,s)?(this.editorHelper.clearOnEditorDispose(e,this.editorHistoryListeners),i||(o.push(...t),i=!0)):t.some(n=>this.editorHelper.matchesEditor(n,s))||o.push(s);i||o.push(...t),this.history=o}clearRecentlyOpened(){this.history=[];for(const[,e]of this.editorHistoryListeners)ie(e);this.editorHistoryListeners.clear()}getHistory(){return this.ensureHistoryLoaded(this.history),this.history}ensureHistoryLoaded(e){this.history||(this.history=[],this.editorGroupService.isReady?this.loadHistory():(async()=>(await this.editorGroupService.whenReady,this.loadHistory()))())}loadHistory(){var o;this.history=[];const e=this.loadHistoryFromStorage(),t=[...this.editorService.getEditors(0)].reverse(),i=new Set;for(const{editor:s}of t)this.includeInHistory(s)&&(this.addToHistory(s),s.resource&&i.add(`${s.resource.toString()}/${s.editorId}`));for(const s of e)i.has(`${s.resource.toString()}/${(o=s.options)==null?void 0:o.override}`)||this.addToHistory(s,!1)}loadHistoryFromStorage(){const e=[],t=this.storageService.get(Gt.HISTORY_STORAGE_KEY,1);if(t)try{const i=JSON.parse(t);for(const o of i)if(!(!o.editor||!o.editor.resource))try{e.push({...o.editor,resource:typeof o.editor.resource=="string"?T.parse(o.editor.resource):T.from(o.editor.resource)})}catch(s){po(s)}}catch(i){po(i)}return e}saveState(){if(!this.history)return;const e=[];for(const t of this.history)pe(t)||!Jo(t)||e.push({editor:{...t,resource:t.resource.toString()}});this.storageService.store(Gt.HISTORY_STORAGE_KEY,JSON.stringify(e),1,1)}getLastActiveWorkspaceRoot(e){const t=this.contextService.getWorkspace().folders;if(t.length!==0){if(t.length===1){const i=t[0].uri;return!e||i.scheme===e?i:void 0}for(const i of this.getHistory()){if(pe(i)||e&&i.resource.scheme!==e)continue;const o=this.contextService.getWorkspaceFolder(i.resource);if(o)return o.uri}for(const i of t){const o=i.uri;if(!e||o.scheme===e)return o}}}getLastActiveFile(e){for(const t of this.getHistory()){let i;if(pe(t)?i=ne.getOriginalUri(t,{filterByScheme:e}):i=t.resource,(i==null?void 0:i.scheme)===e)return i}}};yi.MOUSE_NAVIGATION_SETTING="workbench.editor.mouseBackForwardToNavigate";yi.NAVIGATION_SCOPE_SETTING="workbench.editor.navigationScope";yi.MAX_RECENTLY_CLOSED_EDITORS=20;yi.MAX_HISTORY_ITEMS=200;yi.HISTORY_STORAGE_KEY="history.entries";yi=C([h(0,P),h(1,ee),h(2,ze),h(3,oe),h(4,O),h(5,Ce),h(6,lc),h(7,I),h(8,st),h(9,G)],yi);class Sh{constructor(e,t,i){this.editorIdentifier=e,this.selection=t,this.reason=i}justifiesNewNavigationEntry(e){if(this.editorIdentifier.groupId!==e.editorIdentifier.groupId||!this.editorIdentifier.editor.matches(e.editorIdentifier.editor)||!this.selection||!e.selection)return!0;const t=this.selection.compare(e.selection);return t===2&&(e.reason===4||e.reason===5)?!0:t===3}}let jo=class extends V{constructor(e,t){super(),this.scope=e,this.instantiationService=t,this.selectionsStack=this._register(this.instantiationService.createInstance(co,0,this.scope)),this.editsStack=this._register(this.instantiationService.createInstance(co,1,this.scope)),this.navigationsStack=this._register(this.instantiationService.createInstance(co,2,this.scope)),this.stacks=[this.selectionsStack,this.editsStack,this.navigationsStack],this.onDidChange=A.any(this.selectionsStack.onDidChange,this.editsStack.onDidChange,this.navigationsStack.onDidChange)}canGoForward(e){return this.getStack(e).canGoForward()}goForward(e){return this.getStack(e).goForward()}canGoBack(e){return this.getStack(e).canGoBack()}goBack(e){return this.getStack(e).goBack()}goPrevious(e){return this.getStack(e).goPrevious()}canGoLast(e){return this.getStack(e).canGoLast()}goLast(e){return this.getStack(e).goLast()}getStack(e=0){switch(e){case 0:return this.selectionsStack;case 1:return this.editsStack;case 2:return this.navigationsStack}}handleActiveEditorChange(e){this.selectionsStack.notifyNavigation(e)}handleActiveEditorSelectionChange(e,t){const i=this.selectionsStack.current;this.selectionsStack.notifyNavigation(e,t),t.reason===3?this.editsStack.notifyNavigation(e,t):(t.reason===4||t.reason===5)&&!this.selectionsStack.isNavigating()&&(t.reason===5&&!this.navigationsStack.isNavigating()&&i&&this.navigationsStack.addOrReplace(i.groupId,i.editor,i.selection),this.navigationsStack.notifyNavigation(e,t))}clear(){for(const e of this.stacks)e.clear()}remove(e){for(const t of this.stacks)t.remove(e)}move(e){for(const t of this.stacks)t.move(e)}};jo=C([h(1,I)],jo);class oS{constructor(){this.onDidChange=A.None}canGoForward(){return!1}async goForward(){}canGoBack(){return!1}async goBack(){}async goPrevious(){}canGoLast(){return!1}async goLast(){}handleActiveEditorChange(){}handleActiveEditorSelectionChange(){}clear(){}remove(){}move(){}dispose(){}}let co=class Lp extends V{get current(){return this.stack[this.index]}set current(e){e&&(this.stack[this.index]=e)}constructor(e,t,i,o,s,n){super(),this.filter=e,this.scope=t,this.instantiationService=i,this.editorService=o,this.editorGroupService=s,this.logService=n,this._onDidChange=this._register(new w),this.onDidChange=this._onDidChange.event,this.mapEditorToDisposable=new Map,this.mapGroupToDisposable=new Map,this.editorHelper=this.instantiationService.createInstance(In),this.stack=[],this.index=-1,this.previousIndex=-1,this.navigating=!1,this.currentSelectionState=void 0,this.registerListeners()}registerListeners(){this._register(this.onDidChange(()=>this.traceStack())),this._register(this.logService.onDidChangeLogLevel(()=>this.traceStack()))}traceStack(){var t,i,o;if(this.logService.getLevel()!==Yd.Trace)return;const e=[];for(const s of this.stack)typeof((t=s.selection)==null?void 0:t.log)=="function"?e.push(`- group: ${s.groupId}, editor: ${(i=s.editor.resource)==null?void 0:i.toString()}, selection: ${s.selection.log()}`):e.push(`- group: ${s.groupId}, editor: ${(o=s.editor.resource)==null?void 0:o.toString()}, selection: <none>`);e.length===0?this.trace(`index: ${this.index}, navigating: ${this.isNavigating()}: <empty>`):this.trace(`index: ${this.index}, navigating: ${this.isNavigating()}
${e.join(`
`)}
			`)}trace(e,t=null,i){var n;if(this.logService.getLevel()!==Yd.Trace)return;let o;switch(this.filter){case 0:o="global";break;case 1:o="edits";break;case 2:o="navigation";break}let s;switch(this.scope){case 0:s="default";break;case 1:s="editorGroup";break;case 2:s="editor";break}t!==null?this.logService.trace(`[History stack ${o}-${s}]: ${e} (editor: ${(n=t==null?void 0:t.resource)==null?void 0:n.toString()}, event: ${this.traceEvent(i)})`):this.logService.trace(`[History stack ${o}-${s}]: ${e}`)}traceEvent(e){if(!e)return"<none>";switch(e.reason){case 3:return"edit";case 4:return"navigation";case 5:return"jump";case 1:return"programmatic";case 2:return"user"}}registerGroupListeners(e){if(!this.mapGroupToDisposable.has(e)){const t=this.editorGroupService.getGroup(e);t&&this.mapGroupToDisposable.set(e,t.onWillMoveEditor(i=>this.onWillMoveEditor(i)))}}onWillMoveEditor(e){if(this.trace("onWillMoveEditor()",e.editor),this.scope!==1)for(const t of this.stack)t.groupId===e.groupId&&this.editorHelper.matchesEditor(e.editor,t.editor)&&(t.groupId=e.target)}notifyNavigation(e,t){this.trace("notifyNavigation()",e==null?void 0:e.input,t);const i=Lr(e),o=(e==null?void 0:e.group)&&e.input&&!e.input.isDisposed();this.navigating?(this.trace("notifyNavigation() ignoring (navigating)",e==null?void 0:e.input,t),i&&o?(this.trace("notifyNavigation() updating current selection state",e==null?void 0:e.input,t),this.currentSelectionState=new Sh({groupId:e.group.id,editor:e.input},e.getSelection(),t==null?void 0:t.reason)):(this.trace("notifyNavigation() dropping current selection state",e==null?void 0:e.input,t),this.currentSelectionState=void 0)):(this.trace("notifyNavigation() not ignoring",e==null?void 0:e.input,t),i&&o?this.onSelectionAwareEditorNavigation(e.group.id,e.input,e.getSelection(),t):(this.currentSelectionState=void 0,o&&this.onNonSelectionAwareEditorNavigation(e.group.id,e.input)))}onSelectionAwareEditorNavigation(e,t,i,o){var n;if(((n=this.current)==null?void 0:n.groupId)===e&&!i&&this.editorHelper.matchesEditor(this.current.editor,t))return;this.trace("onSelectionAwareEditorNavigation()",t,o);const s=new Sh({groupId:e,editor:t},i,o==null?void 0:o.reason);!this.currentSelectionState||this.currentSelectionState.justifiesNewNavigationEntry(s)?this.doAdd(e,t,s.selection):this.doReplace(e,t,s.selection),this.currentSelectionState=s}onNonSelectionAwareEditorNavigation(e,t){var i;((i=this.current)==null?void 0:i.groupId)===e&&this.editorHelper.matchesEditor(this.current.editor,t)||(this.trace("onNonSelectionAwareEditorNavigation()",t),this.doAdd(e,t))}doAdd(e,t,i){this.navigating||this.addOrReplace(e,t,i)}doReplace(e,t,i){this.navigating||this.addOrReplace(e,t,i,!0)}addOrReplace(e,t,i,o){this.registerGroupListeners(e);let s=!1;this.current&&(o||this.shouldReplaceStackEntry(this.current,{groupId:e,editor:t,selection:i}))&&(s=!0);const n=this.editorHelper.preferResourceEditorInput(t);if(!n)return;s?this.trace("replace()",n):this.trace("add()",n);const r={groupId:e,editor:n,selection:i},a=[];if(s)this.current&&a.push(this.current),this.current=r;else{if(this.stack.length>this.index+1){for(let d=this.index+1;d<this.stack.length;d++)a.push(this.stack[d]);this.stack=this.stack.slice(0,this.index+1)}this.stack.splice(this.index+1,0,r),this.stack.length>Lp.MAX_STACK_SIZE?(a.push(this.stack.shift()),this.previousIndex>=0&&this.previousIndex--):this.setIndex(this.index+1,!0)}for(const d of a)this.editorHelper.clearOnEditorDispose(d.editor,this.mapEditorToDisposable);pe(n)&&this.editorHelper.onEditorDispose(n,()=>this.remove(n),this.mapEditorToDisposable),this._onDidChange.fire()}shouldReplaceStackEntry(e,t){return e.groupId!==t.groupId||!this.editorHelper.matchesEditor(e.editor,t.editor)?!1:e.selection?t.selection?e.selection.compare(t.selection)===1:!1:!0}move(e){if(e.isOperation(2))for(const t of this.stack)this.editorHelper.matchesEditor(e,t.editor)&&(t.editor={resource:e.target.resource})}remove(e){var t;this.stack=this.stack.filter(i=>{const o=typeof e=="number"?i.groupId===e:this.editorHelper.matchesEditor(e,i.editor);return o&&this.editorHelper.clearOnEditorDispose(i.editor,this.mapEditorToDisposable),!o}),this.flatten(),this.index=this.stack.length-1,this.previousIndex=-1,typeof e=="number"&&((t=this.mapGroupToDisposable.get(e))==null||t.dispose(),this.mapGroupToDisposable.delete(e)),this._onDidChange.fire()}flatten(){const e=[];let t;for(const i of this.stack)t&&this.shouldReplaceStackEntry(i,t)||(t=i,e.push(i));this.stack=e}clear(){this.index=-1,this.previousIndex=-1,this.stack.splice(0);for(const[,e]of this.mapEditorToDisposable)ie(e);this.mapEditorToDisposable.clear();for(const[,e]of this.mapGroupToDisposable)ie(e);this.mapGroupToDisposable.clear()}dispose(){super.dispose(),this.clear()}canGoForward(){return this.stack.length>this.index+1}async goForward(){if(!await this.maybeGoCurrent()&&this.canGoForward())return this.setIndex(this.index+1),this.navigate()}canGoBack(){return this.index>0}async goBack(){if(!await this.maybeGoCurrent()&&this.canGoBack())return this.setIndex(this.index-1),this.navigate()}async goPrevious(){if(!await this.maybeGoCurrent())return this.previousIndex===-1?this.goBack():(this.setIndex(this.previousIndex),this.navigate())}canGoLast(){return this.stack.length>0}async goLast(){if(this.canGoLast())return this.setIndex(this.stack.length-1),this.navigate()}async maybeGoCurrent(){return this.filter===0||this.isCurrentSelectionActive()?!1:(await this.navigate(),!0)}isCurrentSelectionActive(){var i,o;if(!((i=this.current)!=null&&i.selection))return!1;const e=this.editorService.activeEditorPane;if(!Lr(e)||((o=e.group)==null?void 0:o.id)!==this.current.groupId||!e.input||!this.editorHelper.matchesEditor(e.input,this.current.editor))return!1;const t=e.getSelection();return t?t.compare(this.current.selection)===1:!1}setIndex(e,t){this.previousIndex=this.index,this.index=e,t||this._onDidChange.fire()}async navigate(){this.navigating=!0;try{this.current&&await this.doNavigate(this.current)}finally{this.navigating=!1}}doNavigate(e){let t=Object.create(null);return e.selection&&(t=e.selection.restore(t)),pe(e.editor)?this.editorService.openEditor(e.editor,t,e.groupId):this.editorService.openEditor({...e.editor,options:{...e.editor.options,...t}},e.groupId)}isNavigating(){return this.navigating}};co.MAX_STACK_SIZE=50;co=C([h(2,I),h(3,P),h(4,ee),h(5,it)],co);let In=class{constructor(e,t,i,o){this.uriIdentityService=e,this.lifecycleService=t,this.fileService=i,this.pathService=o}preferResourceEditorInput(e){const t=ne.getOriginalUri(e);if((t==null?void 0:t.scheme)===Q.file||(t==null?void 0:t.scheme)===Q.vscodeRemote||(t==null?void 0:t.scheme)===Q.vscodeUserData||(t==null?void 0:t.scheme)===this.pathService.defaultUriScheme){if(pe(e)){const o=e.toUntyped();if(Jo(o))return o}return e}else return pe(e)?e:void 0}matchesEditor(e,t){return e instanceof no||e instanceof Jd?pe(t)?!1:e instanceof no?e.contains(t.resource,2):this.matchesFile(t.resource,e):pe(e)?pe(t)?e.matches(t):this.matchesFile(t.resource,e):pe(t)?this.matchesFile(e.resource,t):e&&t&&this.uriIdentityService.extUri.isEqual(e.resource,t.resource)}matchesFile(e,t){if(t instanceof no)return t.contains(e,2);if(t instanceof Jd)return this.uriIdentityService.extUri.isEqualOrParent(e,t.resource);if(pe(t)){const i=t.resource;return!i||this.lifecycleService.phase>=3&&!this.fileService.hasProvider(i)?!1:this.uriIdentityService.extUri.isEqual(i,e)}return this.uriIdentityService.extUri.isEqual(t==null?void 0:t.resource,e)}matchesEditorIdentifier(e,t){return!(t!=null&&t.group)||e.groupId!==t.group.id?!1:t.input?e.editor.matches(t.input):!1}onEditorDispose(e,t,i){const o=A.once(e.onWillDispose)(()=>t());let s=i.get(e);s||(s=new x,i.set(e,s)),s.add(o)}clearOnEditorDispose(e,t){if(!pe(e))return;const i=t.get(e);i&&(ie(i),t.delete(e))}};In=C([h(0,si),h(1,_o),h(2,Ce),h(3,Mn)],In);class sS{constructor(){this._factories=new Su,this._onDidChange=new w,this.onDidChange=this._onDidChange.event}canCreateOutline(e){for(const t of this._factories)if(t.matches(e))return!0;return!1}async createOutline(e,t,i){for(const o of this._factories)if(o.matches(e))return await o.createOutline(e,t,i)}registerOutlineCreator(e){const t=this._factories.push(e);return this._onDidChange.fire(),Y(()=>{t(),this._onDidChange.fire()})}}var nS=".webview.modified{box-shadow:-6px 0 5px -5px var(--vscode-scrollbar-shadow)}";he(nS,{});class rS{constructor(){this._references=new Map}async getAllModels(e){const t=`${e.toString()}@@@`,i=[];for(const[o,s]of this._references)o.startsWith(t)&&s.model&&i.push(await s.model);return i}async get(e,t){const i=this.key(e,t),o=this._references.get(i);return o==null?void 0:o.model}tryRetain(e,t){const i=this.key(e,t),o=this._references.get(i);if(o)return o.counter++,o.model.then(s=>({object:s,dispose:iw(()=>{--o.counter<=0&&(o.model.then(n=>n.dispose()),this._references.delete(i))})}))}add(e,t,i){const o=this.key(e,t);if(this._references.get(o))throw new Error("Model already exists");return this._references.set(o,{viewType:t,model:i,counter:0}),this.tryRetain(e,t)}disposeAllModelsForView(e){for(const[t,i]of this._references)i.viewType===e&&(i.model.then(o=>o.dispose()),this._references.delete(t))}key(e,t){return`${e.toString()}@@@${t}`}}const lt=Object.freeze({viewType:"viewType",displayName:"displayName",selector:"selector",priority:"priority"}),aS={description:u("contributes.customEditors","Contributed custom editors."),type:"array",defaultSnippets:[{body:[{[lt.viewType]:"$1",[lt.displayName]:"$2",[lt.selector]:[{filenamePattern:"$3"}]}]}],items:{type:"object",required:[lt.viewType,lt.displayName,lt.selector],properties:{[lt.viewType]:{type:"string",markdownDescription:u("contributes.viewType","Identifier for the custom editor. This must be unique across all custom editors, so we recommend including your extension id as part of `viewType`. The `viewType` is used when registering custom editors with `vscode.registerCustomEditorProvider` and in the `onCustomEditor:${id}` [activation event](https://code.visualstudio.com/api/references/activation-events).")},[lt.displayName]:{type:"string",description:u("contributes.displayName","Human readable name of the custom editor. This is displayed to users when selecting which editor to use.")},[lt.selector]:{type:"array",description:u("contributes.selector","Set of globs that the custom editor is enabled for."),items:{type:"object",defaultSnippets:[{body:{filenamePattern:"$1"}}],properties:{filenamePattern:{type:"string",description:u("contributes.selector.filenamePattern","Glob that the custom editor is enabled for.")}}}},[lt.priority]:{type:"string",markdownDeprecationMessage:u("contributes.priority","Controls if the custom editor is enabled automatically when the user opens a file. This may be overridden by users using the `workbench.editorAssociations` setting."),enum:["default","option"],markdownEnumDescriptions:[u("contributes.priority.default","The editor is automatically used when the user opens a resource, provided that no other default custom editors are registered for that resource."),u("contributes.priority.option","The editor is not automatically used when the user opens a resource, but a user can switch to the editor using the `Reopen With` command.")],default:"default"}}}},cS=kc.registerExtensionPoint({extensionPoint:"customEditors",deps:[Tm],jsonSchema:aS,activationEventsGenerator:(c,e)=>{for(const t of c){const i=t[lt.viewType];i&&e.push(`onCustomEditor:${i}`)}}});class Pi extends V{constructor(e){super(),this._editors=new Map,this._onChange=this._register(new w),this.onChange=this._onChange.event,this._memento=new El(Pi.CUSTOM_EDITORS_STORAGE_ID,e);const t=this._memento.getMemento(0,1);for(const i of t[Pi.CUSTOM_EDITORS_ENTRY_ID]||[])this.add(new Pd(i));cS.setHandler(i=>{this.update(i)})}update(e){this._editors.clear();for(const i of e)for(const o of i.value)this.add(new Pd({id:o.viewType,displayName:o.displayName,providerDisplayName:i.description.isBuiltin?u("builtinProviderDisplayName","Built-in"):i.description.displayName||i.description.identifier.value,selector:o.selector||[],priority:dS(o,i.description)}));const t=this._memento.getMemento(0,1);t[Pi.CUSTOM_EDITORS_ENTRY_ID]=Array.from(this._editors.values()),this._memento.saveMemento(),this._onChange.fire()}[Symbol.iterator](){return this._editors.values()}get(e){return this._editors.get(e)}getContributedEditors(e){return Array.from(this._editors.values()).filter(t=>t.matches(e))}add(e){if(this._editors.has(e.id)){console.error(`Custom editor with id '${e.id}' already registered`);return}this._editors.set(e.id,e)}}Pi.CUSTOM_EDITORS_STORAGE_ID="customEditors";Pi.CUSTOM_EDITORS_ENTRY_ID="editors";function dS(c,e){switch(c.priority){case Te.default:case Te.option:return c.priority;case Te.builtin:return e.isBuiltin?Te.builtin:Te.default;default:return Te.default}}let Ja=class extends V{constructor(e,t,i,o,s,n,r,a){super(),this.editorService=o,this.editorGroupService=s,this.instantiationService=n,this.uriIdentityService=r,this.editorResolverService=a,this._untitledCounter=0,this._editorResolverDisposables=this._register(new x),this._editorCapabilities=new Map,this._models=new rS,this._onDidChangeEditorTypes=this._register(new w),this.onDidChangeEditorTypes=this._onDidChangeEditorTypes.event,this._fileEditorFactory=M.as(ii.EditorFactory).getFileEditorFactory(),this._activeCustomEditorId=Vm.bindTo(e),this._focusedCustomEditorIsEditable=Om.bindTo(e),this._contributedEditors=this._register(new Pi(i)),this.editorResolverService.bufferChangeEvents(this.registerContributionPoints.bind(this)),this._register(this._contributedEditors.onChange(()=>{this.editorResolverService.bufferChangeEvents(this.registerContributionPoints.bind(this)),this.updateContexts(),this._onDidChangeEditorTypes.fire()})),this._register(this.editorService.onDidActiveEditorChange(()=>this.updateContexts())),this._register(t.onDidRunOperation(l=>{l.isOperation(2)&&this.handleMovedFileInOpenedFileEditors(l.resource,this.uriIdentityService.asCanonicalUri(l.target.resource))}));const d=105;this._register(wu.addImplementation(d,"custom-editor",()=>this.withActiveCustomEditor(l=>l.undo()))),this._register(yu.addImplementation(d,"custom-editor",()=>this.withActiveCustomEditor(l=>l.redo()))),this.updateContexts()}getEditorTypes(){return[...this._contributedEditors]}withActiveCustomEditor(e){const t=this.editorService.activeEditor;if(t instanceof $e){const i=e(t);return i||!0}return!1}registerContributionPoints(){this._editorResolverDisposables.clear();for(const e of this._contributedEditors)for(const t of e.selector)t.filenamePattern&&this._editorResolverDisposables.add(this.editorResolverService.registerEditor(t.filenamePattern,{id:e.id,label:e.displayName,detail:e.providerDisplayName,priority:e.priority},{singlePerResource:()=>{var i;return!((i=this.getCustomEditorCapabilities(e.id))!=null&&i.supportsMultipleEditorsPerDocument)}},{createEditorInput:({resource:i},o)=>({editor:$e.create(this.instantiationService,i,e.id,o.id)}),createUntitledEditorInput:({resource:i},o)=>({editor:$e.create(this.instantiationService,i??T.from({scheme:Q.untitled,authority:`Untitled-${this._untitledCounter++}`}),e.id,o.id)}),createDiffEditorInput:(i,o)=>({editor:this.createDiffEditorInput(i,e.id,o)})}))}createDiffEditorInput(e,t,i){const o=$e.create(this.instantiationService,K(e.modified.resource),t,i.id,{customClasses:"modified"}),s=$e.create(this.instantiationService,K(e.original.resource),t,i.id,{customClasses:"original"});return this.instantiationService.createInstance(Nn,e.label,e.description,s,o,!0)}get models(){return this._models}getCustomEditor(e){return this._contributedEditors.get(e)}getContributedCustomEditors(e){return new lr(this._contributedEditors.getContributedEditors(e))}getUserConfiguredCustomEditors(e){const t=this.editorResolverService.getAssociationsForResource(e);return new lr(Ge(t.map(i=>this._contributedEditors.get(i.viewType))))}getAllCustomEditors(e){return new lr([...this.getUserConfiguredCustomEditors(e).allEditors,...this.getContributedCustomEditors(e).allEditors])}registerCustomEditorCapabilities(e,t){if(this._editorCapabilities.has(e))throw new Error(`Capabilities for ${e} already set`);return this._editorCapabilities.set(e,t),Y(()=>{this._editorCapabilities.delete(e)})}getCustomEditorCapabilities(e){return this._editorCapabilities.get(e)}updateContexts(){var i;const e=this.editorService.activeEditorPane;if(!((i=e==null?void 0:e.input)==null?void 0:i.resource)){this._activeCustomEditorId.reset(),this._focusedCustomEditorIsEditable.reset();return}this._activeCustomEditorId.set((e==null?void 0:e.input)instanceof $e?e.input.viewType:""),this._focusedCustomEditorIsEditable.set((e==null?void 0:e.input)instanceof $e)}async handleMovedFileInOpenedFileEditors(e,t){if(zt(e).toLowerCase()===zt(t).toLowerCase())return;const i=this.getAllCustomEditors(t);if(!i.allEditors.some(s=>s.priority!==Te.option))return;const o=new Map;for(const s of this.editorGroupService.groups)for(const n of s.editors)if(this._fileEditorFactory.isFileEditor(n)&&!(n instanceof $e)&&Re(n.resource,t)){let r=o.get(s.id);r||(r=[],o.set(s.id,r)),r.push(n)}if(o.size)for(const[s,n]of o)this.editorService.replaceEditors(n.map(r=>{let a;if(i.defaultEditor){const d=i.defaultEditor.id;a=$e.create(this.instantiationService,t,d,s)}else a={resource:t,options:{override:We.id}};return{editor:r,replacement:a,options:{preserveFocus:!0}}}),s)}};Ja=C([h(0,G),h(1,Ce),h(2,oe),h(3,P),h(4,ee),h(5,I),h(6,si),h(7,_s)],Ja);let Xa=class extends V{constructor(e,t){super(),this._themeService=e,this._configurationService=t,this._cachedWebViewThemeData=void 0,this._onThemeDataChanged=this._register(new w),this.onThemeDataChanged=this._onThemeDataChanged.event,this._register(this._themeService.onDidColorThemeChange(()=>{this._reset()}));const i=["editor.fontFamily","editor.fontWeight","editor.fontSize"];this._register(this._configurationService.onDidChangeConfiguration(o=>{i.some(s=>o.affectsConfiguration(s))&&this._reset()}))}getTheme(){return this._themeService.getColorTheme()}getWebviewThemeData(){if(!this._cachedWebViewThemeData){const e=this._configurationService.getValue("editor"),t=e.fontFamily||$s.fontFamily,i=e.fontWeight||$s.fontWeight,o=e.fontSize||$s.fontSize,s=this._themeService.getColorTheme(),n=ow().getColors().reduce((d,l)=>{const p=s.getColor(l.id);return p&&(d["vscode-"+l.id.replace(".","-")]=p.toString()),d},{}),r={"vscode-font-family":Gw,"vscode-font-weight":"normal","vscode-font-size":"13px","vscode-editor-font-family":t,"vscode-editor-font-weight":i,"vscode-editor-font-size":o+"px",...n},a=ps.fromTheme(s);this._cachedWebViewThemeData={styles:r,activeTheme:a,themeLabel:s.label,themeId:s.settingsId}}return this._cachedWebViewThemeData}_reset(){this._cachedWebViewThemeData=void 0,this._onThemeDataChanged.fire()}};Xa=C([h(0,Rm),h(1,O)],Xa);var ps;(function(c){c.light="vscode-light",c.dark="vscode-dark",c.highContrast="vscode-high-contrast",c.highContrastLight="vscode-high-contrast-light"})(ps||(ps={}));(function(c){function e(t){switch(t.type){case Zi.LIGHT:return c.light;case Zi.DARK:return c.dark;case Zi.HIGH_CONTRAST_DARK:return c.highContrast;case Zi.HIGH_CONTRAST_LIGHT:return c.highContrastLight}}c.fromTheme=e})(ps||(ps={}));class hS{constructor(e,t,i){this._getExtensionLocation=e,this._getMappings=t,this.tunnelService=i,this._tunnels=new Map}async getRedirect(e,t){const i=T.parse(t),o=Lm(i);if(o){for(const s of this._getMappings())if(s.webviewPort===o.port){const n=this._getExtensionLocation();if(n&&n.scheme===Q.vscodeRemote){const r=e&&await this.getOrCreateTunnel(e,s.extensionHostPort);if(r)return r.tunnelLocalPort===s.webviewPort?void 0:encodeURI(i.with({authority:`127.0.0.1:${r.tunnelLocalPort}`}).toString(!0))}if(s.webviewPort!==s.extensionHostPort)return encodeURI(i.with({authority:`${o.address}:${s.extensionHostPort}`}).toString(!0))}}}async dispose(){for(const e of this._tunnels.values())await e.dispose();this._tunnels.clear()}async getOrCreateTunnel(e,t){const i=this._tunnels.get(t);if(i)return i;const o=await this.tunnelService.openTunnel({getAddress:async()=>e},void 0,t);return o&&this._tunnels.set(t,o),o}}const lS=new Map([[".svg","image/svg+xml"],[".txt",Ko.text],[".css","text/css"],[".js","application/javascript"],[".cjs","application/javascript"],[".mjs","application/javascript"],[".json","application/json"],[".html","text/html"],[".htm","text/html"],[".xhtml","application/xhtml+xml"],[".oft","font/otf"],[".xml","application/xml"],[".wasm","application/wasm"]]);function uS(c){const e=sw(c.fsPath).toLowerCase();return lS.get(e)||nw(c.fsPath)||Ko.unknown}var Kt;(function(c){let e;(function(o){o[o.Success=0]="Success",o[o.Failed=1]="Failed",o[o.AccessDenied=2]="AccessDenied",o[o.NotModified=3]="NotModified"})(e=c.Type||(c.Type={}));class t{constructor(s,n,r,a){this.stream=s,this.etag=n,this.mtime=r,this.mimeType=a,this.type=e.Success}}c.StreamSuccess=t,c.Failed={type:e.Failed},c.AccessDenied={type:e.AccessDenied};class i{constructor(s,n){this.mimeType=s,this.mtime=n,this.type=e.NotModified}}c.NotModified=i})(Kt||(Kt={}));async function pS(c,e,t,i,o){var r;i.debug(`loadLocalResource - begin. requestUri=${c}`);const s=gS(c,e.roots);if(i.debug(`loadLocalResource - found resource to load. requestUri=${c}, resourceToLoad=${s}`),!s)return Kt.AccessDenied;const n=uS(c);try{const a=await t.readFileStream(s,{etag:e.ifNoneMatch},o);return new Kt.StreamSuccess(a.value,a.etag,a.mtime,n)}catch(a){return a instanceof vu&&a.fileOperationResult===2?new Kt.NotModified(n,(r=a.options)==null?void 0:r.mtime):(i.debug(`loadLocalResource - Error using fileReader. requestUri=${c}`),console.log(a),Kt.Failed)}}function gS(c,e){for(const t of e)if(fS(t,c))return mS(c)}function fS(c,e){if(c.scheme!==e.scheme)return!1;let t=Xd(e.fsPath),i=Xd(c.fsPath+(c.fsPath.endsWith($o)?"":$o));return Zd(c.fsPath)&&Zd(e.fsPath)&&(i=i.toLowerCase(),t=t.toLowerCase()),t.startsWith(i)}function mS(c){return c.scheme===Q.vscodeRemote?T.from({scheme:Q.vscodeRemote,authority:c.authority,path:"/vscode-resource",query:JSON.stringify({requestResourcePath:c.path})}):c}var bS=".monaco-workbench .simple-find-part-wrapper{max-width:calc(100% - 64px);overflow:hidden;padding:0 10px 10px;pointer-events:none;position:absolute;right:18px;top:0;z-index:10}.simple-find-part .monaco-inputbox>.ibwrapper>input{text-overflow:clip}.monaco-workbench .simple-find-part{align-items:center;background-color:var(--vscode-editorWidget-background)!important;border:1px solid var(--vscode-contrastBorder);border-bottom-left-radius:4px;border-bottom-right-radius:4px;box-shadow:0 0 8px 2px var(--vscode-widget-shadow);color:var(--vscode-editorWidget-foreground);display:flex;font-size:12px;padding:4px;pointer-events:all;position:relative;top:-45px;transition:top .2s linear;visibility:hidden;z-index:10}.monaco-workbench.reduce-motion .monaco-editor .find-widget{transition:top 0ms linear}.monaco-workbench .simple-find-part.visible{visibility:visible}.monaco-workbench .simple-find-part.suppress-transition{transition:none}.monaco-workbench .simple-find-part.visible-transition{top:0}.monaco-workbench .simple-find-part .monaco-findInput{flex:1}.monaco-workbench .simple-find-part .matchesCount{max-width:73px;min-width:73px;padding-left:5px;width:73px}.monaco-workbench .simple-find-part.reduced-find-widget .matchesCount{display:none}.monaco-workbench .simple-find-part .button{background-position:50%;background-repeat:no-repeat;cursor:pointer;display:flex;flex:initial;height:20px;justify-content:center;line-height:20px;margin-left:3px;min-width:20px;width:20px}.monaco-workbench div.simple-find-part div.button.disabled{cursor:default;opacity:.3!important}div.simple-find-part-wrapper div.button{border-radius:5px}.no-results.matchesCount{color:var(--vscode-errorForeground)}div.simple-find-part-wrapper div.button:hover:not(.disabled){background-color:var(--vscode-toolbar-hoverBackground);outline:1px dashed var(--vscode-toolbar-hoverOutline);outline-offset:-1px}";he(bS,{});const vS=u("label.find","Find"),wS=u("placeholder.find","Find ( for history)"),yS=u("label.previousMatchButton","Previous Match"),CS=u("label.nextMatchButton","Next Match"),SS=u("label.closeButton","Close"),_S=310,ES=73;class DS extends zn{constructor(e,t,i,o){super(),this._keybindingService=o,this._isVisible=!1,this._foundMatch=!1,this._width=0,this.state=new rw,this._matchesLimit=e.matchesLimit??Number.MAX_SAFE_INTEGER,this._findInput=this._register(new aw(null,t,{label:vS,placeholder:wS,validation:n=>{if(n.length===0||!this._findInput.getRegex())return null;try{return null}catch(r){return this._foundMatch=!1,this.updateButtons(this._foundMatch),{content:r.message}}},showCommonFindToggles:e.showCommonFindToggles,appendCaseSensitiveLabel:e.appendCaseSensitiveLabel&&e.type==="Terminal"?this._getKeybinding("workbench.action.terminal.toggleFindCaseSensitive"):void 0,appendRegexLabel:e.appendRegexLabel&&e.type==="Terminal"?this._getKeybinding("workbench.action.terminal.toggleFindRegex"):void 0,appendWholeWordsLabel:e.appendWholeWordsLabel&&e.type==="Terminal"?this._getKeybinding("workbench.action.terminal.toggleFindWholeWord"):void 0,showHistoryHint:()=>cw(o),inputBoxStyles:dw,toggleStyles:gu},i)),this._updateHistoryDelayer=new hw(500),this._register(this._findInput.onInput(async n=>{(!e.checkImeCompletionState||!this._findInput.isImeSessionInProgress)&&(this._foundMatch=this._onInputChanged(),e.showResultCount&&await this.updateResultCount(),this.updateButtons(this._foundMatch),this.focusFindBox(),this._delayedUpdateHistory())})),this._findInput.setRegex(!!this.state.isRegex),this._findInput.setCaseSensitive(!!this.state.matchCase),this._findInput.setWholeWords(!!this.state.wholeWord),this._register(this._findInput.onDidOptionChange(()=>{this.state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)})),this._register(this.state.onFindReplaceStateChange(()=>{this._findInput.setRegex(this.state.isRegex),this._findInput.setWholeWords(this.state.wholeWord),this._findInput.setCaseSensitive(this.state.matchCase),this.findFirst()})),this.prevBtn=this._register(new mr({label:yS,icon:lw,onTrigger:()=>{this.find(!0)}})),this.nextBtn=this._register(new mr({label:CS,icon:uw,onTrigger:()=>{this.find(!1)}}));const s=this._register(new mr({label:SS,icon:pw,onTrigger:()=>{this.hide()}}));this._innerDomNode=document.createElement("div"),this._innerDomNode.classList.add("simple-find-part"),this._innerDomNode.appendChild(this._findInput.domNode),this._innerDomNode.appendChild(this.prevBtn.domNode),this._innerDomNode.appendChild(this.nextBtn.domNode),this._innerDomNode.appendChild(s.domNode),this._domNode=document.createElement("div"),this._domNode.classList.add("simple-find-part-wrapper"),this._domNode.appendChild(this._innerDomNode),this.onkeyup(this._innerDomNode,n=>{if(n.equals(9)){this.hide(),n.preventDefault();return}}),this._focusTracker=this._register(bi(this._innerDomNode)),this._register(this._focusTracker.onDidFocus(this._onFocusTrackerFocus.bind(this))),this._register(this._focusTracker.onDidBlur(this._onFocusTrackerBlur.bind(this))),this._findInputFocusTracker=this._register(bi(this._findInput.domNode)),this._register(this._findInputFocusTracker.onDidFocus(this._onFindInputFocusTrackerFocus.bind(this))),this._register(this._findInputFocusTracker.onDidBlur(this._onFindInputFocusTrackerBlur.bind(this))),this._register(_(this._innerDomNode,"click",n=>{n.stopPropagation()})),e!=null&&e.showResultCount&&(this._domNode.classList.add("result-count"),this._matchesCount=document.createElement("div"),this._matchesCount.className="matchesCount",this._findInput.domNode.insertAdjacentElement("afterend",this._matchesCount),this._register(this._findInput.onDidChange(async()=>{await this.updateResultCount()})),this._register(this._findInput.onDidOptionChange(async()=>{this._foundMatch=this._onInputChanged(),await this.updateResultCount(),this.focusFindBox(),this._delayedUpdateHistory()})))}get inputValue(){return this._findInput.getValue()}get focusTracker(){return this._focusTracker}_getKeybinding(e){var i;const t=(i=this._keybindingService)==null?void 0:i.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}dispose(){super.dispose(),this._domNode&&this._domNode.parentElement&&this._domNode.parentElement.removeChild(this._domNode)}isVisible(){return this._isVisible}getDomNode(){return this._domNode}reveal(e,t=!0){if(e&&this._findInput.setValue(e),this._isVisible){this._findInput.select();return}this._isVisible=!0,this.updateResultCount(),this.layout(),setTimeout(()=>{this._innerDomNode.classList.toggle("suppress-transition",!t),this._innerDomNode.classList.add("visible","visible-transition"),this._innerDomNode.setAttribute("aria-hidden","false"),this._findInput.select(),t||setTimeout(()=>{this._innerDomNode.classList.remove("suppress-transition")},0)},0)}show(e){e&&!this._isVisible&&this._findInput.setValue(e),this._isVisible=!0,this.layout(),setTimeout(()=>{this._innerDomNode.classList.add("visible","visible-transition"),this._innerDomNode.setAttribute("aria-hidden","false")},0)}hide(e=!0){this._isVisible&&(this._innerDomNode.classList.toggle("suppress-transition",!e),this._innerDomNode.classList.remove("visible-transition"),this._innerDomNode.setAttribute("aria-hidden","true"),setTimeout(()=>{this._isVisible=!1,this.updateButtons(this._foundMatch),this._innerDomNode.classList.remove("visible","suppress-transition")},e?200:0))}layout(e=this._width){if(this._width=e,!!this._isVisible&&this._matchesCount){let t=!1;_S+ES+28>=e&&(t=!0),this._innerDomNode.classList.toggle("reduced-find-widget",t)}}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this))}_updateHistory(){this._findInput.inputBox.addToHistory()}_getRegexValue(){return this._findInput.getRegex()}_getWholeWordValue(){return this._findInput.getWholeWords()}_getCaseSensitiveValue(){return this._findInput.getCaseSensitive()}updateButtons(e){const t=this.inputValue.length>0;this.prevBtn.setEnabled(this._isVisible&&t&&e),this.nextBtn.setEnabled(this._isVisible&&t&&e)}focusFindBox(){this.nextBtn.focus(),this._findInput.inputBox.focus()}async updateResultCount(){if(!this._matchesCount){this.updateButtons(this._foundMatch);return}const e=await this._getResultCount();this._matchesCount.innerText="";const t=this.inputValue.length>0&&(e==null?void 0:e.resultCount)===0;this._matchesCount.classList.toggle("no-results",t);let i="";if(e!=null&&e.resultCount){let o=String(e.resultCount);e.resultCount>=this._matchesLimit&&(o+="+");let s=String(e.resultIndex+1);s==="0"&&(s="?"),i=gw(fw,s,o)}else i=Qd;mw(this._announceSearchResults(i,this.inputValue)),this._matchesCount.appendChild(document.createTextNode(i)),this._foundMatch=!!e&&e.resultCount>0,this.updateButtons(this._foundMatch)}changeState(e){this.state.change(e,!1)}_announceSearchResults(e,t){return t?e===Qd?t===""?u("ariaSearchNoResultEmpty","{0} found",e):u("ariaSearchNoResult","{0} found for '{1}'",e,t):u("ariaSearchNoResultWithLineNumNoCurrentMatch","{0} found for '{1}'",e,t):u("ariaSearchNoInput","Enter search input")}}let Za=class extends DS{async _getResultCount(e){}constructor(e,t,i,o){super({showCommonFindToggles:!1,checkImeCompletionState:e.checkImeCompletionState},t,i,o),this._delegate=e,this._findWidgetFocused=Ac.bindTo(i),this._register(e.hasFindResult(s=>{this.updateButtons(s),this.focusFindBox()})),this._register(e.onDidStopFind(()=>{this.updateButtons(!1)}))}find(e){const t=this.inputValue;t&&this._delegate.find(t,e)}hide(e=!0){super.hide(e),this._delegate.stopFind(!0),this._delegate.focus()}_onInputChanged(){const e=this.inputValue;return e?this._delegate.updateFind(e):this._delegate.stopFind(!1),!1}_onFocusTrackerFocus(){this._findWidgetFocused.set(!0)}_onFocusTrackerBlur(){this._findWidgetFocused.reset()}_onFindInputFocusTrackerFocus(){}_onFindInputFocusTrackerBlur(){}findFirst(){}};Za=C([h(1,$n),h(2,G),h(3,ve)],Za);var An;(function(c){(function(t){t[t.Initializing=0]="Initializing",t[t.Ready=1]="Ready"})(c.Type||(c.Type={}));class e{constructor(i){this.pendingMessages=i,this.type=0}}c.Initializing=e,c.Ready={type:1}})(An||(An={}));const kS="webviewId";let Qa=class extends V{get platform(){return"browser"}get element(){return this._element}get isFocused(){return!(!this._focused||document.activeElement&&document.activeElement!==this.element)}constructor(e,t,i,o,s,n,r,a,d,l,p,g,f){super(),this.webviewThemeDataProvider=t,this._environmentService=n,this._fileService=r,this._logService=a,this._remoteAuthorityResolverService=d,this._telemetryService=l,this._tunnelService=p,this._accessibilityService=f,this.id=Un(),this._expectedServiceWorkerVersion=4,this._state=new An.Initializing([]),this._resourceLoadingCts=this._register(new qe),this._focusDelayer=this._register(new bu(50)),this._onDidHtmlChange=this._register(new w),this.onDidHtmlChange=this._onDidHtmlChange.event,this._messageHandlers=new Map,this.checkImeCompletionState=!0,this._disposed=!1,this._onMissingCsp=this._register(new w),this.onMissingCsp=this._onMissingCsp.event,this._onDidClickLink=this._register(new w),this.onDidClickLink=this._onDidClickLink.event,this._onDidReload=this._register(new w),this.onDidReload=this._onDidReload.event,this._onMessage=this._register(new w),this.onMessage=this._onMessage.event,this._onDidScroll=this._register(new w),this.onDidScroll=this._onDidScroll.event,this._onDidWheel=this._register(new w),this.onDidWheel=this._onDidWheel.event,this._onDidUpdateState=this._register(new w),this.onDidUpdateState=this._onDidUpdateState.event,this._onDidFocus=this._register(new w),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new w),this.onDidBlur=this._onDidBlur.event,this._onFatalError=this._register(new w),this.onFatalError=this._onFatalError.event,this._onDidDispose=this._register(new w),this.onDidDispose=this._onDidDispose.event,this._hasAlertedAboutMissingCsp=!1,this._hasFindResult=this._register(new w),this.hasFindResult=this._hasFindResult.event,this._onDidStopFind=this._register(new w),this.onDidStopFind=this._onDidStopFind.event,this.providedViewType=e.providedViewType,this.origin=e.origin??this.id,this._encodedWebviewOriginPromise=Fm(window.origin,this.origin).then(m=>this._encodedWebviewOrigin=m),this._options=e.options,this.extension=e.extension,this._content={html:"",title:e.title,options:e.contentOptions,state:void 0},this._portMappingManager=this._register(new hS(()=>{var m;return(m=this.extension)==null?void 0:m.location},()=>this._content.options.portMapping||[],this._tunnelService)),this._element=this._createElement(e.options,e.contentOptions);const b=this._register(_(window,"message",m=>{var y,D;if(!(!this._encodedWebviewOrigin||((y=m==null?void 0:m.data)==null?void 0:y.target)!==this.id)&&m.data.channel==="webview-ready"){if(this._messagePort)return;this._logService.debug(`Webview(${this.id}): webview ready`),this._messagePort=m.ports[0],this._messagePort.onmessage=L=>{const $=this._messageHandlers.get(L.data.channel);if(!$){console.log(`No handlers found for '${L.data.channel}'`);return}$==null||$.forEach(Se=>Se(L.data.data,L))},(D=this.element)==null||D.classList.add("ready"),this._state.type===0&&this._state.pendingMessages.forEach(({channel:L,data:$})=>this.doPostMessage(L,$)),this._state=An.Ready,b.dispose()}}));this._register(this.on("no-csp-found",()=>{this.handleNoCspFound()})),this._register(this.on("did-click-link",({uri:m})=>{this._onDidClickLink.fire(m)})),this._register(this.on("onmessage",({message:m,transfer:y})=>{this._onMessage.fire({message:m,transfer:y})})),this._register(this.on("did-scroll",({scrollYPercentage:m})=>{this._onDidScroll.fire({scrollYPercentage:m})})),this._register(this.on("do-reload",()=>{this.reload()})),this._register(this.on("do-update-state",m=>{this.state=m,this._onDidUpdateState.fire(m)})),this._register(this.on("did-focus",()=>{this.handleFocusChange(!0)})),this._register(this.on("did-blur",()=>{this.handleFocusChange(!1)})),this._register(this.on("did-scroll-wheel",m=>{this._onDidWheel.fire(m)})),this._register(this.on("did-find",({didFind:m})=>{this._hasFindResult.fire(m)})),this._register(this.on("fatal-error",m=>{s.error(u("fatalErrorMessage","Error loading webview: {0}",m.message)),this._onFatalError.fire({message:m.message})})),this._register(this.on("did-keydown",m=>{this.handleKeyEvent("keydown",m)})),this._register(this.on("did-keyup",m=>{this.handleKeyEvent("keyup",m)})),this._register(this.on("did-context-menu",m=>{if(!this.element||!this._contextKeyService)return;const y=this.element.getBoundingClientRect(),D=this._contextKeyService.createOverlay([...Object.entries(m.context),[kS,this.providedViewType]]);o.showContextMenu({menuId:S.WebviewContext,menuActionOptions:{shouldForwardArgs:!0},contextKeyService:D,getActionsContext:()=>({...m.context,webview:this.providedViewType}),getAnchor:()=>({x:y.x+m.clientX,y:y.y+m.clientY})})})),this._register(this.on("load-resource",async m=>{try{const y=Nm(m.authority),D=T.from({scheme:m.scheme,authority:y,path:decodeURIComponent(m.path),query:m.query?decodeURIComponent(m.query):m.query});this.loadResource(m.id,D,m.ifNoneMatch)}catch{this._send("did-load-resource",{id:m.id,status:404,path:m.path})}})),this._register(this.on("load-localhost",m=>{this.localLocalhost(m.id,m.origin)})),this._register(A.runAndSubscribe(t.onThemeDataChanged,()=>this.style())),this._register(f.onDidChangeReducedMotion(()=>this.style())),this._register(f.onDidChangeScreenReaderOptimized(()=>this.style())),this._register(o.onDidShowContextMenu(()=>this._send("set-context-menu-visible",{visible:!0}))),this._register(o.onDidHideContextMenu(()=>this._send("set-context-menu-visible",{visible:!1}))),this._confirmBeforeClose=i.getValue("window.confirmBeforeClose"),this._register(i.onDidChangeConfiguration(m=>{m.affectsConfiguration("window.confirmBeforeClose")&&(this._confirmBeforeClose=i.getValue("window.confirmBeforeClose"),this._send("set-confirm-before-close",this._confirmBeforeClose))})),this._register(this.on("drag-start",()=>{this._startBlockingIframeDragEvents()})),e.options.enableFindWidget&&(this._webviewFindWidget=this._register(g.createInstance(Za,this))),this._encodedWebviewOriginPromise.then(m=>{this._disposed||this._initElement(m,this.extension,this._options)})}dispose(){var e;if(this._disposed=!0,(e=this.element)==null||e.remove(),this._element=void 0,this._messagePort=void 0,this._state.type===0){for(const t of this._state.pendingMessages)t.resolve(!1);this._state.pendingMessages=[]}this._onDidDispose.fire(),this._resourceLoadingCts.dispose(!0),super.dispose()}setContextKeyService(e){this._contextKeyService=e}postMessage(e,t){return this._send("message",{message:e,transfer:t})}async _send(e,t,i=[]){if(this._state.type===0){let o;const s=new Promise(n=>o=n);return this._state.pendingMessages.push({channel:e,data:t,transferable:i,resolve:o}),s}else return this.doPostMessage(e,t,i)}_createElement(e,t){const i=document.createElement("iframe");i.name=this.id,i.className=`webview ${e.customClasses||""}`,i.sandbox.add("allow-scripts","allow-same-origin","allow-forms","allow-pointer-lock","allow-downloads");const o=["cross-origin-isolated","autoplay"];return Wr||o.push("clipboard-read","clipboard-write"),i.setAttribute("allow",o.join("; ")),i.style.border="none",i.style.width="100%",i.style.height="100%",i.focus=()=>{this._doFocus()},i}_initElement(e,t,i){const o={id:this.id,origin:this.origin,swVersion:String(this._expectedServiceWorkerVersion),extensionId:(t==null?void 0:t.id.value)??"",platform:this.platform,"vscode-resource-base-authority":Bm,parentOrigin:window.origin};this._options.disableServiceWorker&&(o.disableServiceWorker="true"),this._environmentService.remoteAuthority&&(o.remoteAuthority=this._environmentService.remoteAuthority),i.purpose&&(o.purpose=i.purpose),o.serviceWorkerUri=br.asBrowserUri("vs/workbench/contrib/webview/browser/pre/service-worker.js").toString(!0),o.fakeHtmlUri=br.asBrowserUri("vs/workbench/contrib/webview/browser/pre/fake.html").toString(!0),bw.addSearchParam(o,!0,!0);const s=new URLSearchParams(o).toString(),n=Wr?"index-no-csp.html":"index.html",r=br.asBrowserUri(`vs/workbench/contrib/webview/browser/pre/${n}`);this.element.setAttribute("src",`${r.toString(!0)}?${s}`)}mountTo(e){if(this.element){this._webviewFindWidget&&e.appendChild(this._webviewFindWidget.getDomNode());for(const t of[E.MOUSE_DOWN,E.MOUSE_MOVE,E.DROP])this._register(_(e,t,()=>{this._stopBlockingIframeDragEvents()}));for(const t of[e,window])this._register(_(t,E.DRAG_END,()=>{this._stopBlockingIframeDragEvents()}));e.id=this.id,e.appendChild(this.element)}}_startBlockingIframeDragEvents(){this.element&&(this.element.style.pointerEvents="none")}_stopBlockingIframeDragEvents(){this.element&&(this.element.style.pointerEvents="auto")}webviewContentEndpoint(e){const t=this._environmentService.webviewExternalEndpoint;if(!t)throw new Error("'webviewExternalEndpoint' has not been configured. Webviews will not work!");const i=t.replace("{{uuid}}",e);return i[i.length-1]==="/"?i.slice(0,i.length-1):i}doPostMessage(e,t,i=[]){return this.element&&this._messagePort?(this._messagePort.postMessage({channel:e,args:t},i),!0):!1}on(e,t){let i=this._messageHandlers.get(e);return i||(i=new Set,this._messageHandlers.set(e,i)),i.add(t),Y(()=>{var o;(o=this._messageHandlers.get(e))==null||o.delete(t)})}handleNoCspFound(){var e;if(!this._hasAlertedAboutMissingCsp&&(this._hasAlertedAboutMissingCsp=!0,(e=this.extension)!=null&&e.id)){this._environmentService.isExtensionDevelopment&&this._onMissingCsp.fire(this.extension.id);const t={extension:this.extension.id.value};this._telemetryService.publicLog2("webviewMissingCsp",t)}}reload(){this.doUpdateContent(this._content);const e=this._register(this.on("did-load",()=>{this._onDidReload.fire(),e.dispose()}))}setHtml(e){this.doUpdateContent({...this._content,html:e}),this._onDidHtmlChange.fire(e)}setTitle(e){this._content={...this._content,title:e},this._send("set-title",e)}set contentOptions(e){if(this._logService.debug(`Webview(${this.id}): will update content options`),Wm(e,this._content.options)){this._logService.debug(`Webview(${this.id}): skipping content options update`);return}this.doUpdateContent({...this._content,options:e})}set localResourcesRoot(e){this._content={...this._content,options:{...this._content.options,localResourceRoots:e}}}set state(e){this._content={...this._content,state:e}}set initialScrollProgress(e){this._send("initial-scroll-position",e)}doUpdateContent(e){this._logService.debug(`Webview(${this.id}): will update content`),this._content=e;const t=!!this._content.options.allowScripts;this._send("content",{contents:this._content.html,title:this._content.title,options:{allowMultipleAPIAcquire:!!this._content.options.allowMultipleAPIAcquire,allowScripts:t,allowForms:this._content.options.allowForms??t},state:this._content.state,cspSource:Hm,confirmBeforeClose:this._confirmBeforeClose})}style(){let{styles:e,activeTheme:t,themeLabel:i,themeId:o}=this.webviewThemeDataProvider.getWebviewThemeData();this._options.transformCssVariables&&(e=this._options.transformCssVariables(e));const s=this._accessibilityService.isMotionReduced(),n=this._accessibilityService.isScreenReaderOptimized();this._send("styles",{styles:e,activeTheme:t,themeId:o,themeLabel:i,reduceMotion:s,screenReader:n})}handleFocusChange(e){this._focused=e,e?this._onDidFocus.fire():this._onDidBlur.fire()}handleKeyEvent(e,t){const i=new KeyboardEvent(e,t);Object.defineProperty(i,"target",{get:()=>this.element}),window.dispatchEvent(i)}windowDidDragStart(){this._startBlockingIframeDragEvents()}windowDidDragEnd(){this._stopBlockingIframeDragEvents()}selectAll(){this.execCommand("selectAll")}copy(){this.execCommand("copy")}paste(){this.execCommand("paste")}cut(){this.execCommand("cut")}undo(){this.execCommand("undo")}redo(){this.execCommand("redo")}execCommand(e){this.element&&this._send("execCommand",e)}async loadResource(e,t,i){try{const o=await pS(t,{ifNoneMatch:i,roots:this._content.options.localResourceRoots||[]},this._fileService,this._logService,this._resourceLoadingCts.token);switch(o.type){case Kt.Type.Success:{const s=await this.streamToBuffer(o.stream);return this._send("did-load-resource",{id:e,status:200,path:t.path,mime:o.mimeType,data:s,etag:o.etag,mtime:o.mtime},[s])}case Kt.Type.NotModified:return this._send("did-load-resource",{id:e,status:304,path:t.path,mime:o.mimeType,mtime:o.mtime});case Kt.Type.AccessDenied:return this._send("did-load-resource",{id:e,status:401,path:t.path})}}catch{}return this._send("did-load-resource",{id:e,status:404,path:t.path})}async streamToBuffer(e){return(await vw(e)).buffer.buffer}async localLocalhost(e,t){const i=this._environmentService.remoteAuthority,o=i?await this._remoteAuthorityResolverService.resolveAuthority(i):void 0,s=o?await this._portMappingManager.getRedirect(o.authority,t):void 0;return this._send("did-load-localhost",{id:e,origin:t,location:s})}focus(){this._doFocus(),this.handleFocusChange(!0)}_doFocus(){var e;if(this.element){try{(e=this.element.contentWindow)==null||e.focus()}catch{}this._focusDelayer.trigger(async()=>{var t;!this.isFocused||!this.element||document.activeElement&&document.activeElement!==this.element&&((t=document.activeElement)==null?void 0:t.tagName)!=="BODY"||this._send("focus",void 0)})}}find(e,t){this.element&&this._send("find",{value:e,previous:t})}updateFind(e){!e||!this.element||this._send("find",{value:e})}stopFind(e){this.element&&(this._send("find-stop",{clearSelection:!e}),this._onDidStopFind.fire())}showFind(e=!0){var t;(t=this._webviewFindWidget)==null||t.reveal(void 0,e)}hideFind(e=!0){var t;(t=this._webviewFindWidget)==null||t.hide(e)}runFindAction(e){var t;(t=this._webviewFindWidget)==null||t.find(e)}};Qa=C([h(2,O),h(3,ke),h(4,Ae),h(5,Lt),h(6,Ce),h(7,it),h(8,Mm),h(9,Ne),h(10,Pm),h(11,I),h(12,Nl)],Qa);let ec=class extends V{constructor(e,t,i,o){super(),this._layoutService=t,this._webviewService=i,this._baseContextKeyService=o,this._isFirstLoad=!0,this._firstLoadPendingMessages=new Set,this._webview=this._register(new Ie),this._webviewEvents=this._register(new x),this._html="",this._initialScrollProgress=0,this._state=void 0,this._owner=void 0,this._scopedContextKeyService=this._register(new Ie),this._shouldShowFindWidgetOnRestore=!1,this._isDisposed=!1,this._onDidDispose=this._register(new w),this.onDidDispose=this._onDidDispose.event,this._onDidFocus=this._register(new w),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new w),this.onDidBlur=this._onDidBlur.event,this._onDidClickLink=this._register(new w),this.onDidClickLink=this._onDidClickLink.event,this._onDidReload=this._register(new w),this.onDidReload=this._onDidReload.event,this._onDidScroll=this._register(new w),this.onDidScroll=this._onDidScroll.event,this._onDidUpdateState=this._register(new w),this.onDidUpdateState=this._onDidUpdateState.event,this._onMessage=this._register(new w),this.onMessage=this._onMessage.event,this._onMissingCsp=this._register(new w),this.onMissingCsp=this._onMissingCsp.event,this._onDidWheel=this._register(new w),this.onDidWheel=this._onDidWheel.event,this._onFatalError=this._register(new w),this.onFatalError=this._onFatalError.event,this.providedViewType=e.providedViewType,this.origin=e.origin??Un(),this._title=e.title,this._extension=e.extension,this._options=e.options,this._contentOptions=e.contentOptions}get isFocused(){var e;return!!((e=this._webview.value)!=null&&e.isFocused)}dispose(){var e;this._isDisposed=!0,(e=this._container)==null||e.domNode.remove(),this._container=void 0;for(const t of this._firstLoadPendingMessages)t.resolve(!1);this._firstLoadPendingMessages.clear(),this._onDidDispose.fire(),super.dispose()}get container(){if(this._isDisposed)throw new Error("OverlayWebview has been disposed");if(!this._container){const e=document.createElement("div");e.style.position="absolute",e.style.overflow="hidden",this._container=new yw(e),this._container.setVisibility("hidden"),this._layoutService.container.appendChild(e)}return this._container.domNode}claim(e,t){var o,s,n,r;if(this._isDisposed)return;const i=this._owner;if(this._owner=e,this._show(),i!==e){const a=t||this._baseContextKeyService;this._scopedContextKeyService.clear(),this._scopedContextKeyService.value=a.createScoped(this.container);const d=(o=this._findWidgetVisible)==null?void 0:o.get();(s=this._findWidgetVisible)==null||s.reset(),this._findWidgetVisible=xl.bindTo(a),this._findWidgetVisible.set(!!d),(n=this._findWidgetEnabled)==null||n.reset(),this._findWidgetEnabled=kl.bindTo(a),this._findWidgetEnabled.set(!!this.options.enableFindWidget),(r=this._webview.value)==null||r.setContextKeyService(this._scopedContextKeyService.value)}}release(e){var t;this._owner===e&&(this._scopedContextKeyService.clear(),this._owner=void 0,this._container&&this._container.setVisibility("hidden"),this._options.retainContextWhenHidden?(this._shouldShowFindWidgetOnRestore=!!((t=this._findWidgetVisible)!=null&&t.get()),this.hideFind(!1)):(this._webview.clear(),this._webviewEvents.clear()))}layoutWebviewOverElement(e,t,i){if(!this._container||!this._container.domNode.parentElement)return;const o=e.getBoundingClientRect(),s=this._container.domNode.parentElement.getBoundingClientRect(),n=(s.height-this._container.domNode.parentElement.clientHeight)/2,r=(s.width-this._container.domNode.parentElement.clientWidth)/2;if(this._container.setTop(o.top-s.top-n),this._container.setLeft(o.left-s.left-r),this._container.setWidth(t?t.width:o.width),this._container.setHeight(t?t.height:o.height),i){const{top:a,left:d,right:l,bottom:p}=xS(o,i);this._container.domNode.style.clipPath=`polygon(${d}px ${a}px, ${l}px ${a}px, ${l}px ${p}px, ${d}px ${p}px)`}}_show(){var e,t;if(this._isDisposed)throw new Error("OverlayWebview is disposed");if(!this._webview.value){const i=this._webviewService.createWebviewElement({providedViewType:this.providedViewType,origin:this.origin,title:this._title,options:this._options,contentOptions:this._contentOptions,extension:this.extension});this._webview.value=i,i.state=this._state,this._scopedContextKeyService.value&&this._webview.value.setContextKeyService(this._scopedContextKeyService.value),this._html&&i.setHtml(this._html),this._options.tryRestoreScrollPosition&&(i.initialScrollProgress=this._initialScrollProgress),(e=this._findWidgetEnabled)==null||e.set(!!this.options.enableFindWidget),i.mountTo(this.container),this._webviewEvents.clear(),this._webviewEvents.add(i.onDidFocus(()=>{this._onDidFocus.fire()})),this._webviewEvents.add(i.onDidBlur(()=>{this._onDidBlur.fire()})),this._webviewEvents.add(i.onDidClickLink(o=>{this._onDidClickLink.fire(o)})),this._webviewEvents.add(i.onMessage(o=>{this._onMessage.fire(o)})),this._webviewEvents.add(i.onMissingCsp(o=>{this._onMissingCsp.fire(o)})),this._webviewEvents.add(i.onDidWheel(o=>{this._onDidWheel.fire(o)})),this._webviewEvents.add(i.onDidReload(()=>{this._onDidReload.fire()})),this._webviewEvents.add(i.onFatalError(o=>{this._onFatalError.fire(o)})),this._webviewEvents.add(i.onDidScroll(o=>{this._initialScrollProgress=o.scrollYPercentage,this._onDidScroll.fire(o)})),this._webviewEvents.add(i.onDidUpdateState(o=>{this._state=o,this._onDidUpdateState.fire(o)})),this._isFirstLoad&&this._firstLoadPendingMessages.forEach(async o=>{o.resolve(await i.postMessage(o.message,o.transfer))}),this._isFirstLoad=!1,this._firstLoadPendingMessages.clear()}this.options.retainContextWhenHidden&&this._shouldShowFindWidgetOnRestore&&(this.showFind(!1),this._shouldShowFindWidgetOnRestore=!1),(t=this._container)==null||t.setVisibility("visible")}setHtml(e){this._html=e,this._withWebview(t=>t.setHtml(e))}setTitle(e){this._title=e,this._withWebview(t=>t.setTitle(e))}get initialScrollProgress(){return this._initialScrollProgress}set initialScrollProgress(e){this._initialScrollProgress=e,this._withWebview(t=>t.initialScrollProgress=e)}get state(){return this._state}set state(e){this._state=e,this._withWebview(t=>t.state=e)}get extension(){return this._extension}set extension(e){this._extension=e,this._withWebview(t=>t.extension=e)}get options(){return this._options}set options(e){this._options={customClasses:this._options.customClasses,...e}}get contentOptions(){return this._contentOptions}set contentOptions(e){this._contentOptions=e,this._withWebview(t=>t.contentOptions=e)}set localResourcesRoot(e){this._withWebview(t=>t.localResourcesRoot=e)}async postMessage(e,t){if(this._webview.value)return this._webview.value.postMessage(e,t);if(this._isFirstLoad){let i;const o=new Promise(s=>i=s);return this._firstLoadPendingMessages.add({message:e,transfer:t,resolve:i}),o}return!1}focus(){var e;(e=this._webview.value)==null||e.focus()}reload(){var e;(e=this._webview.value)==null||e.reload()}selectAll(){var e;(e=this._webview.value)==null||e.selectAll()}copy(){var e;(e=this._webview.value)==null||e.copy()}paste(){var e;(e=this._webview.value)==null||e.paste()}cut(){var e;(e=this._webview.value)==null||e.cut()}undo(){var e;(e=this._webview.value)==null||e.undo()}redo(){var e;(e=this._webview.value)==null||e.redo()}showFind(e=!0){var t;this._webview.value&&(this._webview.value.showFind(e),(t=this._findWidgetVisible)==null||t.set(!0))}hideFind(e=!0){var t,i;(t=this._findWidgetVisible)==null||t.reset(),(i=this._webview.value)==null||i.hideFind(e)}runFindAction(e){var t;(t=this._webview.value)==null||t.runFindAction(e)}_withWebview(e){this._webview.value&&e(this._webview.value)}windowDidDragStart(){var e;(e=this._webview.value)==null||e.windowDidDragStart()}windowDidDragEnd(){var e;(e=this._webview.value)==null||e.windowDidDragEnd()}setContextKeyService(e){var t;(t=this._webview.value)==null||t.setContextKeyService(e)}};ec=C([h(1,ww),h(2,Do),h(3,G)],ec);function xS(c,e){const t=e.getBoundingClientRect(),i=Math.max(t.top-c.top,0),o=Math.max(c.width-(c.right-t.right),0),s=Math.max(c.height-(c.bottom-t.bottom),0),n=Math.max(t.left-c.left,0);return{top:i,right:o,bottom:s,left:n}}let tc=class extends V{constructor(e){super(),this._instantiationService=e,this._webviews=new Set,this._onDidChangeActiveWebview=this._register(new w),this.onDidChangeActiveWebview=this._onDidChangeActiveWebview.event,this._webviewThemeDataProvider=this._instantiationService.createInstance(Xa)}get activeWebview(){return this._activeWebview}_updateActiveWebview(e){e!==this._activeWebview&&(this._activeWebview=e,this._onDidChangeActiveWebview.fire(e))}get webviews(){return this._webviews.values()}createWebviewElement(e){const t=this._instantiationService.createInstance(Qa,e,this._webviewThemeDataProvider);return this.registerNewWebview(t),t}createWebviewOverlay(e){const t=this._instantiationService.createInstance(ec,e);return this.registerNewWebview(t),t}registerNewWebview(e){this._webviews.add(e),e.onDidFocus(()=>{this._updateActiveWebview(e)});const t=()=>{this._activeWebview===e&&this._updateActiveWebview(void 0)};e.onDidBlur(t),e.onDidDispose(()=>{t(),this._webviews.delete(e)})}};tc=C([h(0,I)],tc);class gs{constructor(){this.uris=[]}async perform(){return this}toString(){return"(noop)"}}class Mp{constructor(e,t,i){this.newUri=e,this.oldUri=t,this.options=i,this.type="rename"}}let ic=class Pp{constructor(e,t,i,o){this._edits=e,this._undoRedoInfo=t,this._workingCopyFileService=i,this._fileService=o}get uris(){return this._edits.map(e=>[e.newUri,e.oldUri]).flat()}async perform(e){const t=[],i=[];for(const o of this._edits)o.options.overwrite===void 0&&o.options.ignoreIfExists&&await this._fileService.exists(o.newUri)||(t.push({file:{source:o.oldUri,target:o.newUri},overwrite:o.options.overwrite}),i.push(new Mp(o.oldUri,o.newUri,o.options)));return t.length===0?new gs:(await this._workingCopyFileService.move(t,e,this._undoRedoInfo),new Pp(i,{isUndoing:!0},this._workingCopyFileService,this._fileService))}toString(){return`(rename ${this._edits.map(e=>`${e.oldUri} to ${e.newUri}`).join(", ")})`}};ic=C([h(2,Gn),h(3,Ce)],ic);class IS{constructor(e,t,i){this.newUri=e,this.oldUri=t,this.options=i,this.type="copy"}}let oc=class{constructor(e,t,i,o,s){this._edits=e,this._undoRedoInfo=t,this._workingCopyFileService=i,this._fileService=o,this._instaService=s}get uris(){return this._edits.map(e=>[e.newUri,e.oldUri]).flat()}async perform(e){const t=[];for(const s of this._edits)s.options.overwrite===void 0&&s.options.ignoreIfExists&&await this._fileService.exists(s.newUri)||t.push({file:{source:s.oldUri,target:s.newUri},overwrite:s.options.overwrite});if(t.length===0)return new gs;const i=await this._workingCopyFileService.copy(t,e,this._undoRedoInfo),o=[];for(let s=0;s<i.length;s++){const n=i[s],r=this._edits[s];o.push(new md(n.resource,{recursive:!0,folder:this._edits[s].options.folder||n.isDirectory,...r.options},!1))}return this._instaService.createInstance(fs,o,{isUndoing:!0})}toString(){return`(copy ${this._edits.map(e=>`${e.oldUri} to ${e.newUri}`).join(", ")})`}};oc=C([h(2,Gn),h(3,Ce),h(4,I)],oc);class Fp{constructor(e,t,i){this.newUri=e,this.options=t,this.contents=i,this.type="create"}}let Tn=class{constructor(e,t,i,o,s,n){this._edits=e,this._undoRedoInfo=t,this._fileService=i,this._workingCopyFileService=o,this._instaService=s,this._textFileService=n}get uris(){return this._edits.map(e=>e.newUri)}async perform(e){const t=[],i=[],o=[];for(const s of this._edits)if(!(s.options.overwrite===void 0&&s.options.ignoreIfExists&&await this._fileService.exists(s.newUri))){if(s.options.folder)t.push({resource:s.newUri});else{const n=typeof s.contents<"u"?s.contents:await this._textFileService.getEncodedReadable(s.newUri);i.push({resource:s.newUri,contents:n,overwrite:s.options.overwrite})}o.push(new md(s.newUri,s.options,!s.options.folder&&!s.contents))}return t.length===0&&i.length===0?new gs:(await this._workingCopyFileService.createFolder(t,e,this._undoRedoInfo),await this._workingCopyFileService.create(i,e,this._undoRedoInfo),this._instaService.createInstance(fs,o,{isUndoing:!0}))}toString(){return`(create ${this._edits.map(e=>{var t;return e.options.folder?`folder ${e.newUri}`:`file ${e.newUri} with ${((t=e.contents)==null?void 0:t.byteLength)||0} bytes`}).join(", ")})`}};Tn=C([h(2,Ce),h(3,Gn),h(4,I),h(5,Eo)],Tn);class md{constructor(e,t,i){this.oldUri=e,this.options=t,this.undoesCreate=i,this.type="delete"}}let fs=class{constructor(e,t,i,o,s,n,r){this._edits=e,this._undoRedoInfo=t,this._workingCopyFileService=i,this._fileService=o,this._configurationService=s,this._instaService=n,this._logService=r}get uris(){return this._edits.map(e=>e.oldUri)}async perform(e){const t=[],i=[];for(const o of this._edits){let s;try{s=await this._fileService.resolve(o.oldUri,{resolveMetadata:!0})}catch{if(!o.options.ignoreIfNotExists)throw new Error(`${o.oldUri} does not exist and can not be deleted`);continue}t.push({resource:o.oldUri,recursive:o.options.recursive,useTrash:!o.options.skipTrashBin&&this._fileService.hasCapability(o.oldUri,4096)&&this._configurationService.getValue("files.enableTrash")});let n;if(!o.undoesCreate&&!o.options.folder&&!(typeof o.options.maxSize=="number"&&s.size>o.options.maxSize))try{n=await this._fileService.readFile(o.oldUri)}catch(r){this._logService.error(r)}n!==void 0&&i.push(new Fp(o.oldUri,o.options,n.value))}return t.length===0?new gs:(await this._workingCopyFileService.delete(t,e,this._undoRedoInfo),i.length===0?new gs:this._instaService.createInstance(Tn,i,{isUndoing:!0}))}toString(){return`(delete ${this._edits.map(e=>e.oldUri).join(", ")})`}};fs=C([h(2,Gn),h(3,Ce),h(4,O),h(5,I),h(6,it)],fs);class AS{constructor(e,t,i,o){this.label=e,this.code=t,this.operations=i,this.confirmBeforeUndo=o,this.type=1,this.resources=i.map(s=>s.uris).flat()}async undo(){await this._reverse()}async redo(){await this._reverse()}async _reverse(){for(let e=0;e<this.operations.length;e++){const i=await this.operations[e].perform(Bi.None);this.operations[e]=i}}toString(){return this.operations.map(e=>String(e)).join(", ")}}let sc=class{constructor(e,t,i,o,s,n,r,a,d,l){this._label=e,this._code=t,this._undoRedoGroup=i,this._undoRedoSource=o,this._confirmBeforeUndo=s,this._progress=n,this._token=r,this._edits=a,this._instaService=d,this._undoRedoService=l}async apply(){var n,r;const e=[],t={undoRedoGroupId:this._undoRedoGroup.id},i=[];for(const a of this._edits)a.newResource&&a.oldResource&&!((n=a.options)!=null&&n.copy)?i.push(new Mp(a.newResource,a.oldResource,a.options??{})):a.newResource&&a.oldResource&&((r=a.options)!=null&&r.copy)?i.push(new IS(a.newResource,a.oldResource,a.options??{})):!a.newResource&&a.oldResource?i.push(new md(a.oldResource,a.options??{},!1)):a.newResource&&!a.oldResource&&i.push(new Fp(a.newResource,a.options??{},await a.options.contents));if(i.length===0)return[];const o=[];o[0]=[i[0]];for(let a=1;a<i.length;a++){const d=i[a],l=ql(o);l[0].type===d.type?l.push(d):o.push([d])}for(const a of o){if(this._token.isCancellationRequested)break;let d;switch(a[0].type){case"rename":d=this._instaService.createInstance(ic,a,t);break;case"copy":d=this._instaService.createInstance(oc,a,t);break;case"delete":d=this._instaService.createInstance(fs,a,t);break;case"create":d=this._instaService.createInstance(Tn,a,t);break}if(d){const l=await d.perform(this._token);e.push(l)}this._progress.report(void 0)}const s=new AS(this._label,this._code,e,this._confirmBeforeUndo);return this._undoRedoService.pushElement(s,this._undoRedoGroup,this._undoRedoSource),s.resources}};sc=C([h(8,I),h(9,Xn)],sc);class Np{constructor(e){this._modelReference=e,this.model=this._modelReference.object.textEditorModel,this._edits=[]}dispose(){this._modelReference.dispose()}isNoOp(){return!(this._edits.length>0||this._newEol!==void 0&&this._newEol!==this.model.getEndOfLineSequence())}addEdit(e){this._expectedModelVersionId=e.versionId;const{textEdit:t}=e;if(typeof t.eol=="number"&&(this._newEol=t.eol),!t.range&&!t.text||Fe.isEmpty(t.range)&&!t.text)return;let i;t.range?i=Fe.lift(t.range):i=this.model.getFullModelRange(),this._edits.push({..._w.replaceMove(i,t.text),insertAsSnippet:t.insertAsSnippet})}validate(){return typeof this._expectedModelVersionId>"u"||this.model.getVersionId()===this._expectedModelVersionId?{canApply:!0}:{canApply:!1,reason:this.model.uri}}getBeforeCursorState(){return null}apply(){this._edits.length>0&&(this._edits=this._edits.map(this._transformSnippetStringToInsertText,this).sort((e,t)=>Fe.compareRangesUsingStarts(e.range,t.range)),this.model.pushEditOperations(null,this._edits,()=>null)),this._newEol!==void 0&&this.model.pushEOL(this._newEol)}_transformSnippetStringToInsertText(e){if(!e.insertAsSnippet||!e.text)return e;const t=_u.asInsertText(e.text);return{...e,insertAsSnippet:!1,text:t}}}class TS extends Np{constructor(e,t){super(e),this._editor=t}getBeforeCursorState(){return this._canUseEditor()?this._editor.getSelections():null}apply(){if(!this._canUseEditor()){super.apply();return}if(this._edits.length>0){const e=Ew.get(this._editor);if(e&&this._edits.some(t=>t.insertAsSnippet)){const t=[];for(const i of this._edits)i.range&&i.text!==null&&t.push({range:Fe.lift(i.range),template:i.insertAsSnippet?i.text:_u.escape(i.text)});e.apply(t,{undoStopBefore:!1,undoStopAfter:!1})}else this._edits=this._edits.map(this._transformSnippetStringToInsertText,this).sort((t,i)=>Fe.compareRangesUsingStarts(t.range,i.range)),this._editor.executeEdits("",this._edits)}this._newEol!==void 0&&this._editor.hasModel()&&this._editor.getModel().pushEOL(this._newEol)}_canUseEditor(){var e,t;return((t=(e=this._editor)==null?void 0:e.getModel())==null?void 0:t.uri.toString())===this.model.uri.toString()}}let nc=class{constructor(e,t,i,o,s,n,r,a,d,l,p,g){this._label=e,this._code=t,this._editor=i,this._undoRedoGroup=o,this._undoRedoSource=s,this._progress=n,this._token=r,this._editorWorker=d,this._modelService=l,this._textModelResolverService=p,this._undoRedoService=g,this._edits=new ot;for(const f of a){let b=this._edits.get(f.resource);b||(b=[],this._edits.set(f.resource,b)),b.push(f)}}_validateBeforePrepare(){for(const e of this._edits.values())for(const t of e)if(typeof t.versionId=="number"){const i=this._modelService.getModel(t.resource);if(i&&i.getVersionId()!==t.versionId)throw new Error(`${i.uri.toString()} has changed in the meantime`)}}async _createEditsTasks(){const e=[],t=[];for(const[i,o]of this._edits){const s=this._textModelResolverService.createModelReference(i).then(async n=>{var d,l;let r,a=!1;((l=(d=this._editor)==null?void 0:d.getModel())==null?void 0:l.uri.toString())===n.object.textEditorModel.uri.toString()?(r=new TS(n,this._editor),a=!0):r=new Np(n);for(const p of o)if(a&&!p.textEdit.insertAsSnippet){const g=await this._editorWorker.computeMoreMinimalEdits(p.resource,[p.textEdit]);if(!g)r.addEdit(p);else for(const f of g)r.addEdit(new is(p.resource,f,p.versionId,p.metadata))}else r.addEdit(p);e.push(r)});t.push(s)}return await Promise.all(t),e}_validateTasks(e){for(const t of e){const i=t.validate();if(!i.canApply)return i}return{canApply:!0}}async apply(){this._validateBeforePrepare();const e=await this._createEditsTasks();try{if(this._token.isCancellationRequested)return[];const t=[],i=this._validateTasks(e);if(!i.canApply)throw new Error(`${i.reason.toString()} has changed in the meantime`);if(e.length===1){const o=e[0];if(!o.isNoOp()){const s=new eh(this._label,this._code,o.model,o.getBeforeCursorState());this._undoRedoService.pushElement(s,this._undoRedoGroup,this._undoRedoSource),o.apply(),s.close(),t.push(o.model.uri)}this._progress.report(void 0)}else{const o=new Sw(this._label,this._code,e.map(s=>new eh(this._label,this._code,s.model,s.getBeforeCursorState())));this._undoRedoService.pushElement(o,this._undoRedoGroup,this._undoRedoSource);for(const s of e)s.apply(),this._progress.report(void 0),t.push(s.model.uri);o.close()}return t}finally{ie(e)}}};nc=C([h(8,Cw),h(9,Pl),h(10,Ki),h(11,Xn)],nc);function VS(c){return c.map(e=>{if(is.is(e))return is.lift(e);if(sn.is(e))return sn.lift(e);if(Mr.is(e))return Mr.lift(e);throw new Error("Unsupported edit")})}let rc=class{constructor(e,t,i,o,s,n,r,a,d,l,p){this._label=e,this._code=t,this._editor=i,this._progress=o,this._token=s,this._edits=n,this._undoRedoGroup=r,this._undoRedoSource=a,this._confirmBeforeUndo=d,this._instaService=l,this._logService=p}ariaMessage(){const e=new ot,t=new ot;let i=0;for(const o of this._edits)o instanceof is?(i+=1,t.set(o.resource,!0)):o instanceof sn&&e.set(o.oldResource??o.newResource,!0);return this._edits.length===0?u("summary.0","Made no edits"):e.size===0?i>1&&t.size>1?u("summary.nm","Made {0} text edits in {1} files",i,t.size):u("summary.n0","Made {0} text edits in one file",i):u("summary.textFiles","Made {0} text edits in {1} files, also created or deleted {2} files",i,t.size,e.size)}async perform(){if(this._edits.length===0)return[];const e=[1];for(let n=1;n<this._edits.length;n++)Object.getPrototypeOf(this._edits[n-1])===Object.getPrototypeOf(this._edits[n])?e[e.length-1]++:e.push(1);const t=this._edits.length>1?0:void 0;this._progress.report({increment:t,total:100});const i={report:n=>this._progress.report({increment:100/this._edits.length})},o=[];let s=0;for(const n of e){if(this._token.isCancellationRequested)break;const r=this._edits.slice(s,s+n);r[0]instanceof sn?o.push(await this._performFileEdits(r,this._undoRedoGroup,this._undoRedoSource,this._confirmBeforeUndo,i)):r[0]instanceof is?o.push(await this._performTextEdits(r,this._undoRedoGroup,this._undoRedoSource,i)):r[0]instanceof Mr?o.push(await this._performCellEdits(r,this._undoRedoGroup,this._undoRedoSource,i)):console.log("UNKNOWN EDIT"),s=s+n}return o.flat()}async _performFileEdits(e,t,i,o,s){return this._logService.debug("_performFileEdits",JSON.stringify(e)),await this._instaService.createInstance(sc,this._label||u("workspaceEdit","Workspace Edit"),this._code||"undoredo.workspaceEdit",t,i,o,s,this._token,e).apply()}async _performTextEdits(e,t,i,o){return this._logService.debug("_performTextEdits",JSON.stringify(e)),await this._instaService.createInstance(nc,this._label||u("workspaceEdit","Workspace Edit"),this._code||"undoredo.workspaceEdit",this._editor,t,i,o,this._token,e).apply()}async _performCellEdits(e,t,i,o){return this._logService.debug("_performCellEdits",JSON.stringify(e)),await this._instaService.createInstance(Gm,t,i,o,this._token,e).apply()}};rc=C([h(9,I),h(10,it)],rc);let ac=class{constructor(e,t,i,o,s,n,r){this._instaService=e,this._logService=t,this._editorService=i,this._lifecycleService=o,this._dialogService=s,this._workingCopyService=n,this._configService=r,this._activeUndoRedoGroups=new Su}setPreviewHandler(e){return this._previewHandler=e,Y(()=>{this._previewHandler===e&&(this._previewHandler=void 0)})}hasPreviewHandler(){return!!this._previewHandler}async apply(e,t){let i=VS(Array.isArray(e)?e:e.edits);if(i.length===0)return{ariaSummary:u("nothing","Made no edits"),isApplied:!1};this._previewHandler&&(t!=null&&t.showPreview||i.some(l=>{var p;return(p=l.metadata)==null?void 0:p.needsConfirmation}))&&(i=await this._previewHandler(i,t));let o=t==null?void 0:t.editor;if(!o){const l=this._editorService.activeTextEditorControl;so(l)&&(o=l)}o&&o.getOption(88)&&(o=void 0);let s,n=()=>{};if(typeof(t==null?void 0:t.undoRedoGroupId)=="number"){for(const l of this._activeUndoRedoGroups)if(l.id===t.undoRedoGroupId){s=l;break}}s||(s=new Dw,n=this._activeUndoRedoGroups.push(s));const r=(t==null?void 0:t.quotableLabel)||(t==null?void 0:t.label),a=this._instaService.createInstance(rc,r,t==null?void 0:t.code,o,(t==null?void 0:t.progress)??kw.None,(t==null?void 0:t.token)??Bi.None,i,s,t==null?void 0:t.undoRedoSource,!!(t!=null&&t.confirmBeforeUndo));let d;try{d=this._lifecycleService.onBeforeShutdown(p=>p.veto(this._shouldVeto(r,p.reason),"veto.blukEditService"));const l=await a.perform();return t!=null&&t.respectAutoSaveConfig&&this._configService.getValue(Bp)===!0&&l.length>1&&await this._saveAll(l),{ariaSummary:a.ariaMessage(),isApplied:i.length>0}}catch(l){throw this._logService.error(l),l}finally{d==null||d.dispose(),n()}}async _saveAll(e){const t=new jr(e),i=this._workingCopyService.dirtyWorkingCopies.map(async s=>{t.has(s.resource)&&await s.save()}),o=await Promise.allSettled(i);for(const s of o)s.status==="rejected"&&this._logService.warn(s.reason)}async _shouldVeto(e,t){let i,o;switch(t){case 1:i=u("closeTheWindow.message","Are you sure you want to close the window?"),o=u({key:"closeTheWindow",comment:["&& denotes a mnemonic"]},"&&Close Window");break;case 4:i=u("changeWorkspace.message","Are you sure you want to change the workspace?"),o=u({key:"changeWorkspace",comment:["&& denotes a mnemonic"]},"Change &&Workspace");break;case 3:i=u("reloadTheWindow.message","Are you sure you want to reload the window?"),o=u({key:"reloadTheWindow",comment:["&& denotes a mnemonic"]},"&&Reload Window");break;default:i=u("quit.message","Are you sure you want to quit?"),o=u({key:"quit",comment:["&& denotes a mnemonic"]},"&&Quit");break}return!(await this._dialogService.confirm({message:i,detail:u("areYouSureQuiteBulkEdit.detail","'{0}' is in progress.",e||u("fileOperation","File operation")),primaryButton:o})).confirmed}};ac=C([h(0,I),h(1,it),h(2,P),h(3,_o),h(4,uc),h(5,Al),h(6,O)],ac);const Bp="files.refactoring.autoSave";M.as(Yc.Configuration).registerConfiguration({id:"files",properties:{[Bp]:{description:u("refactoring.autoSave","Controls if files that were part of a refactoring are saved automatically"),default:!0,type:"boolean"}}});function OS(){return{[Gl.toString()]:new W(ac)}}const nr=new Map,bd=new Map;class RS{constructor(){this.onDidPaneCompositeOpen=A.None,this.onDidPaneCompositeClose=A.None}async openPaneComposite(e,t,i){var o;return(o=this.getPartByLocation(t))==null?void 0:o.openPaneComposite(e,i)}getActivePaneComposite(e){var t;return(t=this.getPartByLocation(e))==null?void 0:t.getActivePaneComposite()}getPaneComposite(e,t){var i;return(i=this.getPartByLocation(t))==null?void 0:i.getPaneComposite(e)}getPaneComposites(e){var t;return((t=this.getPartByLocation(e))==null?void 0:t.getPaneComposites())??[]}getPinnedPaneCompositeIds(e){var t;return((t=this.getSelectorPartByLocation(e))==null?void 0:t.getPinnedPaneCompositeIds())??[]}getVisiblePaneCompositeIds(e){var t;return((t=this.getSelectorPartByLocation(e))==null?void 0:t.getVisiblePaneCompositeIds())??[]}getProgressIndicator(e,t){var i;return(i=this.getPartByLocation(t))==null?void 0:i.getProgressIndicator(e)}hideActivePaneComposite(e){var t;(t=this.getPartByLocation(e))==null||t.hideActivePaneComposite()}getLastActivePaneCompositeId(e){return this.getPartByLocation(e).getLastActivePaneCompositeId()}showActivity(e,t,i,o,s){return this.getSelectorPartByLocation(t).showActivity(e,i,o,s)}getPartByLocation(e){return nr.get(e)}getSelectorPartByLocation(e){return bd.get(e)}}function LS(c,e,t){const i=document.createElement(e==="status"?"footer":"div");return i.classList.add("part",...t),i.id=c,i.setAttribute("role",e),e==="status"&&i.setAttribute("aria-live","off"),i}function Fs(c,e,t,i,o){const s=LS(c,e,t);o.append(s),s.oncontextmenu=()=>!1,i.create(s);function n(){i.layout(Math.max(i.minimumWidth,Math.min(i.maximumWidth,o.offsetWidth)),Math.max(i.minimumHeight,Math.min(i.maximumHeight,o.offsetHeight)),0,0)}i.onDidVisibilityChange(a=>{a&&n()}),n();const r=new ResizeObserver(n);return r.observe(o),{dispose(){return r.disconnect()}}}function bE(c){const e=Zt.get(I).createInstance(Qt,nr.get(0));return bd.set(0,e),e._register(Fs("workbench.parts.activitybar","none",["activitybar","left"],e,c)),e}function vE(c){const e=Zt.get(I).createInstance(rn);return nr.set(0,e),e._register(Fs("workbench.parts.sidebar","none",["sidebar","left"],e,c)),e.getPaneComposites().length>0&&e.openPaneComposite(e.getPaneComposites()[0].id),e}function wE(c){const e=Zt.get(I).createInstance(ln);return bd.set(1,e),nr.set(1,e),e._register(Fs("workbench.parts.panel","none",["panel","basepanel",tb(0)],e,c)),e.getPaneComposites().length>0&&e.openPaneComposite(e.getPaneComposites()[0].id),e}function yE(c){const e=Zt.get(ee);return Fs("workbench.parts.editor","main",["editor"],e,c)}function CE(c){const e=Zt.get(oi);return Fs("workbench.parts.statusbar","status",["statusbar"],e,c)}function _E(c){let e=class extends Ir{constructor(s,n,r){super(c.id,s,n,r)}createEditor(s){this.content=z(".editor-pane-content"),this.content.style.display="flex",this.content.style.alignItems="stretch",de(s,this.content),this._register(c.renderBody(this.content))}layout(s){this.content.style.height=`${s.height}px`,this.content.style.width=`${s.width}px`}};e=C([h(0,Ne),h(1,te),h(2,oe)],e);class t extends Vl{constructor(s){super(),this.closeHandler=s,this.name=c.name,this.title=c.name,this.description=c.name,this.dirty=!1}get typeId(){return t.ID}get resource(){}setName(s){this.name=s,this._onDidChangeLabel.fire()}setTitle(s){this.title=s,this._onDidChangeLabel.fire()}setDescription(s){this.description=s,this._onDidChangeLabel.fire()}getLabelValue(s,n){if(typeof s=="string")return s;switch(n){case 0:return s.short;case 2:return s.long;case 1:default:return s.medium}}getName(){return this.name}getTitle(s){return this.getLabelValue(this.title,s)}getDescription(s){return this.getLabelValue(this.description,s)}isDirty(){return this.dirty}setDirty(s){this.dirty=s,this._onDidChangeDirty.fire()}}return t.ID=`workbench.editors.${c.id}Input`,{disposable:M.as(ii.EditorPane).registerEditorPane(Ss.create(e,c.id,c.name),[new W(t)]),CustomEditorInput:t}}function EE(c){const e=c.icon!=null?T.parse(c.icon):void 0,t=M.as(Xe.ViewContainersRegistry).registerViewContainer({id:c.id,title:c.name,order:c.order,ctorDescriptor:new W(hc,[c.id,{mergeViewWithContainerWhenSingleView:!0}]),hideIfEmpty:!0,icon:e},c.location),i=[{id:c.id,name:c.name,canToggleVisibility:!1,ctorDescriptor:new W(class extends Wn{renderBody(s){super.renderBody(s),this.content=z(".view-pane-content"),this.content.style.display="flex",this.content.style.alignItems="stretch",de(s,this.content),this._register(c.renderBody(this.content))}getActionViewItem(s,n){const r=(c.actions??[]).find(a=>a.id===s.id);return(r==null?void 0:r.render)!=null?new class extends xw{constructor(){super(null,s),this.render=r.render}}:super.getActionViewItem(s,n)}layoutBody(s,n){this.content.style.height=`${s}px`,this.content.style.width=`${n}px`}}),canMoveView:c.canMoveView??!0,containerIcon:e}];M.as(Xe.ViewsRegistry).registerViews(i,t),(c.default??!1)&&Zt.get(_o).when(4).then(()=>{Zt.get(Pn).openViewContainer(c.id)});const o=new x;o.add({dispose(){M.as(Xe.ViewsRegistry).deregisterViews(i,t),M.as(Xe.ViewContainersRegistry).deregisterViewContainer(t)}});for(const s of c.actions??[])o.add(j(class extends ye{constructor(){super({id:s.id,title:{value:s.title,original:s.title},category:fe.View,menu:[{id:S.ViewTitle,when:v.equals("view",c.id),group:"navigation",order:s.order},{id:S.CommandPalette}],tooltip:s.tooltip,icon:s.icon!=null?le[s.icon]:void 0}),this.run=s.run??(async()=>{})}}));return o}let cc=class{constructor(e){this.editorPart=e}createEditorDropTarget(e,t){return this.editorPart.createEditorDropTarget(e,t)}};cc=C([h(0,ee)],cc);function MS(){var e;return((e=Zt.get(ee).getContainer())==null?void 0:e.isConnected)??!1}let dc=class extends qa{constructor(e,t,i,o,s,n,r,a,d,l,p,g){super(t,i,o,s,n,r,a,d,l,p),this.openEditor=Nw(g,this.openEditor.bind(this),e)}get activeTextEditorControl(){return super.activeTextEditorControl??Zt.get(qi).getFocusedCodeEditor()??void 0}async openEditor(e,t,i){if(MS())return super.openEditor(e,t,i)}};dc=C([h(1,ee),h(2,I),h(3,Ce),h(4,O),h(5,ze),h(6,si),h(7,_s),h(8,Cu),h(9,ti),h(10,Hn),h(11,Ki)],dc);let No;Um({"vs/workbench/contrib/webview/browser/pre/service-worker.js":()=>Bs(new URL("/assets/service-worker-90548569.js",self.location).href,No),"vs/workbench/contrib/webview/browser/pre/index.html":()=>Bs(new URL("/assets/index-96e0339d.html",self.location).href,No),"vs/workbench/contrib/webview/browser/pre/index-no-csp.html":()=>Bs(new URL("/assets/index-no-csp-1bc96807.html",self.location).href,No),"vs/workbench/contrib/webview/browser/pre/fake.html":()=>Bs(new URL("/assets/fake-dfa91b18.html",self.location).href,No)});function xE(c,e){return e!=null&&(No=e),{...zm(),...OS(),[Pn.toString()]:new W(Aw),[Qe.toString()]:new W(os),[So.toString()]:new W(Qr),[Si.toString()]:new W(RS),[Mt.toString()]:new W(sa),[nt.toString()]:new W(dn),[qi.toString()]:new W(Fw),[Hn.toString()]:new W(Km),[ee.toString()]:new W(as),[oi.toString()]:new W(Ya),[$m.toString()]:new W(cc),[P.toString()]:new W(dc,[c]),[_s.toString()]:new W(Co),[Pt.toString()]:new W(qm),[$n.toString()]:new W(Iw),[jm.toString()]:new W(Ym),[Jm.toString()]:new W(Xm),[Zm.toString()]:new W(yi),[Rn.toString()]:new W(sS),[Dl.toString()]:new W(Ja),[Do.toString()]:new W(tc),[_l.toString()]:new W(Qm),[xc.toString()]:new W(eb)}}export{Qr as ActivityService,Qt as ActivitybarPart,TE as ConfirmResult,sa as HoverService,ln as PanelPart,rn as SidebarPart,Ya as StatusbarPart,VE as ViewContainerLocation,xE as default,MS as isEditorPartVisible,EE as registerCustomView,_E as registerEditorPane,bE as renderActivitybarPar,yE as renderEditorPart,wE as renderPanelPart,vE as renderSidebarPart,CE as renderStatusBarPart};
